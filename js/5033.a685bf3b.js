"use strict";(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[5033],{56239:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modern-bg"},[e("el-row",{attrs:{gutter:0,justify:"center"}},[e("el-col",{attrs:{xs:{span:24,offset:0},sm:{span:22,offset:1},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:12,offset:6}}},[e("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"page-header"},[e("h1",[t._v("ğŸ“Š VCFè½¬Excelé€šè®¯å½•")]),e("p",[t._v("å°†VCFé€šè®¯å½•æ–‡ä»¶è½¬æ¢ä¸ºExcelè¡¨æ ¼ï¼Œæ–¹ä¾¿ç¼–è¾‘å’Œç®¡ç†è”ç³»äºº")])]),e("div",{staticClass:"upload-section"},[e("el-upload",{staticClass:"upload-dragger",attrs:{action:"#",drag:"","file-list":t.fileList,"before-upload":t.beforeUpload,"on-change":t.handleFileChange,"auto-upload":!1,accept:".vcf",limit:1}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("å°†VCFæ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–"),e("em",[t._v("ç‚¹å‡»ä¸Šä¼ ")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" æ”¯æŒ.vcfæ ¼å¼æ–‡ä»¶ï¼Œæœ€å¤§10MB ")])])],1),t.contacts.length>0?e("div",{staticClass:"preview-section"},[e("h3",[t._v("è§£æç»“æœé¢„è§ˆ (å…± "+t._s(t.contacts.length)+" ä¸ªè”ç³»äºº)")]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.previewContacts,size:"small",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"å§“å",width:"120"}}),e("el-table-column",{attrs:{prop:"phone",label:"ç”µè¯",width:"150"}}),e("el-table-column",{attrs:{prop:"email",label:"é‚®ç®±",width:"200"}}),e("el-table-column",{attrs:{prop:"company",label:"å…¬å¸",width:"120"}}),e("el-table-column",{attrs:{prop:"address",label:"åœ°å€","show-overflow-tooltip":""}})],1),t.contacts.length>5?e("p",{staticClass:"preview-tip"},[t._v(" ä»…æ˜¾ç¤ºå‰5æ¡æ•°æ®ï¼Œå®Œæ•´æ•°æ®å°†åœ¨Excelä¸­æ˜¾ç¤º ")]):t._e()],1):t._e(),t.contacts.length>0?e("div",{staticClass:"options-section"},[e("h3",[t._v("å¯¼å‡ºé€‰é¡¹")]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-checkbox",{model:{value:t.exportOptions.includeEmpty,callback:function(e){t.$set(t.exportOptions,"includeEmpty",e)},expression:"exportOptions.includeEmpty"}},[t._v("åŒ…å«ç©ºå­—æ®µåˆ—")])],1),e("el-col",{attrs:{span:12}},[e("el-checkbox",{model:{value:t.exportOptions.formatPhone,callback:function(e){t.$set(t.exportOptions,"formatPhone",e)},expression:"exportOptions.formatPhone"}},[t._v("æ ¼å¼åŒ–ç”µè¯å·ç ")])],1)],1)],1):t._e(),e("div",{staticClass:"action-section"},[e("el-button",{attrs:{type:"primary",disabled:0===t.contacts.length,loading:t.converting,size:"large"},on:{click:t.convertToExcel}},[e("i",{staticClass:"el-icon-download"}),t._v(" è½¬æ¢å¹¶ä¸‹è½½Excelæ–‡ä»¶ ")]),e("el-button",{attrs:{size:"large"},on:{click:t.clearAll}},[e("i",{staticClass:"el-icon-refresh"}),t._v(" æ¸…ç©ºé‡ç½® ")])],1),e("div",{staticClass:"usage-guide"},[e("h3",[t._v("ä½¿ç”¨è¯´æ˜")]),e("div",{staticClass:"guide-content"},[e("div",{staticClass:"guide-section"},[e("h4",[t._v("æ”¯æŒæ ¼å¼")]),e("ul",[e("li",[t._v("è¾“å…¥æ ¼å¼ï¼šVCF (vCard) é€šè®¯å½•æ–‡ä»¶")]),e("li",[t._v("è¾“å‡ºæ ¼å¼ï¼šExcelæ–‡ä»¶ (.xlsx)")]),e("li",[t._v("æ–‡ä»¶å¤§å°ï¼šæœ€å¤§10MB")]),e("li",[t._v("å…¼å®¹ç‰ˆæœ¬ï¼švCard 2.1ã€3.0ã€4.0")])])]),e("div",{staticClass:"guide-section"},[e("h4",[t._v("ä½¿ç”¨æ­¥éª¤")]),e("ol",[e("li",[t._v("ä»æ‰‹æœºæˆ–å…¶ä»–è®¾å¤‡å¯¼å‡ºVCFé€šè®¯å½•æ–‡ä»¶")]),e("li",[t._v("ä¸Šä¼ VCFæ–‡ä»¶åˆ°æœ¬å·¥å…·")]),e("li",[t._v("é¢„è§ˆè§£æç»“æœï¼Œç¡®è®¤è”ç³»äººä¿¡æ¯")]),e("li",[t._v("é€‰æ‹©å¯¼å‡ºé€‰é¡¹ï¼ˆå¯é€‰ï¼‰")]),e("li",[t._v("ç‚¹å‡»è½¬æ¢æŒ‰é’®ä¸‹è½½Excelæ–‡ä»¶")]),e("li",[t._v("ä½¿ç”¨Excelç¼–è¾‘å’Œç®¡ç†è”ç³»äººä¿¡æ¯")])])]),e("div",{staticClass:"guide-section"},[e("h4",[t._v("å¯¼å‡ºå­—æ®µ")]),e("ul",[e("li",[e("strong",[t._v("å§“å")]),t._v("ï¼šè”ç³»äººå§“å")]),e("li",[e("strong",[t._v("ç”µè¯")]),t._v("ï¼šä¸»è¦ç”µè¯å·ç ")]),e("li",[e("strong",[t._v("é‚®ç®±")]),t._v("ï¼šç”µå­é‚®ä»¶åœ°å€")]),e("li",[e("strong",[t._v("å…¬å¸")]),t._v("ï¼šå·¥ä½œå•ä½")]),e("li",[e("strong",[t._v("åœ°å€")]),t._v("ï¼šè”ç³»åœ°å€")]),e("li",[e("strong",[t._v("å¤‡æ³¨")]),t._v("ï¼šå…¶ä»–ä¿¡æ¯")])])]),e("div",{staticClass:"guide-section"},[e("h4",[t._v("æ³¨æ„äº‹é¡¹")]),e("ul",[e("li",[t._v("æ”¯æŒä»iPhoneã€Androidã€Outlookç­‰è®¾å¤‡å¯¼å‡ºçš„VCFæ–‡ä»¶")]),e("li",[t._v("è‡ªåŠ¨è¯†åˆ«ä¸­æ–‡å’Œè‹±æ–‡è”ç³»äººä¿¡æ¯")]),e("li",[t._v("å¤šä¸ªç”µè¯å·ç ä¼šåˆå¹¶æ˜¾ç¤ºï¼Œç”¨åˆ†å·åˆ†éš”")]),e("li",[t._v("ç©ºå­—æ®µå¯é€‰æ‹©æ˜¯å¦åœ¨Excelä¸­æ˜¾ç¤º")]),e("li",[t._v("ç”Ÿæˆçš„Excelæ–‡ä»¶å¯ç›´æ¥ç”¨äºExcelè½¬VCFåŠŸèƒ½")])])])])])])],1)],1)],1)},s=[],n=(a(44114),a(93230)),c=a(95866),i={name:"VcfToExcelView",metaInfo:{title:"VCFè½¬Excelé€šè®¯å½• - è”ç³»äººç®¡ç†å·¥å…·",meta:[{name:"description",content:"å°†VCFé€šè®¯å½•æ–‡ä»¶è½¬æ¢ä¸ºExcelè¡¨æ ¼ï¼Œæ–¹ä¾¿ç¼–è¾‘å’Œç®¡ç†è”ç³»äººä¿¡æ¯ã€‚"},{name:"keywords",content:"VCFè½¬Excel,é€šè®¯å½•è½¬æ¢,è”ç³»äººå¯¼å‡º,VCFè§£æ,Excelç”Ÿæˆ"}]},data(){return{fileList:[],contacts:[],converting:!1,exportOptions:{includeEmpty:!1,formatPhone:!0}}},computed:{previewContacts(){return this.contacts.slice(0,5)}},methods:{beforeUpload(t){const e="text/vcard"===t.type||t.name.toLowerCase().endsWith(".vcf"),a=t.size/1024/1024<10;return e?(a||this.$message.error("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB!"),!1):(this.$message.error("åªèƒ½ä¸Šä¼ VCFæ ¼å¼çš„æ–‡ä»¶!"),!1)},async handleFileChange(t){t.raw&&(this.fileList=[t],await this.parseVcfFile(t.raw))},async parseVcfFile(t){try{const e=await this.fileToText(t);this.contacts=this.parseVcfContent(e),0===this.contacts.length?this.$message.warning("æœªæ‰¾åˆ°æœ‰æ•ˆçš„è”ç³»äººä¿¡æ¯"):this.$message.success(`æˆåŠŸè§£æ ${this.contacts.length} ä¸ªè”ç³»äºº`)}catch(e){console.error("è§£æVCFæ–‡ä»¶å¤±è´¥:",e),this.$message.error("è§£æVCFæ–‡ä»¶å¤±è´¥: "+e.message)}},fileToText(t){return new Promise(((e,a)=>{const o=new FileReader;o.onload=t=>e(t.target.result),o.onerror=a,o.readAsText(t,"UTF-8")}))},parseVcfContent(t){const e=[],a=t.split(/BEGIN:VCARD/i).slice(1);return a.forEach((t=>{try{const a=this.parseVcardBlock("BEGIN:VCARD"+t);(a.name||a.phone)&&e.push(a)}catch(a){console.warn("è§£ævCardå—å¤±è´¥:",a)}})),e},parseVcardBlock(t){const e={name:"",phone:"",email:"",company:"",address:"",note:""},a=t.split(/\r?\n/);return a.forEach((t=>{if(t=t.trim(),t){if(t.match(/^FN[:;]/i)&&(e.name=this.extractVcfValue(t)),t.match(/^TEL[:;]/i)){const a=this.extractVcfValue(t);a&&(e.phone=e.phone?e.phone+"; "+a:a)}if(t.match(/^EMAIL[:;]/i)){const a=this.extractVcfValue(t);a&&(e.email=e.email?e.email+"; "+a:a)}if(t.match(/^ORG[:;]/i)&&(e.company=this.extractVcfValue(t)),t.match(/^ADR[:;]/i)){const a=this.extractVcfValue(t);e.address=a.replace(/;+/g," ").trim()}t.match(/^NOTE[:;]/i)&&(e.note=this.extractVcfValue(t))}})),this.exportOptions.formatPhone&&e.phone&&(e.phone=this.formatPhoneNumbers(e.phone)),e},extractVcfValue(t){const e=t.indexOf(":");if(-1===e)return"";let a=t.substring(e+1).trim();return a=a.replace(/\\n/g,"\n").replace(/\\;/g,";").replace(/\\,/g,",").replace(/\\\\/g,"\\"),a},formatPhoneNumbers(t){return t.split(";").map((t=>(t=t.trim(),t=t.replace(/[\s\-()ï¼ˆï¼‰]/g,""),/^(\+86)?1[3-9]\d{9}$/.test(t)?(t=t.replace(/^\+?86/,""),t.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3")):t))).join("; ")},async convertToExcel(){if(0!==this.contacts.length){this.converting=!0;try{const t=["å§“å","ç”µè¯","é‚®ç®±","å…¬å¸","åœ°å€","å¤‡æ³¨"],e=[t];this.contacts.forEach((t=>{const a=[t.name||"",t.phone||"",t.email||"",t.company||"",t.address||"",t.note||""];(this.exportOptions.includeEmpty||a.slice(1).some((t=>t.trim())))&&e.push(a)}));const a=n.Wp.book_new(),o=n.Wp.aoa_to_sheet(e),s=[{wch:12},{wch:18},{wch:25},{wch:15},{wch:25},{wch:20}];o["!cols"]=s;const i=n.Wp.decode_range(o["!ref"]);for(let c=i.s.c;c<=i.e.c;c++){const t=n.Wp.encode_cell({r:0,c:c});o[t]&&(o[t].s={font:{bold:!0},fill:{fgColor:{rgb:"FFCCCCCC"}}})}n.Wp.book_append_sheet(a,o,"é€šè®¯å½•");const l=c.A.generateTimestampFilename("é€šè®¯å½•","xlsx");n._h(a,l),this.$message.success(`Excelæ–‡ä»¶å·²ç”Ÿæˆï¼å…±å¯¼å‡º ${e.length-1} ä¸ªè”ç³»äºº`)}catch(t){console.error("è½¬æ¢å¤±è´¥:",t),this.$message.error("è½¬æ¢å¤±è´¥: "+t.message)}finally{this.converting=!1}}else this.$message.warning("æ²¡æœ‰å¯è½¬æ¢çš„è”ç³»äººæ•°æ®")},clearAll(){this.fileList=[],this.contacts=[],this.exportOptions={includeEmpty:!1,formatPhone:!0},this.$message.info("å·²æ¸…ç©ºæ‰€æœ‰æ•°æ®")}}},l=i,r=a(81656),d=(0,r.A)(l,o,s,!1,null,"39cfa25e",null),p=d.exports},95866:function(t,e,a){a(16280),a(14603),a(47566),a(98721);class o{static downloadText(t,e,a="text/plain"){const o=new Blob([t],{type:a});this.downloadBlob(o,e)}static downloadJSON(t,e="data.json"){const a=JSON.stringify(t,null,2);this.downloadText(a,e,"application/json")}static downloadCSV(t,e="data.csv",a=null){let o="";a&&a.length>0&&(o+=a.join(",")+"\n"),t.forEach((t=>{if(Array.isArray(t))o+=t.map((t=>`"${t}"`)).join(",")+"\n";else if("object"===typeof t){const e=a?a.map((e=>t[e]||"")):Object.values(t);o+=e.map((t=>`"${t}"`)).join(",")+"\n"}}));const s="\ufeff";this.downloadText(s+o,e,"text/csv;charset=utf-8")}static downloadImage(t,e="image.png"){const a=document.createElement("a");a.download=e,a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}static downloadCanvas(t,e="canvas.png",a="image/png",o=1){const s=t.toDataURL(a,o);this.downloadImage(s,e)}static downloadBlob(t,e){const a=URL.createObjectURL(t),o=document.createElement("a");o.href=a,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}static downloadURL(t,e){const a=document.createElement("a");a.href=t,a.download=e,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}static async downloadZip(t,e="files.zip"){const o=(await a.e(4813).then(a.t.bind(a,44813,23))).default,s=new o;t.forEach((t=>{t.content,Blob,s.file(t.name,t.content)}));try{const t=await s.generateAsync({type:"blob"});return this.downloadBlob(t,e),!0}catch(n){return console.error("ç”ŸæˆZIPæ–‡ä»¶å¤±è´¥:",n),!1}}static async fetchBlob(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.blob()}catch(e){throw console.error("è·å–æ–‡ä»¶å¤±è´¥:",e),e}}static generateTimestampFilename(t,e){const a=(new Date).toISOString().replace(/[:.]/g,"-").slice(0,-5);return`${t}_${a}.${e}`}static formatFileSize(t){if(0===t)return"0 Bytes";const e=1024,a=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,o)).toFixed(2))+" "+a[o]}}e.A=o},67979:function(t,e,a){var o=a(28551);t.exports=function(){var t=o(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},69479:function(t,e,a){var o=a(44576),s=a(43724),n=a(62106),c=a(67979),i=a(79039),l=o.RegExp,r=l.prototype,d=s&&i((function(){var t=!0;try{l(".","d")}catch(d){t=!1}var e={},a="",o=t?"dgimsy":"gimsy",s=function(t,o){Object.defineProperty(e,t,{get:function(){return a+=o,!0}})},n={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var c in t&&(n.hasIndices="d"),n)s(c,n[c]);var i=Object.getOwnPropertyDescriptor(r,"flags").get.call(e);return i!==o||a!==o}));d&&n(r,"flags",{configurable:!0,get:c})}}]);