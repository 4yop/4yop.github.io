"use strict";(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[2523],{12523:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modern-bg"},[t("el-row",{attrs:{gutter:0,justify:"center"}},[t("el-col",{attrs:{xs:{span:24,offset:0},sm:{span:22,offset:1},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:12,offset:6}}},[t("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"page-header"},[t("h1",[e._v("ğŸ“Š VCFè½¬Excelé€šè®¯å½•")]),t("p",[e._v("å°†VCFé€šè®¯å½•æ–‡ä»¶è½¬æ¢ä¸ºExcelè¡¨æ ¼ï¼Œæ–¹ä¾¿ç¼–è¾‘å’Œç®¡ç†è”ç³»äºº")])]),t("div",{staticClass:"upload-section"},[t("el-upload",{staticClass:"upload-dragger",attrs:{drag:"","file-list":e.fileList,"before-upload":e.beforeUpload,"on-change":e.handleFileChange,"auto-upload":!1,accept:".vcf",limit:1}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("å°†VCFæ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–"),t("em",[e._v("ç‚¹å‡»ä¸Šä¼ ")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" æ”¯æŒ.vcfæ ¼å¼æ–‡ä»¶ï¼Œæœ€å¤§10MB ")])])],1),e.contacts.length>0?t("div",{staticClass:"preview-section"},[t("h3",[e._v("è§£æç»“æœé¢„è§ˆ (å…± "+e._s(e.contacts.length)+" ä¸ªè”ç³»äºº)")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.previewContacts,size:"small",border:""}},[t("el-table-column",{attrs:{prop:"name",label:"å§“å",width:"120"}}),t("el-table-column",{attrs:{prop:"phone",label:"ç”µè¯",width:"150"}}),t("el-table-column",{attrs:{prop:"email",label:"é‚®ç®±",width:"200"}}),t("el-table-column",{attrs:{prop:"company",label:"å…¬å¸",width:"120"}}),t("el-table-column",{attrs:{prop:"address",label:"åœ°å€","show-overflow-tooltip":""}})],1),e.contacts.length>5?t("p",{staticClass:"preview-tip"},[e._v(" ä»…æ˜¾ç¤ºå‰5æ¡æ•°æ®ï¼Œå®Œæ•´æ•°æ®å°†åœ¨Excelä¸­æ˜¾ç¤º ")]):e._e()],1):e._e(),e.contacts.length>0?t("div",{staticClass:"options-section"},[t("h3",[e._v("å¯¼å‡ºé€‰é¡¹")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-checkbox",{model:{value:e.exportOptions.includeEmpty,callback:function(t){e.$set(e.exportOptions,"includeEmpty",t)},expression:"exportOptions.includeEmpty"}},[e._v("åŒ…å«ç©ºå­—æ®µåˆ—")])],1),t("el-col",{attrs:{span:12}},[t("el-checkbox",{model:{value:e.exportOptions.formatPhone,callback:function(t){e.$set(e.exportOptions,"formatPhone",t)},expression:"exportOptions.formatPhone"}},[e._v("æ ¼å¼åŒ–ç”µè¯å·ç ")])],1)],1)],1):e._e(),t("div",{staticClass:"action-section"},[t("el-button",{attrs:{type:"primary",disabled:0===e.contacts.length,loading:e.converting,size:"large"},on:{click:e.convertToExcel}},[t("i",{staticClass:"el-icon-download"}),e._v(" è½¬æ¢å¹¶ä¸‹è½½Excelæ–‡ä»¶ ")]),t("el-button",{attrs:{size:"large"},on:{click:e.clearAll}},[t("i",{staticClass:"el-icon-refresh"}),e._v(" æ¸…ç©ºé‡ç½® ")])],1),t("div",{staticClass:"usage-guide"},[t("h3",[e._v("ä½¿ç”¨è¯´æ˜")]),t("div",{staticClass:"guide-content"},[t("div",{staticClass:"guide-section"},[t("h4",[e._v("æ”¯æŒæ ¼å¼")]),t("ul",[t("li",[e._v("è¾“å…¥æ ¼å¼ï¼šVCF (vCard) é€šè®¯å½•æ–‡ä»¶")]),t("li",[e._v("è¾“å‡ºæ ¼å¼ï¼šExcelæ–‡ä»¶ (.xlsx)")]),t("li",[e._v("æ–‡ä»¶å¤§å°ï¼šæœ€å¤§10MB")]),t("li",[e._v("å…¼å®¹ç‰ˆæœ¬ï¼švCard 2.1ã€3.0ã€4.0")])])]),t("div",{staticClass:"guide-section"},[t("h4",[e._v("ä½¿ç”¨æ­¥éª¤")]),t("ol",[t("li",[e._v("ä»æ‰‹æœºæˆ–å…¶ä»–è®¾å¤‡å¯¼å‡ºVCFé€šè®¯å½•æ–‡ä»¶")]),t("li",[e._v("ä¸Šä¼ VCFæ–‡ä»¶åˆ°æœ¬å·¥å…·")]),t("li",[e._v("é¢„è§ˆè§£æç»“æœï¼Œç¡®è®¤è”ç³»äººä¿¡æ¯")]),t("li",[e._v("é€‰æ‹©å¯¼å‡ºé€‰é¡¹ï¼ˆå¯é€‰ï¼‰")]),t("li",[e._v("ç‚¹å‡»è½¬æ¢æŒ‰é’®ä¸‹è½½Excelæ–‡ä»¶")]),t("li",[e._v("ä½¿ç”¨Excelç¼–è¾‘å’Œç®¡ç†è”ç³»äººä¿¡æ¯")])])]),t("div",{staticClass:"guide-section"},[t("h4",[e._v("å¯¼å‡ºå­—æ®µ")]),t("ul",[t("li",[t("strong",[e._v("å§“å")]),e._v("ï¼šè”ç³»äººå§“å")]),t("li",[t("strong",[e._v("ç”µè¯")]),e._v("ï¼šä¸»è¦ç”µè¯å·ç ")]),t("li",[t("strong",[e._v("é‚®ç®±")]),e._v("ï¼šç”µå­é‚®ä»¶åœ°å€")]),t("li",[t("strong",[e._v("å…¬å¸")]),e._v("ï¼šå·¥ä½œå•ä½")]),t("li",[t("strong",[e._v("åœ°å€")]),e._v("ï¼šè”ç³»åœ°å€")]),t("li",[t("strong",[e._v("å¤‡æ³¨")]),e._v("ï¼šå…¶ä»–ä¿¡æ¯")])])]),t("div",{staticClass:"guide-section"},[t("h4",[e._v("æ³¨æ„äº‹é¡¹")]),t("ul",[t("li",[e._v("æ”¯æŒä»iPhoneã€Androidã€Outlookç­‰è®¾å¤‡å¯¼å‡ºçš„VCFæ–‡ä»¶")]),t("li",[e._v("è‡ªåŠ¨è¯†åˆ«ä¸­æ–‡å’Œè‹±æ–‡è”ç³»äººä¿¡æ¯")]),t("li",[e._v("å¤šä¸ªç”µè¯å·ç ä¼šåˆå¹¶æ˜¾ç¤ºï¼Œç”¨åˆ†å·åˆ†éš”")]),t("li",[e._v("ç©ºå­—æ®µå¯é€‰æ‹©æ˜¯å¦åœ¨Excelä¸­æ˜¾ç¤º")]),t("li",[e._v("ç”Ÿæˆçš„Excelæ–‡ä»¶å¯ç›´æ¥ç”¨äºExcelè½¬VCFåŠŸèƒ½")])])])])])])],1)],1)],1)},l=[],o=(s(44114),s(93230)),i=s(95866),c={name:"VcfToExcelView",data(){return{metaInfo:{title:"VCFè½¬Excelé€šè®¯å½• - è”ç³»äººç®¡ç†å·¥å…·",meta:[{name:"description",content:"å°†VCFé€šè®¯å½•æ–‡ä»¶è½¬æ¢ä¸ºExcelè¡¨æ ¼ï¼Œæ–¹ä¾¿ç¼–è¾‘å’Œç®¡ç†è”ç³»äººä¿¡æ¯ã€‚"},{name:"keywords",content:"VCFè½¬Excel,é€šè®¯å½•è½¬æ¢,è”ç³»äººå¯¼å‡º,VCFè§£æ,Excelç”Ÿæˆ"}]},fileList:[],contacts:[],converting:!1,exportOptions:{includeEmpty:!1,formatPhone:!0}}},computed:{previewContacts(){return this.contacts.slice(0,5)}},methods:{beforeUpload(e){const t="text/vcard"===e.type||e.name.toLowerCase().endsWith(".vcf"),s=e.size/1024/1024<10;return t?(s||this.$message.error("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB!"),!1):(this.$message.error("åªèƒ½ä¸Šä¼ VCFæ ¼å¼çš„æ–‡ä»¶!"),!1)},async handleFileChange(e){e.raw&&(this.fileList=[e],await this.parseVcfFile(e.raw))},async parseVcfFile(e){try{const t=await this.fileToText(e);this.contacts=this.parseVcfContent(t),0===this.contacts.length?this.$message.warning("æœªæ‰¾åˆ°æœ‰æ•ˆçš„è”ç³»äººä¿¡æ¯"):this.$message.success(`æˆåŠŸè§£æ ${this.contacts.length} ä¸ªè”ç³»äºº`)}catch(t){console.error("è§£æVCFæ–‡ä»¶å¤±è´¥:",t),this.$message.error("è§£æVCFæ–‡ä»¶å¤±è´¥: "+t.message)}},fileToText(e){return new Promise(((t,s)=>{const a=new FileReader;a.onload=e=>t(e.target.result),a.onerror=s,a.readAsText(e,"UTF-8")}))},parseVcfContent(e){const t=[],s=e.split(/BEGIN:VCARD/i).slice(1);return s.forEach((e=>{try{const s=this.parseVcardBlock("BEGIN:VCARD"+e);(s.name||s.phone)&&t.push(s)}catch(s){console.warn("è§£ævCardå—å¤±è´¥:",s)}})),t},parseVcardBlock(e){const t={name:"",phone:"",email:"",company:"",address:"",note:""},s=e.split(/\r?\n/);return s.forEach((e=>{if(e=e.trim(),e){if(e.match(/^FN[:;]/i)&&(t.name=this.extractVcfValue(e)),e.match(/^TEL[:;]/i)){const s=this.extractVcfValue(e);s&&(t.phone=t.phone?t.phone+"; "+s:s)}if(e.match(/^EMAIL[:;]/i)){const s=this.extractVcfValue(e);s&&(t.email=t.email?t.email+"; "+s:s)}if(e.match(/^ORG[:;]/i)&&(t.company=this.extractVcfValue(e)),e.match(/^ADR[:;]/i)){const s=this.extractVcfValue(e);t.address=s.replace(/;+/g," ").trim()}e.match(/^NOTE[:;]/i)&&(t.note=this.extractVcfValue(e))}})),this.exportOptions.formatPhone&&t.phone&&(t.phone=this.formatPhoneNumbers(t.phone)),t},extractVcfValue(e){const t=e.indexOf(":");if(-1===t)return"";let s=e.substring(t+1).trim();return s=s.replace(/\\n/g,"\n").replace(/\\;/g,";").replace(/\\,/g,",").replace(/\\\\/g,"\\"),s},formatPhoneNumbers(e){return e.split(";").map((e=>(e=e.trim(),e=e.replace(/[\s\-()ï¼ˆï¼‰]/g,""),/^(\+86)?1[3-9]\d{9}$/.test(e)?(e=e.replace(/^\+?86/,""),e.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3")):e))).join("; ")},async convertToExcel(){if(0!==this.contacts.length){this.converting=!0;try{const e=["å§“å","ç”µè¯","é‚®ç®±","å…¬å¸","åœ°å€","å¤‡æ³¨"],t=[e];this.contacts.forEach((e=>{const s=[e.name||"",e.phone||"",e.email||"",e.company||"",e.address||"",e.note||""];(this.exportOptions.includeEmpty||s.slice(1).some((e=>e.trim())))&&t.push(s)}));const s=o.Wp.book_new(),a=o.Wp.aoa_to_sheet(t),l=[{wch:12},{wch:18},{wch:25},{wch:15},{wch:25},{wch:20}];a["!cols"]=l;const c=o.Wp.decode_range(a["!ref"]);for(let i=c.s.c;i<=c.e.c;i++){const e=o.Wp.encode_cell({r:0,c:i});a[e]&&(a[e].s={font:{bold:!0},fill:{fgColor:{rgb:"FFCCCCCC"}}})}o.Wp.book_append_sheet(s,a,"é€šè®¯å½•");const n=i.A.generateTimestampFilename("é€šè®¯å½•","xlsx");o._h(s,n),this.$message.success(`Excelæ–‡ä»¶å·²ç”Ÿæˆï¼å…±å¯¼å‡º ${t.length-1} ä¸ªè”ç³»äºº`)}catch(e){console.error("è½¬æ¢å¤±è´¥:",e),this.$message.error("è½¬æ¢å¤±è´¥: "+e.message)}finally{this.converting=!1}}else this.$message.warning("æ²¡æœ‰å¯è½¬æ¢çš„è”ç³»äººæ•°æ®")},clearAll(){this.fileList=[],this.contacts=[],this.exportOptions={includeEmpty:!1,formatPhone:!0},this.$message.info("å·²æ¸…ç©ºæ‰€æœ‰æ•°æ®")}}},n=c,r=s(81656),p=(0,r.A)(n,a,l,!1,null,"2aa6a6ea",null),h=p.exports}}]);
//# sourceMappingURL=2523.794215e8.js.map