(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[926],{926:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return W}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modern-bg"},[e("el-row",{attrs:{gutter:0,justify:"center"}},[e("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:16,offset:4},lg:{span:12,offset:6},xl:{span:10,offset:7}}},[e("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[e("h2",{staticClass:"modern-title"},[t._v("图片压缩")]),e("el-divider"),e("el-upload",{staticClass:"modern-upload",attrs:{"auto-upload":!1,multiple:!0,action:"#","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-change":t.handleChange}},[e("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),e("div",{staticClass:"block modern-slider-block"},[e("div",[e("span",{staticClass:"demonstration"},[t._v("压缩率")]),e("el-slider",{staticClass:"modern-slider",attrs:{"show-input":""},model:{value:t.compressVal,callback:function(e){t.compressVal=e},expression:"compressVal"}})],1),e("div",[e("span",{staticClass:"demonstration"},[t._v("保存格式")]),e("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择保存格式"},model:{value:t.saveFormat,callback:function(e){t.saveFormat=e},expression:"saveFormat"}},t._l(t.formatOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"modern-btn-group"},[e("el-button",{attrs:{type:"primary",round:""},on:{click:t.startCompress}},[t._v("开始压缩")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.compressFileList.length>0,expression:"compressFileList.length > 0"}],attrs:{type:"success",round:""},on:{click:t.startDownload}},[t._v("下载")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.compressFileList.length>0,expression:"compressFileList.length > 0"}],attrs:{type:"warning",round:""},on:{click:t.startDownloadAsZip}},[t._v("打包下载")])],1)])],1)],1)],1),e("el-row",{attrs:{gutter:0,justify:"center"}},[e("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:16,offset:4},lg:{span:12,offset:6},xl:{span:10,offset:7}}},[e("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[e("h3",{staticClass:"modern-title"},[t._v("压缩"+t._s(t.compressValue)+"%结果")]),e("el-divider"),e("el-row",{staticClass:"row-bg",attrs:{gutter:16}},t._l(t.compressFileList,(function(r){return e("el-col",{key:r.k,attrs:{xs:{span:12},sm:{span:8},md:{span:6},lg:{span:6},xl:{span:4}}},[e("el-card",{staticClass:"img-card",attrs:{shadow:"always"}},[e("el-image",{staticStyle:{width:"100px",height:"100px","border-radius":"12px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},attrs:{src:r.file_url,"preview-src-list":t.compressFileList.map((t=>t.file_url)),fit:"scale-down"}}),e("div",{staticClass:"img-info"},[t._v("压缩前:"+t._s(r.before_size))]),e("div",{staticClass:"img-info"},[t._v("压缩后:"+t._s(r.after_size))])],1)],1)})),1)],1)],1)],1)],1)},n=[],s=(r(44114),r(14603),r(47566),r(98721),r(79372)),a=r.n(s),o=r(75912);r(16280),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(64979),r(13611);function h(t,e){return e.forEach((function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((function(r){if("default"!==r&&!(r in t)){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}}))})),Object.freeze(t)}function l(t,e){return new Promise((function(r,i){let n;return c(t).then((function(t){try{return n=t,r(new Blob([e.slice(0,2),n,e.slice(2)],{type:"image/jpeg"}))}catch(t){return i(t)}}),i)}))}const c=t=>new Promise(((e,r)=>{const i=new FileReader;i.addEventListener("load",(({target:{result:t}})=>{const i=new DataView(t);let n=0;if(65496!==i.getUint16(n))return r("not a valid JPEG");for(n+=2;;){const s=i.getUint16(n);if(65498===s)break;const a=i.getUint16(n+2);if(65505===s&&1165519206===i.getUint32(n+4)){const s=n+10;let o;switch(i.getUint16(s)){case 18761:o=!0;break;case 19789:o=!1;break;default:return r("TIFF header contains invalid endian")}if(42!==i.getUint16(s+2,o))return r("TIFF header contains invalid version");const h=i.getUint32(s+4,o),l=s+h+2+12*i.getUint16(s+h,o);for(let t=s+h+2;t<l;t+=12)if(274==i.getUint16(t,o)){if(3!==i.getUint16(t+2,o))return r("Orientation data type is invalid");if(1!==i.getUint32(t+4,o))return r("Orientation data count is invalid");i.setUint16(t+8,1,o);break}return e(t.slice(n,n+2+a))}n+=2+a}return e(new Blob)})),i.readAsArrayBuffer(t)}));var u={},f={get exports(){return u},set exports(t){u=t}};!function(){var t,e,r={};f.exports=r,r.parse=function(t,e){for(var i=r.bin.readUshort,n=r.bin.readUint,s=0,a={},o=new Uint8Array(t),h=o.length-4;101010256!=n(o,h);)h--;s=h,s+=4;var l=i(o,s+=4);i(o,s+=2);var c=n(o,s+=2),u=n(o,s+=4);s+=4,s=u;for(var f=0;f<l;f++){n(o,s),s+=4,s+=4,s+=4,n(o,s+=4),c=n(o,s+=4);var d=n(o,s+=4),m=i(o,s+=4),g=i(o,s+2),p=i(o,s+4);s+=6;var w=n(o,s+=8);s+=4,s+=m+g+p,r._readLocal(o,w,a,c,d,e)}return a},r._readLocal=function(t,e,i,n,s,a){var o=r.bin.readUshort,h=r.bin.readUint;h(t,e),o(t,e+=4),o(t,e+=2);var l=o(t,e+=2);h(t,e+=2),h(t,e+=4),e+=4;var c=o(t,e+=8),u=o(t,e+=2);e+=2;var f=r.bin.readUTF8(t,e,c);if(e+=c,e+=u,a)i[f]={size:s,csize:n};else{var d=new Uint8Array(t.buffer,e);if(0==l)i[f]=new Uint8Array(d.buffer.slice(e,e+n));else{if(8!=l)throw"unknown compression method: "+l;var m=new Uint8Array(s);r.inflateRaw(d,m),i[f]=m}}},r.inflateRaw=function(t,e){return r.F.inflate(t,e)},r.inflate=function(t,e){return t[0],t[1],r.inflateRaw(new Uint8Array(t.buffer,t.byteOffset+2,t.length-6),e)},r.deflate=function(t,e){null==e&&(e={level:6});var i=0,n=new Uint8Array(50+Math.floor(1.1*t.length));n[i]=120,n[i+1]=156,i+=2,i=r.F.deflateRaw(t,n,i,e.level);var s=r.adler(t,0,t.length);return n[i+0]=s>>>24&255,n[i+1]=s>>>16&255,n[i+2]=s>>>8&255,n[i+3]=s>>>0&255,new Uint8Array(n.buffer,0,i+4)},r.deflateRaw=function(t,e){null==e&&(e={level:6});var i=new Uint8Array(50+Math.floor(1.1*t.length)),n=r.F.deflateRaw(t,i,n,e.level);return new Uint8Array(i.buffer,0,n)},r.encode=function(t,e){null==e&&(e=!1);var i=0,n=r.bin.writeUint,s=r.bin.writeUshort,a={};for(var o in t){var h=!r._noNeed(o)&&!e,l=t[o],c=r.crc.crc(l,0,l.length);a[o]={cpr:h,usize:l.length,crc:c,file:h?r.deflateRaw(l):l}}for(var o in a)i+=a[o].file.length+30+46+2*r.bin.sizeUTF8(o);i+=22;var u=new Uint8Array(i),f=0,d=[];for(var o in a){var m=a[o];d.push(f),f=r._writeHeader(u,f,o,m,0)}var g=0,p=f;for(var o in a)m=a[o],d.push(f),f=r._writeHeader(u,f,o,m,1,d[g++]);var w=f-p;return n(u,f,101010256),f+=4,s(u,f+=4,g),s(u,f+=2,g),n(u,f+=2,w),n(u,f+=4,p),f+=4,f+=2,u.buffer},r._noNeed=function(t){var e=t.split(".").pop().toLowerCase();return-1!="png,jpg,jpeg,zip".indexOf(e)},r._writeHeader=function(t,e,i,n,s,a){var o=r.bin.writeUint,h=r.bin.writeUshort,l=n.file;return o(t,e,0==s?67324752:33639248),e+=4,1==s&&(e+=2),h(t,e,20),h(t,e+=2,0),h(t,e+=2,n.cpr?8:0),o(t,e+=2,0),o(t,e+=4,n.crc),o(t,e+=4,l.length),o(t,e+=4,n.usize),h(t,e+=4,r.bin.sizeUTF8(i)),h(t,e+=2,0),e+=2,1==s&&(e+=2,e+=2,o(t,e+=6,a),e+=4),e+=r.bin.writeUTF8(t,e,i),0==s&&(t.set(l,e),e+=l.length),e},r.crc={table:function(){for(var t=new Uint32Array(256),e=0;e<256;e++){for(var r=e,i=0;i<8;i++)1&r?r=3988292384^r>>>1:r>>>=1;t[e]=r}return t}(),update:function(t,e,i,n){for(var s=0;s<n;s++)t=r.crc.table[255&(t^e[i+s])]^t>>>8;return t},crc:function(t,e,i){return 4294967295^r.crc.update(4294967295,t,e,i)}},r.adler=function(t,e,r){for(var i=1,n=0,s=e,a=e+r;s<a;){for(var o=Math.min(s+5552,a);s<o;)n+=i+=t[s++];i%=65521,n%=65521}return n<<16|i},r.bin={readUshort:function(t,e){return t[e]|t[e+1]<<8},writeUshort:function(t,e,r){t[e]=255&r,t[e+1]=r>>8&255},readUint:function(t,e){return 16777216*t[e+3]+(t[e+2]<<16|t[e+1]<<8|t[e])},writeUint:function(t,e,r){t[e]=255&r,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},readASCII:function(t,e,r){for(var i="",n=0;n<r;n++)i+=String.fromCharCode(t[e+n]);return i},writeASCII:function(t,e,r){for(var i=0;i<r.length;i++)t[e+i]=r.charCodeAt(i)},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(t,e,i){for(var n,s="",a=0;a<i;a++)s+="%"+r.bin.pad(t[e+a].toString(16));try{n=decodeURIComponent(s)}catch(n){return r.bin.readASCII(t,e,i)}return n},writeUTF8:function(t,e,r){for(var i=r.length,n=0,s=0;s<i;s++){var a=r.charCodeAt(s);if(0==(4294967168&a))t[e+n]=a,n++;else if(0==(4294965248&a))t[e+n]=192|a>>6,t[e+n+1]=128|63&a,n+=2;else if(0==(4294901760&a))t[e+n]=224|a>>12,t[e+n+1]=128|a>>6&63,t[e+n+2]=128|63&a,n+=3;else{if(0!=(4292870144&a))throw"e";t[e+n]=240|a>>18,t[e+n+1]=128|a>>12&63,t[e+n+2]=128|a>>6&63,t[e+n+3]=128|63&a,n+=4}}return n},sizeUTF8:function(t){for(var e=t.length,r=0,i=0;i<e;i++){var n=t.charCodeAt(i);if(0==(4294967168&n))r++;else if(0==(4294965248&n))r+=2;else if(0==(4294901760&n))r+=3;else{if(0!=(4292870144&n))throw"e";r+=4}}return r}},r.F={},r.F.deflateRaw=function(t,e,i,n){var s=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][n],a=r.F.U,o=r.F._goodIndex;r.F._hash;var h=r.F._putsE,l=0,c=i<<3,u=0,f=t.length;if(0==n){for(;l<f;)h(e,c,l+(A=Math.min(65535,f-l))==f?1:0),c=r.F._copyExact(t,l,A,e,c+8),l+=A;return c>>>3}var d=a.lits,m=a.strt,g=a.prev,p=0,w=0,b=0,y=0,_=0,v=0;for(f>2&&(m[v=r.F._hash(t,0)]=0),l=0;l<f;l++){if(_=v,l+1<f-2){v=r.F._hash(t,l+1);var x=l+1&32767;g[x]=m[v],m[v]=x}if(u<=l){(p>14e3||w>26697)&&f-l>100&&(u<l&&(d[p]=l-u,p+=2,u=l),c=r.F._writeBlock(l==f-1||u==f?1:0,d,p,y,t,b,l-b,e,c),p=w=y=0,b=l);var k=0;l<f-2&&(k=r.F._bestMatch(t,l,g,_,Math.min(s[2],f-l),s[3]));var A=k>>>16,M=65535&k;if(0!=k){M=65535&k;var E=o(A=k>>>16,a.of0);a.lhst[257+E]++;var S=o(M,a.df0);a.dhst[S]++,y+=a.exb[E]+a.dxb[S],d[p]=A<<23|l-u,d[p+1]=M<<16|E<<8|S,p+=2,u=l+A}else a.lhst[t[l]]++;w++}}for(b==l&&0!=t.length||(u<l&&(d[p]=l-u,p+=2,u=l),c=r.F._writeBlock(1,d,p,y,t,b,l-b,e,c),p=0,w=0,p=w=y=0,b=l);0!=(7&c);)c++;return c>>>3},r.F._bestMatch=function(t,e,i,n,s,a){var o=32767&e,h=i[o],l=o-h+32768&32767;if(h==o||n!=r.F._hash(t,e-l))return 0;for(var c=0,u=0,f=Math.min(32767,e);l<=f&&0!=--a&&h!=o;){if(0==c||t[e+c]==t[e+c-l]){var d=r.F._howLong(t,e,l);if(d>c){if(u=l,(c=d)>=s)break;l+2<d&&(d=l+2);for(var m=0,g=0;g<d-2;g++){var p=e-l+g+32768&32767,w=p-i[p]+32768&32767;w>m&&(m=w,h=p)}}}l+=(o=h)-(h=i[o])+32768&32767}return c<<16|u},r.F._howLong=function(t,e,r){if(t[e]!=t[e-r]||t[e+1]!=t[e+1-r]||t[e+2]!=t[e+2-r])return 0;var i=e,n=Math.min(t.length,e+258);for(e+=3;e<n&&t[e]==t[e-r];)e++;return e-i},r.F._hash=function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(t,e,i,n,s,a,o,h,l){var c,u,f,d,m,g,p,w,b,y=r.F.U,_=r.F._putsF,v=r.F._putsE;y.lhst[256]++,u=(c=r.F.getTrees())[0],f=c[1],d=c[2],m=c[3],g=c[4],p=c[5],w=c[6],b=c[7];var x=32+(0==(l+3&7)?0:8-(l+3&7))+(o<<3),k=n+r.F.contSize(y.fltree,y.lhst)+r.F.contSize(y.fdtree,y.dhst),A=n+r.F.contSize(y.ltree,y.lhst)+r.F.contSize(y.dtree,y.dhst);A+=14+3*p+r.F.contSize(y.itree,y.ihst)+(2*y.ihst[16]+3*y.ihst[17]+7*y.ihst[18]);for(var M=0;M<286;M++)y.lhst[M]=0;for(M=0;M<30;M++)y.dhst[M]=0;for(M=0;M<19;M++)y.ihst[M]=0;var E=x<k&&x<A?0:k<A?1:2;if(_(h,l,t),_(h,l+1,E),l+=3,0==E){for(;0!=(7&l);)l++;l=r.F._copyExact(s,a,o,h,l)}else{var S,R;if(1==E&&(S=y.fltree,R=y.fdtree),2==E){r.F.makeCodes(y.ltree,u),r.F.revCodes(y.ltree,u),r.F.makeCodes(y.dtree,f),r.F.revCodes(y.dtree,f),r.F.makeCodes(y.itree,d),r.F.revCodes(y.itree,d),S=y.ltree,R=y.dtree,v(h,l,m-257),v(h,l+=5,g-1),v(h,l+=5,p-4),l+=4;for(var I=0;I<p;I++)v(h,l+3*I,y.itree[1+(y.ordr[I]<<1)]);l+=3*p,l=r.F._codeTiny(w,y.itree,h,l),l=r.F._codeTiny(b,y.itree,h,l)}for(var D=a,C=0;C<i;C+=2){for(var B=e[C],T=B>>>23,U=D+(8388607&B);D<U;)l=r.F._writeLit(s[D++],S,h,l);if(0!=T){var P=e[C+1],F=P>>16,z=P>>8&255,L=255&P;v(h,l=r.F._writeLit(257+z,S,h,l),T-y.of0[z]),l+=y.exb[z],_(h,l=r.F._writeLit(L,R,h,l),F-y.df0[L]),l+=y.dxb[L],D+=T}}l=r.F._writeLit(256,S,h,l)}return l},r.F._copyExact=function(t,e,r,i,n){var s=n>>>3;return i[s]=r,i[s+1]=r>>>8,i[s+2]=255-i[s],i[s+3]=255-i[s+1],s+=4,i.set(new Uint8Array(t.buffer,e,r),s),n+(r+4<<3)},r.F.getTrees=function(){for(var t=r.F.U,e=r.F._hufTree(t.lhst,t.ltree,15),i=r.F._hufTree(t.dhst,t.dtree,15),n=[],s=r.F._lenCodes(t.ltree,n),a=[],o=r.F._lenCodes(t.dtree,a),h=0;h<n.length;h+=2)t.ihst[n[h]]++;for(h=0;h<a.length;h+=2)t.ihst[a[h]]++;for(var l=r.F._hufTree(t.ihst,t.itree,7),c=19;c>4&&0==t.itree[1+(t.ordr[c-1]<<1)];)c--;return[e,i,l,s,o,c,n,a]},r.F.getSecond=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(t[r+1]);return e},r.F.nonZero=function(t){for(var e="",r=0;r<t.length;r+=2)0!=t[r+1]&&(e+=(r>>1)+",");return e},r.F.contSize=function(t,e){for(var r=0,i=0;i<e.length;i++)r+=e[i]*t[1+(i<<1)];return r},r.F._codeTiny=function(t,e,i,n){for(var s=0;s<t.length;s+=2){var a=t[s],o=t[s+1];n=r.F._writeLit(a,e,i,n);var h=16==a?2:17==a?3:7;a>15&&(r.F._putsE(i,n,o,h),n+=h)}return n},r.F._lenCodes=function(t,e){for(var r=t.length;2!=r&&0==t[r-1];)r-=2;for(var i=0;i<r;i+=2){var n=t[i+1],s=i+3<r?t[i+3]:-1,a=i+5<r?t[i+5]:-1,o=0==i?-1:t[i-1];if(0==n&&s==n&&a==n){for(var h=i+5;h+2<r&&t[h+2]==n;)h+=2;(l=Math.min(h+1-i>>>1,138))<11?e.push(17,l-3):e.push(18,l-11),i+=2*l-2}else if(n==o&&s==n&&a==n){for(h=i+5;h+2<r&&t[h+2]==n;)h+=2;var l=Math.min(h+1-i>>>1,6);e.push(16,l-3),i+=2*l-2}else e.push(n,0)}return r>>>1},r.F._hufTree=function(t,e,i){var n=[],s=t.length,a=e.length,o=0;for(o=0;o<a;o+=2)e[o]=0,e[o+1]=0;for(o=0;o<s;o++)0!=t[o]&&n.push({lit:o,f:t[o]});var h=n.length,l=n.slice(0);if(0==h)return 0;if(1==h){var c=n[0].lit;return l=0==c?1:0,e[1+(c<<1)]=1,e[1+(l<<1)]=1,1}n.sort((function(t,e){return t.f-e.f}));var u=n[0],f=n[1],d=0,m=1,g=2;for(n[0]={lit:-1,f:u.f+f.f,l:u,r:f,d:0};m!=h-1;)u=d!=m&&(g==h||n[d].f<n[g].f)?n[d++]:n[g++],f=d!=m&&(g==h||n[d].f<n[g].f)?n[d++]:n[g++],n[m++]={lit:-1,f:u.f+f.f,l:u,r:f};var p=r.F.setDepth(n[m-1],0);for(p>i&&(r.F.restrictDepth(l,i,p),p=i),o=0;o<h;o++)e[1+(l[o].lit<<1)]=l[o].d;return p},r.F.setDepth=function(t,e){return-1!=t.lit?(t.d=e,e):Math.max(r.F.setDepth(t.l,e+1),r.F.setDepth(t.r,e+1))},r.F.restrictDepth=function(t,e,r){var i=0,n=1<<r-e,s=0;for(t.sort((function(t,e){return e.d==t.d?t.f-e.f:e.d-t.d})),i=0;i<t.length&&t[i].d>e;i++){var a=t[i].d;t[i].d=e,s+=n-(1<<r-a)}for(s>>>=r-e;s>0;)(a=t[i].d)<e?(t[i].d++,s-=1<<e-a-1):i++;for(;i>=0;i--)t[i].d==e&&s<0&&(t[i].d--,s++);0!=s&&console.log("debt left")},r.F._goodIndex=function(t,e){var r=0;return e[16|r]<=t&&(r|=16),e[8|r]<=t&&(r|=8),e[4|r]<=t&&(r|=4),e[2|r]<=t&&(r|=2),e[1|r]<=t&&(r|=1),r},r.F._writeLit=function(t,e,i,n){return r.F._putsF(i,n,e[t<<1]),n+e[1+(t<<1)]},r.F.inflate=function(t,e){var i=Uint8Array;if(3==t[0]&&0==t[1])return e||new i(0);var n=r.F,s=n._bitsF,a=n._bitsE,o=n._decodeTiny,h=n.makeCodes,l=n.codes2map,c=n._get17,u=n.U,f=null==e;f&&(e=new i(t.length>>>2<<3));for(var d,m,g=0,p=0,w=0,b=0,y=0,_=0,v=0,x=0,k=0;0==g;)if(g=s(t,k,1),p=s(t,k+1,2),k+=3,0!=p){if(f&&(e=r.F._check(e,x+(1<<17))),1==p&&(d=u.flmap,m=u.fdmap,_=511,v=31),2==p){w=a(t,k,5)+257,b=a(t,k+5,5)+1,y=a(t,k+10,4)+4,k+=14;for(var A=0;A<38;A+=2)u.itree[A]=0,u.itree[A+1]=0;var M=1;for(A=0;A<y;A++){var E=a(t,k+3*A,3);u.itree[1+(u.ordr[A]<<1)]=E,E>M&&(M=E)}k+=3*y,h(u.itree,M),l(u.itree,M,u.imap),d=u.lmap,m=u.dmap,k=o(u.imap,(1<<M)-1,w+b,t,k,u.ttree);var S=n._copyOut(u.ttree,0,w,u.ltree);_=(1<<S)-1;var R=n._copyOut(u.ttree,w,b,u.dtree);v=(1<<R)-1,h(u.ltree,S),l(u.ltree,S,d),h(u.dtree,R),l(u.dtree,R,m)}for(;;){var I=d[c(t,k)&_];k+=15&I;var D=I>>>4;if(D>>>8==0)e[x++]=D;else{if(256==D)break;var C=x+D-254;if(D>264){var B=u.ldef[D-257];C=x+(B>>>3)+a(t,k,7&B),k+=7&B}var T=m[c(t,k)&v];k+=15&T;var U=T>>>4,P=u.ddef[U],F=(P>>>4)+s(t,k,15&P);for(k+=15&P,f&&(e=r.F._check(e,x+(1<<17)));x<C;)e[x]=e[x++-F],e[x]=e[x++-F],e[x]=e[x++-F],e[x]=e[x++-F];x=C}}}else{0!=(7&k)&&(k+=8-(7&k));var z=4+(k>>>3),L=t[z-4]|t[z-3]<<8;f&&(e=r.F._check(e,x+L)),e.set(new i(t.buffer,t.byteOffset+z,L),x),k=z+L<<3,x+=L}return e.length==x?e:e.slice(0,x)},r.F._check=function(t,e){var r=t.length;if(e<=r)return t;var i=new Uint8Array(Math.max(r<<1,e));return i.set(t,0),i},r.F._decodeTiny=function(t,e,i,n,s,a){for(var o=r.F._bitsE,h=r.F._get17,l=0;l<i;){var c=t[h(n,s)&e];s+=15&c;var u=c>>>4;if(u<=15)a[l]=u,l++;else{var f=0,d=0;16==u?(d=3+o(n,s,2),s+=2,f=a[l-1]):17==u?(d=3+o(n,s,3),s+=3):18==u&&(d=11+o(n,s,7),s+=7);for(var m=l+d;l<m;)a[l]=f,l++}}return s},r.F._copyOut=function(t,e,r,i){for(var n=0,s=0,a=i.length>>>1;s<r;){var o=t[s+e];i[s<<1]=0,i[1+(s<<1)]=o,o>n&&(n=o),s++}for(;s<a;)i[s<<1]=0,i[1+(s<<1)]=0,s++;return n},r.F.makeCodes=function(t,e){for(var i,n,s,a,o=r.F.U,h=t.length,l=o.bl_count,c=0;c<=e;c++)l[c]=0;for(c=1;c<h;c+=2)l[t[c]]++;var u=o.next_code;for(i=0,l[0]=0,n=1;n<=e;n++)i=i+l[n-1]<<1,u[n]=i;for(s=0;s<h;s+=2)0!=(a=t[s+1])&&(t[s]=u[a],u[a]++)},r.F.codes2map=function(t,e,i){for(var n=t.length,s=r.F.U.rev15,a=0;a<n;a+=2)if(0!=t[a+1])for(var o=a>>1,h=t[a+1],l=o<<4|h,c=e-h,u=t[a]<<c,f=u+(1<<c);u!=f;)i[s[u]>>>15-e]=l,u++},r.F.revCodes=function(t,e){for(var i=r.F.U.rev15,n=15-e,s=0;s<t.length;s+=2){var a=t[s]<<e-t[s+1];t[s]=i[a]>>>n}},r.F._putsE=function(t,e,r){r<<=7&e;var i=e>>>3;t[i]|=r,t[i+1]|=r>>>8},r.F._putsF=function(t,e,r){r<<=7&e;var i=e>>>3;t[i]|=r,t[i+1]|=r>>>8,t[i+2]|=r>>>16},r.F._bitsE=function(t,e,r){return(t[e>>>3]|t[1+(e>>>3)]<<8)>>>(7&e)&(1<<r)-1},r.F._bitsF=function(t,e,r){return(t[e>>>3]|t[1+(e>>>3)]<<8|t[2+(e>>>3)]<<16)>>>(7&e)&(1<<r)-1},r.F._get17=function(t,e){return(t[e>>>3]|t[1+(e>>>3)]<<8|t[2+(e>>>3)]<<16)>>>(7&e)},r.F._get25=function(t,e){return(t[e>>>3]|t[1+(e>>>3)]<<8|t[2+(e>>>3)]<<16|t[3+(e>>>3)]<<24)>>>(7&e)},r.F.U=(t=Uint16Array,e=Uint32Array,{next_code:new t(16),bl_count:new t(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new t(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new t(512),fltree:[],fdmap:new t(32),fdtree:[],lmap:new t(32768),ltree:[],ttree:[],dmap:new t(32768),dtree:[],imap:new t(512),itree:[],rev15:new t(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new t(65536),prev:new t(32768)}),function(){for(var t=r.F.U,e=0;e<32768;e++){var i=e;i=(4278255360&(i=(4042322160&(i=(3435973836&(i=(2863311530&i)>>>1|(1431655765&i)<<1))>>>2|(858993459&i)<<2))>>>4|(252645135&i)<<4))>>>8|(16711935&i)<<8,t.rev15[e]=(i>>>16|i<<16)>>>17}function n(t,e,r){for(;0!=e--;)t.push(0,r)}for(e=0;e<32;e++)t.ldef[e]=t.of0[e]<<3|t.exb[e],t.ddef[e]=t.df0[e]<<4|t.dxb[e];n(t.fltree,144,8),n(t.fltree,112,9),n(t.fltree,24,7),n(t.fltree,8,8),r.F.makeCodes(t.fltree,9),r.F.codes2map(t.fltree,9,t.flmap),r.F.revCodes(t.fltree,9),n(t.fdtree,32,5),r.F.makeCodes(t.fdtree,5),r.F.codes2map(t.fdtree,5,t.fdmap),r.F.revCodes(t.fdtree,5),n(t.itree,19,0),n(t.ltree,286,0),n(t.dtree,30,0),n(t.ttree,320,0)}()}();var d=h({__proto__:null,default:u},[u]);const m=function(){var t={nextZero(t,e){for(;0!=t[e];)e++;return e},readUshort:(t,e)=>t[e]<<8|t[e+1],writeUshort(t,e,r){t[e]=r>>8&255,t[e+1]=255&r},readUint:(t,e)=>16777216*t[e]+(t[e+1]<<16|t[e+2]<<8|t[e+3]),writeUint(t,e,r){t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},readASCII(t,e,r){let i="";for(let n=0;n<r;n++)i+=String.fromCharCode(t[e+n]);return i},writeASCII(t,e,r){for(let i=0;i<r.length;i++)t[e+i]=r.charCodeAt(i)},readBytes(t,e,r){const i=[];for(let n=0;n<r;n++)i.push(t[e+n]);return i},pad:t=>t.length<2?`0${t}`:t,readUTF8(e,r,i){let n,s="";for(let a=0;a<i;a++)s+=`%${t.pad(e[r+a].toString(16))}`;try{n=decodeURIComponent(s)}catch(n){return t.readASCII(e,r,i)}return n}};function e(e,r,i,n){const a=r*i,o=s(n),h=Math.ceil(r*o/8),l=new Uint8Array(4*a),c=new Uint32Array(l.buffer),{ctype:u}=n,{depth:f}=n,d=t.readUshort;if(6==u){const t=a<<2;if(8==f)for(var m=0;m<t;m+=4)l[m]=e[m],l[m+1]=e[m+1],l[m+2]=e[m+2],l[m+3]=e[m+3];if(16==f)for(m=0;m<t;m++)l[m]=e[m<<1]}else if(2==u){const t=n.tabs.tRNS;if(null==t){if(8==f)for(m=0;m<a;m++){var g=3*m;c[m]=255<<24|e[g+2]<<16|e[g+1]<<8|e[g]}if(16==f)for(m=0;m<a;m++)g=6*m,c[m]=255<<24|e[g+4]<<16|e[g+2]<<8|e[g]}else{var p=t[0];const r=t[1],i=t[2];if(8==f)for(m=0;m<a;m++){var w=m<<2;g=3*m,c[m]=255<<24|e[g+2]<<16|e[g+1]<<8|e[g],e[g]==p&&e[g+1]==r&&e[g+2]==i&&(l[w+3]=0)}if(16==f)for(m=0;m<a;m++)w=m<<2,g=6*m,c[m]=255<<24|e[g+4]<<16|e[g+2]<<8|e[g],d(e,g)==p&&d(e,g+2)==r&&d(e,g+4)==i&&(l[w+3]=0)}}else if(3==u){const t=n.tabs.PLTE,s=n.tabs.tRNS,o=s?s.length:0;if(1==f)for(var b=0;b<i;b++){var y=b*h,_=b*r;for(m=0;m<r;m++){w=_+m<<2;var v=3*(x=e[y+(m>>3)]>>7-(7&m)&1);l[w]=t[v],l[w+1]=t[v+1],l[w+2]=t[v+2],l[w+3]=x<o?s[x]:255}}if(2==f)for(b=0;b<i;b++)for(y=b*h,_=b*r,m=0;m<r;m++)w=_+m<<2,v=3*(x=e[y+(m>>2)]>>6-((3&m)<<1)&3),l[w]=t[v],l[w+1]=t[v+1],l[w+2]=t[v+2],l[w+3]=x<o?s[x]:255;if(4==f)for(b=0;b<i;b++)for(y=b*h,_=b*r,m=0;m<r;m++)w=_+m<<2,v=3*(x=e[y+(m>>1)]>>4-((1&m)<<2)&15),l[w]=t[v],l[w+1]=t[v+1],l[w+2]=t[v+2],l[w+3]=x<o?s[x]:255;if(8==f)for(m=0;m<a;m++){var x;w=m<<2,v=3*(x=e[m]),l[w]=t[v],l[w+1]=t[v+1],l[w+2]=t[v+2],l[w+3]=x<o?s[x]:255}}else if(4==u){if(8==f)for(m=0;m<a;m++){w=m<<2;var k=e[A=m<<1];l[w]=k,l[w+1]=k,l[w+2]=k,l[w+3]=e[A+1]}if(16==f)for(m=0;m<a;m++){var A;w=m<<2,k=e[A=m<<2],l[w]=k,l[w+1]=k,l[w+2]=k,l[w+3]=e[A+2]}}else if(0==u)for(p=n.tabs.tRNS?n.tabs.tRNS:-1,b=0;b<i;b++){const t=b*h,i=b*r;if(1==f)for(var M=0;M<r;M++){var E=(k=255*(e[t+(M>>>3)]>>>7-(7&M)&1))==255*p?0:255;c[i+M]=E<<24|k<<16|k<<8|k}else if(2==f)for(M=0;M<r;M++)E=(k=85*(e[t+(M>>>2)]>>>6-((3&M)<<1)&3))==85*p?0:255,c[i+M]=E<<24|k<<16|k<<8|k;else if(4==f)for(M=0;M<r;M++)E=(k=17*(e[t+(M>>>1)]>>>4-((1&M)<<2)&15))==17*p?0:255,c[i+M]=E<<24|k<<16|k<<8|k;else if(8==f)for(M=0;M<r;M++)E=(k=e[t+M])==p?0:255,c[i+M]=E<<24|k<<16|k<<8|k;else if(16==f)for(M=0;M<r;M++)k=e[t+(M<<1)],E=d(e,t+(M<<1))==p?0:255,c[i+M]=E<<24|k<<16|k<<8|k}return l}function r(t,e,r,o){const h=s(t),l=Math.ceil(r*h/8),c=new Uint8Array((l+1+t.interlace)*o);return e=t.tabs.CgBI?n(e,c):i(e,c),0==t.interlace?e=a(e,t,0,r,o):1==t.interlace&&(e=function(t,e){const r=e.width,i=e.height,n=s(e),o=n>>3,h=Math.ceil(r*n/8),l=new Uint8Array(i*h);let c=0;const u=[0,0,4,0,2,0,1],f=[0,4,0,2,0,1,0],d=[8,8,8,4,4,2,2],m=[8,8,4,4,2,2,1];let g=0;for(;g<7;){const s=d[g],w=m[g];let b=0,y=0,_=u[g];for(;_<i;)_+=s,y++;let v=f[g];for(;v<r;)v+=w,b++;const x=Math.ceil(b*n/8);a(t,e,c,b,y);let k=0,A=u[g];for(;A<i;){let e=f[g],i=c+k*x<<3;for(;e<r;){var p;if(1==n&&(p=(p=t[i>>3])>>7-(7&i)&1,l[A*h+(e>>3)]|=p<<7-(7&e)),2==n&&(p=(p=t[i>>3])>>6-(7&i)&3,l[A*h+(e>>2)]|=p<<6-((3&e)<<1)),4==n&&(p=(p=t[i>>3])>>4-(7&i)&15,l[A*h+(e>>1)]|=p<<4-((1&e)<<2)),n>=8){const r=A*h+e*o;for(let e=0;e<o;e++)l[r+e]=t[(i>>3)+e]}i+=n,e+=w}k++,A+=s}b*y!=0&&(c+=y*(1+x)),g+=1}return l}(e,t)),e}function i(t,e){return n(new Uint8Array(t.buffer,2,t.length-6),e)}var n=function(){const t={H:{}};return t.H.N=function(e,r){const i=Uint8Array;let n,s,a=0,o=0,h=0,l=0,c=0,u=0,f=0,d=0,m=0;if(3==e[0]&&0==e[1])return r||new i(0);const g=t.H,p=g.b,w=g.e,b=g.R,y=g.n,_=g.A,v=g.Z,x=g.m,k=null==r;for(k&&(r=new i(e.length>>>2<<5));0==a;)if(a=p(e,m,1),o=p(e,m+1,2),m+=3,0!=o){if(k&&(r=t.H.W(r,d+(1<<17))),1==o&&(n=x.J,s=x.h,u=511,f=31),2==o){h=w(e,m,5)+257,l=w(e,m+5,5)+1,c=w(e,m+10,4)+4,m+=14;let t=1;for(var A=0;A<38;A+=2)x.Q[A]=0,x.Q[A+1]=0;for(A=0;A<c;A++){const r=w(e,m+3*A,3);x.Q[1+(x.X[A]<<1)]=r,r>t&&(t=r)}m+=3*c,y(x.Q,t),_(x.Q,t,x.u),n=x.w,s=x.d,m=b(x.u,(1<<t)-1,h+l,e,m,x.v);const r=g.V(x.v,0,h,x.C);u=(1<<r)-1;const i=g.V(x.v,h,l,x.D);f=(1<<i)-1,y(x.C,r),_(x.C,r,n),y(x.D,i),_(x.D,i,s)}for(;;){const t=n[v(e,m)&u];m+=15&t;const i=t>>>4;if(i>>>8==0)r[d++]=i;else{if(256==i)break;{let t=d+i-254;if(i>264){const r=x.q[i-257];t=d+(r>>>3)+w(e,m,7&r),m+=7&r}const n=s[v(e,m)&f];m+=15&n;const a=n>>>4,o=x.c[a],h=(o>>>4)+p(e,m,15&o);for(m+=15&o;d<t;)r[d]=r[d++-h],r[d]=r[d++-h],r[d]=r[d++-h],r[d]=r[d++-h];d=t}}}}else{0!=(7&m)&&(m+=8-(7&m));const n=4+(m>>>3),s=e[n-4]|e[n-3]<<8;k&&(r=t.H.W(r,d+s)),r.set(new i(e.buffer,e.byteOffset+n,s),d),m=n+s<<3,d+=s}return r.length==d?r:r.slice(0,d)},t.H.W=function(t,e){const r=t.length;if(e<=r)return t;const i=new Uint8Array(r<<1);return i.set(t,0),i},t.H.R=function(e,r,i,n,s,a){const o=t.H.e,h=t.H.Z;let l=0;for(;l<i;){const t=e[h(n,s)&r];s+=15&t;const i=t>>>4;if(i<=15)a[l]=i,l++;else{let t=0,e=0;16==i?(e=3+o(n,s,2),s+=2,t=a[l-1]):17==i?(e=3+o(n,s,3),s+=3):18==i&&(e=11+o(n,s,7),s+=7);const r=l+e;for(;l<r;)a[l]=t,l++}}return s},t.H.V=function(t,e,r,i){let n=0,s=0;const a=i.length>>>1;for(;s<r;){const r=t[s+e];i[s<<1]=0,i[1+(s<<1)]=r,r>n&&(n=r),s++}for(;s<a;)i[s<<1]=0,i[1+(s<<1)]=0,s++;return n},t.H.n=function(e,r){const i=t.H.m,n=e.length;let s,a,o,h;const l=i.j;for(var c=0;c<=r;c++)l[c]=0;for(c=1;c<n;c+=2)l[e[c]]++;const u=i.K;for(s=0,l[0]=0,a=1;a<=r;a++)s=s+l[a-1]<<1,u[a]=s;for(o=0;o<n;o+=2)h=e[o+1],0!=h&&(e[o]=u[h],u[h]++)},t.H.A=function(e,r,i){const n=e.length,s=t.H.m.r;for(let t=0;t<n;t+=2)if(0!=e[t+1]){const n=t>>1,a=e[t+1],o=n<<4|a,h=r-a;let l=e[t]<<h;const c=l+(1<<h);for(;l!=c;)i[s[l]>>>15-r]=o,l++}},t.H.l=function(e,r){const i=t.H.m.r,n=15-r;for(let t=0;t<e.length;t+=2){const s=e[t]<<r-e[t+1];e[t]=i[s]>>>n}},t.H.M=function(t,e,r){r<<=7&e;const i=e>>>3;t[i]|=r,t[i+1]|=r>>>8},t.H.I=function(t,e,r){r<<=7&e;const i=e>>>3;t[i]|=r,t[i+1]|=r>>>8,t[i+2]|=r>>>16},t.H.e=function(t,e,r){return(t[e>>>3]|t[1+(e>>>3)]<<8)>>>(7&e)&(1<<r)-1},t.H.b=function(t,e,r){return(t[e>>>3]|t[1+(e>>>3)]<<8|t[2+(e>>>3)]<<16)>>>(7&e)&(1<<r)-1},t.H.Z=function(t,e){return(t[e>>>3]|t[1+(e>>>3)]<<8|t[2+(e>>>3)]<<16)>>>(7&e)},t.H.i=function(t,e){return(t[e>>>3]|t[1+(e>>>3)]<<8|t[2+(e>>>3)]<<16|t[3+(e>>>3)]<<24)>>>(7&e)},t.H.m=function(){const t=Uint16Array,e=Uint32Array;return{K:new t(16),j:new t(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new t(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new e(32),J:new t(512),_:[],h:new t(32),$:[],w:new t(32768),C:[],v:[],d:new t(32768),D:[],u:new t(512),Q:[],r:new t(32768),s:new e(286),Y:new e(30),a:new e(19),t:new e(15e3),k:new t(65536),g:new t(32768)}}(),function(){const e=t.H.m;for(var r=0;r<32768;r++){let t=r;t=(2863311530&t)>>>1|(1431655765&t)<<1,t=(3435973836&t)>>>2|(858993459&t)<<2,t=(4042322160&t)>>>4|(252645135&t)<<4,t=(4278255360&t)>>>8|(16711935&t)<<8,e.r[r]=(t>>>16|t<<16)>>>17}function i(t,e,r){for(;0!=e--;)t.push(0,r)}for(r=0;r<32;r++)e.q[r]=e.S[r]<<3|e.T[r],e.c[r]=e.p[r]<<4|e.z[r];i(e._,144,8),i(e._,112,9),i(e._,24,7),i(e._,8,8),t.H.n(e._,9),t.H.A(e._,9,e.J),t.H.l(e._,9),i(e.$,32,5),t.H.n(e.$,5),t.H.A(e.$,5,e.h),t.H.l(e.$,5),i(e.Q,19,0),i(e.C,286,0),i(e.D,30,0),i(e.v,320,0)}(),t.H.N}();function s(t){return[1,null,3,1,2,null,4][t.ctype]*t.depth}function a(t,e,r,i,n){let a=s(e);const h=Math.ceil(i*a/8);let l,c;a=Math.ceil(a/8);let u=t[r],f=0;if(u>1&&(t[r]=[0,0,1][u-2]),3==u)for(f=a;f<h;f++)t[f+1]=t[f+1]+(t[f+1-a]>>>1)&255;for(let s=0;s<n;s++)if(l=r+s*h,c=l+s+1,u=t[c-1],f=0,0==u)for(;f<h;f++)t[l+f]=t[c+f];else if(1==u){for(;f<a;f++)t[l+f]=t[c+f];for(;f<h;f++)t[l+f]=t[c+f]+t[l+f-a]}else if(2==u)for(;f<h;f++)t[l+f]=t[c+f]+t[l+f-h];else if(3==u){for(;f<a;f++)t[l+f]=t[c+f]+(t[l+f-h]>>>1);for(;f<h;f++)t[l+f]=t[c+f]+(t[l+f-h]+t[l+f-a]>>>1)}else{for(;f<a;f++)t[l+f]=t[c+f]+o(0,t[l+f-h],0);for(;f<h;f++)t[l+f]=t[c+f]+o(t[l+f-a],t[l+f-h],t[l+f-a-h])}return t}function o(t,e,r){const i=t+e-r,n=i-t,s=i-e,a=i-r;return n*n<=s*s&&n*n<=a*a?t:s*s<=a*a?e:r}function h(e,r,i){i.width=t.readUint(e,r),r+=4,i.height=t.readUint(e,r),r+=4,i.depth=e[r],r++,i.ctype=e[r],r++,i.compress=e[r],r++,i.filter=e[r],r++,i.interlace=e[r],r++}function l(t,e,r,i,n,s,a,o,h){const l=Math.min(e,n),c=Math.min(r,s);let u=0,f=0;for(let v=0;v<c;v++)for(let r=0;r<l;r++)if(a>=0&&o>=0?(u=v*e+r<<2,f=(o+v)*n+a+r<<2):(u=(-o+v)*e-a+r<<2,f=v*n+r<<2),0==h)i[f]=t[u],i[f+1]=t[u+1],i[f+2]=t[u+2],i[f+3]=t[u+3];else if(1==h){var d=t[u+3]*(1/255),m=t[u]*d,g=t[u+1]*d,p=t[u+2]*d,w=i[f+3]*(1/255),b=i[f]*w,y=i[f+1]*w,_=i[f+2]*w;const e=1-d,r=d+w*e,n=0==r?0:1/r;i[f+3]=255*r,i[f+0]=(m+b*e)*n,i[f+1]=(g+y*e)*n,i[f+2]=(p+_*e)*n}else if(2==h)d=t[u+3],m=t[u],g=t[u+1],p=t[u+2],w=i[f+3],b=i[f],y=i[f+1],_=i[f+2],d==w&&m==b&&g==y&&p==_?(i[f]=0,i[f+1]=0,i[f+2]=0,i[f+3]=0):(i[f]=m,i[f+1]=g,i[f+2]=p,i[f+3]=d);else if(3==h){if(d=t[u+3],m=t[u],g=t[u+1],p=t[u+2],w=i[f+3],b=i[f],y=i[f+1],_=i[f+2],d==w&&m==b&&g==y&&p==_)continue;if(d<220&&w>20)return!1}return!0}return{decode:function(e){const s=new Uint8Array(e);let a=8;const o=t,l=o.readUshort,c=o.readUint,u={tabs:{},frames:[]},f=new Uint8Array(s.length);let d,m=0,g=0;const p=[137,80,78,71,13,10,26,10];for(var w=0;w<8;w++)if(s[w]!=p[w])throw"The input is not a PNG file!";for(;a<s.length;){const e=o.readUint(s,a);a+=4;const p=o.readASCII(s,a,4);if(a+=4,"IHDR"==p)h(s,a,u);else if("iCCP"==p){for(var b=a;0!=s[b];)b++;o.readASCII(s,a,b-a),s[b+1];const r=s.slice(b+2,a+e);let h=null;try{h=i(r)}catch(t){h=n(r)}u.tabs[p]=h}else if("CgBI"==p)u.tabs[p]=s.slice(a,a+4);else if("IDAT"==p){for(w=0;w<e;w++)f[m+w]=s[a+w];m+=e}else if("acTL"==p)u.tabs[p]={num_frames:c(s,a),num_plays:c(s,a+4)},d=new Uint8Array(s.length);else if("fcTL"==p){0!=g&&((A=u.frames[u.frames.length-1]).data=r(u,d.slice(0,g),A.rect.width,A.rect.height),g=0);const t={x:c(s,a+12),y:c(s,a+16),width:c(s,a+4),height:c(s,a+8)};let e=l(s,a+22);e=l(s,a+20)/(0==e?100:e);const i={rect:t,delay:Math.round(1e3*e),dispose:s[a+24],blend:s[a+25]};u.frames.push(i)}else if("fdAT"==p){for(w=0;w<e-4;w++)d[g+w]=s[a+w+4];g+=e-4}else if("pHYs"==p)u.tabs[p]=[o.readUint(s,a),o.readUint(s,a+4),s[a+8]];else if("cHRM"==p)for(u.tabs[p]=[],w=0;w<8;w++)u.tabs[p].push(o.readUint(s,a+4*w));else if("tEXt"==p||"zTXt"==p){null==u.tabs[p]&&(u.tabs[p]={});var y=o.nextZero(s,a),_=o.readASCII(s,a,y-a),v=a+e-y-1;if("tEXt"==p)k=o.readASCII(s,y+1,v);else{var x=i(s.slice(y+2,y+2+v));k=o.readUTF8(x,0,x.length)}u.tabs[p][_]=k}else if("iTXt"==p){null==u.tabs[p]&&(u.tabs[p]={}),y=0,b=a,y=o.nextZero(s,b),_=o.readASCII(s,b,y-b);const t=s[b=y+1];var k;s[b+1],b+=2,y=o.nextZero(s,b),o.readASCII(s,b,y-b),b=y+1,y=o.nextZero(s,b),o.readUTF8(s,b,y-b),v=e-((b=y+1)-a),0==t?k=o.readUTF8(s,b,v):(x=i(s.slice(b,b+v)),k=o.readUTF8(x,0,x.length)),u.tabs[p][_]=k}else if("PLTE"==p)u.tabs[p]=o.readBytes(s,a,e);else if("hIST"==p){const t=u.tabs.PLTE.length/3;for(u.tabs[p]=[],w=0;w<t;w++)u.tabs[p].push(l(s,a+2*w))}else if("tRNS"==p)3==u.ctype?u.tabs[p]=o.readBytes(s,a,e):0==u.ctype?u.tabs[p]=l(s,a):2==u.ctype&&(u.tabs[p]=[l(s,a),l(s,a+2),l(s,a+4)]);else if("gAMA"==p)u.tabs[p]=o.readUint(s,a)/1e5;else if("sRGB"==p)u.tabs[p]=s[a];else if("bKGD"==p)0==u.ctype||4==u.ctype?u.tabs[p]=[l(s,a)]:2==u.ctype||6==u.ctype?u.tabs[p]=[l(s,a),l(s,a+2),l(s,a+4)]:3==u.ctype&&(u.tabs[p]=s[a]);else if("IEND"==p)break;a+=e,o.readUint(s,a),a+=4}var A;return 0!=g&&((A=u.frames[u.frames.length-1]).data=r(u,d.slice(0,g),A.rect.width,A.rect.height)),u.data=r(u,f,u.width,u.height),delete u.compress,delete u.interlace,delete u.filter,u},toRGBA8:function(t){const r=t.width,i=t.height;if(null==t.tabs.acTL)return[e(t.data,r,i,t).buffer];const n=[];null==t.frames[0].data&&(t.frames[0].data=t.data);const s=r*i*4,a=new Uint8Array(s),o=new Uint8Array(s),h=new Uint8Array(s);for(let u=0;u<t.frames.length;u++){const f=t.frames[u],d=f.rect.x,m=f.rect.y,g=f.rect.width,p=f.rect.height,w=e(f.data,g,p,t);if(0!=u)for(var c=0;c<s;c++)h[c]=a[c];if(0==f.blend?l(w,g,p,a,r,i,d,m,0):1==f.blend&&l(w,g,p,a,r,i,d,m,1),n.push(a.buffer.slice(0)),0==f.dispose);else if(1==f.dispose)l(o,g,p,a,r,i,d,m,0);else if(2==f.dispose)for(c=0;c<s;c++)a[c]=h[c]}return n},_paeth:o,_copyTile:l,_bin:t}}();!function(){const{_copyTile:t}=m,{_bin:e}=m,r=m._paeth;var i={table:function(){const t=new Uint32Array(256);for(let e=0;e<256;e++){let r=e;for(let t=0;t<8;t++)1&r?r=3988292384^r>>>1:r>>>=1;t[e]=r}return t}(),update(t,e,r,n){for(let s=0;s<n;s++)t=i.table[255&(t^e[r+s])]^t>>>8;return t},crc:(t,e,r)=>4294967295^i.update(4294967295,t,e,r)};function n(t,e,r,i){e[r]+=t[0]*i>>4,e[r+1]+=t[1]*i>>4,e[r+2]+=t[2]*i>>4,e[r+3]+=t[3]*i>>4}function s(t){return Math.max(0,Math.min(255,t))}function a(t,e){const r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return r*r+i*i+n*n+s*s}function o(t,e,r,i,o,h,l){null==l&&(l=1);const c=i.length,u=[];for(var f=0;f<c;f++){const t=i[f];u.push([t>>>0&255,t>>>8&255,t>>>16&255,t>>>24&255])}for(f=0;f<c;f++){let t=4294967295;for(var d=0,m=0;m<c;m++){var g=a(u[f],u[m]);m!=f&&g<t&&(t=g,d=m)}}const p=new Uint32Array(o.buffer),w=new Int16Array(e*r*4),b=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(f=0;f<b.length;f++)b[f]=255*((b[f]+.5)/16-.5);for(let _=0;_<r;_++)for(let o=0;o<e;o++){var y;f=4*(_*e+o),2!=l?y=[s(t[f]+w[f]),s(t[f+1]+w[f+1]),s(t[f+2]+w[f+2]),s(t[f+3]+w[f+3])]:(g=b[4*(3&_)+(3&o)],y=[s(t[f]+g),s(t[f+1]+g),s(t[f+2]+g),s(t[f+3]+g)]),d=0;let v=16777215;for(m=0;m<c;m++){const t=a(y,u[m]);t<v&&(v=t,d=m)}const x=u[d],k=[y[0]-x[0],y[1]-x[1],y[2]-x[2],y[3]-x[3]];1==l&&(o!=e-1&&n(k,w,f+4,7),_!=r-1&&(0!=o&&n(k,w,f+4*e-4,3),n(k,w,f+4*e,5),o!=e-1&&n(k,w,f+4*e+4,1))),h[f>>2]=d,p[f>>2]=i[d]}}function h(t,r,n,s,a){null==a&&(a={});const{crc:o}=i,h=e.writeUint,l=e.writeUshort,c=e.writeASCII;let u=8;const f=t.frames.length>1;let d,m=!1,g=33+(f?20:0);if(null!=a.sRGB&&(g+=13),null!=a.pHYs&&(g+=21),null!=a.iCCP&&(d=pako.deflate(a.iCCP),g+=21+d.length+4),3==t.ctype){for(var p=t.plte.length,w=0;w<p;w++)t.plte[w]>>>24!=255&&(m=!0);g+=8+3*p+4+(m?8+1*p+4:0)}for(var b=0;b<t.frames.length;b++)f&&(g+=38),g+=(x=t.frames[b]).cimg.length+12,0!=b&&(g+=4);g+=12;const y=new Uint8Array(g),_=[137,80,78,71,13,10,26,10];for(w=0;w<8;w++)y[w]=_[w];if(h(y,u,13),u+=4,c(y,u,"IHDR"),u+=4,h(y,u,r),u+=4,h(y,u,n),u+=4,y[u]=t.depth,u++,y[u]=t.ctype,u++,y[u]=0,u++,y[u]=0,u++,y[u]=0,u++,h(y,u,o(y,u-17,17)),u+=4,null!=a.sRGB&&(h(y,u,1),u+=4,c(y,u,"sRGB"),u+=4,y[u]=a.sRGB,u++,h(y,u,o(y,u-5,5)),u+=4),null!=a.iCCP){const t=13+d.length;h(y,u,t),u+=4,c(y,u,"iCCP"),u+=4,c(y,u,"ICC profile"),u+=11,u+=2,y.set(d,u),u+=d.length,h(y,u,o(y,u-(t+4),t+4)),u+=4}if(null!=a.pHYs&&(h(y,u,9),u+=4,c(y,u,"pHYs"),u+=4,h(y,u,a.pHYs[0]),u+=4,h(y,u,a.pHYs[1]),u+=4,y[u]=a.pHYs[2],u++,h(y,u,o(y,u-13,13)),u+=4),f&&(h(y,u,8),u+=4,c(y,u,"acTL"),u+=4,h(y,u,t.frames.length),u+=4,h(y,u,null!=a.loop?a.loop:0),u+=4,h(y,u,o(y,u-12,12)),u+=4),3==t.ctype){for(h(y,u,3*(p=t.plte.length)),u+=4,c(y,u,"PLTE"),u+=4,w=0;w<p;w++){const e=3*w,r=t.plte[w],i=255&r,n=r>>>8&255,s=r>>>16&255;y[u+e+0]=i,y[u+e+1]=n,y[u+e+2]=s}if(u+=3*p,h(y,u,o(y,u-3*p-4,3*p+4)),u+=4,m){for(h(y,u,p),u+=4,c(y,u,"tRNS"),u+=4,w=0;w<p;w++)y[u+w]=t.plte[w]>>>24&255;u+=p,h(y,u,o(y,u-p-4,p+4)),u+=4}}let v=0;for(b=0;b<t.frames.length;b++){var x=t.frames[b];f&&(h(y,u,26),u+=4,c(y,u,"fcTL"),u+=4,h(y,u,v++),u+=4,h(y,u,x.rect.width),u+=4,h(y,u,x.rect.height),u+=4,h(y,u,x.rect.x),u+=4,h(y,u,x.rect.y),u+=4,l(y,u,s[b]),u+=2,l(y,u,1e3),u+=2,y[u]=x.dispose,u++,y[u]=x.blend,u++,h(y,u,o(y,u-30,30)),u+=4);const e=x.cimg;h(y,u,(p=e.length)+(0==b?0:4)),u+=4;const r=u;c(y,u,0==b?"IDAT":"fdAT"),u+=4,0!=b&&(h(y,u,v++),u+=4),y.set(e,u),u+=p,h(y,u,o(y,r,u-r)),u+=4}return h(y,u,0),u+=4,c(y,u,"IEND"),u+=4,h(y,u,o(y,u-4,4)),u+=4,y.buffer}function l(t,e,r){for(let i=0;i<t.frames.length;i++){const n=t.frames[i];n.rect.width;const s=n.rect.height,a=new Uint8Array(s*n.bpl+s);n.cimg=g(n.img,s,n.bpp,n.bpl,a,e,r)}}function c(e,r,i,n,s){const a=s[0],h=s[1],l=s[2],c=s[3],d=s[4],m=s[5];let g=6,p=8,b=255;for(var y=0;y<e.length;y++){const t=new Uint8Array(e[y]);for(var _=t.length,v=0;v<_;v+=4)b&=t[v+3]}const x=255!=b,k=function(e,r,i,n,s,a){const o=[];for(var h=0;h<e.length;h++){const u=new Uint8Array(e[h]),d=new Uint32Array(u.buffer);var l;let g=0,p=0,w=r,b=i,y=n?1:0;if(0!=h){const _=a||n||1==h||0!=o[h-2].dispose?1:2;let v=0,x=1e9;for(let t=0;t<_;t++){var c=new Uint8Array(e[h-1-t]);const n=new Uint32Array(e[h-1-t]);let a=r,o=i,l=-1,u=-1;for(let t=0;t<i;t++)for(let e=0;e<r;e++)d[m=t*r+e]!=n[m]&&(e<a&&(a=e),e>l&&(l=e),t<o&&(o=t),t>u&&(u=t));-1==l&&(a=o=l=u=0),s&&(1==(1&a)&&a--,1==(1&o)&&o--);const f=(l-a+1)*(u-o+1);f<x&&(x=f,v=t,g=a,p=o,w=l-a+1,b=u-o+1)}c=new Uint8Array(e[h-1-v]),1==v&&(o[h-1].dispose=2),l=new Uint8Array(w*b*4),t(c,r,i,l,w,b,-g,-p,0),y=t(u,r,i,l,w,b,-g,-p,3)?1:0,1==y?f(u,r,i,l,{x:g,y:p,width:w,height:b}):t(u,r,i,l,w,b,-g,-p,0)}else l=u.slice(0);o.push({rect:{x:g,y:p,width:w,height:b},img:l,blend:y,dispose:0})}if(n)for(h=0;h<o.length;h++){if(1==(g=o[h]).blend)continue;const t=g.rect,n=o[h-1].rect,a=Math.min(t.x,n.x),l=Math.min(t.y,n.y),c={x:a,y:l,width:Math.max(t.x+t.width,n.x+n.width)-a,height:Math.max(t.y+t.height,n.y+n.height)-l};o[h-1].dispose=1,h-1!=0&&u(e,r,i,o,h-1,c,s),u(e,r,i,o,h,c,s)}let d=0;if(1!=e.length)for(var m=0;m<o.length;m++){var g;d+=(g=o[m]).rect.width*g.rect.height}return o}(e,r,i,a,h,l),A={},M=[],E=[];if(0!=n){const t=[];for(v=0;v<k.length;v++)t.push(k[v].img.buffer);const e=function(t){let e=0;for(var r=0;r<t.length;r++)e+=t[r].byteLength;const i=new Uint8Array(e);let n=0;for(r=0;r<t.length;r++){const e=new Uint8Array(t[r]),s=e.length;for(let t=0;t<s;t+=4){let r=e[t],s=e[t+1],a=e[t+2];const o=e[t+3];0==o&&(r=s=a=0),i[n+t]=r,i[n+t+1]=s,i[n+t+2]=a,i[n+t+3]=o}n+=s}return i.buffer}(t),r=w(e,n);for(v=0;v<r.plte.length;v++)M.push(r.plte[v].est.rgba);let i=0;for(v=0;v<k.length;v++){const t=(R=k[v]).img.length;var S=new Uint8Array(r.inds.buffer,i>>2,t>>2);E.push(S);const e=new Uint8Array(r.abuf,i,t);m&&o(R.img,R.rect.width,R.rect.height,M,e,S),R.img.set(e),i+=t}}else for(y=0;y<k.length;y++){var R=k[y];const t=new Uint32Array(R.img.buffer);var I=R.rect.width;for(_=t.length,S=new Uint8Array(_),E.push(S),v=0;v<_;v++){const e=t[v];if(0!=v&&e==t[v-1])S[v]=S[v-1];else if(v>I&&e==t[v-I])S[v]=S[v-I];else{let t=A[e];if(null==t&&(A[e]=t=M.length,M.push(e),M.length>=300))break;S[v]=t}}}const D=M.length;for(D<=256&&0==d&&(p=D<=2?1:D<=4?2:D<=16?4:8,p=Math.max(p,c)),y=0;y<k.length;y++){(R=k[y]).rect.x,R.rect.y,I=R.rect.width;const t=R.rect.height;let e=R.img;new Uint32Array(e.buffer);let r=4*I,i=4;if(D<=256&&0==d){r=Math.ceil(p*I/8);var C=new Uint8Array(r*t);const n=E[y];for(let e=0;e<t;e++){v=e*r;const t=e*I;if(8==p)for(var B=0;B<I;B++)C[v+B]=n[t+B];else if(4==p)for(B=0;B<I;B++)C[v+(B>>1)]|=n[t+B]<<4-4*(1&B);else if(2==p)for(B=0;B<I;B++)C[v+(B>>2)]|=n[t+B]<<6-2*(3&B);else if(1==p)for(B=0;B<I;B++)C[v+(B>>3)]|=n[t+B]<<7-1*(7&B)}e=C,g=3,i=1}else if(0==x&&1==k.length){C=new Uint8Array(I*t*3);const n=I*t;for(v=0;v<n;v++){const t=3*v,r=4*v;C[t]=e[r],C[t+1]=e[r+1],C[t+2]=e[r+2]}e=C,g=2,i=3,r=3*I}R.img=e,R.bpl=r,R.bpp=i}return{ctype:g,depth:p,plte:M,frames:k}}function u(e,r,i,n,s,a,o){const h=Uint8Array,l=Uint32Array,c=new h(e[s-1]),u=new l(e[s-1]),d=s+1<e.length?new h(e[s+1]):null,m=new h(e[s]),g=new l(m.buffer);let p=r,w=i,b=-1,y=-1;for(let t=0;t<a.height;t++)for(let e=0;e<a.width;e++){const i=a.x+e,o=a.y+t,h=o*r+i,l=g[h];0==l||0==n[s-1].dispose&&u[h]==l&&(null==d||0!=d[4*h+3])||(i<p&&(p=i),i>b&&(b=i),o<w&&(w=o),o>y&&(y=o))}-1==b&&(p=w=b=y=0),o&&(1==(1&p)&&p--,1==(1&w)&&w--),a={x:p,y:w,width:b-p+1,height:y-w+1};const _=n[s];_.rect=a,_.blend=1,_.img=new Uint8Array(a.width*a.height*4),0==n[s-1].dispose?(t(c,r,i,_.img,a.width,a.height,-a.x,-a.y,0),f(m,r,i,_.img,a)):t(m,r,i,_.img,a.width,a.height,-a.x,-a.y,0)}function f(e,r,i,n,s){t(e,r,i,n,s.width,s.height,-s.x,-s.y,2)}function g(t,e,r,i,n,s,a){const o=[];let h,l=[0,1,2,3,4];-1!=s?l=[s]:(e*i>5e5||1==r)&&(l=[0]),a&&(h={level:0});const c=d;for(var u=0;u<l.length;u++){for(let s=0;s<e;s++)p(n,t,s,i,r,l[u]);o.push(c.deflate(n,h))}let f,m=1e9;for(u=0;u<o.length;u++)o[u].length<m&&(f=u,m=o[u].length);return o[f]}function p(t,e,i,n,s,a){const o=i*n;let h=o+i;if(t[h]=a,h++,0==a)if(n<500)for(var l=0;l<n;l++)t[h+l]=e[o+l];else t.set(new Uint8Array(e.buffer,o,n),h);else if(1==a){for(l=0;l<s;l++)t[h+l]=e[o+l];for(l=s;l<n;l++)t[h+l]=e[o+l]-e[o+l-s]+256&255}else if(0==i){for(l=0;l<s;l++)t[h+l]=e[o+l];if(2==a)for(l=s;l<n;l++)t[h+l]=e[o+l];if(3==a)for(l=s;l<n;l++)t[h+l]=e[o+l]-(e[o+l-s]>>1)+256&255;if(4==a)for(l=s;l<n;l++)t[h+l]=e[o+l]-r(e[o+l-s],0,0)+256&255}else{if(2==a)for(l=0;l<n;l++)t[h+l]=e[o+l]+256-e[o+l-n]&255;if(3==a){for(l=0;l<s;l++)t[h+l]=e[o+l]+256-(e[o+l-n]>>1)&255;for(l=s;l<n;l++)t[h+l]=e[o+l]+256-(e[o+l-n]+e[o+l-s]>>1)&255}if(4==a){for(l=0;l<s;l++)t[h+l]=e[o+l]+256-r(0,e[o+l-n],0)&255;for(l=s;l<n;l++)t[h+l]=e[o+l]+256-r(e[o+l-s],e[o+l-n],e[o+l-s-n])&255}}}function w(t,e){const r=new Uint8Array(t),i=r.slice(0),n=new Uint32Array(i.buffer),s=b(i,e),a=s[0],o=s[1],h=r.length,l=new Uint8Array(h>>2);let c;if(r.length<2e7)for(var u=0;u<h;u+=4)c=y(a,f=r[u]*(1/255),d=r[u+1]*(1/255),m=r[u+2]*(1/255),g=r[u+3]*(1/255)),l[u>>2]=c.ind,n[u>>2]=c.est.rgba;else for(u=0;u<h;u+=4){var f=r[u]*(1/255),d=r[u+1]*(1/255),m=r[u+2]*(1/255),g=r[u+3]*(1/255);for(c=a;c.left;)c=_(c.est,f,d,m,g)<=0?c.left:c.right;l[u>>2]=c.ind,n[u>>2]=c.est.rgba}return{abuf:i.buffer,inds:l,plte:o}}function b(t,e,r){null==r&&(r=1e-4);const i=new Uint32Array(t.buffer),n={i0:0,i1:t.length,bst:null,est:null,tdst:0,left:null,right:null};n.bst=k(t,n.i0,n.i1),n.est=A(n.bst);const s=[n];for(;s.length<e;){let e=0,n=0;for(var a=0;a<s.length;a++)s[a].est.L>e&&(e=s[a].est.L,n=a);if(e<r)break;const o=s[n],h=v(t,i,o.i0,o.i1,o.est.e,o.est.eMq255);if(o.i0>=h||o.i1<=h){o.est.L=0;continue}const l={i0:o.i0,i1:h,bst:null,est:null,tdst:0,left:null,right:null};l.bst=k(t,l.i0,l.i1),l.est=A(l.bst);const c={i0:h,i1:o.i1,bst:null,est:null,tdst:0,left:null,right:null};for(c.bst={R:[],m:[],N:o.bst.N-l.bst.N},a=0;a<16;a++)c.bst.R[a]=o.bst.R[a]-l.bst.R[a];for(a=0;a<4;a++)c.bst.m[a]=o.bst.m[a]-l.bst.m[a];c.est=A(c.bst),o.left=l,o.right=c,s[n]=l,s.push(c)}for(s.sort(((t,e)=>e.bst.N-t.bst.N)),a=0;a<s.length;a++)s[a].ind=a;return[n,s]}function y(t,e,r,i,n){if(null==t.left)return t.tdst=function(t,e,r,i,n){const s=e-t[0],a=r-t[1],o=i-t[2],h=n-t[3];return s*s+a*a+o*o+h*h}(t.est.q,e,r,i,n),t;const s=_(t.est,e,r,i,n);let a=t.left,o=t.right;s>0&&(a=t.right,o=t.left);const h=y(a,e,r,i,n);if(h.tdst<=s*s)return h;const l=y(o,e,r,i,n);return l.tdst<h.tdst?l:h}function _(t,e,r,i,n){const{e:s}=t;return s[0]*e+s[1]*r+s[2]*i+s[3]*n-t.eMq}function v(t,e,r,i,n,s){for(i-=4;r<i;){for(;x(t,r,n)<=s;)r+=4;for(;x(t,i,n)>s;)i-=4;if(r>=i)break;const a=e[r>>2];e[r>>2]=e[i>>2],e[i>>2]=a,r+=4,i-=4}for(;x(t,r,n)>s;)r-=4;return r+4}function x(t,e,r){return t[e]*r[0]+t[e+1]*r[1]+t[e+2]*r[2]+t[e+3]*r[3]}function k(t,e,r){const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=[0,0,0,0],s=r-e>>2;for(let a=e;a<r;a+=4){const e=t[a]*(1/255),r=t[a+1]*(1/255),s=t[a+2]*(1/255),o=t[a+3]*(1/255);n[0]+=e,n[1]+=r,n[2]+=s,n[3]+=o,i[0]+=e*e,i[1]+=e*r,i[2]+=e*s,i[3]+=e*o,i[5]+=r*r,i[6]+=r*s,i[7]+=r*o,i[10]+=s*s,i[11]+=s*o,i[15]+=o*o}return i[4]=i[1],i[8]=i[2],i[9]=i[6],i[12]=i[3],i[13]=i[7],i[14]=i[11],{R:i,m:n,N:s}}function A(t){const{R:e}=t,{m:r}=t,{N:i}=t,n=r[0],s=r[1],a=r[2],o=r[3],h=0==i?0:1/i,l=[e[0]-n*n*h,e[1]-n*s*h,e[2]-n*a*h,e[3]-n*o*h,e[4]-s*n*h,e[5]-s*s*h,e[6]-s*a*h,e[7]-s*o*h,e[8]-a*n*h,e[9]-a*s*h,e[10]-a*a*h,e[11]-a*o*h,e[12]-o*n*h,e[13]-o*s*h,e[14]-o*a*h,e[15]-o*o*h],c=l,u=M;let f=[Math.random(),Math.random(),Math.random(),Math.random()],d=0,m=0;if(0!=i)for(let p=0;p<16&&(f=u.multVec(c,f),m=Math.sqrt(u.dot(f,f)),f=u.sml(1/m,f),!(0!=p&&Math.abs(m-d)<1e-9));p++)d=m;const g=[n*h,s*h,a*h,o*h];return{Cov:l,q:g,e:f,L:d,eMq255:u.dot(u.sml(255,g),f),eMq:u.dot(f,g),rgba:(Math.round(255*g[3])<<24|Math.round(255*g[2])<<16|Math.round(255*g[1])<<8|Math.round(255*g[0]))>>>0}}var M={multVec:(t,e)=>[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]],dot:(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],sml:(t,e)=>[t*e[0],t*e[1],t*e[2],t*e[3]]};m.encode=function(t,e,r,i,n,s,a){null==i&&(i=0),null==a&&(a=!1);const o=c(t,e,r,i,[!1,!1,!1,0,a,!1]);return l(o,-1),h(o,e,r,n,s)},m.encodeLL=function(t,e,r,i,n,s,a,o){const c={ctype:0+(1==i?0:2)+(0==n?0:4),depth:s,frames:[]},u=(i+n)*s,f=u*e;for(let h=0;h<t.length;h++)c.frames.push({rect:{x:0,y:0,width:e,height:r},img:new Uint8Array(t[h]),blend:0,dispose:1,bpp:Math.ceil(u/8),bpl:Math.ceil(f/8)});return l(c,0,!0),h(c,e,r,a,o)},m.encode.compress=c,m.encode.dither=o,m.quantize=w,m.quantize.getKDtree=b,m.quantize.getNearest=y}();const g={toArrayBuffer(t,e){const r=t.width,i=t.height,n=r<<2,s=t.getContext("2d").getImageData(0,0,r,i),a=new Uint32Array(s.data.buffer),o=(32*r+31)/32<<2,h=o*i,l=122+h,c=new ArrayBuffer(l),u=new DataView(c),f=1<<20;let d,m,p,w,b=f,y=0,_=0,v=0;function x(t){u.setUint16(_,t,!0),_+=2}function k(t){u.setUint32(_,t,!0),_+=4}function A(t){_+=t}x(19778),k(l),A(4),k(122),k(108),k(r),k(-i>>>0),x(1),x(32),k(3),k(h),k(2835),k(2835),A(8),k(16711680),k(65280),k(255),k(4278190080),k(1466527264),function t(){for(;y<i&&b>0;){for(w=122+y*o,d=0;d<n;)b--,m=a[v++],p=m>>>24,u.setUint32(w+d,m<<8|p),d+=4;y++}v<a.length?(b=f,setTimeout(t,g._dly)):e(c)}()},toBlob(t,e){this.toArrayBuffer(t,(t=>{e(new Blob([t],{type:"image/bmp"}))}))},_dly:9};var p={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},w={[p.CHROME]:16384,[p.FIREFOX]:11180,[p.DESKTOP_SAFARI]:16384,[p.IE]:8192,[p.IOS]:4096,[p.ETC]:8192};const b="undefined"!=typeof window,y="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,_=b&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),v=(b||y)&&(_&&_.getOriginalSymbol(window,"File")||"undefined"!=typeof File&&File),x=(b||y)&&(_&&_.getOriginalSymbol(window,"FileReader")||"undefined"!=typeof FileReader&&FileReader);function k(t,e,r=Date.now()){return new Promise((i=>{const n=t.split(","),s=n[0].match(/:(.*?);/)[1],a=globalThis.atob(n[1]);let o=a.length;const h=new Uint8Array(o);for(;o--;)h[o]=a.charCodeAt(o);const l=new Blob([h],{type:s});l.name=e,l.lastModified=r,i(l)}))}function A(t){return new Promise(((e,r)=>{const i=new x;i.onload=()=>e(i.result),i.onerror=t=>r(t),i.readAsDataURL(t)}))}function M(t){return new Promise(((e,r)=>{const i=new Image;i.onload=()=>e(i),i.onerror=t=>r(t),i.src=t}))}function E(){if(void 0!==E.cachedResult)return E.cachedResult;let t=p.ETC;const{userAgent:e}=navigator;return/Chrom(e|ium)/i.test(e)?t=p.CHROME:/iP(ad|od|hone)/i.test(e)&&/WebKit/i.test(e)?t=p.IOS:/Safari/i.test(e)?t=p.DESKTOP_SAFARI:/Firefox/i.test(e)?t=p.FIREFOX:(/MSIE/i.test(e)||1==!!document.documentMode)&&(t=p.IE),E.cachedResult=t,E.cachedResult}function S(t,e){const r=E(),i=w[r];let n=t,s=e,a=n*s;const o=n>s?s/n:n/s;for(;a>i*i;){const t=(i+n)/2,e=(i+s)/2;t<e?(s=e,n=e*o):(s=t*o,n=t),a=n*s}return{width:n,height:s}}function R(t,e){let r,i;try{if(r=new OffscreenCanvas(t,e),i=r.getContext("2d"),null===i)throw new Error("getContext of OffscreenCanvas returns null")}catch(t){r=document.createElement("canvas"),i=r.getContext("2d")}return r.width=t,r.height=e,[r,i]}function I(t,e){const{width:r,height:i}=S(t.width,t.height),[n,s]=R(r,i);return e&&/jpe?g/.test(e)&&(s.fillStyle="white",s.fillRect(0,0,n.width,n.height)),s.drawImage(t,0,0,n.width,n.height),n}function D(){return void 0!==D.cachedResult||(D.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"undefined"!=typeof document&&"ontouchend"in document),D.cachedResult}function C(t,e={}){return new Promise((function(r,i){let n,s;var a=function(){try{return s=I(n,e.fileType||t.type),r([n,s])}catch(t){return i(t)}},o=function(e){try{var r=function(t){try{throw t}catch(t){return i(t)}};try{let e;return A(t).then((function(t){try{return e=t,M(e).then((function(t){try{return n=t,function(){try{return a()}catch(t){return i(t)}}()}catch(t){return r(t)}}),r)}catch(t){return r(t)}}),r)}catch(t){r(t)}}catch(t){return i(t)}};try{if(D()||[p.DESKTOP_SAFARI,p.MOBILE_SAFARI].includes(E()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(t).then((function(t){try{return n=t,a()}catch(t){return o()}}),o)}catch(t){o()}}))}function B(t,e,r,i,n=1){return new Promise((function(s,a){let o;if("image/png"===e){let l,c,u;return l=t.getContext("2d"),({data:c}=l.getImageData(0,0,t.width,t.height)),u=m.encode([c.buffer],t.width,t.height,4096*n),o=new Blob([u],{type:e}),o.name=r,o.lastModified=i,h.call(this)}{if("image/bmp"===e)return new Promise((e=>g.toBlob(t,e))).then(function(t){try{return o=t,o.name=r,o.lastModified=i,f.call(this)}catch(t){return a(t)}}.bind(this),a);{if("function"==typeof OffscreenCanvas&&t instanceof OffscreenCanvas)return t.convertToBlob({type:e,quality:n}).then(function(t){try{return o=t,o.name=r,o.lastModified=i,d.call(this)}catch(t){return a(t)}}.bind(this),a);{let p;return p=t.toDataURL(e,n),k(p,r,i).then(function(t){try{return o=t,d.call(this)}catch(t){return a(t)}}.bind(this),a)}function d(){return f.call(this)}}function f(){return h.call(this)}}function h(){return s(o)}}))}function T(t){t.width=0,t.height=0}function U(){return new Promise((function(t,e){let r,i,n,s,a;return void 0!==U.cachedResult?t(U.cachedResult):(r="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==",k("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(r){try{return i=r,C(i).then((function(r){try{return n=r[1],B(n,i.type,i.name,i.lastModified).then((function(r){try{return s=r,T(n),C(s).then((function(r){try{return a=r[0],U.cachedResult=1===a.width&&2===a.height,t(U.cachedResult)}catch(t){return e(t)}}),e)}catch(t){return e(t)}}),e)}catch(t){return e(t)}}),e)}catch(t){return e(t)}}),e))}))}function P(t){return new Promise(((e,r)=>{const i=new x;i.onload=t=>{const r=new DataView(t.target.result);if(65496!=r.getUint16(0,!1))return e(-2);const i=r.byteLength;let n=2;for(;n<i;){if(r.getUint16(n+2,!1)<=8)return e(-1);const t=r.getUint16(n,!1);if(n+=2,65505==t){if(1165519206!=r.getUint32(n+=2,!1))return e(-1);const t=18761==r.getUint16(n+=6,!1);n+=r.getUint32(n+4,t);const i=r.getUint16(n,t);n+=2;for(let s=0;s<i;s++)if(274==r.getUint16(n+12*s,t))return e(r.getUint16(n+12*s+8,t))}else{if(65280!=(65280&t))break;n+=r.getUint16(n,!1)}}return e(-1)},i.onerror=t=>r(t),i.readAsArrayBuffer(t)}))}function F(t,e){const{width:r}=t,{height:i}=t,{maxWidthOrHeight:n}=e;let s,a=t;return isFinite(n)&&(r>n||i>n)&&([a,s]=R(r,i),r>i?(a.width=n,a.height=i/r*n):(a.width=r/i*n,a.height=n),s.drawImage(t,0,0,a.width,a.height),T(t)),a}function z(t,e){const{width:r}=t,{height:i}=t,[n,s]=R(r,i);switch(e>4&&e<9?(n.width=i,n.height=r):(n.width=r,n.height=i),e){case 2:s.transform(-1,0,0,1,r,0);break;case 3:s.transform(-1,0,0,-1,r,i);break;case 4:s.transform(1,0,0,-1,0,i);break;case 5:s.transform(0,1,1,0,0,0);break;case 6:s.transform(0,1,-1,0,i,0);break;case 7:s.transform(0,-1,-1,0,i,r);break;case 8:s.transform(0,-1,1,0,0,r)}return s.drawImage(t,0,0,r,i),T(t),n}function L(t,e,r=0){return new Promise((function(i,n){let s,a,o,h,l,c,u,f,d,m,g,p,w,b,y,_,v,x,k,A;function M(t=5){if(e.signal&&e.signal.aborted)throw e.signal.reason;s+=t,e.onProgress(Math.min(s,100))}function E(t){if(e.signal&&e.signal.aborted)throw e.signal.reason;s=Math.min(Math.max(t,s),100),e.onProgress(s)}return s=r,a=e.maxIteration||10,o=1024*e.maxSizeMB*1024,M(),C(t,e).then(function(r){try{return[,h]=r,M(),l=F(h,e),M(),new Promise((function(r,i){var n;if(!(n=e.exifOrientation))return P(t).then(function(t){try{return n=t,s.call(this)}catch(t){return i(t)}}.bind(this),i);function s(){return r(n)}return s.call(this)})).then(function(r){try{return c=r,M(),U().then(function(r){try{return u=r?l:z(l,c),M(),f=e.initialQuality||1,d=e.fileType||t.type,B(u,d,t.name,t.lastModified,f).then(function(r){try{{if(m=r,M(),g=m.size>o,p=m.size>t.size,!g&&!p)return E(100),i(m);var s;function S(){if(a--&&(y>o||y>w)){let e,r;return e=A?.95*k.width:k.width,r=A?.95*k.height:k.height,[v,x]=R(e,r),x.drawImage(k,0,0,e,r),f*="image/png"===d?.85:.95,B(v,d,t.name,t.lastModified,f).then((function(t){try{return _=t,T(k),k=v,y=_.size,E(Math.min(99,Math.floor((b-y)/(b-o)*100))),S}catch(t){return n(t)}}),n)}return[1]}return w=t.size,b=m.size,y=b,k=u,A=!e.alwaysKeepResolution&&g,(s=function(t){for(;t;){if(t.then)return void t.then(s,n);try{if(t.pop){if(t.length)return t.pop()?I.call(this):t;t=S}else t=t.call(this)}catch(t){return n(t)}}}.bind(this))(S);function I(){return T(k),T(v),T(l),T(u),T(h),E(100),i(_)}}}catch(c){return n(c)}}.bind(this),n)}catch(t){return n(t)}}.bind(this),n)}catch(t){return n(t)}}.bind(this),n)}catch(t){return n(t)}}.bind(this),n)}))}const O="\nlet scriptImported = false\nself.addEventListener('message', async (e) => {\n  const { file, id, imageCompressionLibUrl, options } = e.data\n  options.onProgress = (progress) => self.postMessage({ progress, id })\n  try {\n    if (!scriptImported) {\n      // console.log('[worker] importScripts', imageCompressionLibUrl)\n      self.importScripts(imageCompressionLibUrl)\n      scriptImported = true\n    }\n    // console.log('[worker] self', self)\n    const compressedFile = await imageCompression(file, options)\n    self.postMessage({ file: compressedFile, id })\n  } catch (e) {\n    // console.error('[worker] error', e)\n    self.postMessage({ error: e.message + '\\n' + e.stack, id })\n  }\n})\n";let N;function Y(t,e){return new Promise(((r,i)=>{N||(N=function(t){const e=[];return"function"==typeof t?e.push(`(${t})()`):e.push(t),URL.createObjectURL(new Blob(e))}(O));const n=new Worker(N);n.addEventListener("message",(function(t){if(e.signal&&e.signal.aborted)n.terminate();else if(void 0===t.data.progress){if(t.data.error)return i(new Error(t.data.error)),void n.terminate();r(t.data.file),n.terminate()}else e.onProgress(t.data.progress)})),n.addEventListener("error",i),e.signal&&e.signal.addEventListener("abort",(()=>{i(e.signal.reason),n.terminate()})),n.postMessage({file:t,imageCompressionLibUrl:e.libURL,options:{...e,onProgress:void 0,signal:void 0}})}))}function V(t,e){return new Promise((function(r,i){let n,s,a,o,h,c;if(n={...e},a=0,({onProgress:o}=n),n.maxSizeMB=n.maxSizeMB||Number.POSITIVE_INFINITY,h="boolean"!=typeof n.useWebWorker||n.useWebWorker,delete n.useWebWorker,n.onProgress=t=>{a=t,"function"==typeof o&&o(a)},!(t instanceof Blob||t instanceof v))return i(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(t.type))return i(new Error("The file given is not an image"));if(c="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,!h||"function"!=typeof Worker||c)return L(t,n).then(function(t){try{return s=t,d.call(this)}catch(t){return i(t)}}.bind(this),i);var u=function(){try{return d.call(this)}catch(t){return i(t)}}.bind(this),f=function(e){try{return L(t,n).then((function(t){try{return s=t,u()}catch(t){return i(t)}}),i)}catch(t){return i(t)}};try{return n.libURL=n.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Y(t,n).then((function(t){try{return s=t,u()}catch(t){return f()}}),f)}catch(t){f()}function d(){try{s.name=t.name,s.lastModified=t.lastModified}catch(t){}try{n.preserveExif&&"image/jpeg"===t.type&&(!n.fileType||n.fileType&&n.fileType===t.type)&&(s=l(t,s))}catch(t){}return r(s)}}))}V.getDataUrlFromFile=A,V.getFilefromDataUrl=k,V.loadImage=M,V.drawImageInCanvas=I,V.drawFileInCanvas=C,V.canvasToFile=B,V.getExifOrientation=P,V.handleMaxWidthOrHeight=F,V.followExifOrientation=z,V.cleanupCanvasMemory=T,V.isAutoOrientationInBrowser=U,V.approximateBelowMaximumCanvasSizeOfBrowser=S,V.copyExifWithoutOrientation=l,V.getBrowserName=E,V.version="2.0.2";const{Image:X}=r(88881);class j extends o.A{static compressImage(t,e=.6,r="image/png"){return new Promise(((i,n)=>{new(a())(t,{quality:e,mimeType:r,success:i,error:n})}))}static async changeExt(t,e,r=100){X.load(t).then((t=>{t.save("output.jpg",{quality:r,format:e}),console.log("图片已成功转换为 JPEG 格式")})).catch((t=>{console.error("图片转换出错：",t)}))}static async changeExtension(t,e="image/jpeg"){const r={useWebWorker:!0,fileType:e},i=await V(t,r);return i}static advancedCompressImage(t,e=.8,r=1920,i=1080){return new Promise((n=>{const s=document.createElement("canvas"),a=s.getContext("2d"),o=new X;o.onload=()=>{let{width:h,height:l}=o;h>r&&(l=l*r/h,h=r),l>i&&(h=h*i/l,l=i),s.width=h,s.height=l,a.drawImage(o,0,0,h,l),s.toBlob((e=>{const r=new File([e],t.name,{type:t.type,lastModified:Date.now()});n(r)}),t.type,e)},o.src=URL.createObjectURL(t)}))}static getImageDimensions(t){return new Promise(((e,r)=>{const i=new X;i.onload=()=>{e({width:i.naturalWidth,height:i.naturalHeight}),URL.revokeObjectURL(i.src)},i.onerror=r,i.src=URL.createObjectURL(t)}))}static createThumbnail(t,e=150){return new Promise((r=>{const i=document.createElement("canvas"),n=i.getContext("2d"),s=new X;s.onload=()=>{const{width:t,height:a}=s,o=Math.min(e/t,e/a),h=t*o,l=a*o;i.width=e,i.height=e;const c=(e-h)/2,u=(e-l)/2;n.fillStyle="#f0f0f0",n.fillRect(0,0,e,e),n.drawImage(s,c,u,h,l),r(i.toDataURL()),URL.revokeObjectURL(s.src)},s.src=URL.createObjectURL(t)}))}}var H=r(95866),G={data(){return{metaInfo:{title:"在线图片压缩与格式转换 - 支持JPG/PNG/WebP",meta:[{name:"description",content:"上传图片后可一键压缩，保持清晰度的同时大幅减小文件体积，支持多种格式相互转换。"},{name:"keywords",content:"在线图片压缩,JPG压缩,PNG压缩,WebP转换,图片格式转换,免费压缩工具,批量压缩"}]},fileList:[],compressFileList:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,compressVal:50,compressValue:0,saveFormat:"original",formatOptions:[{label:"原格式",value:"original"},{label:"image/jpeg",value:"image/jpeg"},{label:"image/jpg",value:"image/jpg"},{label:"image/png",value:"image/png"},{label:"image/webp",value:"image/webp"},{label:"image/gif",value:"image/gif"}]}},methods:{async startDownload(){this.compressFileList.forEach(((t,e)=>{var r,i;const n=null!==(r=this.fileList[e])&&void 0!==r&&r.name?this.fileList[e].name.replace(/\.[^.]+$/,""):e,s="original"===this.saveFormat?o.A.getExt((null===(i=this.fileList[e])||void 0===i?void 0:i.name)||t.save_name):"jpg"===this.saveFormat.replace("image/","")?"jpg":this.saveFormat.replace("image/",""),a=n+"."+s;H.A.downloadBlob(t.file,a)}))},async startDownloadAsZip(){const t=this.$loading({lock:!0,text:"打包下载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});try{const t=this.compressFileList.map(((t,e)=>{var r,i;const n=null!==(r=this.fileList[e])&&void 0!==r&&r.name?this.fileList[e].name.replace(/\.[^.]+$/,""):e,s="original"===this.saveFormat?o.A.getExt((null===(i=this.fileList[e])||void 0===i?void 0:i.name)||t.save_name):"jpg"===this.saveFormat.replace("image/","")?"jpg":this.saveFormat.replace("image/",""),a=n+"."+s;return{file:t.file,save_name:a}})),e=H.A.generateTimestampFilename("compressed_images","zip");await H.A.downloadAsZip(t,e,"file","save_name")}catch(u){console.log("startDownloadAsZip err"+u.message)}t.close()},async startCompress(){this.compressFileList=[];let t=0;const e=this.$loading({lock:!0,text:"压缩中图片中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.compressValue=this.compressVal;for(const i of this.fileList)try{let e,r="";"original"===this.saveFormat?(r=i.raw.type,["image/png","image/jpeg","image/jpg","image/webp","image/gif"].includes(r)||(r="image/jpeg")):r=this.saveFormat,e="image/gif"===r?i.raw:await j.compressImage(i.raw,(100-this.compressValue)/100,r);const n="image/png"===r?"png":"image/jpeg"===r?"jpeg":"image/jpg"===r?"jpg":"image/webp"===r?"webp":"image/gif"===r?"gif":o.A.getExt(i.name),s=j.fileToBlob(e);this.compressFileList.push({before_size:j.formatBytes(i.size),file:s,save_name:t+"."+n,file_url:URL.createObjectURL(s),after_size:j.formatBytes(e.size||e.size),k:t++})}catch(r){console.error("Compression Error:",r.message)}e.close()},handleRemove(t){console.log(t)},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleDownload(t){console.log(t)},handleChange(t,e){this.fileList=e}}},q=G,$=r(81656),Z=(0,$.A)(q,i,n,!1,null,"210c7e38",null),W=Z.exports},79372:function(t,e,r){r(16280),r(44114),r(72712),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(64979),r(13611),
/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */
function(e,r){t.exports=r()}(0,(function(){"use strict";function t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function e(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function n(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e=h(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(){return a=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a.apply(this,arguments)}function o(t,e){if("object"!==typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function h(t){var e=o(t,"string");return"symbol"===typeof e?e:String(e)}var l={exports:{}};(function(t){"undefined"!==typeof window&&function(e){var r=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,i=e.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),n=i&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,o=(i||s)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(t){var e,r,o,h,l,c,u,f,d;if(e=t.match(a),!e)throw new Error("invalid data URI");for(r=e[2]?e[1]:"text/plain"+(e[3]||";charset=US-ASCII"),o=!!e[4],h=t.slice(e[0].length),l=o?atob(h):decodeURIComponent(h),c=new ArrayBuffer(l.length),u=new Uint8Array(c),f=0;f<l.length;f+=1)u[f]=l.charCodeAt(f);return i?new Blob([n?u:c],{type:r}):(d=new s,d.append(c),d.getBlob(r))};e.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(t,e,i){var n=this;setTimeout((function(){i&&r.toDataURL&&o?t(o(n.toDataURL(e,i))):t(n.mozGetAsFile("blob",e))}))}:r.toDataURL&&o&&(r.msToBlob?r.toBlob=function(t,e,i){var n=this;setTimeout((function(){(e&&"image/png"!==e||i)&&r.toDataURL&&o?t(o(n.toDataURL(e,i))):t(n.msToBlob(e))}))}:r.toBlob=function(t,e,r){var i=this;setTimeout((function(){t(o(i.toDataURL(e,r)))}))})),t.exports?t.exports=o:e.dataURLtoBlob=o}(window)})(l);var c=l.exports,u=function(t){return"undefined"!==typeof Blob&&(t instanceof Blob||"[object Blob]"===Object.prototype.toString.call(t))},f={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},d="undefined"!==typeof window&&"undefined"!==typeof window.document,m=d?window:{},g=function(t){return t>0&&t<1/0},p=Array.prototype.slice;function w(t){return Array.from?Array.from(t):p.call(t)}var b=/^image\/.+$/;function y(t){return b.test(t)}function _(t){var e=y(t)?t.substr(6):"";return"jpeg"===e&&(e="jpg"),".".concat(e)}var v=String.fromCharCode;function x(t,e,r){var i,n="";for(r+=e,i=e;i<r;i+=1)n+=v(t.getUint8(i));return n}var k=m.btoa;function A(t,e){var r=[],i=8192,n=new Uint8Array(t);while(n.length>0)r.push(v.apply(null,w(n.subarray(0,i)))),n=n.subarray(i);return"data:".concat(e,";base64,").concat(k(r.join("")))}function M(t){var e,r=new DataView(t);try{var i,n,s;if(255===r.getUint8(0)&&216===r.getUint8(1)){var a=r.byteLength,o=2;while(o+1<a){if(255===r.getUint8(o)&&225===r.getUint8(o+1)){n=o;break}o+=1}}if(n){var h=n+4,l=n+10;if("Exif"===x(r,h,4)){var c=r.getUint16(l);if(i=18761===c,(i||19789===c)&&42===r.getUint16(l+2,i)){var u=r.getUint32(l+4,i);u>=8&&(s=l+u)}}}if(s){var f,d,m=r.getUint16(s,i);for(d=0;d<m;d+=1)if(f=s+12*d+2,274===r.getUint16(f,i)){f+=8,e=r.getUint16(f,i),r.setUint16(f,1,i);break}}}catch(g){e=1}return e}function E(t){var e=0,r=1,i=1;switch(t){case 2:r=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,r=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:r,scaleY:i}}var S=/\.\d*(?:0|9){12}\d*$/;function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return S.test(t)?Math.round(t*e)/e:t}function I(t){var e=t.aspectRatio,r=t.height,i=t.width,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",s=g(i),a=g(r);if(s&&a){var o=r*e;("contain"===n||"none"===n)&&o>i||"cover"===n&&o<i?r=i/e:i=r*e}else s?r=i/e:a&&(i=r*e);return{width:i,height:r}}function D(t){var e=w(new Uint8Array(t)),r=e.length,i=[],n=0;while(n+3<r){var s=e[n],a=e[n+1];if(255===s&&218===a)break;if(255===s&&216===a)n+=2;else{var o=256*e[n+2]+e[n+3],h=n+o+2,l=e.slice(n,h);i.push(l),n=h}}return i.reduce((function(t,e){return 255===e[0]&&225===e[1]?t.concat(e):t}),[])}function C(t,e){var r=w(new Uint8Array(t));if(255!==r[2]||224!==r[3])return t;var i=256*r[4]+r[5],n=[255,216].concat(e,r.slice(4+i));return new Uint8Array(n)}var B=m.ArrayBuffer,T=m.FileReader,U=m.URL||m.webkitURL,P=/\.\w+$/,F=m.Compressor,z=function(){function t(i,n){r(this,t),this.file=i,this.exif=[],this.image=new Image,this.options=e(e({},f),n),this.aborted=!1,this.result=null,this.init()}return n(t,[{key:"init",value:function(){var t=this,e=this.file,r=this.options;if(u(e)){var i=e.type;if(y(i))if(U&&T){B||(r.checkOrientation=!1,r.retainExif=!1);var n="image/jpeg"===i,s=n&&r.checkOrientation,o=n&&r.retainExif;if(!U||s||o){var h=new T;this.reader=h,h.onload=function(r){var n=r.target,h=n.result,l={},c=1;s&&(c=M(h),c>1&&a(l,E(c))),o&&(t.exif=D(h)),l.url=s||o?!U||c>1?A(h,i):U.createObjectURL(e):h,t.load(l)},h.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},h.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},h.onloadend=function(){t.reader=null},s||o?h.readAsArrayBuffer(e):h.readAsDataURL(e)}else this.load({url:U.createObjectURL(e)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(t){var r=this,i=this.file,n=this.image;n.onload=function(){r.draw(e(e({},t),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){r.fail(new Error("Aborted to load the image."))},n.onerror=function(){r.fail(new Error("Failed to load the image."))},m.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(m.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=t.url}},{key:"draw",value:function(t){var e=this,r=t.naturalWidth,i=t.naturalHeight,n=t.rotate,s=void 0===n?0:n,a=t.scaleX,o=void 0===a?1:a,h=t.scaleY,l=void 0===h?1:h,u=this.file,f=this.image,d=this.options,m=document.createElement("canvas"),p=m.getContext("2d"),w=Math.abs(s)%180===90,b=("contain"===d.resize||"cover"===d.resize)&&g(d.width)&&g(d.height),_=Math.max(d.maxWidth,0)||1/0,v=Math.max(d.maxHeight,0)||1/0,x=Math.max(d.minWidth,0)||0,k=Math.max(d.minHeight,0)||0,M=r/i,E=d.width,S=d.height;if(w){var D=[v,_];_=D[0],v=D[1];var B=[k,x];x=B[0],k=B[1];var U=[S,E];E=U[0],S=U[1]}b&&(M=E/S);var P=I({aspectRatio:M,width:_,height:v},"contain");_=P.width,v=P.height;var F=I({aspectRatio:M,width:x,height:k},"cover");if(x=F.width,k=F.height,b){var z=I({aspectRatio:M,width:E,height:S},d.resize);E=z.width,S=z.height}else{var L=I({aspectRatio:M,width:E,height:S}),O=L.width;E=void 0===O?r:O;var N=L.height;S=void 0===N?i:N}E=Math.floor(R(Math.min(Math.max(E,x),_))),S=Math.floor(R(Math.min(Math.max(S,k),v)));var Y=-E/2,V=-S/2,X=E,j=S,H=[];if(b){var G=0,q=0,$=r,Z=i,W=I({aspectRatio:M,width:r,height:i},{contain:"cover",cover:"contain"}[d.resize]);$=W.width,Z=W.height,G=(r-$)/2,q=(i-Z)/2,H.push(G,q,$,Z)}if(H.push(Y,V,X,j),w){var Q=[S,E];E=Q[0],S=Q[1]}m.width=E,m.height=S,y(d.mimeType)||(d.mimeType=u.type);var K="transparent";u.size>d.convertSize&&d.convertTypes.indexOf(d.mimeType)>=0&&(d.mimeType="image/jpeg");var J="image/jpeg"===d.mimeType;if(J&&(K="#fff"),p.fillStyle=K,p.fillRect(0,0,E,S),d.beforeDraw&&d.beforeDraw.call(this,p,m),!this.aborted&&(p.save(),p.translate(E/2,S/2),p.rotate(s*Math.PI/180),p.scale(o,l),p.drawImage.apply(p,[f].concat(H)),p.restore(),d.drew&&d.drew.call(this,p,m),!this.aborted)){var tt=function(t){if(!e.aborted){var n=function(t){return e.done({naturalWidth:r,naturalHeight:i,result:t})};if(t&&J&&d.retainExif&&e.exif&&e.exif.length>0){var s=function(t){return n(c(A(C(t,e.exif),d.mimeType)))};if(t.arrayBuffer)t.arrayBuffer().then(s).catch((function(){e.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))}));else{var a=new T;e.reader=a,a.onload=function(t){var e=t.target;s(e.result)},a.onabort=function(){e.fail(new Error("Aborted to read the compressed image with FileReader."))},a.onerror=function(){e.fail(new Error("Failed to read the compressed image with FileReader."))},a.onloadend=function(){e.reader=null},a.readAsArrayBuffer(t)}}else n(t)}};m.toBlob?m.toBlob(tt,d.mimeType,d.quality):tt(c(m.toDataURL(d.mimeType,d.quality)))}}},{key:"done",value:function(t){var e=t.naturalWidth,r=t.naturalHeight,i=t.result,n=this.file,s=this.image,a=this.options;if(U&&0===s.src.indexOf("blob:")&&U.revokeObjectURL(s.src),i)if(a.strict&&!a.retainExif&&i.size>n.size&&a.mimeType===n.type&&!(a.width>e||a.height>r||a.minWidth>e||a.minHeight>r||a.maxWidth<e||a.maxHeight<r))i=n;else{var o=new Date;i.lastModified=o.getTime(),i.lastModifiedDate=o,i.name=n.name,i.name&&i.type!==n.type&&(i.name=i.name.replace(P,_(i.type)))}else i=n;this.result=i,a.success&&a.success.call(this,i)}},{key:"fail",value:function(t){var e=this.options;if(!e.error)throw t;e.error.call(this,t)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=F,t}},{key:"setDefaults",value:function(t){a(f,t)}}]),t}();return z}))},1210:function(t,e,r){"use strict";r(16280),r(44114);const{IOBuffer:i}=r(10036),n=r(54798),s=[];for(let o=0;o<=8;o++)s.push(255<<o);class a extends i{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new i,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),r=Math.ceil(this.bitDepth*this.width/8),i=e-r,n=this.bitDepth*this.width%8,a=0===n?0:8-n,o=e*this.height;let h,l,c=0,u=0,f=8;t.mark(),l=this.readUint8();for(let d=this.height-1;d>=0;d--){const o=0===d;t.reset(),t.skip(d*e);for(let e=0;e<r;e++){const d=e===r-1;u<=a&&d?(t.writeByte(l<<u),0!==a&&a!==u||o||(h=l,l=this.readByte())):0===u?(h=l,l=this.readUint8(),t.writeByte(h)):(h=l,l=this.readUint8(),t.writeByte(h<<u&s[u]|l>>f)),d&&(c+=n||0,t.skip(i),u=c%8,f=8-u)}}e>r&&(t.reset(),t.skip(o-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32),e=t*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(n.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(e).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(n.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(n.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}t.exports=a},54798:function(t){"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},62027:function(t,e,r){"use strict";const i=r(1210);e.l=function(t){const e=new i(t);return e.encode()}},86477:function(t,e,r){"use strict";r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577);const i=8192,n=[];class s{constructor(t,e){e=e||{},void 0===t&&(t=i),"number"===typeof t&&(t=new ArrayBuffer(t));let r=t.byteLength;const n=e.offset?e.offset>>>0:0;t.buffer&&(r=t.byteLength-n,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+n,t.byteOffset+t.byteLength):n?t.buffer.slice(n):t.buffer),this.buffer=t,this.length=r,this.byteLength=r,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=r||i,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,r=new Uint8Array(e);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),r=0;r<t;r++)e[r]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),n.length=t;for(var e=0;e<t;e++)n[e]=this.readChar();return n.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}t.exports=s},5853:function(t,e,r){"use strict";const i=r(94714);t.exports=function(t,e){const r=new i(t,e);return r.decode(e)}},58362:function(t,e,r){"use strict";r(16280);const i={standard:r(97544),exif:r(70235),gps:r(12365)};class n{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"===typeof t)return this.fields.get(t);if("string"===typeof t)return this.fields.get(i[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=i[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}t.exports=n},67233:function(t,e,r){"use strict";r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577);var i=new Map([[1,[1,n]],[2,[1,s]],[3,[2,a]],[4,[4,o]],[5,[8,h]],[6,[1,l]],[7,[1,n]],[8,[2,c]],[9,[4,u]],[10,[8,f]],[11,[4,d]],[12,[8,m]]]);function n(t,e){if(1===e)return t.readUint8();for(var r=new Uint8Array(e),i=0;i<e;i++)r[i]=t.readUint8();return r}function s(t,e){for(var r=[],i="",n=0;n<e;n++){var s=String.fromCharCode(t.readUint8());"\0"===s?(r.push(i),i=""):i+=s}return 1===r.length?r[0]:r}function a(t,e){if(1===e)return t.readUint16();for(var r=new Uint16Array(e),i=0;i<e;i++)r[i]=t.readUint16();return r}function o(t,e){if(1===e)return t.readUint32();for(var r=new Uint32Array(e),i=0;i<e;i++)r[i]=t.readUint32();return r}function h(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var r=new Array(e),i=0;i<e;i++)r[i]=t.readUint32()/t.readUint32();return r}function l(t,e){if(1===e)return t.readInt8();for(var r=new Int8Array(e),i=0;i<e;i++)r[i]=t.readInt8();return r}function c(t,e){if(1===e)return t.readInt16();for(var r=new Int16Array(e),i=0;i<e;i++)r[i]=t.readInt16();return r}function u(t,e){if(1===e)return t.readInt32();for(var r=new Int32Array(e),i=0;i<e;i++)r[i]=t.readInt32();return r}function f(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var r=new Array(e),i=0;i<e;i++)r[i]=t.readInt32()/t.readInt32();return r}function d(t,e){if(1===e)return t.readFloat32();for(var r=new Float32Array(e),i=0;i<e;i++)r[i]=t.readFloat32();return r}function m(t,e){if(1===e)return t.readFloat64();for(var r=new Float64Array(e),i=0;i<e;i++)r[i]=t.readFloat64();return r}e.getByteLength=function(t,e){return i.get(t)[0]*e},e.readData=function(t,e,r){return i.get(e)[1](t,r)}},13091:function(t,e,r){"use strict";e.decode=r(5853)},70235:function(t){"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},r={};for(var i in e)r[e[i]]=i;t.exports={tagsById:e,tagsByName:r}},12365:function(t){"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},r={};for(var i in e)r[e[i]]=i;t.exports={tagsById:e,tagsByName:r}},97544:function(t){"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},r={};for(var i in e)r[e[i]]=i;t.exports={tagsById:e,tagsByName:r}},94714:function(t,e,r){"use strict";r(16280),r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577);const i=r(86477),n=r(58362),s=r(41727),a=r(67233),o={ignoreImageData:!1,onlyFirst:!1};class h extends i{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},o,t);const e=[];this.decodeHeader();while(this._nextIFD)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new n(t.kind):new s;const r=this.readUint16();for(var i=0;i<r;i++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,r=this.readUint16(),i=this.readUint16(),n=this.readUint32();if(i<1||i>12)return void this.skip(4);const s=a.getByteLength(i,n);s>4&&this.seek(this.readUint32());const o=a.readData(this,i,n);if(t.fields.set(r,o),34665===r||34853===r){let e,i=this.offset;34665===r?e="exif":34853===r&&(e="gps"),this._nextIFD=o,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=i}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&d("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:d("image type",t.type);break}}readStripData(t){const e=t.width,r=t.height,i=m(t.bitsPerSample),n=t.sampleFormat;let s=e*r;const a=l(s,1,i,n),o=t.compression,h=t.rowsPerStrip,g=h*e,p=t.stripOffsets,w=t.stripByteCounts;for(var b=0,y=0;y<p.length;y++){var _=this.getStripData(o,p[y],w[y]),v=s>g?g:s;s-=v,8===i?b=c(a,_,b,v):16===i?b=u(a,_,b,v,this.isLittleEndian()):32===i&&3===n?b=f(a,_,b,v,this.isLittleEndian()):d("bitDepth",i)}t.data=a}getStripData(t,e,r){switch(t){case 1:return new DataView(this.buffer,e,r);case 2:case 32773:return d("Compression",t);default:throw new Error("invalid compression: "+t)}}}function l(t,e,r,i){return 8===r?new Uint8Array(t*e):16===r?new Uint16Array(t*e):32===r&&3===i?new Float32Array(t*e):d("bit depth / sample format",r+" / "+i)}function c(t,e,r,i){for(var n=0;n<i;n++)t[r++]=e.getUint8(n);return r}function u(t,e,r,i,n){for(var s=0;s<2*i;s+=2)t[r++]=e.getUint16(s,n);return r}function f(t,e,r,i,n){for(var s=0;s<4*i;s+=4)t[r++]=e.getFloat32(s,n);return r}function d(t,e){throw new Error("Unsupported "+t+": "+e)}function m(t){if(t.length){const r=t;t=r[0];for(var e=0;e<r.length;e++)r[e]!==t&&d("bit depth",r)}return t}t.exports=h},41727:function(t,e,r){"use strict";const i=r(58362),n=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class s extends i{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=n.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return a(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return a(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}function a(t){return"number"===typeof t?[t]:t}t.exports=s},30748:function(t,e,r){"use strict";r(16280);const i=r(86477),n=r(13091);function s(t){const e=new i(t),r={};e.setBigEndian();const s=e.readUint16();if(65496!==s)throw new Error("SOI marker not found. Not a valid JPEG file");const a=e.readUint16();if(65505===a){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=n.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});r.exif=t}}return r}t.exports=s},40536:function(t,e,r){"use strict";e.decode=r(30748)},13578:function(t,e,r){r(16280),r(44114),function(){function e(t,e,r){this.next=r,r&&(r.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function r(){if(!(this instanceof r))return new r;this._head=null,this._tail=null,this.length=0}r.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);var e=this._head;while(t-- >0&&e)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");var r=e-t,i=new Array(r),n=0,s=this._head;while(t-- >0&&s)s=s.next;while(n<r&&s)i[n++]=s.data,s=s.next;return i},drop:function(){r.call(this)},forEach:function(t,e){var r=this._head,i=0,n=this.length;while(i<n&&r)t.call(e||this,r.data,i,this),r=r.next,i++},map:function(t,e){var i=new r;return this.forEach((function(r,n,s){i.push(t.call(e||s,r,n,s))})),i},filter:function(t,e){var i=new r;return this.forEach((function(r,n,s){t.call(e||s,r,n,s)&&i.push(r)})),i},reduce:function(t,e,r){var i=0,n=this._head,s=this.length;e||(i=1,e=n&&n.data,n=n&&n.next);while(i<s&&n)e=t.call(r||this,e,n.data,this),i++,n=n.next;return e}},t.exports=r}()},15883:function(t,e,r){"use strict";function i(t){if(this.size=0|t,this.size<=1||0!==(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),r=0;r<e.length;r+=2){const t=Math.PI*r/this.size;e[r]=Math.cos(t),e[r+1]=-Math.sin(t)}this.table=e;for(var i=0,n=1;this.size>n;n<<=1)i++;this._width=i%2===0?i-1:i,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var a=0;a<this._width;a+=2){var o=this._width-a-2;this._bitrev[s]|=(s>>>a&3)<<o}}this._out=null,this._data=null,this._inv=0}r(16280),t.exports=i,i.prototype.fromComplexArray=function(t,e){for(var r=e||new Array(t.length>>>1),i=0;i<t.length;i+=2)r[i>>>1]=t[i];return r},i.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},i.prototype.toComplexArray=function(t,e){for(var r=e||this.createComplexArray(),i=0;i<r.length;i+=2)r[i]=t[i>>>1],r[i+1]=0;return r},i.prototype.completeSpectrum=function(t){for(var e=this._csize,r=e>>>1,i=2;i<r;i+=2)t[e-i]=t[i],t[e-i+1]=-t[i+1]},i.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},i.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},i.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var r=0;r<t.length;r++)t[r]/=this.size;this._out=null,this._data=null},i.prototype._transform4=function(){var t,e,r=this._out,i=this._csize,n=this._width,s=1<<n,a=i/s<<1,o=this._bitrev;if(4===a)for(t=0,e=0;t<i;t+=a,e++){const r=o[e];this._singleTransform2(t,r,s)}else for(t=0,e=0;t<i;t+=a,e++){const r=o[e];this._singleTransform4(t,r,s)}var h=this._inv?-1:1,l=this.table;for(s>>=2;s>=2;s>>=2){a=i/s<<1;var c=a>>>2;for(t=0;t<i;t+=a)for(var u=t+c,f=t,d=0;f<u;f+=2,d+=s){const t=f,e=t+c,i=e+c,n=i+c,s=r[t],a=r[t+1],o=r[e],u=r[e+1],m=r[i],g=r[i+1],p=r[n],w=r[n+1],b=s,y=a,_=l[d],v=h*l[d+1],x=o*_-u*v,k=o*v+u*_,A=l[2*d],M=h*l[2*d+1],E=m*A-g*M,S=m*M+g*A,R=l[3*d],I=h*l[3*d+1],D=p*R-w*I,C=p*I+w*R,B=b+E,T=y+S,U=b-E,P=y-S,F=x+D,z=k+C,L=h*(x-D),O=h*(k-C),N=B+F,Y=T+z,V=B-F,X=T-z,j=U+O,H=P-L,G=U-O,q=P+L;r[t]=N,r[t+1]=Y,r[e]=j,r[e+1]=H,r[i]=V,r[i+1]=X,r[n]=G,r[n+1]=q}}},i.prototype._singleTransform2=function(t,e,r){const i=this._out,n=this._data,s=n[e],a=n[e+1],o=n[e+r],h=n[e+r+1],l=s+o,c=a+h,u=s-o,f=a-h;i[t]=l,i[t+1]=c,i[t+2]=u,i[t+3]=f},i.prototype._singleTransform4=function(t,e,r){const i=this._out,n=this._data,s=this._inv?-1:1,a=2*r,o=3*r,h=n[e],l=n[e+1],c=n[e+r],u=n[e+r+1],f=n[e+a],d=n[e+a+1],m=n[e+o],g=n[e+o+1],p=h+f,w=l+d,b=h-f,y=l-d,_=c+m,v=u+g,x=s*(c-m),k=s*(u-g),A=p+_,M=w+v,E=b+k,S=y-x,R=p-_,I=w-v,D=b-k,C=y+x;i[t]=A,i[t+1]=M,i[t+2]=E,i[t+3]=S,i[t+4]=R,i[t+5]=I,i[t+6]=D,i[t+7]=C},i.prototype._realTransform4=function(){var t,e,r=this._out,i=this._csize,n=this._width,s=1<<n,a=i/s<<1,o=this._bitrev;if(4===a)for(t=0,e=0;t<i;t+=a,e++){const r=o[e];this._singleRealTransform2(t,r>>>1,s>>>1)}else for(t=0,e=0;t<i;t+=a,e++){const r=o[e];this._singleRealTransform4(t,r>>>1,s>>>1)}var h=this._inv?-1:1,l=this.table;for(s>>=2;s>=2;s>>=2){a=i/s<<1;var c=a>>>1,u=c>>>1,f=u>>>1;for(t=0;t<i;t+=a)for(var d=0,m=0;d<=f;d+=2,m+=s){var g=t+d,p=g+u,w=p+u,b=w+u,y=r[g],_=r[g+1],v=r[p],x=r[p+1],k=r[w],A=r[w+1],M=r[b],E=r[b+1],S=y,R=_,I=l[m],D=h*l[m+1],C=v*I-x*D,B=v*D+x*I,T=l[2*m],U=h*l[2*m+1],P=k*T-A*U,F=k*U+A*T,z=l[3*m],L=h*l[3*m+1],O=M*z-E*L,N=M*L+E*z,Y=S+P,V=R+F,X=S-P,j=R-F,H=C+O,G=B+N,q=h*(C-O),$=h*(B-N),Z=Y+H,W=V+G,Q=X+$,K=j-q;if(r[g]=Z,r[g+1]=W,r[p]=Q,r[p+1]=K,0!==d){if(d!==f){var J=X,tt=-j,et=Y,rt=-V,it=-h*$,nt=-h*q,st=-h*G,at=-h*H,ot=J+it,ht=tt+nt,lt=et+at,ct=rt-st,ut=t+u-d,ft=t+c-d;r[ut]=ot,r[ut+1]=ht,r[ft]=lt,r[ft+1]=ct}}else{var dt=Y-H,mt=V-G;r[w]=dt,r[w+1]=mt}}}},i.prototype._singleRealTransform2=function(t,e,r){const i=this._out,n=this._data,s=n[e],a=n[e+r],o=s+a,h=s-a;i[t]=o,i[t+1]=0,i[t+2]=h,i[t+3]=0},i.prototype._singleRealTransform4=function(t,e,r){const i=this._out,n=this._data,s=this._inv?-1:1,a=2*r,o=3*r,h=n[e],l=n[e+r],c=n[e+a],u=n[e+o],f=h+c,d=h-c,m=l+u,g=s*(l-u),p=f+m,w=d,b=-g,y=f-m,_=d,v=g;i[t]=p,i[t+1]=0,i[t+2]=w,i[t+3]=b,i[t+4]=y,i[t+5]=0,i[t+6]=_,i[t+7]=v}},331:function(module,__unused_webpack_exports,__webpack_require__){"use strict";__webpack_require__(16280),__webpack_require__(16573),__webpack_require__(78100),__webpack_require__(77936),__webpack_require__(48140),__webpack_require__(21903),__webpack_require__(91134),__webpack_require__(28845),__webpack_require__(37467),__webpack_require__(44732),__webpack_require__(79577);const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let r=t[e],i=1,n=0;while(++n<8)i*=256,r+=t[e+n]*i;return r}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const r=(t,r)=>{r=Object.assign({offset:0},r);for(let i=0;i<t.length;i++)if(r.mask){if(t[i]!==(r.mask[i]&e[i+r.offset]))return!1}else if(t[i]!==e[i+r.offset])return!1;return!0},i=(t,e)=>r(toBytes(t),e);if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(r([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(r([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((r([73,73,42,0])||r([77,77,0,42]))&&r([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r([73,73,42,0])||r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(r([80,75,3,4])){if(r([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(r(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(i("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(i("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(i("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,r,i)=>r>=e&&80===i[r]&&75===i[r+1]&&3===i[r+2]&&4===i[r+3]));let n=0,s=!1,a=null;do{const o=n+30;if(s||(s=r(oxmlContentTypes,{offset:o})||r(oxmlRels,{offset:o})),a||(i("word/",{offset:o})?a={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:i("ppt/",{offset:o})?a={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:i("xl/",{offset:o})&&(a={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),s&&a)return a;n=t(e,o)}while(n>=0);if(a)return a}if(r([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(r([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(r([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([51,103,112,53])||r([0,0,0])&&r([102,116,121,112],{offset:4})&&(r([109,112,52,49],{offset:8})||r([109,112,52,50],{offset:8})||r([105,115,111,109],{offset:8})||r([105,115,111,50],{offset:8})||r([109,109,112,52],{offset:8})||r([77,52,86],{offset:8})||r([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(r([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(r([26,69,223,163])){const t=e.subarray(4,4100),r=t.findIndex(((t,e,r)=>66===r[e]&&130===r[e+1]));if(-1!==r){const e=r+3,i=r=>[...r].every(((r,i)=>t[e+i]===r.charCodeAt(0)));if(i("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(i("webm"))return{ext:"webm",mime:"video/webm"}}}if(r([0,0,0,20,102,116,121,112,113,116,32,32])||r([102,114,101,101],{offset:4})||r([102,116,121,112,113,116,32,32],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(r([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const i=readUInt64LE(e,t+16);if(r([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(r([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(r([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=i}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let n=0;n<2&&n<e.length-16;n++){if(r([73,68,51],{offset:n})||r([255,226],{offset:n,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([255,228],{offset:n,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,248],{offset:n,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,240],{offset:n,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(r([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(r([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(r([79,103,103,83]))return r([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:r([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:r([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:r([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:r([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(r([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(r([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(r([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(r([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(r([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([119,79,70,70])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(r([119,79,70,50])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(r([37,33]))return{ext:"ps",mime:"application/postscript"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(r([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(r([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(r([77,83,67,70])||r([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(r([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(r([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){if(r([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(r([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(r([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(r([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(r([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(i("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([102,116,121,112],{offset:4})){if(r([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(r([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(r([104,101,105,99],{offset:8})||r([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(r([104,101,118,99],{offset:8})||r([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return r([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:r([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:r([77,80,43])||r([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:r([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:r([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:r([212,195,178,161])||r([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports["default"]=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(r){reject(r)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},82287:function(t,e,r){var i=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return i.call(e,t)},e.version=r(77753).version},88881:function(t,e,r){"use strict";r.r(e),r.d(e,{Image:function(){return Hy},Kernel:function(){return o},Shape:function(){return wb},Stack:function(){return om},Static:function(){return n_},Worker:function(){return i_},default:function(){return Hy}});var i={};r.r(i),r.d(i,{CMYK:function(){return Sa},GREY:function(){return ka},HSL:function(){return Ma},HSV:function(){return Ea},RGB:function(){return Aa}});var n={};r.r(n),r.d(n,{tagsById:function(){return eo},tagsByName:function(){return ro}});var s={};r.r(s),r.d(s,{tagsById:function(){return io},tagsByName:function(){return no}});var a={};r.r(a),r.d(a,{tagsById:function(){return so},tagsByName:function(){return ao}});var o={};r.r(o),r.d(o,{DISCRETE_LAPLACE_4:function(){return Vm},DISCRETE_LAPLACE_8:function(){return Xm},SCHARR_X:function(){return Gm},SCHARR_Y:function(){return qm},SECOND_DERIVATIVE:function(){return $m},SECOND_DERIVATIVE_INV:function(){return Zm},SOBEL_X:function(){return jm},SOBEL_Y:function(){return Hm},laplacianOfGaussian:function(){return Gy}});r(16280);const h={getBit(t){return this.data[l(t)]&1<<c(t)?1:0},setBit(t){this.data[l(t)]|=1<<c(t)},clearBit(t){this.data[l(t)]&=~(1<<c(t))},toggleBit(t){this.data[l(t)]^=1<<c(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function l(t){return t>>3}function c(t){return 7-(7&t)}function u(t){for(const e in h)t.prototype[e]=h[e]}function f(t,e={}){let{bitDepth:r,alpha:i,colorModel:n,components:s,channels:a}=e;if("string"!==typeof t||0===t.length)throw new TypeError("processName must be a string");if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${r}`);if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${i}`);if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${n}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${s}`;throw 1===s.length&&1===s[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(a&&(Array.isArray(a)||(a=[a]),!a.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${a}`)}r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(64979),r(14603),r(47566),r(98721);function d(t,e){t=t||[],e=e||{},"string"===typeof e&&(e={type:e});try{return new Blob(t,e)}catch(s){if("TypeError"!==s.name)throw s;for(var r="undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,i=new r,n=0;n<t.length;n+=1)i.append(t[n]);return i.getBlob(e.type)}}function m(t){var e=t.match(/data:([^;]+)/)[1],r=t.replace(/^[^,]+,/,""),i=p(atob(r));return d([i],{type:e})}function g(t,e,r){return"function"===typeof t.toBlob?new Promise((function(i){t.toBlob(i,e,r)})):Promise.resolve(m(t.toDataURL(e,r)))}function p(t){var e=t.length,r=new ArrayBuffer(e),i=new Uint8Array(r),n=-1;while(++n<e)i[n]=t.charCodeAt(n);return r}var w=r(62027),b=(r(44114),r(10036));r(69479);
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
const y=4,_=0,v=1,x=2;function k(t){let e=t.length;while(--e>=0)t[e]=0}const A=0,M=1,E=2,S=3,R=258,I=29,D=256,C=D+1+I,B=30,T=19,U=2*C+1,P=15,F=16,z=7,L=256,O=16,N=17,Y=18,V=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),X=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),j=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),H=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),G=512,q=new Array(2*(C+2));k(q);const $=new Array(2*B);k($);const Z=new Array(G);k(Z);const W=new Array(R-S+1);k(W);const Q=new Array(I);k(Q);const K=new Array(B);function J(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let tt,et,rt;function it(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}k(K);const nt=t=>t<256?Z[t]:Z[256+(t>>>7)],st=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},at=(t,e,r)=>{t.bi_valid>F-r?(t.bi_buf|=e<<t.bi_valid&65535,st(t,t.bi_buf),t.bi_buf=e>>F-t.bi_valid,t.bi_valid+=r-F):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},ot=(t,e,r)=>{at(t,r[2*e],r[2*e+1])},ht=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},lt=t=>{16===t.bi_valid?(st(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)},ct=(t,e)=>{const r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,c,u,f,d,m,g=0;for(f=0;f<=P;f++)t.bl_count[f]=0;for(r[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<U;l++)c=t.heap[l],f=r[2*r[2*c+1]+1]+1,f>h&&(f=h,g++),r[2*c+1]=f,c>i||(t.bl_count[f]++,d=0,c>=o&&(d=a[c-o]),m=r[2*c],t.opt_len+=m*(f+d),s&&(t.static_len+=m*(n[2*c+1]+d)));if(0!==g){do{f=h-1;while(0===t.bl_count[f])f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[h]--,g-=2}while(g>0);for(f=h;0!==f;f--){c=t.bl_count[f];while(0!==c)u=t.heap[--l],u>i||(r[2*u+1]!==f&&(t.opt_len+=(f-r[2*u+1])*r[2*u],r[2*u+1]=f),c--)}}},ut=(t,e,r)=>{const i=new Array(P+1);let n,s,a=0;for(n=1;n<=P;n++)a=a+r[n-1]<<1,i[n]=a;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=ht(i[e]++,e))}},ft=()=>{let t,e,r,i,n;const s=new Array(P+1);for(r=0,i=0;i<I-1;i++)for(Q[i]=r,t=0;t<1<<V[i];t++)W[r++]=i;for(W[r-1]=i,n=0,i=0;i<16;i++)for(K[i]=n,t=0;t<1<<X[i];t++)Z[n++]=i;for(n>>=7;i<B;i++)for(K[i]=n<<7,t=0;t<1<<X[i]-7;t++)Z[256+n++]=i;for(e=0;e<=P;e++)s[e]=0;t=0;while(t<=143)q[2*t+1]=8,t++,s[8]++;while(t<=255)q[2*t+1]=9,t++,s[9]++;while(t<=279)q[2*t+1]=7,t++,s[7]++;while(t<=287)q[2*t+1]=8,t++,s[8]++;for(ut(q,C+1,s),t=0;t<B;t++)$[2*t+1]=5,$[2*t]=ht(t,5);tt=new J(q,V,D+1,C,P),et=new J($,X,0,B,P),rt=new J(new Array(0),j,0,T,z)},dt=t=>{let e;for(e=0;e<C;e++)t.dyn_ltree[2*e]=0;for(e=0;e<B;e++)t.dyn_dtree[2*e]=0;for(e=0;e<T;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*L]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},mt=t=>{t.bi_valid>8?st(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},gt=(t,e,r,i)=>{const n=2*e,s=2*r;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]},pt=(t,e,r)=>{const i=t.heap[r];let n=r<<1;while(n<=t.heap_len){if(n<t.heap_len&&gt(e,t.heap[n+1],t.heap[n],t.depth)&&n++,gt(e,i,t.heap[n],t.depth))break;t.heap[r]=t.heap[n],r=n,n<<=1}t.heap[r]=i},wt=(t,e,r)=>{let i,n,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,n=t.pending_buf[t.sym_buf+o++],0===i?ot(t,n,e):(s=W[n],ot(t,s+D+1,e),a=V[s],0!==a&&(n-=Q[s],at(t,n,a)),i--,s=nt(i),ot(t,s,r),a=X[s],0!==a&&(i-=K[s],at(t,i,a)))}while(o<t.sym_next);ot(t,L,e)},bt=(t,e)=>{const r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let a,o,h,l=-1;for(t.heap_len=0,t.heap_max=U,a=0;a<s;a++)0!==r[2*a]?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):r[2*a+1]=0;while(t.heap_len<2)h=t.heap[++t.heap_len]=l<2?++l:0,r[2*h]=1,t.depth[h]=0,t.opt_len--,n&&(t.static_len-=i[2*h+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)pt(t,r,a);h=s;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],pt(t,r,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,r[2*h]=r[2*a]+r[2*o],t.depth[h]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,r[2*a+1]=r[2*o+1]=h,t.heap[1]=h++,pt(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],ct(t,e),ut(r,l,t.bl_count)},yt=(t,e,r)=>{let i,n,s=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=e[2*(i+1)+1],++o<h&&n===a||(o<l?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[2*O]++):o<=10?t.bl_tree[2*N]++:t.bl_tree[2*Y]++,o=0,s=n,0===a?(h=138,l=3):n===a?(h=6,l=3):(h=7,l=4))},_t=(t,e,r)=>{let i,n,s=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),i=0;i<=r;i++)if(n=a,a=e[2*(i+1)+1],!(++o<h&&n===a)){if(o<l)do{ot(t,n,t.bl_tree)}while(0!==--o);else 0!==n?(n!==s&&(ot(t,n,t.bl_tree),o--),ot(t,O,t.bl_tree),at(t,o-3,2)):o<=10?(ot(t,N,t.bl_tree),at(t,o-3,3)):(ot(t,Y,t.bl_tree),at(t,o-11,7));o=0,s=n,0===a?(h=138,l=3):n===a?(h=6,l=3):(h=7,l=4)}},vt=t=>{let e;for(yt(t,t.dyn_ltree,t.l_desc.max_code),yt(t,t.dyn_dtree,t.d_desc.max_code),bt(t,t.bl_desc),e=T-1;e>=3;e--)if(0!==t.bl_tree[2*H[e]+1])break;return t.opt_len+=3*(e+1)+5+5+4,e},xt=(t,e,r,i)=>{let n;for(at(t,e-257,5),at(t,r-1,5),at(t,i-4,4),n=0;n<i;n++)at(t,t.bl_tree[2*H[n]+1],3);_t(t,t.dyn_ltree,e-1),_t(t,t.dyn_dtree,r-1)},kt=t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return _;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return v;for(e=32;e<D;e++)if(0!==t.dyn_ltree[2*e])return v;return _};let At=!1;const Mt=t=>{At||(ft(),At=!0),t.l_desc=new it(t.dyn_ltree,tt),t.d_desc=new it(t.dyn_dtree,et),t.bl_desc=new it(t.bl_tree,rt),t.bi_buf=0,t.bi_valid=0,dt(t)},Et=(t,e,r,i)=>{at(t,(A<<1)+(i?1:0),3),mt(t),st(t,r),st(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},St=t=>{at(t,M<<1,3),ot(t,L,q),lt(t)},Rt=(t,e,r,i)=>{let n,s,a=0;t.level>0?(t.strm.data_type===x&&(t.strm.data_type=kt(t)),bt(t,t.l_desc),bt(t,t.d_desc),a=vt(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==e?Et(t,e,r,i):t.strategy===y||s===n?(at(t,(M<<1)+(i?1:0),3),wt(t,q,$)):(at(t,(E<<1)+(i?1:0),3),xt(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),wt(t,t.dyn_ltree,t.dyn_dtree)),dt(t),i&&mt(t)},It=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(W[r]+D+1)]++,t.dyn_dtree[2*nt(e)]++),t.sym_next===t.sym_end);var Dt=Mt,Ct=Et,Bt=Rt,Tt=It,Ut=St,Pt={_tr_init:Dt,_tr_stored_block:Ct,_tr_flush_block:Bt,_tr_tally:Tt,_tr_align:Ut};const Ft=(t,e,r,i)=>{let n=65535&t,s=t>>>16&65535,a=0;while(0!==r){a=r>2e3?2e3:r,r-=a;do{n=n+e[i++]|0,s=s+n|0}while(--a);n%=65521,s%=65521}return n|s<<16};var zt=Ft;const Lt=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e},Ot=new Uint32Array(Lt()),Nt=(t,e,r,i)=>{const n=Ot,s=i+r;t^=-1;for(let a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return~t};var Yt=Nt,Vt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Xt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:jt,_tr_stored_block:Ht,_tr_flush_block:Gt,_tr_tally:qt,_tr_align:$t}=Pt,{Z_NO_FLUSH:Zt,Z_PARTIAL_FLUSH:Wt,Z_FULL_FLUSH:Qt,Z_FINISH:Kt,Z_BLOCK:Jt,Z_OK:te,Z_STREAM_END:ee,Z_STREAM_ERROR:re,Z_DATA_ERROR:ie,Z_BUF_ERROR:ne,Z_DEFAULT_COMPRESSION:se,Z_FILTERED:ae,Z_HUFFMAN_ONLY:oe,Z_RLE:he,Z_FIXED:le,Z_DEFAULT_STRATEGY:ce,Z_UNKNOWN:ue,Z_DEFLATED:fe}=Xt,de=9,me=15,ge=8,pe=29,we=256,be=we+1+pe,ye=30,_e=19,ve=2*be+1,xe=15,ke=3,Ae=258,Me=Ae+ke+1,Ee=32,Se=42,Re=57,Ie=69,De=73,Ce=91,Be=103,Te=113,Ue=666,Pe=1,Fe=2,ze=3,Le=4,Oe=3,Ne=(t,e)=>(t.msg=Vt[e],e),Ye=t=>2*t-(t>4?9:0),Ve=t=>{let e=t.length;while(--e>=0)t[e]=0},Xe=t=>{let e,r,i,n=t.w_size;e=t.hash_size,i=e;do{r=t.head[--i],t.head[i]=r>=n?r-n:0}while(--e);e=n,i=e;do{r=t.prev[--i],t.prev[i]=r>=n?r-n:0}while(--e)};let je=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,He=je;const Ge=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},qe=(t,e)=>{Gt(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Ge(t.strm)},$e=(t,e)=>{t.pending_buf[t.pending++]=e},Ze=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},We=(t,e,r,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),r),1===t.state.wrap?t.adler=zt(t.adler,e,n,r):2===t.state.wrap&&(t.adler=Yt(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)},Qe=(t,e)=>{let r,i,n=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match;const h=t.strstart>t.w_size-Me?t.strstart-(t.w_size-Me):0,l=t.window,c=t.w_mask,u=t.prev,f=t.strstart+Ae;let d=l[s+a-1],m=l[s+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(r=e,l[r+a]===m&&l[r+a-1]===d&&l[r]===l[s]&&l[++r]===l[s+1]){s+=2,r++;do{}while(l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&s<f);if(i=Ae-(f-s),s=f-Ae,i>a){if(t.match_start=e,a=i,i>=o)break;d=l[s+a-1],m=l[s+a]}}}while((e=u[e&c])>h&&0!==--n);return a<=t.lookahead?a:t.lookahead},Ke=t=>{const e=t.w_size;let r,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Me)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Xe(t),i+=e),0===t.strm.avail_in)break;if(r=We(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=ke){n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=He(t,t.ins_h,t.window[n+1]);while(t.insert)if(t.ins_h=He(t,t.ins_h,t.window[n+ke-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,t.lookahead+t.insert<ke)break}}while(t.lookahead<Me&&0!==t.strm.avail_in)},Je=(t,e)=>{let r,i,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,a=0,o=t.strm.avail_in;do{if(r=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,i=t.strstart-t.block_start,r>i+t.strm.avail_in&&(r=i+t.strm.avail_in),r>n&&(r=n),r<s&&(0===r&&e!==Kt||e===Zt||r!==i+t.strm.avail_in))break;a=e===Kt&&r===i+t.strm.avail_in?1:0,Ht(t,0,0,a),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,Ge(t.strm),i&&(i>r&&(i=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,r-=i),r&&(We(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(0===a);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?Le:e!==Zt&&e!==Kt&&0===t.strm.avail_in&&t.strstart===t.block_start?Fe:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(We(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,i=t.strstart-t.block_start,(i>=s||(i||e===Kt)&&e!==Zt&&0===t.strm.avail_in&&i<=n)&&(r=i>n?n:i,a=e===Kt&&0===t.strm.avail_in&&r===i?1:0,Ht(t,t.block_start,r,a),t.block_start+=r,Ge(t.strm)),a?ze:Pe)},tr=(t,e)=>{let r,i;for(;;){if(t.lookahead<Me){if(Ke(t),t.lookahead<Me&&e===Zt)return Pe;if(0===t.lookahead)break}if(r=0,t.lookahead>=ke&&(t.ins_h=He(t,t.ins_h,t.window[t.strstart+ke-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-Me&&(t.match_length=Qe(t,r)),t.match_length>=ke)if(i=qt(t,t.strstart-t.match_start,t.match_length-ke),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=ke){t.match_length--;do{t.strstart++,t.ins_h=He(t,t.ins_h,t.window[t.strstart+ke-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=He(t,t.ins_h,t.window[t.strstart+1]);else i=qt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(qe(t,!1),0===t.strm.avail_out))return Pe}return t.insert=t.strstart<ke-1?t.strstart:ke-1,e===Kt?(qe(t,!0),0===t.strm.avail_out?ze:Le):t.sym_next&&(qe(t,!1),0===t.strm.avail_out)?Pe:Fe},er=(t,e)=>{let r,i,n;for(;;){if(t.lookahead<Me){if(Ke(t),t.lookahead<Me&&e===Zt)return Pe;if(0===t.lookahead)break}if(r=0,t.lookahead>=ke&&(t.ins_h=He(t,t.ins_h,t.window[t.strstart+ke-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=ke-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Me&&(t.match_length=Qe(t,r),t.match_length<=5&&(t.strategy===ae||t.match_length===ke&&t.strstart-t.match_start>4096)&&(t.match_length=ke-1)),t.prev_length>=ke&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-ke,i=qt(t,t.strstart-1-t.prev_match,t.prev_length-ke),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=He(t,t.ins_h,t.window[t.strstart+ke-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=ke-1,t.strstart++,i&&(qe(t,!1),0===t.strm.avail_out))return Pe}else if(t.match_available){if(i=qt(t,0,t.window[t.strstart-1]),i&&qe(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Pe}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=qt(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<ke-1?t.strstart:ke-1,e===Kt?(qe(t,!0),0===t.strm.avail_out?ze:Le):t.sym_next&&(qe(t,!1),0===t.strm.avail_out)?Pe:Fe},rr=(t,e)=>{let r,i,n,s;const a=t.window;for(;;){if(t.lookahead<=Ae){if(Ke(t),t.lookahead<=Ae&&e===Zt)return Pe;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=ke&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){s=t.strstart+Ae;do{}while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);t.match_length=Ae-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=ke?(r=qt(t,1,t.match_length-ke),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=qt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(qe(t,!1),0===t.strm.avail_out))return Pe}return t.insert=0,e===Kt?(qe(t,!0),0===t.strm.avail_out?ze:Le):t.sym_next&&(qe(t,!1),0===t.strm.avail_out)?Pe:Fe},ir=(t,e)=>{let r;for(;;){if(0===t.lookahead&&(Ke(t),0===t.lookahead)){if(e===Zt)return Pe;break}if(t.match_length=0,r=qt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(qe(t,!1),0===t.strm.avail_out))return Pe}return t.insert=0,e===Kt?(qe(t,!0),0===t.strm.avail_out?ze:Le):t.sym_next&&(qe(t,!1),0===t.strm.avail_out)?Pe:Fe};function nr(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}const sr=[new nr(0,0,0,0,Je),new nr(4,4,8,4,tr),new nr(4,5,16,8,tr),new nr(4,6,32,32,tr),new nr(4,4,16,16,er),new nr(8,16,32,32,er),new nr(8,16,128,128,er),new nr(8,32,128,256,er),new nr(32,128,258,1024,er),new nr(32,258,258,4096,er)],ar=t=>{t.window_size=2*t.w_size,Ve(t.head),t.max_lazy_match=sr[t.level].max_lazy,t.good_match=sr[t.level].good_length,t.nice_match=sr[t.level].nice_length,t.max_chain_length=sr[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=ke-1,t.match_available=0,t.ins_h=0};function or(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*ve),this.dyn_dtree=new Uint16Array(2*(2*ye+1)),this.bl_tree=new Uint16Array(2*(2*_e+1)),Ve(this.dyn_ltree),Ve(this.dyn_dtree),Ve(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(xe+1),this.heap=new Uint16Array(2*be+1),Ve(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*be+1),Ve(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const hr=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Se&&e.status!==Re&&e.status!==Ie&&e.status!==De&&e.status!==Ce&&e.status!==Be&&e.status!==Te&&e.status!==Ue?1:0},lr=t=>{if(hr(t))return Ne(t,re);t.total_in=t.total_out=0,t.data_type=ue;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?Re:e.wrap?Se:Te,t.adler=2===e.wrap?0:1,e.last_flush=-2,jt(e),te},cr=t=>{const e=lr(t);return e===te&&ar(t.state),e},ur=(t,e)=>hr(t)||2!==t.state.wrap?re:(t.state.gzhead=e,te),fr=(t,e,r,i,n,s)=>{if(!t)return re;let a=1;if(e===se&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>de||r!==fe||i<8||i>15||e<0||e>9||s<0||s>le||8===i&&1!==a)return Ne(t,re);8===i&&(i=9);const o=new or;return t.state=o,o.strm=t,o.status=Se,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+ke-1)/ke),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=s,o.method=r,cr(t)},dr=(t,e)=>fr(t,e,fe,me,ge,ce),mr=(t,e)=>{if(hr(t)||e>Jt||e<0)return t?Ne(t,re):re;const r=t.state;if(!t.output||0!==t.avail_in&&!t.input||r.status===Ue&&e!==Kt)return Ne(t,0===t.avail_out?ne:re);const i=r.last_flush;if(r.last_flush=e,0!==r.pending){if(Ge(t),0===t.avail_out)return r.last_flush=-1,te}else if(0===t.avail_in&&Ye(e)<=Ye(i)&&e!==Kt)return Ne(t,ne);if(r.status===Ue&&0!==t.avail_in)return Ne(t,ne);if(r.status===Se&&0===r.wrap&&(r.status=Te),r.status===Se){let e=fe+(r.w_bits-8<<4)<<8,i=-1;if(i=r.strategy>=oe||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=i<<6,0!==r.strstart&&(e|=Ee),e+=31-e%31,Ze(r,e),0!==r.strstart&&(Ze(r,t.adler>>>16),Ze(r,65535&t.adler)),t.adler=1,r.status=Te,Ge(t),0!==r.pending)return r.last_flush=-1,te}if(r.status===Re)if(t.adler=0,$e(r,31),$e(r,139),$e(r,8),r.gzhead)$e(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),$e(r,255&r.gzhead.time),$e(r,r.gzhead.time>>8&255),$e(r,r.gzhead.time>>16&255),$e(r,r.gzhead.time>>24&255),$e(r,9===r.level?2:r.strategy>=oe||r.level<2?4:0),$e(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&($e(r,255&r.gzhead.extra.length),$e(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=Yt(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Ie;else if($e(r,0),$e(r,0),$e(r,0),$e(r,0),$e(r,0),$e(r,9===r.level?2:r.strategy>=oe||r.level<2?4:0),$e(r,Oe),r.status=Te,Ge(t),0!==r.pending)return r.last_flush=-1,te;if(r.status===Ie){if(r.gzhead.extra){let e=r.pending,i=(65535&r.gzhead.extra.length)-r.gzindex;while(r.pending+i>r.pending_buf_size){let n=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>e&&(t.adler=Yt(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex+=n,Ge(t),0!==r.pending)return r.last_flush=-1,te;e=0,i-=n}let n=new Uint8Array(r.gzhead.extra);r.pending_buf.set(n.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>e&&(t.adler=Yt(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex=0}r.status=De}if(r.status===De){if(r.gzhead.name){let e,i=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(t.adler=Yt(t.adler,r.pending_buf,r.pending-i,i)),Ge(t),0!==r.pending)return r.last_flush=-1,te;i=0}e=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,$e(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>i&&(t.adler=Yt(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=Ce}if(r.status===Ce){if(r.gzhead.comment){let e,i=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(t.adler=Yt(t.adler,r.pending_buf,r.pending-i,i)),Ge(t),0!==r.pending)return r.last_flush=-1,te;i=0}e=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,$e(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>i&&(t.adler=Yt(t.adler,r.pending_buf,r.pending-i,i))}r.status=Be}if(r.status===Be){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ge(t),0!==r.pending))return r.last_flush=-1,te;$e(r,255&t.adler),$e(r,t.adler>>8&255),t.adler=0}if(r.status=Te,Ge(t),0!==r.pending)return r.last_flush=-1,te}if(0!==t.avail_in||0!==r.lookahead||e!==Zt&&r.status!==Ue){let i=0===r.level?Je(r,e):r.strategy===oe?ir(r,e):r.strategy===he?rr(r,e):sr[r.level].func(r,e);if(i!==ze&&i!==Le||(r.status=Ue),i===Pe||i===ze)return 0===t.avail_out&&(r.last_flush=-1),te;if(i===Fe&&(e===Wt?$t(r):e!==Jt&&(Ht(r,0,0,!1),e===Qt&&(Ve(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ge(t),0===t.avail_out))return r.last_flush=-1,te}return e!==Kt?te:r.wrap<=0?ee:(2===r.wrap?($e(r,255&t.adler),$e(r,t.adler>>8&255),$e(r,t.adler>>16&255),$e(r,t.adler>>24&255),$e(r,255&t.total_in),$e(r,t.total_in>>8&255),$e(r,t.total_in>>16&255),$e(r,t.total_in>>24&255)):(Ze(r,t.adler>>>16),Ze(r,65535&t.adler)),Ge(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?te:ee)},gr=t=>{if(hr(t))return re;const e=t.state.status;return t.state=null,e===Te?Ne(t,ie):te},pr=(t,e)=>{let r=e.length;if(hr(t))return re;const i=t.state,n=i.wrap;if(2===n||1===n&&i.status!==Se||i.lookahead)return re;if(1===n&&(t.adler=zt(t.adler,e,r,0)),i.wrap=0,r>=i.w_size){0===n&&(Ve(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(r-i.w_size,r),0),e=t,r=i.w_size}const s=t.avail_in,a=t.next_in,o=t.input;t.avail_in=r,t.next_in=0,t.input=e,Ke(i);while(i.lookahead>=ke){let t=i.strstart,e=i.lookahead-(ke-1);do{i.ins_h=He(i,i.ins_h,i.window[t+ke-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=ke-1,Ke(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=ke-1,i.match_available=0,t.next_in=a,t.input=o,t.avail_in=s,i.wrap=n,te};var wr=dr,br=fr,yr=cr,_r=lr,vr=ur,xr=mr,kr=gr,Ar=pr,Mr="pako deflate (from Nodeca project)",Er={deflateInit:wr,deflateInit2:br,deflateReset:yr,deflateResetKeep:_r,deflateSetHeader:vr,deflate:xr,deflateEnd:kr,deflateSetDictionary:Ar,deflateInfo:Mr};const Sr=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Rr=function(t){const e=Array.prototype.slice.call(arguments,1);while(e.length){const r=e.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const e in r)Sr(r,e)&&(t[e]=r[e])}}return t},Ir=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const r=new Uint8Array(e);for(let i=0,n=0,s=t.length;i<s;i++){let e=t[i];r.set(e,n),n+=e.length}return r},Dr={assign:Rr,flattenChunks:Ir};let Cr=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s_){Cr=!1}const Br=new Uint8Array(256);for(let a_=0;a_<256;a_++)Br[a_]=a_>=252?6:a_>=248?5:a_>=240?4:a_>=224?3:a_>=192?2:1;Br[254]=Br[254]=1;var Tr=t=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)r=t.charCodeAt(n),55296===(64512&r)&&n+1<a&&(i=t.charCodeAt(n+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),n++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),s=0,n=0;s<o;n++)r=t.charCodeAt(n),55296===(64512&r)&&n+1<a&&(i=t.charCodeAt(n+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|63&r):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e};const Ur=(t,e)=>{if(e<65534&&t.subarray&&Cr)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r};var Pr=(t,e)=>{const r=e||t.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const s=new Array(2*r);for(n=0,i=0;i<r;){let e=t[i++];if(e<128){s[n++]=e;continue}let a=Br[e];if(a>4)s[n++]=65533,i+=a-1;else{e&=2===a?31:3===a?15:7;while(a>1&&i<r)e=e<<6|63&t[i++],a--;a>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return Ur(s,n)},Fr=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;while(r>=0&&128===(192&t[r]))r--;return r<0||0===r?e:r+Br[t[r]]>e?r:e},zr={string2buf:Tr,buf2string:Pr,utf8border:Fr};function Lr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Or=Lr;const Nr=Object.prototype.toString,{Z_NO_FLUSH:Yr,Z_SYNC_FLUSH:Vr,Z_FULL_FLUSH:Xr,Z_FINISH:jr,Z_OK:Hr,Z_STREAM_END:Gr,Z_DEFAULT_COMPRESSION:qr,Z_DEFAULT_STRATEGY:$r,Z_DEFLATED:Zr}=Xt;function Wr(t){this.options=Dr.assign({level:qr,method:Zr,chunkSize:16384,windowBits:15,memLevel:8,strategy:$r},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Or,this.strm.avail_out=0;let r=Er.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Hr)throw new Error(Vt[r]);if(e.header&&Er.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"===typeof e.dictionary?zr.string2buf(e.dictionary):"[object ArrayBuffer]"===Nr.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=Er.deflateSetDictionary(this.strm,t),r!==Hr)throw new Error(Vt[r]);this._dict_set=!0}}function Qr(t,e){const r=new Wr(e);if(r.push(t,!0),r.err)throw r.msg||Vt[r.err];return r.result}function Kr(t,e){return e=e||{},e.raw=!0,Qr(t,e)}function Jr(t,e){return e=e||{},e.gzip=!0,Qr(t,e)}Wr.prototype.push=function(t,e){const r=this.strm,i=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?jr:Yr,"string"===typeof t?r.input=zr.string2buf(t):"[object ArrayBuffer]"===Nr.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(s===Vr||s===Xr)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(n=Er.deflate(r,s),n===Gr)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=Er.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Hr;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},Wr.prototype.onData=function(t){this.chunks.push(t)},Wr.prototype.onEnd=function(t){t===Hr&&(this.result=Dr.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var ti=Wr,ei=Qr,ri=Kr,ii=Jr,ni=Xt,si={Deflate:ti,deflate:ei,deflateRaw:ri,gzip:ii,constants:ni};const ai=16209,oi=16191;var hi=function(t,e){let r,i,n,s,a,o,h,l,c,u,f,d,m,g,p,w,b,y,_,v,x,k,A,M;const E=t.state;r=t.next_in,A=t.input,i=r+(t.avail_in-5),n=t.next_out,M=t.output,s=n-(e-t.avail_out),a=n+(t.avail_out-257),o=E.dmax,h=E.wsize,l=E.whave,c=E.wnext,u=E.window,f=E.hold,d=E.bits,m=E.lencode,g=E.distcode,p=(1<<E.lenbits)-1,w=(1<<E.distbits)-1;t:do{d<15&&(f+=A[r++]<<d,d+=8,f+=A[r++]<<d,d+=8),b=m[f&p];e:for(;;){if(y=b>>>24,f>>>=y,d-=y,y=b>>>16&255,0===y)M[n++]=65535&b;else{if(!(16&y)){if(0===(64&y)){b=m[(65535&b)+(f&(1<<y)-1)];continue e}if(32&y){E.mode=oi;break t}t.msg="invalid literal/length code",E.mode=ai;break t}_=65535&b,y&=15,y&&(d<y&&(f+=A[r++]<<d,d+=8),_+=f&(1<<y)-1,f>>>=y,d-=y),d<15&&(f+=A[r++]<<d,d+=8,f+=A[r++]<<d,d+=8),b=g[f&w];r:for(;;){if(y=b>>>24,f>>>=y,d-=y,y=b>>>16&255,!(16&y)){if(0===(64&y)){b=g[(65535&b)+(f&(1<<y)-1)];continue r}t.msg="invalid distance code",E.mode=ai;break t}if(v=65535&b,y&=15,d<y&&(f+=A[r++]<<d,d+=8,d<y&&(f+=A[r++]<<d,d+=8)),v+=f&(1<<y)-1,v>o){t.msg="invalid distance too far back",E.mode=ai;break t}if(f>>>=y,d-=y,y=n-s,v>y){if(y=v-y,y>l&&E.sane){t.msg="invalid distance too far back",E.mode=ai;break t}if(x=0,k=u,0===c){if(x+=h-y,y<_){_-=y;do{M[n++]=u[x++]}while(--y);x=n-v,k=M}}else if(c<y){if(x+=h+c-y,y-=c,y<_){_-=y;do{M[n++]=u[x++]}while(--y);if(x=0,c<_){y=c,_-=y;do{M[n++]=u[x++]}while(--y);x=n-v,k=M}}}else if(x+=c-y,y<_){_-=y;do{M[n++]=u[x++]}while(--y);x=n-v,k=M}while(_>2)M[n++]=k[x++],M[n++]=k[x++],M[n++]=k[x++],_-=3;_&&(M[n++]=k[x++],_>1&&(M[n++]=k[x++]))}else{x=n-v;do{M[n++]=M[x++],M[n++]=M[x++],M[n++]=M[x++],_-=3}while(_>2);_&&(M[n++]=M[x++],_>1&&(M[n++]=M[x++]))}break}}break}}while(r<i&&n<a);_=d>>3,r-=_,d-=_<<3,f&=(1<<d)-1,t.next_in=r,t.next_out=n,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=n<a?a-n+257:257-(n-a),E.hold=f,E.bits=d};const li=15,ci=852,ui=592,fi=0,di=1,mi=2,gi=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),pi=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),wi=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),bi=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),yi=(t,e,r,i,n,s,a,o)=>{const h=o.bits;let l,c,u,f,d,m,g=0,p=0,w=0,b=0,y=0,_=0,v=0,x=0,k=0,A=0,M=null;const E=new Uint16Array(li+1),S=new Uint16Array(li+1);let R,I,D,C=null;for(g=0;g<=li;g++)E[g]=0;for(p=0;p<i;p++)E[e[r+p]]++;for(y=h,b=li;b>=1;b--)if(0!==E[b])break;if(y>b&&(y=b),0===b)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(w=1;w<b;w++)if(0!==E[w])break;for(y<w&&(y=w),x=1,g=1;g<=li;g++)if(x<<=1,x-=E[g],x<0)return-1;if(x>0&&(t===fi||1!==b))return-1;for(S[1]=0,g=1;g<li;g++)S[g+1]=S[g]+E[g];for(p=0;p<i;p++)0!==e[r+p]&&(a[S[e[r+p]]++]=p);if(t===fi?(M=C=a,m=20):t===di?(M=gi,C=pi,m=257):(M=wi,C=bi,m=0),A=0,p=0,g=w,d=s,_=y,v=0,u=-1,k=1<<y,f=k-1,t===di&&k>ci||t===mi&&k>ui)return 1;for(;;){R=g-v,a[p]+1<m?(I=0,D=a[p]):a[p]>=m?(I=C[a[p]-m],D=M[a[p]-m]):(I=96,D=0),l=1<<g-v,c=1<<_,w=c;do{c-=l,n[d+(A>>v)+c]=R<<24|I<<16|D}while(0!==c);l=1<<g-1;while(A&l)l>>=1;if(0!==l?(A&=l-1,A+=l):A=0,p++,0===--E[g]){if(g===b)break;g=e[r+a[p]]}if(g>y&&(A&f)!==u){0===v&&(v=y),d+=w,_=g-v,x=1<<_;while(_+v<b){if(x-=E[_+v],x<=0)break;_++,x<<=1}if(k+=1<<_,t===di&&k>ci||t===mi&&k>ui)return 1;u=A&f,n[u]=y<<24|_<<16|d-s}}return 0!==A&&(n[d+A]=g-v<<24|64<<16),o.bits=y,0};var _i=yi;const vi=0,xi=1,ki=2,{Z_FINISH:Ai,Z_BLOCK:Mi,Z_TREES:Ei,Z_OK:Si,Z_STREAM_END:Ri,Z_NEED_DICT:Ii,Z_STREAM_ERROR:Di,Z_DATA_ERROR:Ci,Z_MEM_ERROR:Bi,Z_BUF_ERROR:Ti,Z_DEFLATED:Ui}=Xt,Pi=16180,Fi=16181,zi=16182,Li=16183,Oi=16184,Ni=16185,Yi=16186,Vi=16187,Xi=16188,ji=16189,Hi=16190,Gi=16191,qi=16192,$i=16193,Zi=16194,Wi=16195,Qi=16196,Ki=16197,Ji=16198,tn=16199,en=16200,rn=16201,nn=16202,sn=16203,an=16204,on=16205,hn=16206,ln=16207,cn=16208,un=16209,fn=16210,dn=16211,mn=852,gn=592,pn=15,wn=pn,bn=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function yn(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _n=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Pi||e.mode>dn?1:0},vn=t=>{if(_n(t))return Di;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Pi,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(mn),e.distcode=e.distdyn=new Int32Array(gn),e.sane=1,e.back=-1,Si},xn=t=>{if(_n(t))return Di;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,vn(t)},kn=(t,e)=>{let r;if(_n(t))return Di;const i=t.state;return e<0?(r=0,e=-e):(r=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Di:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,xn(t))},An=(t,e)=>{if(!t)return Di;const r=new yn;t.state=r,r.strm=t,r.window=null,r.mode=Pi;const i=kn(t,e);return i!==Si&&(t.state=null),i},Mn=t=>An(t,wn);let En,Sn,Rn=!0;const In=t=>{if(Rn){En=new Int32Array(512),Sn=new Int32Array(32);let e=0;while(e<144)t.lens[e++]=8;while(e<256)t.lens[e++]=9;while(e<280)t.lens[e++]=7;while(e<288)t.lens[e++]=8;_i(xi,t.lens,0,288,En,0,t.work,{bits:9}),e=0;while(e<32)t.lens[e++]=5;_i(ki,t.lens,0,32,Sn,0,t.work,{bits:5}),Rn=!1}t.lencode=En,t.lenbits=9,t.distcode=Sn,t.distbits=5},Dn=(t,e,r,i)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(r-i,r-i+n),s.wnext),i-=n,i?(s.window.set(e.subarray(r-i,r),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},Cn=(t,e)=>{let r,i,n,s,a,o,h,l,c,u,f,d,m,g,p,w,b,y,_,v,x,k,A=0;const M=new Uint8Array(4);let E,S;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_n(t)||!t.output||!t.input&&0!==t.avail_in)return Di;r=t.state,r.mode===Gi&&(r.mode=qi),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=r.hold,c=r.bits,u=o,f=h,k=Si;t:for(;;)switch(r.mode){case Pi:if(0===r.wrap){r.mode=qi;break}while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(2&r.wrap&&35615===l){0===r.wbits&&(r.wbits=15),r.check=0,M[0]=255&l,M[1]=l>>>8&255,r.check=Yt(r.check,M,2,0),l=0,c=0,r.mode=Fi;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=un;break}if((15&l)!==Ui){t.msg="unknown compression method",r.mode=un;break}if(l>>>=4,c-=4,x=8+(15&l),0===r.wbits&&(r.wbits=x),x>15||x>r.wbits){t.msg="invalid window size",r.mode=un;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=512&l?ji:Gi,l=0,c=0;break;case Fi:while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(r.flags=l,(255&r.flags)!==Ui){t.msg="unknown compression method",r.mode=un;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=un;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,r.check=Yt(r.check,M,2,0)),l=0,c=0,r.mode=zi;case zi:while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.head&&(r.head.time=l),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,M[2]=l>>>16&255,M[3]=l>>>24&255,r.check=Yt(r.check,M,4,0)),l=0,c=0,r.mode=Li;case Li:while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,r.check=Yt(r.check,M,2,0)),l=0,c=0,r.mode=Oi;case Oi:if(1024&r.flags){while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,r.check=Yt(r.check,M,2,0)),l=0,c=0}else r.head&&(r.head.extra=null);r.mode=Ni;case Ni:if(1024&r.flags&&(d=r.length,d>o&&(d=o),d&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(i.subarray(s,s+d),x)),512&r.flags&&4&r.wrap&&(r.check=Yt(r.check,i,d,s)),o-=d,s+=d,r.length-=d),r.length))break t;r.length=0,r.mode=Yi;case Yi:if(2048&r.flags){if(0===o)break t;d=0;do{x=i[s+d++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&d<o);if(512&r.flags&&4&r.wrap&&(r.check=Yt(r.check,i,d,s)),o-=d,s+=d,x)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=Vi;case Vi:if(4096&r.flags){if(0===o)break t;d=0;do{x=i[s+d++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&d<o);if(512&r.flags&&4&r.wrap&&(r.check=Yt(r.check,i,d,s)),o-=d,s+=d,x)break t}else r.head&&(r.head.comment=null);r.mode=Xi;case Xi:if(512&r.flags){while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(4&r.wrap&&l!==(65535&r.check)){t.msg="header crc mismatch",r.mode=un;break}l=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Gi;break;case ji:while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}t.adler=r.check=bn(l),l=0,c=0,r.mode=Hi;case Hi:if(0===r.havedict)return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=l,r.bits=c,Ii;t.adler=r.check=1,r.mode=Gi;case Gi:if(e===Mi||e===Ei)break t;case qi:if(r.last){l>>>=7&c,c-=7&c,r.mode=hn;break}while(c<3){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}switch(r.last=1&l,l>>>=1,c-=1,3&l){case 0:r.mode=$i;break;case 1:if(In(r),r.mode=tn,e===Ei){l>>>=2,c-=2;break t}break;case 2:r.mode=Qi;break;case 3:t.msg="invalid block type",r.mode=un}l>>>=2,c-=2;break;case $i:l>>>=7&c,c-=7&c;while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if((65535&l)!==(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=un;break}if(r.length=65535&l,l=0,c=0,r.mode=Zi,e===Ei)break t;case Zi:r.mode=Wi;case Wi:if(d=r.length,d){if(d>o&&(d=o),d>h&&(d=h),0===d)break t;n.set(i.subarray(s,s+d),a),o-=d,s+=d,h-=d,a+=d,r.length-=d;break}r.mode=Gi;break;case Qi:while(c<14){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(r.nlen=257+(31&l),l>>>=5,c-=5,r.ndist=1+(31&l),l>>>=5,c-=5,r.ncode=4+(15&l),l>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=un;break}r.have=0,r.mode=Ki;case Ki:while(r.have<r.ncode){while(c<3){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.lens[R[r.have++]]=7&l,l>>>=3,c-=3}while(r.have<19)r.lens[R[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},k=_i(vi,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,k){t.msg="invalid code lengths set",r.mode=un;break}r.have=0,r.mode=Ji;case Ji:while(r.have<r.nlen+r.ndist){for(;;){if(A=r.lencode[l&(1<<r.lenbits)-1],p=A>>>24,w=A>>>16&255,b=65535&A,p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(b<16)l>>>=p,c-=p,r.lens[r.have++]=b;else{if(16===b){S=p+2;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(l>>>=p,c-=p,0===r.have){t.msg="invalid bit length repeat",r.mode=un;break}x=r.lens[r.have-1],d=3+(3&l),l>>>=2,c-=2}else if(17===b){S=p+3;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=p,c-=p,x=0,d=3+(7&l),l>>>=3,c-=3}else{S=p+7;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=p,c-=p,x=0,d=11+(127&l),l>>>=7,c-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=un;break}while(d--)r.lens[r.have++]=x}}if(r.mode===un)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=un;break}if(r.lenbits=9,E={bits:r.lenbits},k=_i(xi,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,k){t.msg="invalid literal/lengths set",r.mode=un;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},k=_i(ki,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,k){t.msg="invalid distances set",r.mode=un;break}if(r.mode=tn,e===Ei)break t;case tn:r.mode=en;case en:if(o>=6&&h>=258){t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=l,r.bits=c,hi(t,f),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=r.hold,c=r.bits,r.mode===Gi&&(r.back=-1);break}for(r.back=0;;){if(A=r.lencode[l&(1<<r.lenbits)-1],p=A>>>24,w=A>>>16&255,b=65535&A,p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(w&&0===(240&w)){for(y=p,_=w,v=b;;){if(A=r.lencode[v+((l&(1<<y+_)-1)>>y)],p=A>>>24,w=A>>>16&255,b=65535&A,y+p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=y,c-=y,r.back+=y}if(l>>>=p,c-=p,r.back+=p,r.length=b,0===w){r.mode=on;break}if(32&w){r.back=-1,r.mode=Gi;break}if(64&w){t.msg="invalid literal/length code",r.mode=un;break}r.extra=15&w,r.mode=rn;case rn:if(r.extra){S=r.extra;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=nn;case nn:for(;;){if(A=r.distcode[l&(1<<r.distbits)-1],p=A>>>24,w=A>>>16&255,b=65535&A,p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(0===(240&w)){for(y=p,_=w,v=b;;){if(A=r.distcode[v+((l&(1<<y+_)-1)>>y)],p=A>>>24,w=A>>>16&255,b=65535&A,y+p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=y,c-=y,r.back+=y}if(l>>>=p,c-=p,r.back+=p,64&w){t.msg="invalid distance code",r.mode=un;break}r.offset=b,r.extra=15&w,r.mode=sn;case sn:if(r.extra){S=r.extra;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=un;break}r.mode=an;case an:if(0===h)break t;if(d=f-h,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=un;break}d>r.wnext?(d-=r.wnext,m=r.wsize-d):m=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=n,m=a-r.offset,d=r.length;d>h&&(d=h),h-=d,r.length-=d;do{n[a++]=g[m++]}while(--d);0===r.length&&(r.mode=en);break;case on:if(0===h)break t;n[a++]=r.length,h--,r.mode=en;break;case hn:if(r.wrap){while(c<32){if(0===o)break t;o--,l|=i[s++]<<c,c+=8}if(f-=h,t.total_out+=f,r.total+=f,4&r.wrap&&f&&(t.adler=r.check=r.flags?Yt(r.check,n,f,a-f):zt(r.check,n,f,a-f)),f=h,4&r.wrap&&(r.flags?l:bn(l))!==r.check){t.msg="incorrect data check",r.mode=un;break}l=0,c=0}r.mode=ln;case ln:if(r.wrap&&r.flags){while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(4&r.wrap&&l!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=un;break}l=0,c=0}r.mode=cn;case cn:k=Ri;break t;case un:k=Ci;break t;case fn:return Bi;case dn:default:return Di}return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=l,r.bits=c,(r.wsize||f!==t.avail_out&&r.mode<un&&(r.mode<hn||e!==Ai))&&Dn(t,t.output,t.next_out,f-t.avail_out),u-=t.avail_in,f-=t.avail_out,t.total_in+=u,t.total_out+=f,r.total+=f,4&r.wrap&&f&&(t.adler=r.check=r.flags?Yt(r.check,n,f,t.next_out-f):zt(r.check,n,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Gi?128:0)+(r.mode===tn||r.mode===Zi?256:0),(0===u&&0===f||e===Ai)&&k===Si&&(k=Ti),k},Bn=t=>{if(_n(t))return Di;let e=t.state;return e.window&&(e.window=null),t.state=null,Si},Tn=(t,e)=>{if(_n(t))return Di;const r=t.state;return 0===(2&r.wrap)?Di:(r.head=e,e.done=!1,Si)},Un=(t,e)=>{const r=e.length;let i,n,s;return _n(t)?Di:(i=t.state,0!==i.wrap&&i.mode!==Hi?Di:i.mode===Hi&&(n=1,n=zt(n,e,r,0),n!==i.check)?Ci:(s=Dn(t,e,r,r),s?(i.mode=fn,Bi):(i.havedict=1,Si)))};var Pn=xn,Fn=kn,zn=vn,Ln=Mn,On=An,Nn=Cn,Yn=Bn,Vn=Tn,Xn=Un,jn="pako inflate (from Nodeca project)",Hn={inflateReset:Pn,inflateReset2:Fn,inflateResetKeep:zn,inflateInit:Ln,inflateInit2:On,inflate:Nn,inflateEnd:Yn,inflateGetHeader:Vn,inflateSetDictionary:Xn,inflateInfo:jn};function Gn(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var qn=Gn;const $n=Object.prototype.toString,{Z_NO_FLUSH:Zn,Z_FINISH:Wn,Z_OK:Qn,Z_STREAM_END:Kn,Z_NEED_DICT:Jn,Z_STREAM_ERROR:ts,Z_DATA_ERROR:es,Z_MEM_ERROR:rs}=Xt;function is(t){this.options=Dr.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Or,this.strm.avail_out=0;let r=Hn.inflateInit2(this.strm,e.windowBits);if(r!==Qn)throw new Error(Vt[r]);if(this.header=new qn,Hn.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"===typeof e.dictionary?e.dictionary=zr.string2buf(e.dictionary):"[object ArrayBuffer]"===$n.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Hn.inflateSetDictionary(this.strm,e.dictionary),r!==Qn)))throw new Error(Vt[r])}function ns(t,e){const r=new is(e);if(r.push(t),r.err)throw r.msg||Vt[r.err];return r.result}function ss(t,e){return e=e||{},e.raw=!0,ns(t,e)}is.prototype.push=function(t,e){const r=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(a=e===~~e?e:!0===e?Wn:Zn,"[object ArrayBuffer]"===$n.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),s=Hn.inflate(r,a),s===Jn&&n&&(s=Hn.inflateSetDictionary(r,n),s===Qn?s=Hn.inflate(r,a):s===es&&(s=Jn));while(r.avail_in>0&&s===Kn&&r.state.wrap>0&&0!==t[r.next_in])Hn.inflateReset(r),s=Hn.inflate(r,a);switch(s){case ts:case es:case Jn:case rs:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(0===r.avail_out||s===Kn))if("string"===this.options.to){let t=zr.utf8border(r.output,r.next_out),e=r.next_out-t,n=zr.buf2string(r.output,t);r.next_out=e,r.avail_out=i-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==Qn||0!==o){if(s===Kn)return s=Hn.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},is.prototype.onData=function(t){this.chunks.push(t)},is.prototype.onEnd=function(t){t===Qn&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Dr.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var as=is,os=ns,hs=ss,ls=ns,cs=Xt,us={Inflate:as,inflate:os,inflateRaw:hs,ungzip:ls,constants:cs};const{Deflate:fs,deflate:ds,deflateRaw:ms,gzip:gs}=si,{Inflate:ps,inflate:ws,inflateRaw:bs,ungzip:ys}=us;var _s=ds,vs=ps,xs=ws;const ks=[137,80,78,71,13,10,26,10],As=[];for(let a_=0;a_<256;a_++){let t=a_;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;As[a_]=t}const Ms=4294967295;function Es(t,e,r){let i=t;for(let n=0;n<r;n++)i=As[255&(i^e[n])]^i>>>8;return i}function Ss(t,e){return(Es(Ms,t,e)^Ms)>>>0}var Rs,Is,Ds,Cs;(function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["GREYSCALE"]=0]="GREYSCALE",t[t["TRUECOLOUR"]=2]="TRUECOLOUR",t[t["INDEXED_COLOUR"]=3]="INDEXED_COLOUR",t[t["GREYSCALE_ALPHA"]=4]="GREYSCALE_ALPHA",t[t["TRUECOLOUR_ALPHA"]=6]="TRUECOLOUR_ALPHA"})(Rs||(Rs={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["DEFLATE"]=0]="DEFLATE"}(Is||(Is={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["ADAPTIVE"]=0]="ADAPTIVE"}(Ds||(Ds={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["NO_INTERLACE"]=0]="NO_INTERLACE",t[t["ADAM7"]=1]="ADAM7"}(Cs||(Cs={}));const Bs=new Uint8Array(0),Ts="\0",Us=new Uint16Array([255]),Ps=new Uint8Array(Us.buffer),Fs=255===Ps[0];class zs extends b.IOBuffer{constructor(t,e={}){super(t);const{checkCrc:r=!1}=e;this._checkCrc=r,this._inflator=new vs,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Is.UNKNOWN,this._filterMethod=Ds.UNKNOWN,this._interlaceMethod=Cs.UNKNOWN,this._colorType=Rs.UNKNOWN,this.setBigEndian()}decode(){this.decodeSignature();while(!this._end)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<ks.length;t++)if(this.readUint8()!==ks[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${ks[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),r=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-r!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const r=this.readUint32(),i=t+4,n=Ss(new Uint8Array(this.buffer,this.byteOffset+this.offset-i-4,i),i);if(n!==r)throw new Error(`CRC mismatch for chunk ${e}. Expected ${r}, found ${n}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=Hs(this.readUint8());const e=this.readUint8();let r;switch(this._colorType=e,e){case Rs.GREYSCALE:r=1;break;case Rs.TRUECOLOUR:r=3;break;case Rs.INDEXED_COLOUR:r=1;break;case Rs.GREYSCALE_ALPHA:r=2;break;case Rs.TRUECOLOUR_ALPHA:r=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==Is.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const r=[];this._palette=r;for(let i=0;i<e;i++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case Rs.GREYSCALE:case Rs.TRUECOLOUR:if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case Rs.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,r="";while((e=this.readChar())!==Ts)r+=e;const i=this.readUint8();if(i!==Is.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const n=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:xs(n)}}decodetEXt(t){let e,r="";while((e=this.readChar())!==Ts)r+=e;this._png.text[r]=this.readChars(t-r.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),r=this.readByte();this._png.resolution={x:t,y:e,unit:r}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==Ds.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==Cs.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,r=this._png.channels*this._png.depth/8,i=this._png.width*r,n=new Uint8Array(this._png.height*i);let s,a,o=Bs,h=0;for(let l=0;l<e;l++){switch(s=t.subarray(h+1,h+1+i),a=n.subarray(l*i,(l+1)*i),t[h]){case 0:Ls(s,a,i);break;case 1:Os(s,a,i,r);break;case 2:Ns(s,a,o,i);break;case 3:Ys(s,a,o,i,r);break;case 4:Vs(s,a,o,i,r);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}o=a,h+=i+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(n.buffer);if(Fs)for(let e=0;e<t.length;e++)t[e]=js(t[e]);this._png.data=t}else this._png.data=n}}function Ls(t,e,r){for(let i=0;i<r;i++)e[i]=t[i]}function Os(t,e,r,i){let n=0;for(;n<i;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-i]&255}function Ns(t,e,r,i){let n=0;if(0===r.length)for(;n<i;n++)e[n]=t[n];else for(;n<i;n++)e[n]=t[n]+r[n]&255}function Ys(t,e,r,i,n){let s=0;if(0===r.length){for(;s<n;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<i;s++)e[s]=t[s]+(e[s-n]+r[s]>>1)&255}}function Vs(t,e,r,i,n){let s=0;if(0===r.length){for(;s<n;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+r[s]&255;for(;s<i;s++)e[s]=t[s]+Xs(e[s-n],r[s],r[s-n])&255}}function Xs(t,e,r){const i=t+e-r,n=Math.abs(i-t),s=Math.abs(i-e),a=Math.abs(i-r);return n<=s&&n<=a?t:s<=a?e:r}function js(t){return(255&t)<<8|t>>8&255}function Hs(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}const Gs={level:3};class qs extends b.IOBuffer{constructor(t,e={}){super(),this._colorType=Rs.UNKNOWN,this._zlibOptions={...Gs,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(ks)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(Is.DEFLATE),this.writeByte(Ds.ADAPTIVE),this.writeByte(Cs.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:r,depth:i,data:n}=this._png,s=r*t,a=(new b.IOBuffer).setBigEndian();let o=0;for(let c=0;c<e;c++)if(a.writeByte(0),8===i)o=Ws(n,a,s,o);else{if(16!==i)throw new Error("unreachable");o=Qs(n,a,s,o)}const h=a.toArray(),l=_s(h,this._zlibOptions);this.encodeIDAT(l)}_checkData(t){const{colorType:e,channels:r,depth:i}=Zs(t),n={width:$s(t.width,"width"),height:$s(t.height,"height"),channels:r,data:t.data,depth:i,text:{}};this._colorType=e;const s=n.width*n.height*r;if(n.data.length!==s)throw new RangeError(`wrong data size. Found ${n.data.length}, expected ${s}`);return n}writeCrc(t){this.writeUint32(Ss(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function $s(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function Zs(t){const{channels:e=4,depth:r=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==r&&16!==r)throw new RangeError(`unsupported bit depth: ${r}`);const i={channels:e,depth:r,colorType:Rs.UNKNOWN};switch(e){case 4:i.colorType=Rs.TRUECOLOUR_ALPHA;break;case 3:i.colorType=Rs.TRUECOLOUR;break;case 1:i.colorType=Rs.GREYSCALE;break;case 2:i.colorType=Rs.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return i}function Ws(t,e,r,i){for(let n=0;n<r;n++)e.writeByte(t[i++]);return i}function Qs(t,e,r,i){for(let n=0;n<r;n++)e.writeUint16(t[i++]);return i}var Ks;function Js(t,e){const r=new zs(t,e);return r.decode()}function ta(t,e){const r=new qs(t,e);return r.encode()}(function(t){t[t["UNKNOWN"]=0]="UNKNOWN",t[t["METRE"]=1]="METRE"})(Ks||(Ks={}));var ea=r(6696);let ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ia=new Uint8Array(256);for(let a_=0;a_<ra.length;a_++)ia[ra.charCodeAt(a_)]=a_;function na(t){let e,r=t.length,i="";for(e=0;e<r;e+=3)i+=ra[t[e]>>2],i+=ra[(3&t[e])<<4|t[e+1]>>4],i+=ra[(15&t[e+1])<<2|t[e+2]>>6],i+=ra[63&t[e+2]];return r%3===2?i=`${i.substring(0,i.length-1)}=`:r%3===1&&(i=`${i.substring(0,i.length-2)}==`),i}function sa(t){let e,r,i,n,s=.75*t.length,a=t.length,o=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const h=new Uint8Array(s);for(let l=0;l<a;l+=4)e=ia[t.charCodeAt(l)],r=ia[t.charCodeAt(l+1)],i=ia[t.charCodeAt(l+2)],n=ia[t.charCodeAt(l+3)],h[o++]=e<<2|r>>4,h[o++]=(15&r)<<4|i>>2,h[o++]=(3&i)<<6|63&n;return h}function aa(t,e){const r=na(t);return`data:${e};base64,${r}`}r(13611);const oa=self.ImageData,ha=self.Image;function la(t,e){let r=self.document.createElement("canvas");return r.width=t,r.height=e,r}function ca(t,{withCredentials:e=!1}={}){return new Promise((function(r,i){let n=new self.XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.withCredentials=e,n.onload=function(t){200!==this.status?i(t):r(this.response)},n.onerror=i,n.send()}))}function ua(){throw new Error("createWriteStream does not exist in the browser")}function fa(){throw new Error("writeFile does not exist in the browser")}function da(t){return t.includes("/")||(t=`image/${t}`),t}function ma(t,e={}){const r={width:t.width,height:t.height,data:t.getRGBAData()};return(0,ea.encode)(r,e.quality).data}function ga(t,e){const r={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==r.depth&&32!==r.depth||(r.depth=8,r.channels=4,r.data=t.getRGBAData()),ta(r,e)}const pa={save(t,e={}){const{useCanvas:r=!1,encoder:i}=e;let{format:n}=e;if(!n){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(n=e.groups.format.toLowerCase())}if(!n)throw new Error("file format not provided");return new Promise(((e,s)=>{let a,o;switch(n.toLowerCase()){case"png":r?a=this.getCanvas().pngStream():o=ga(this,i);break;case"jpg":case"jpeg":r?a=this.getCanvas().jpegStream():o=ma(this,i);break;case"bmp":o=(0,w.l)(this,i);break;default:throw new RangeError(`invalid output format: ${n}`)}if(a){let r=ua(t);r.on("finish",e),r.on("error",s),a.pipe(r)}else o&&fa(t,o,(t=>{t?s(t):e()}))}))},toDataURL(t="image/png",e={}){"object"===typeof t&&(e=t,t="image/png");const{useCanvas:r=!1,encoder:i}=e;function n(e,r){const n=e(r,i);return aa(n,t)}return t=da(t),"image/bmp"===t?n(w.l,this):"image/png"!==t||r?"image/jpeg"!==t||r?this.getCanvas().toDataURL(t):n(ma,this):n(ga,this)},toBuffer(t={}){const{format:e="png",encoder:r}=t;switch(e.toLowerCase()){case"png":return ga(this,r);case"jpeg":case"jpg":return ma(this,r);case"bmp":return(0,w.l)(this,r);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(t="image/png",e={}){if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const r=this.toDataURL(t,e);return r.substring(r.indexOf(",")+1)}},toBlob(t="image/png",e=.8){return g(this.getCanvas(),t,e)},getCanvas(){const t=new oa(this.getRGBAData({clamped:!0}),this.width,this.height);let e=la(this.width,this.height),r=e.getContext("2d");return r.putImageData(t,0,0),e}};function wa(t){for(const e in pa)t.prototype[e]=pa[e]}var ba=r(82287),ya=r.n(ba);let _a={configurable:!0,enumerable:!1,get:void 0};function va(t,e,r={}){let{inPlace:i=!1,returnThis:n=!0,partialArgs:s=[]}=r;return Hy.prototype[t]=i?function(...t){this.computed=null;let r=e.apply(this,[...s,...t]);return n?this:r}:function(...t){return e.apply(this,[...s,...t])},Hy}function xa(t,e,r={}){let{partialArgs:i=[]}=r;return _a.get=function(){if(null===this.computed)this.computed={};else if(ya()(t,this.computed))return this.computed[t];let r=e.apply(this,i);return this.computed[t]=r,r},Object.defineProperty(Hy.prototype,t,_a),Hy}const ka="GREY",Aa="RGB",Ma="HSL",Ea="HSV",Sa="CMYK";function Ra(t={}){const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const r=this.width*this.height*4;let i=e?new Uint8ClampedArray(r):new Uint8Array(r);return 1===this.bitDepth?Ia(this,i):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?Da(this,i):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[Aa]}),Ca(this,i))):1===this.components?Ba(this,i):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[Aa]}),Ta(this,i)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),Ua(this,i)):Pa(this,i),i}function Ia(t,e){for(let r=0;r<t.size;r++){const i=t.getBit(r);e[4*r]=255*i,e[4*r+1]=255*i,e[4*r+2]=255*i}}function Da(t,e){const r=t.min[0],i=t.max[0],n=i-r;for(let s=0;s<t.size;s++){const i=Math.floor(255*(t.data[s]-r)/n);e[4*s]=i,e[4*s+1]=i,e[4*s+2]=i}}function Ca(t,e){const r=Math.min(...t.min),i=Math.max(...t.max),n=i-r;for(let s=0;s<t.size;s++){const i=Math.floor(255*(t.data[3*s]-r)/n),a=Math.floor(255*(t.data[3*s+1]-r)/n),o=Math.floor(255*(t.data[3*s+2]-r)/n);e[4*s]=i,e[4*s+1]=a,e[4*s+2]=o}}function Ba(t,e){for(let r=0;r<t.size;r++)e[4*r]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+1]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+2]=t.data[r*t.channels]>>>t.bitDepth-8}function Ta(t,e){for(let r=0;r<t.size;r++)e[4*r]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+1]=t.data[r*t.channels+1]>>>t.bitDepth-8,e[4*r+2]=t.data[r*t.channels+2]>>>t.bitDepth-8}function Ua(t,e){for(let r=0;r<t.size;r++)e[4*r+3]=t.data[r*t.channels+t.components]>>t.bitDepth-8}function Pa(t,e){for(let r=0;r<t.size;r++)e[4*r+3]=255}const Fa="BINARY",za="GREY",La="GREYA",Oa="RGB",Na="RGBA",Ya="CMYK",Va="CMYKA",Xa={};function ja(t){const e=Xa[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}Xa[Fa]={components:1,alpha:0,bitDepth:1,colorModel:ka},Xa[La]={components:1,alpha:1,bitDepth:8,colorModel:ka},Xa[za]={components:1,alpha:0,bitDepth:8,colorModel:ka},Xa[Na]={components:3,alpha:1,bitDepth:8,colorModel:Aa},Xa[Oa]={components:3,alpha:0,bitDepth:8,colorModel:Aa},Xa[Ya]={components:4,alpha:0,bitDepth:8,colorModel:Sa},Xa[Va]={components:4,alpha:1,bitDepth:8,colorModel:Sa};const Ha=[1,8,16,32];function Ga(t){const{components:e,alpha:r,bitDepth:n,colorModel:s}=t;if(!Number.isInteger(e)||e<=0)throw new RangeError(`invalid components: ${e}. Must be a positive integer`);if(0!==r&&1!==r&&"boolean"!==typeof r)throw new TypeError(`invalid alpha: ${r}: must be a boolean, 0 or 1`);if(!Ha.includes(n))throw new RangeError(`invalid bitDepth: ${n}. Must be one of ${Ha.join(", ")}`);if(!i[s])throw new RangeError(`invalid colorModel: ${s}. Must be one of ${Object.keys(i).join(", ")}`)}function qa(t,e,r){let i=e*t;return 1===r&&(i=Math.ceil(i/8)),i}function $a(t,e,r,i,n,s){const a=i*t;let o;switch(n){case 1:o=new Uint8Array(Math.ceil(a/8));break;case 8:o=new Uint8Array(a);break;case 16:o=new Uint16Array(a);break;case 32:o=new Float32Array(a);break;default:throw new Error(`Cannot create pixel array for bit depth ${n}`)}if(r)for(let h=e;h<o.length;h+=i)o[h]=s;return o}var Za=r(40536),Wa=r(59070),Qa=r.n(Wa);function Ka(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}function Ja(t,e,r){let i=0;while(i<t.length){for(let n=r;n<e*r;n+=r)for(let e=0;e<r;e++)t[i+n+e]=t[i+n+e]+t[i+n-(r-e)]&255;i+=e*r}}function to(t,e,r){let i=0;while(i<t.length){for(let n=r;n<e*r;n+=r)for(let e=0;e<r;e++)t[i+n+e]=t[i+n+e]+t[i+n-(r-e)]&65535;i+=e*r}}const eo={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},ro={};for(let a_ in eo)ro[eo[a_]]=Number(a_);const io={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},no={};for(let a_ in io)no[io[a_]]=Number(a_);const so={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},ao={};for(let a_ in so)ao[so[a_]]=Number(a_);const oo={standard:a,exif:n,gps:s};class ho{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"===typeof t)return this.fields.get(t);if("string"===typeof t)return this.fields.get(oo[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=oo[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let lo=new Map([[1,[1,fo]],[2,[1,mo]],[3,[2,go]],[4,[4,po]],[5,[8,wo]],[6,[1,bo]],[7,[1,fo]],[8,[2,yo]],[9,[4,_o]],[10,[8,vo]],[11,[4,xo]],[12,[8,ko]]]);function co(t,e){const r=lo.get(t);if(!r)throw new Error(`type not found: ${t}`);return r[0]*e}function uo(t,e,r){const i=lo.get(e);if(!i)throw new Error(`type not found: ${e}`);return i[1](t,r)}function fo(t,e){if(1===e)return t.readUint8();let r=new Uint8Array(e);for(let i=0;i<e;i++)r[i]=t.readUint8();return r}function mo(t,e){let r=[],i="";for(let n=0;n<e;n++){let e=String.fromCharCode(t.readUint8());"\0"===e?(r.push(i),i=""):i+=e}return 1===r.length?r[0]:r}function go(t,e){if(1===e)return t.readUint16();let r=new Uint16Array(e);for(let i=0;i<e;i++)r[i]=t.readUint16();return r}function po(t,e){if(1===e)return t.readUint32();let r=new Uint32Array(e);for(let i=0;i<e;i++)r[i]=t.readUint32();return r}function wo(t,e){if(1===e)return t.readUint32()/t.readUint32();let r=new Array(e);for(let i=0;i<e;i++)r[i]=t.readUint32()/t.readUint32();return r}function bo(t,e){if(1===e)return t.readInt8();let r=new Int8Array(e);for(let i=0;i<e;i++)r[i]=t.readInt8();return r}function yo(t,e){if(1===e)return t.readInt16();let r=new Int16Array(e);for(let i=0;i<e;i++)r[i]=t.readInt16();return r}function _o(t,e){if(1===e)return t.readInt32();let r=new Int32Array(e);for(let i=0;i<e;i++)r[i]=t.readInt32();return r}function vo(t,e){if(1===e)return t.readInt32()/t.readInt32();let r=new Array(e);for(let i=0;i<e;i++)r[i]=t.readInt32()/t.readInt32();return r}function xo(t,e){if(1===e)return t.readFloat32();let r=new Float32Array(e);for(let i=0;i<e;i++)r[i]=t.readFloat32();return r}function ko(t,e){if(1===e)return t.readFloat64();let r=new Float64Array(e);for(let i=0;i<e;i++)r[i]=t.readFloat64();return r}const Ao=256,Mo=257,Eo=258,So=9;let Ro=[];function Io(){if(0===Ro.length){for(let e=0;e<256;e++)Ro.push([e]);const t=[];for(let e=256;e<4096;e++)Ro.push(t)}}const Do=[511,1023,2047,4095],Co=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class Bo{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=Eo,this.currentBitLength=So,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new b.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;while((t=this.getNextCode())!==Mo)if(t===Ao){if(this.initializeTable(),t=this.getNextCode(),t===Mo)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const r=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(r),this.addStringToTable(r),e=t}const r=this.outData.toArray();return new DataView(r.buffer,r.byteOffset,r.byteLength)}initializeTable(){Io(),this.tableLength=Eo,this.currentBitLength=So}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return Ro[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(Ro[this.tableLength++]=t,Ro.length>4096)throw Ro=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===Co[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&Do[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function To(t){return new Bo(t).decode()}const Uo=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class Po extends ho{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=Uo.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!==typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return Fo(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return Fo(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return Fo(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const r=[];for(let i=0;i<t;i++)r.push([e[i],e[i+t],e[i+2*t]]);return r}}function Fo(t){return"number"===typeof t?[t]:t}
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
const zo=4,Lo=0,Oo=1,No=2;function Yo(t){let e=t.length;while(--e>=0)t[e]=0}const Vo=0,Xo=1,jo=2,Ho=3,Go=258,qo=29,$o=256,Zo=$o+1+qo,Wo=30,Qo=19,Ko=2*Zo+1,Jo=15,th=16,eh=7,rh=256,ih=16,nh=17,sh=18,ah=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),oh=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),hh=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),lh=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ch=512,uh=new Array(2*(Zo+2));Yo(uh);const fh=new Array(2*Wo);Yo(fh);const dh=new Array(ch);Yo(dh);const mh=new Array(Go-Ho+1);Yo(mh);const gh=new Array(qo);Yo(gh);const ph=new Array(Wo);function wh(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let bh,yh,_h;function vh(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Yo(ph);const xh=t=>t<256?dh[t]:dh[256+(t>>>7)],kh=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Ah=(t,e,r)=>{t.bi_valid>th-r?(t.bi_buf|=e<<t.bi_valid&65535,kh(t,t.bi_buf),t.bi_buf=e>>th-t.bi_valid,t.bi_valid+=r-th):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},Mh=(t,e,r)=>{Ah(t,r[2*e],r[2*e+1])},Eh=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},Sh=t=>{16===t.bi_valid?(kh(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)},Rh=(t,e)=>{const r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,c,u,f,d,m,g=0;for(f=0;f<=Jo;f++)t.bl_count[f]=0;for(r[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<Ko;l++)c=t.heap[l],f=r[2*r[2*c+1]+1]+1,f>h&&(f=h,g++),r[2*c+1]=f,c>i||(t.bl_count[f]++,d=0,c>=o&&(d=a[c-o]),m=r[2*c],t.opt_len+=m*(f+d),s&&(t.static_len+=m*(n[2*c+1]+d)));if(0!==g){do{f=h-1;while(0===t.bl_count[f])f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[h]--,g-=2}while(g>0);for(f=h;0!==f;f--){c=t.bl_count[f];while(0!==c)u=t.heap[--l],u>i||(r[2*u+1]!==f&&(t.opt_len+=(f-r[2*u+1])*r[2*u],r[2*u+1]=f),c--)}}},Ih=(t,e,r)=>{const i=new Array(Jo+1);let n,s,a=0;for(n=1;n<=Jo;n++)a=a+r[n-1]<<1,i[n]=a;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=Eh(i[e]++,e))}},Dh=()=>{let t,e,r,i,n;const s=new Array(Jo+1);for(r=0,i=0;i<qo-1;i++)for(gh[i]=r,t=0;t<1<<ah[i];t++)mh[r++]=i;for(mh[r-1]=i,n=0,i=0;i<16;i++)for(ph[i]=n,t=0;t<1<<oh[i];t++)dh[n++]=i;for(n>>=7;i<Wo;i++)for(ph[i]=n<<7,t=0;t<1<<oh[i]-7;t++)dh[256+n++]=i;for(e=0;e<=Jo;e++)s[e]=0;t=0;while(t<=143)uh[2*t+1]=8,t++,s[8]++;while(t<=255)uh[2*t+1]=9,t++,s[9]++;while(t<=279)uh[2*t+1]=7,t++,s[7]++;while(t<=287)uh[2*t+1]=8,t++,s[8]++;for(Ih(uh,Zo+1,s),t=0;t<Wo;t++)fh[2*t+1]=5,fh[2*t]=Eh(t,5);bh=new wh(uh,ah,$o+1,Zo,Jo),yh=new wh(fh,oh,0,Wo,Jo),_h=new wh(new Array(0),hh,0,Qo,eh)},Ch=t=>{let e;for(e=0;e<Zo;e++)t.dyn_ltree[2*e]=0;for(e=0;e<Wo;e++)t.dyn_dtree[2*e]=0;for(e=0;e<Qo;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*rh]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Bh=t=>{t.bi_valid>8?kh(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Th=(t,e,r,i)=>{const n=2*e,s=2*r;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]},Uh=(t,e,r)=>{const i=t.heap[r];let n=r<<1;while(n<=t.heap_len){if(n<t.heap_len&&Th(e,t.heap[n+1],t.heap[n],t.depth)&&n++,Th(e,i,t.heap[n],t.depth))break;t.heap[r]=t.heap[n],r=n,n<<=1}t.heap[r]=i},Ph=(t,e,r)=>{let i,n,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,n=t.pending_buf[t.sym_buf+o++],0===i?Mh(t,n,e):(s=mh[n],Mh(t,s+$o+1,e),a=ah[s],0!==a&&(n-=gh[s],Ah(t,n,a)),i--,s=xh(i),Mh(t,s,r),a=oh[s],0!==a&&(i-=ph[s],Ah(t,i,a)))}while(o<t.sym_next);Mh(t,rh,e)},Fh=(t,e)=>{const r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let a,o,h,l=-1;for(t.heap_len=0,t.heap_max=Ko,a=0;a<s;a++)0!==r[2*a]?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):r[2*a+1]=0;while(t.heap_len<2)h=t.heap[++t.heap_len]=l<2?++l:0,r[2*h]=1,t.depth[h]=0,t.opt_len--,n&&(t.static_len-=i[2*h+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)Uh(t,r,a);h=s;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Uh(t,r,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,r[2*h]=r[2*a]+r[2*o],t.depth[h]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,r[2*a+1]=r[2*o+1]=h,t.heap[1]=h++,Uh(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],Rh(t,e),Ih(r,l,t.bl_count)},zh=(t,e,r)=>{let i,n,s=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=e[2*(i+1)+1],++o<h&&n===a||(o<l?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[2*ih]++):o<=10?t.bl_tree[2*nh]++:t.bl_tree[2*sh]++,o=0,s=n,0===a?(h=138,l=3):n===a?(h=6,l=3):(h=7,l=4))},Lh=(t,e,r)=>{let i,n,s=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),i=0;i<=r;i++)if(n=a,a=e[2*(i+1)+1],!(++o<h&&n===a)){if(o<l)do{Mh(t,n,t.bl_tree)}while(0!==--o);else 0!==n?(n!==s&&(Mh(t,n,t.bl_tree),o--),Mh(t,ih,t.bl_tree),Ah(t,o-3,2)):o<=10?(Mh(t,nh,t.bl_tree),Ah(t,o-3,3)):(Mh(t,sh,t.bl_tree),Ah(t,o-11,7));o=0,s=n,0===a?(h=138,l=3):n===a?(h=6,l=3):(h=7,l=4)}},Oh=t=>{let e;for(zh(t,t.dyn_ltree,t.l_desc.max_code),zh(t,t.dyn_dtree,t.d_desc.max_code),Fh(t,t.bl_desc),e=Qo-1;e>=3;e--)if(0!==t.bl_tree[2*lh[e]+1])break;return t.opt_len+=3*(e+1)+5+5+4,e},Nh=(t,e,r,i)=>{let n;for(Ah(t,e-257,5),Ah(t,r-1,5),Ah(t,i-4,4),n=0;n<i;n++)Ah(t,t.bl_tree[2*lh[n]+1],3);Lh(t,t.dyn_ltree,e-1),Lh(t,t.dyn_dtree,r-1)},Yh=t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return Lo;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return Oo;for(e=32;e<$o;e++)if(0!==t.dyn_ltree[2*e])return Oo;return Lo};let Vh=!1;const Xh=t=>{Vh||(Dh(),Vh=!0),t.l_desc=new vh(t.dyn_ltree,bh),t.d_desc=new vh(t.dyn_dtree,yh),t.bl_desc=new vh(t.bl_tree,_h),t.bi_buf=0,t.bi_valid=0,Ch(t)},jh=(t,e,r,i)=>{Ah(t,(Vo<<1)+(i?1:0),3),Bh(t),kh(t,r),kh(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},Hh=t=>{Ah(t,Xo<<1,3),Mh(t,rh,uh),Sh(t)},Gh=(t,e,r,i)=>{let n,s,a=0;t.level>0?(t.strm.data_type===No&&(t.strm.data_type=Yh(t)),Fh(t,t.l_desc),Fh(t,t.d_desc),a=Oh(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==e?jh(t,e,r,i):t.strategy===zo||s===n?(Ah(t,(Xo<<1)+(i?1:0),3),Ph(t,uh,fh)):(Ah(t,(jo<<1)+(i?1:0),3),Nh(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),Ph(t,t.dyn_ltree,t.dyn_dtree)),Ch(t),i&&Bh(t)},qh=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(mh[r]+$o+1)]++,t.dyn_dtree[2*xh(e)]++),t.sym_next===t.sym_end);var $h=Xh,Zh=jh,Wh=Gh,Qh=qh,Kh=Hh,Jh={_tr_init:$h,_tr_stored_block:Zh,_tr_flush_block:Wh,_tr_tally:Qh,_tr_align:Kh};const tl=(t,e,r,i)=>{let n=65535&t,s=t>>>16&65535,a=0;while(0!==r){a=r>2e3?2e3:r,r-=a;do{n=n+e[i++]|0,s=s+n|0}while(--a);n%=65521,s%=65521}return n|s<<16};var el=tl;const rl=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e},il=new Uint32Array(rl()),nl=(t,e,r,i)=>{const n=il,s=i+r;t^=-1;for(let a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return~t};var sl=nl,al={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ol={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:hl,_tr_stored_block:ll,_tr_flush_block:cl,_tr_tally:ul,_tr_align:fl}=Jh,{Z_NO_FLUSH:dl,Z_PARTIAL_FLUSH:ml,Z_FULL_FLUSH:gl,Z_FINISH:pl,Z_BLOCK:wl,Z_OK:bl,Z_STREAM_END:yl,Z_STREAM_ERROR:_l,Z_DATA_ERROR:vl,Z_BUF_ERROR:xl,Z_DEFAULT_COMPRESSION:kl,Z_FILTERED:Al,Z_HUFFMAN_ONLY:Ml,Z_RLE:El,Z_FIXED:Sl,Z_DEFAULT_STRATEGY:Rl,Z_UNKNOWN:Il,Z_DEFLATED:Dl}=ol,Cl=9,Bl=15,Tl=8,Ul=29,Pl=256,Fl=Pl+1+Ul,zl=30,Ll=19,Ol=2*Fl+1,Nl=15,Yl=3,Vl=258,Xl=Vl+Yl+1,jl=32,Hl=42,Gl=57,ql=69,$l=73,Zl=91,Wl=103,Ql=113,Kl=666,Jl=1,tc=2,ec=3,rc=4,ic=3,nc=(t,e)=>(t.msg=al[e],e),sc=t=>2*t-(t>4?9:0),ac=t=>{let e=t.length;while(--e>=0)t[e]=0},oc=t=>{let e,r,i,n=t.w_size;e=t.hash_size,i=e;do{r=t.head[--i],t.head[i]=r>=n?r-n:0}while(--e);e=n,i=e;do{r=t.prev[--i],t.prev[i]=r>=n?r-n:0}while(--e)};let hc=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,lc=hc;const cc=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},uc=(t,e)=>{cl(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,cc(t.strm)},fc=(t,e)=>{t.pending_buf[t.pending++]=e},dc=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},mc=(t,e,r,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),r),1===t.state.wrap?t.adler=el(t.adler,e,n,r):2===t.state.wrap&&(t.adler=sl(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)},gc=(t,e)=>{let r,i,n=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match;const h=t.strstart>t.w_size-Xl?t.strstart-(t.w_size-Xl):0,l=t.window,c=t.w_mask,u=t.prev,f=t.strstart+Vl;let d=l[s+a-1],m=l[s+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(r=e,l[r+a]===m&&l[r+a-1]===d&&l[r]===l[s]&&l[++r]===l[s+1]){s+=2,r++;do{}while(l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&s<f);if(i=Vl-(f-s),s=f-Vl,i>a){if(t.match_start=e,a=i,i>=o)break;d=l[s+a-1],m=l[s+a]}}}while((e=u[e&c])>h&&0!==--n);return a<=t.lookahead?a:t.lookahead},pc=t=>{const e=t.w_size;let r,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Xl)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),oc(t),i+=e),0===t.strm.avail_in)break;if(r=mc(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=Yl){n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=lc(t,t.ins_h,t.window[n+1]);while(t.insert)if(t.ins_h=lc(t,t.ins_h,t.window[n+Yl-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,t.lookahead+t.insert<Yl)break}}while(t.lookahead<Xl&&0!==t.strm.avail_in)},wc=(t,e)=>{let r,i,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,a=0,o=t.strm.avail_in;do{if(r=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,i=t.strstart-t.block_start,r>i+t.strm.avail_in&&(r=i+t.strm.avail_in),r>n&&(r=n),r<s&&(0===r&&e!==pl||e===dl||r!==i+t.strm.avail_in))break;a=e===pl&&r===i+t.strm.avail_in?1:0,ll(t,0,0,a),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,cc(t.strm),i&&(i>r&&(i=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,r-=i),r&&(mc(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(0===a);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?rc:e!==dl&&e!==pl&&0===t.strm.avail_in&&t.strstart===t.block_start?tc:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(mc(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,i=t.strstart-t.block_start,(i>=s||(i||e===pl)&&e!==dl&&0===t.strm.avail_in&&i<=n)&&(r=i>n?n:i,a=e===pl&&0===t.strm.avail_in&&r===i?1:0,ll(t,t.block_start,r,a),t.block_start+=r,cc(t.strm)),a?ec:Jl)},bc=(t,e)=>{let r,i;for(;;){if(t.lookahead<Xl){if(pc(t),t.lookahead<Xl&&e===dl)return Jl;if(0===t.lookahead)break}if(r=0,t.lookahead>=Yl&&(t.ins_h=lc(t,t.ins_h,t.window[t.strstart+Yl-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-Xl&&(t.match_length=gc(t,r)),t.match_length>=Yl)if(i=ul(t,t.strstart-t.match_start,t.match_length-Yl),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Yl){t.match_length--;do{t.strstart++,t.ins_h=lc(t,t.ins_h,t.window[t.strstart+Yl-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=lc(t,t.ins_h,t.window[t.strstart+1]);else i=ul(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(uc(t,!1),0===t.strm.avail_out))return Jl}return t.insert=t.strstart<Yl-1?t.strstart:Yl-1,e===pl?(uc(t,!0),0===t.strm.avail_out?ec:rc):t.sym_next&&(uc(t,!1),0===t.strm.avail_out)?Jl:tc},yc=(t,e)=>{let r,i,n;for(;;){if(t.lookahead<Xl){if(pc(t),t.lookahead<Xl&&e===dl)return Jl;if(0===t.lookahead)break}if(r=0,t.lookahead>=Yl&&(t.ins_h=lc(t,t.ins_h,t.window[t.strstart+Yl-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Yl-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Xl&&(t.match_length=gc(t,r),t.match_length<=5&&(t.strategy===Al||t.match_length===Yl&&t.strstart-t.match_start>4096)&&(t.match_length=Yl-1)),t.prev_length>=Yl&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-Yl,i=ul(t,t.strstart-1-t.prev_match,t.prev_length-Yl),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=lc(t,t.ins_h,t.window[t.strstart+Yl-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=Yl-1,t.strstart++,i&&(uc(t,!1),0===t.strm.avail_out))return Jl}else if(t.match_available){if(i=ul(t,0,t.window[t.strstart-1]),i&&uc(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Jl}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=ul(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Yl-1?t.strstart:Yl-1,e===pl?(uc(t,!0),0===t.strm.avail_out?ec:rc):t.sym_next&&(uc(t,!1),0===t.strm.avail_out)?Jl:tc},_c=(t,e)=>{let r,i,n,s;const a=t.window;for(;;){if(t.lookahead<=Vl){if(pc(t),t.lookahead<=Vl&&e===dl)return Jl;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=Yl&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){s=t.strstart+Vl;do{}while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);t.match_length=Vl-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Yl?(r=ul(t,1,t.match_length-Yl),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=ul(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(uc(t,!1),0===t.strm.avail_out))return Jl}return t.insert=0,e===pl?(uc(t,!0),0===t.strm.avail_out?ec:rc):t.sym_next&&(uc(t,!1),0===t.strm.avail_out)?Jl:tc},vc=(t,e)=>{let r;for(;;){if(0===t.lookahead&&(pc(t),0===t.lookahead)){if(e===dl)return Jl;break}if(t.match_length=0,r=ul(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(uc(t,!1),0===t.strm.avail_out))return Jl}return t.insert=0,e===pl?(uc(t,!0),0===t.strm.avail_out?ec:rc):t.sym_next&&(uc(t,!1),0===t.strm.avail_out)?Jl:tc};function xc(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}const kc=[new xc(0,0,0,0,wc),new xc(4,4,8,4,bc),new xc(4,5,16,8,bc),new xc(4,6,32,32,bc),new xc(4,4,16,16,yc),new xc(8,16,32,32,yc),new xc(8,16,128,128,yc),new xc(8,32,128,256,yc),new xc(32,128,258,1024,yc),new xc(32,258,258,4096,yc)],Ac=t=>{t.window_size=2*t.w_size,ac(t.head),t.max_lazy_match=kc[t.level].max_lazy,t.good_match=kc[t.level].good_length,t.nice_match=kc[t.level].nice_length,t.max_chain_length=kc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Yl-1,t.match_available=0,t.ins_h=0};function Mc(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Dl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Ol),this.dyn_dtree=new Uint16Array(2*(2*zl+1)),this.bl_tree=new Uint16Array(2*(2*Ll+1)),ac(this.dyn_ltree),ac(this.dyn_dtree),ac(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Nl+1),this.heap=new Uint16Array(2*Fl+1),ac(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Fl+1),ac(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ec=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Hl&&e.status!==Gl&&e.status!==ql&&e.status!==$l&&e.status!==Zl&&e.status!==Wl&&e.status!==Ql&&e.status!==Kl?1:0},Sc=t=>{if(Ec(t))return nc(t,_l);t.total_in=t.total_out=0,t.data_type=Il;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?Gl:e.wrap?Hl:Ql,t.adler=2===e.wrap?0:1,e.last_flush=-2,hl(e),bl},Rc=t=>{const e=Sc(t);return e===bl&&Ac(t.state),e},Ic=(t,e)=>Ec(t)||2!==t.state.wrap?_l:(t.state.gzhead=e,bl),Dc=(t,e,r,i,n,s)=>{if(!t)return _l;let a=1;if(e===kl&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>Cl||r!==Dl||i<8||i>15||e<0||e>9||s<0||s>Sl||8===i&&1!==a)return nc(t,_l);8===i&&(i=9);const o=new Mc;return t.state=o,o.strm=t,o.status=Hl,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Yl-1)/Yl),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=s,o.method=r,Rc(t)},Cc=(t,e)=>Dc(t,e,Dl,Bl,Tl,Rl),Bc=(t,e)=>{if(Ec(t)||e>wl||e<0)return t?nc(t,_l):_l;const r=t.state;if(!t.output||0!==t.avail_in&&!t.input||r.status===Kl&&e!==pl)return nc(t,0===t.avail_out?xl:_l);const i=r.last_flush;if(r.last_flush=e,0!==r.pending){if(cc(t),0===t.avail_out)return r.last_flush=-1,bl}else if(0===t.avail_in&&sc(e)<=sc(i)&&e!==pl)return nc(t,xl);if(r.status===Kl&&0!==t.avail_in)return nc(t,xl);if(r.status===Hl&&0===r.wrap&&(r.status=Ql),r.status===Hl){let e=Dl+(r.w_bits-8<<4)<<8,i=-1;if(i=r.strategy>=Ml||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=i<<6,0!==r.strstart&&(e|=jl),e+=31-e%31,dc(r,e),0!==r.strstart&&(dc(r,t.adler>>>16),dc(r,65535&t.adler)),t.adler=1,r.status=Ql,cc(t),0!==r.pending)return r.last_flush=-1,bl}if(r.status===Gl)if(t.adler=0,fc(r,31),fc(r,139),fc(r,8),r.gzhead)fc(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),fc(r,255&r.gzhead.time),fc(r,r.gzhead.time>>8&255),fc(r,r.gzhead.time>>16&255),fc(r,r.gzhead.time>>24&255),fc(r,9===r.level?2:r.strategy>=Ml||r.level<2?4:0),fc(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(fc(r,255&r.gzhead.extra.length),fc(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=sl(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=ql;else if(fc(r,0),fc(r,0),fc(r,0),fc(r,0),fc(r,0),fc(r,9===r.level?2:r.strategy>=Ml||r.level<2?4:0),fc(r,ic),r.status=Ql,cc(t),0!==r.pending)return r.last_flush=-1,bl;if(r.status===ql){if(r.gzhead.extra){let e=r.pending,i=(65535&r.gzhead.extra.length)-r.gzindex;while(r.pending+i>r.pending_buf_size){let n=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>e&&(t.adler=sl(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex+=n,cc(t),0!==r.pending)return r.last_flush=-1,bl;e=0,i-=n}let n=new Uint8Array(r.gzhead.extra);r.pending_buf.set(n.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>e&&(t.adler=sl(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex=0}r.status=$l}if(r.status===$l){if(r.gzhead.name){let e,i=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(t.adler=sl(t.adler,r.pending_buf,r.pending-i,i)),cc(t),0!==r.pending)return r.last_flush=-1,bl;i=0}e=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,fc(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>i&&(t.adler=sl(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=Zl}if(r.status===Zl){if(r.gzhead.comment){let e,i=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(t.adler=sl(t.adler,r.pending_buf,r.pending-i,i)),cc(t),0!==r.pending)return r.last_flush=-1,bl;i=0}e=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,fc(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>i&&(t.adler=sl(t.adler,r.pending_buf,r.pending-i,i))}r.status=Wl}if(r.status===Wl){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(cc(t),0!==r.pending))return r.last_flush=-1,bl;fc(r,255&t.adler),fc(r,t.adler>>8&255),t.adler=0}if(r.status=Ql,cc(t),0!==r.pending)return r.last_flush=-1,bl}if(0!==t.avail_in||0!==r.lookahead||e!==dl&&r.status!==Kl){let i=0===r.level?wc(r,e):r.strategy===Ml?vc(r,e):r.strategy===El?_c(r,e):kc[r.level].func(r,e);if(i!==ec&&i!==rc||(r.status=Kl),i===Jl||i===ec)return 0===t.avail_out&&(r.last_flush=-1),bl;if(i===tc&&(e===ml?fl(r):e!==wl&&(ll(r,0,0,!1),e===gl&&(ac(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),cc(t),0===t.avail_out))return r.last_flush=-1,bl}return e!==pl?bl:r.wrap<=0?yl:(2===r.wrap?(fc(r,255&t.adler),fc(r,t.adler>>8&255),fc(r,t.adler>>16&255),fc(r,t.adler>>24&255),fc(r,255&t.total_in),fc(r,t.total_in>>8&255),fc(r,t.total_in>>16&255),fc(r,t.total_in>>24&255)):(dc(r,t.adler>>>16),dc(r,65535&t.adler)),cc(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?bl:yl)},Tc=t=>{if(Ec(t))return _l;const e=t.state.status;return t.state=null,e===Ql?nc(t,vl):bl},Uc=(t,e)=>{let r=e.length;if(Ec(t))return _l;const i=t.state,n=i.wrap;if(2===n||1===n&&i.status!==Hl||i.lookahead)return _l;if(1===n&&(t.adler=el(t.adler,e,r,0)),i.wrap=0,r>=i.w_size){0===n&&(ac(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(r-i.w_size,r),0),e=t,r=i.w_size}const s=t.avail_in,a=t.next_in,o=t.input;t.avail_in=r,t.next_in=0,t.input=e,pc(i);while(i.lookahead>=Yl){let t=i.strstart,e=i.lookahead-(Yl-1);do{i.ins_h=lc(i,i.ins_h,i.window[t+Yl-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=Yl-1,pc(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Yl-1,i.match_available=0,t.next_in=a,t.input=o,t.avail_in=s,i.wrap=n,bl};var Pc=Cc,Fc=Dc,zc=Rc,Lc=Sc,Oc=Ic,Nc=Bc,Yc=Tc,Vc=Uc,Xc="pako deflate (from Nodeca project)",jc={deflateInit:Pc,deflateInit2:Fc,deflateReset:zc,deflateResetKeep:Lc,deflateSetHeader:Oc,deflate:Nc,deflateEnd:Yc,deflateSetDictionary:Vc,deflateInfo:Xc};const Hc=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Gc=function(t){const e=Array.prototype.slice.call(arguments,1);while(e.length){const r=e.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const e in r)Hc(r,e)&&(t[e]=r[e])}}return t},qc=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const r=new Uint8Array(e);for(let i=0,n=0,s=t.length;i<s;i++){let e=t[i];r.set(e,n),n+=e.length}return r},$c={assign:Gc,flattenChunks:qc};let Zc=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s_){Zc=!1}const Wc=new Uint8Array(256);for(let a_=0;a_<256;a_++)Wc[a_]=a_>=252?6:a_>=248?5:a_>=240?4:a_>=224?3:a_>=192?2:1;Wc[254]=Wc[254]=1;var Qc=t=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)r=t.charCodeAt(n),55296===(64512&r)&&n+1<a&&(i=t.charCodeAt(n+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),n++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),s=0,n=0;s<o;n++)r=t.charCodeAt(n),55296===(64512&r)&&n+1<a&&(i=t.charCodeAt(n+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|63&r):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e};const Kc=(t,e)=>{if(e<65534&&t.subarray&&Zc)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r};var Jc=(t,e)=>{const r=e||t.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const s=new Array(2*r);for(n=0,i=0;i<r;){let e=t[i++];if(e<128){s[n++]=e;continue}let a=Wc[e];if(a>4)s[n++]=65533,i+=a-1;else{e&=2===a?31:3===a?15:7;while(a>1&&i<r)e=e<<6|63&t[i++],a--;a>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return Kc(s,n)},tu=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;while(r>=0&&128===(192&t[r]))r--;return r<0||0===r?e:r+Wc[t[r]]>e?r:e},eu={string2buf:Qc,buf2string:Jc,utf8border:tu};function ru(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var iu=ru;const nu=Object.prototype.toString,{Z_NO_FLUSH:su,Z_SYNC_FLUSH:au,Z_FULL_FLUSH:ou,Z_FINISH:hu,Z_OK:lu,Z_STREAM_END:cu,Z_DEFAULT_COMPRESSION:uu,Z_DEFAULT_STRATEGY:fu,Z_DEFLATED:du}=ol;function mu(t){this.options=$c.assign({level:uu,method:du,chunkSize:16384,windowBits:15,memLevel:8,strategy:fu},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iu,this.strm.avail_out=0;let r=jc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==lu)throw new Error(al[r]);if(e.header&&jc.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"===typeof e.dictionary?eu.string2buf(e.dictionary):"[object ArrayBuffer]"===nu.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=jc.deflateSetDictionary(this.strm,t),r!==lu)throw new Error(al[r]);this._dict_set=!0}}function gu(t,e){const r=new mu(e);if(r.push(t,!0),r.err)throw r.msg||al[r.err];return r.result}function pu(t,e){return e=e||{},e.raw=!0,gu(t,e)}function wu(t,e){return e=e||{},e.gzip=!0,gu(t,e)}mu.prototype.push=function(t,e){const r=this.strm,i=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?hu:su,"string"===typeof t?r.input=eu.string2buf(t):"[object ArrayBuffer]"===nu.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(s===au||s===ou)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(n=jc.deflate(r,s),n===cu)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=jc.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===lu;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},mu.prototype.onData=function(t){this.chunks.push(t)},mu.prototype.onEnd=function(t){t===lu&&(this.result=$c.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var bu=mu,yu=gu,_u=pu,vu=wu,xu=ol,ku={Deflate:bu,deflate:yu,deflateRaw:_u,gzip:vu,constants:xu};const Au=16209,Mu=16191;var Eu=function(t,e){let r,i,n,s,a,o,h,l,c,u,f,d,m,g,p,w,b,y,_,v,x,k,A,M;const E=t.state;r=t.next_in,A=t.input,i=r+(t.avail_in-5),n=t.next_out,M=t.output,s=n-(e-t.avail_out),a=n+(t.avail_out-257),o=E.dmax,h=E.wsize,l=E.whave,c=E.wnext,u=E.window,f=E.hold,d=E.bits,m=E.lencode,g=E.distcode,p=(1<<E.lenbits)-1,w=(1<<E.distbits)-1;t:do{d<15&&(f+=A[r++]<<d,d+=8,f+=A[r++]<<d,d+=8),b=m[f&p];e:for(;;){if(y=b>>>24,f>>>=y,d-=y,y=b>>>16&255,0===y)M[n++]=65535&b;else{if(!(16&y)){if(0===(64&y)){b=m[(65535&b)+(f&(1<<y)-1)];continue e}if(32&y){E.mode=Mu;break t}t.msg="invalid literal/length code",E.mode=Au;break t}_=65535&b,y&=15,y&&(d<y&&(f+=A[r++]<<d,d+=8),_+=f&(1<<y)-1,f>>>=y,d-=y),d<15&&(f+=A[r++]<<d,d+=8,f+=A[r++]<<d,d+=8),b=g[f&w];r:for(;;){if(y=b>>>24,f>>>=y,d-=y,y=b>>>16&255,!(16&y)){if(0===(64&y)){b=g[(65535&b)+(f&(1<<y)-1)];continue r}t.msg="invalid distance code",E.mode=Au;break t}if(v=65535&b,y&=15,d<y&&(f+=A[r++]<<d,d+=8,d<y&&(f+=A[r++]<<d,d+=8)),v+=f&(1<<y)-1,v>o){t.msg="invalid distance too far back",E.mode=Au;break t}if(f>>>=y,d-=y,y=n-s,v>y){if(y=v-y,y>l&&E.sane){t.msg="invalid distance too far back",E.mode=Au;break t}if(x=0,k=u,0===c){if(x+=h-y,y<_){_-=y;do{M[n++]=u[x++]}while(--y);x=n-v,k=M}}else if(c<y){if(x+=h+c-y,y-=c,y<_){_-=y;do{M[n++]=u[x++]}while(--y);if(x=0,c<_){y=c,_-=y;do{M[n++]=u[x++]}while(--y);x=n-v,k=M}}}else if(x+=c-y,y<_){_-=y;do{M[n++]=u[x++]}while(--y);x=n-v,k=M}while(_>2)M[n++]=k[x++],M[n++]=k[x++],M[n++]=k[x++],_-=3;_&&(M[n++]=k[x++],_>1&&(M[n++]=k[x++]))}else{x=n-v;do{M[n++]=M[x++],M[n++]=M[x++],M[n++]=M[x++],_-=3}while(_>2);_&&(M[n++]=M[x++],_>1&&(M[n++]=M[x++]))}break}}break}}while(r<i&&n<a);_=d>>3,r-=_,d-=_<<3,f&=(1<<d)-1,t.next_in=r,t.next_out=n,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=n<a?a-n+257:257-(n-a),E.hold=f,E.bits=d};const Su=15,Ru=852,Iu=592,Du=0,Cu=1,Bu=2,Tu=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Uu=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Pu=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Fu=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),zu=(t,e,r,i,n,s,a,o)=>{const h=o.bits;let l,c,u,f,d,m,g=0,p=0,w=0,b=0,y=0,_=0,v=0,x=0,k=0,A=0,M=null;const E=new Uint16Array(Su+1),S=new Uint16Array(Su+1);let R,I,D,C=null;for(g=0;g<=Su;g++)E[g]=0;for(p=0;p<i;p++)E[e[r+p]]++;for(y=h,b=Su;b>=1;b--)if(0!==E[b])break;if(y>b&&(y=b),0===b)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(w=1;w<b;w++)if(0!==E[w])break;for(y<w&&(y=w),x=1,g=1;g<=Su;g++)if(x<<=1,x-=E[g],x<0)return-1;if(x>0&&(t===Du||1!==b))return-1;for(S[1]=0,g=1;g<Su;g++)S[g+1]=S[g]+E[g];for(p=0;p<i;p++)0!==e[r+p]&&(a[S[e[r+p]]++]=p);if(t===Du?(M=C=a,m=20):t===Cu?(M=Tu,C=Uu,m=257):(M=Pu,C=Fu,m=0),A=0,p=0,g=w,d=s,_=y,v=0,u=-1,k=1<<y,f=k-1,t===Cu&&k>Ru||t===Bu&&k>Iu)return 1;for(;;){R=g-v,a[p]+1<m?(I=0,D=a[p]):a[p]>=m?(I=C[a[p]-m],D=M[a[p]-m]):(I=96,D=0),l=1<<g-v,c=1<<_,w=c;do{c-=l,n[d+(A>>v)+c]=R<<24|I<<16|D}while(0!==c);l=1<<g-1;while(A&l)l>>=1;if(0!==l?(A&=l-1,A+=l):A=0,p++,0===--E[g]){if(g===b)break;g=e[r+a[p]]}if(g>y&&(A&f)!==u){0===v&&(v=y),d+=w,_=g-v,x=1<<_;while(_+v<b){if(x-=E[_+v],x<=0)break;_++,x<<=1}if(k+=1<<_,t===Cu&&k>Ru||t===Bu&&k>Iu)return 1;u=A&f,n[u]=y<<24|_<<16|d-s}}return 0!==A&&(n[d+A]=g-v<<24|64<<16),o.bits=y,0};var Lu=zu;const Ou=0,Nu=1,Yu=2,{Z_FINISH:Vu,Z_BLOCK:Xu,Z_TREES:ju,Z_OK:Hu,Z_STREAM_END:Gu,Z_NEED_DICT:qu,Z_STREAM_ERROR:$u,Z_DATA_ERROR:Zu,Z_MEM_ERROR:Wu,Z_BUF_ERROR:Qu,Z_DEFLATED:Ku}=ol,Ju=16180,tf=16181,ef=16182,rf=16183,nf=16184,sf=16185,af=16186,of=16187,hf=16188,lf=16189,cf=16190,uf=16191,ff=16192,df=16193,mf=16194,gf=16195,pf=16196,wf=16197,bf=16198,yf=16199,_f=16200,vf=16201,xf=16202,kf=16203,Af=16204,Mf=16205,Ef=16206,Sf=16207,Rf=16208,If=16209,Df=16210,Cf=16211,Bf=852,Tf=592,Uf=15,Pf=Uf,Ff=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function zf(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Lf=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Ju||e.mode>Cf?1:0},Of=t=>{if(Lf(t))return $u;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Ju,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Bf),e.distcode=e.distdyn=new Int32Array(Tf),e.sane=1,e.back=-1,Hu},Nf=t=>{if(Lf(t))return $u;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Of(t)},Yf=(t,e)=>{let r;if(Lf(t))return $u;const i=t.state;return e<0?(r=0,e=-e):(r=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?$u:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,Nf(t))},Vf=(t,e)=>{if(!t)return $u;const r=new zf;t.state=r,r.strm=t,r.window=null,r.mode=Ju;const i=Yf(t,e);return i!==Hu&&(t.state=null),i},Xf=t=>Vf(t,Pf);let jf,Hf,Gf=!0;const qf=t=>{if(Gf){jf=new Int32Array(512),Hf=new Int32Array(32);let e=0;while(e<144)t.lens[e++]=8;while(e<256)t.lens[e++]=9;while(e<280)t.lens[e++]=7;while(e<288)t.lens[e++]=8;Lu(Nu,t.lens,0,288,jf,0,t.work,{bits:9}),e=0;while(e<32)t.lens[e++]=5;Lu(Yu,t.lens,0,32,Hf,0,t.work,{bits:5}),Gf=!1}t.lencode=jf,t.lenbits=9,t.distcode=Hf,t.distbits=5},$f=(t,e,r,i)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(r-i,r-i+n),s.wnext),i-=n,i?(s.window.set(e.subarray(r-i,r),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},Zf=(t,e)=>{let r,i,n,s,a,o,h,l,c,u,f,d,m,g,p,w,b,y,_,v,x,k,A=0;const M=new Uint8Array(4);let E,S;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Lf(t)||!t.output||!t.input&&0!==t.avail_in)return $u;r=t.state,r.mode===uf&&(r.mode=ff),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=r.hold,c=r.bits,u=o,f=h,k=Hu;t:for(;;)switch(r.mode){case Ju:if(0===r.wrap){r.mode=ff;break}while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(2&r.wrap&&35615===l){0===r.wbits&&(r.wbits=15),r.check=0,M[0]=255&l,M[1]=l>>>8&255,r.check=sl(r.check,M,2,0),l=0,c=0,r.mode=tf;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=If;break}if((15&l)!==Ku){t.msg="unknown compression method",r.mode=If;break}if(l>>>=4,c-=4,x=8+(15&l),0===r.wbits&&(r.wbits=x),x>15||x>r.wbits){t.msg="invalid window size",r.mode=If;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=512&l?lf:uf,l=0,c=0;break;case tf:while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(r.flags=l,(255&r.flags)!==Ku){t.msg="unknown compression method",r.mode=If;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=If;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,r.check=sl(r.check,M,2,0)),l=0,c=0,r.mode=ef;case ef:while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.head&&(r.head.time=l),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,M[2]=l>>>16&255,M[3]=l>>>24&255,r.check=sl(r.check,M,4,0)),l=0,c=0,r.mode=rf;case rf:while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,r.check=sl(r.check,M,2,0)),l=0,c=0,r.mode=nf;case nf:if(1024&r.flags){while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&4&r.wrap&&(M[0]=255&l,M[1]=l>>>8&255,r.check=sl(r.check,M,2,0)),l=0,c=0}else r.head&&(r.head.extra=null);r.mode=sf;case sf:if(1024&r.flags&&(d=r.length,d>o&&(d=o),d&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(i.subarray(s,s+d),x)),512&r.flags&&4&r.wrap&&(r.check=sl(r.check,i,d,s)),o-=d,s+=d,r.length-=d),r.length))break t;r.length=0,r.mode=af;case af:if(2048&r.flags){if(0===o)break t;d=0;do{x=i[s+d++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&d<o);if(512&r.flags&&4&r.wrap&&(r.check=sl(r.check,i,d,s)),o-=d,s+=d,x)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=of;case of:if(4096&r.flags){if(0===o)break t;d=0;do{x=i[s+d++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&d<o);if(512&r.flags&&4&r.wrap&&(r.check=sl(r.check,i,d,s)),o-=d,s+=d,x)break t}else r.head&&(r.head.comment=null);r.mode=hf;case hf:if(512&r.flags){while(c<16){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(4&r.wrap&&l!==(65535&r.check)){t.msg="header crc mismatch",r.mode=If;break}l=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=uf;break;case lf:while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}t.adler=r.check=Ff(l),l=0,c=0,r.mode=cf;case cf:if(0===r.havedict)return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=l,r.bits=c,qu;t.adler=r.check=1,r.mode=uf;case uf:if(e===Xu||e===ju)break t;case ff:if(r.last){l>>>=7&c,c-=7&c,r.mode=Ef;break}while(c<3){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}switch(r.last=1&l,l>>>=1,c-=1,3&l){case 0:r.mode=df;break;case 1:if(qf(r),r.mode=yf,e===ju){l>>>=2,c-=2;break t}break;case 2:r.mode=pf;break;case 3:t.msg="invalid block type",r.mode=If}l>>>=2,c-=2;break;case df:l>>>=7&c,c-=7&c;while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if((65535&l)!==(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=If;break}if(r.length=65535&l,l=0,c=0,r.mode=mf,e===ju)break t;case mf:r.mode=gf;case gf:if(d=r.length,d){if(d>o&&(d=o),d>h&&(d=h),0===d)break t;n.set(i.subarray(s,s+d),a),o-=d,s+=d,h-=d,a+=d,r.length-=d;break}r.mode=uf;break;case pf:while(c<14){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(r.nlen=257+(31&l),l>>>=5,c-=5,r.ndist=1+(31&l),l>>>=5,c-=5,r.ncode=4+(15&l),l>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=If;break}r.have=0,r.mode=wf;case wf:while(r.have<r.ncode){while(c<3){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.lens[R[r.have++]]=7&l,l>>>=3,c-=3}while(r.have<19)r.lens[R[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},k=Lu(Ou,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,k){t.msg="invalid code lengths set",r.mode=If;break}r.have=0,r.mode=bf;case bf:while(r.have<r.nlen+r.ndist){for(;;){if(A=r.lencode[l&(1<<r.lenbits)-1],p=A>>>24,w=A>>>16&255,b=65535&A,p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(b<16)l>>>=p,c-=p,r.lens[r.have++]=b;else{if(16===b){S=p+2;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(l>>>=p,c-=p,0===r.have){t.msg="invalid bit length repeat",r.mode=If;break}x=r.lens[r.have-1],d=3+(3&l),l>>>=2,c-=2}else if(17===b){S=p+3;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=p,c-=p,x=0,d=3+(7&l),l>>>=3,c-=3}else{S=p+7;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=p,c-=p,x=0,d=11+(127&l),l>>>=7,c-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=If;break}while(d--)r.lens[r.have++]=x}}if(r.mode===If)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=If;break}if(r.lenbits=9,E={bits:r.lenbits},k=Lu(Nu,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,k){t.msg="invalid literal/lengths set",r.mode=If;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},k=Lu(Yu,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,k){t.msg="invalid distances set",r.mode=If;break}if(r.mode=yf,e===ju)break t;case yf:r.mode=_f;case _f:if(o>=6&&h>=258){t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=l,r.bits=c,Eu(t,f),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=r.hold,c=r.bits,r.mode===uf&&(r.back=-1);break}for(r.back=0;;){if(A=r.lencode[l&(1<<r.lenbits)-1],p=A>>>24,w=A>>>16&255,b=65535&A,p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(w&&0===(240&w)){for(y=p,_=w,v=b;;){if(A=r.lencode[v+((l&(1<<y+_)-1)>>y)],p=A>>>24,w=A>>>16&255,b=65535&A,y+p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=y,c-=y,r.back+=y}if(l>>>=p,c-=p,r.back+=p,r.length=b,0===w){r.mode=Mf;break}if(32&w){r.back=-1,r.mode=uf;break}if(64&w){t.msg="invalid literal/length code",r.mode=If;break}r.extra=15&w,r.mode=vf;case vf:if(r.extra){S=r.extra;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=xf;case xf:for(;;){if(A=r.distcode[l&(1<<r.distbits)-1],p=A>>>24,w=A>>>16&255,b=65535&A,p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(0===(240&w)){for(y=p,_=w,v=b;;){if(A=r.distcode[v+((l&(1<<y+_)-1)>>y)],p=A>>>24,w=A>>>16&255,b=65535&A,y+p<=c)break;if(0===o)break t;o--,l+=i[s++]<<c,c+=8}l>>>=y,c-=y,r.back+=y}if(l>>>=p,c-=p,r.back+=p,64&w){t.msg="invalid distance code",r.mode=If;break}r.offset=b,r.extra=15&w,r.mode=kf;case kf:if(r.extra){S=r.extra;while(c<S){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=If;break}r.mode=Af;case Af:if(0===h)break t;if(d=f-h,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=If;break}d>r.wnext?(d-=r.wnext,m=r.wsize-d):m=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=n,m=a-r.offset,d=r.length;d>h&&(d=h),h-=d,r.length-=d;do{n[a++]=g[m++]}while(--d);0===r.length&&(r.mode=_f);break;case Mf:if(0===h)break t;n[a++]=r.length,h--,r.mode=_f;break;case Ef:if(r.wrap){while(c<32){if(0===o)break t;o--,l|=i[s++]<<c,c+=8}if(f-=h,t.total_out+=f,r.total+=f,4&r.wrap&&f&&(t.adler=r.check=r.flags?sl(r.check,n,f,a-f):el(r.check,n,f,a-f)),f=h,4&r.wrap&&(r.flags?l:Ff(l))!==r.check){t.msg="incorrect data check",r.mode=If;break}l=0,c=0}r.mode=Sf;case Sf:if(r.wrap&&r.flags){while(c<32){if(0===o)break t;o--,l+=i[s++]<<c,c+=8}if(4&r.wrap&&l!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=If;break}l=0,c=0}r.mode=Rf;case Rf:k=Gu;break t;case If:k=Zu;break t;case Df:return Wu;case Cf:default:return $u}return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=l,r.bits=c,(r.wsize||f!==t.avail_out&&r.mode<If&&(r.mode<Ef||e!==Vu))&&$f(t,t.output,t.next_out,f-t.avail_out),u-=t.avail_in,f-=t.avail_out,t.total_in+=u,t.total_out+=f,r.total+=f,4&r.wrap&&f&&(t.adler=r.check=r.flags?sl(r.check,n,f,t.next_out-f):el(r.check,n,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===uf?128:0)+(r.mode===yf||r.mode===mf?256:0),(0===u&&0===f||e===Vu)&&k===Hu&&(k=Qu),k},Wf=t=>{if(Lf(t))return $u;let e=t.state;return e.window&&(e.window=null),t.state=null,Hu},Qf=(t,e)=>{if(Lf(t))return $u;const r=t.state;return 0===(2&r.wrap)?$u:(r.head=e,e.done=!1,Hu)},Kf=(t,e)=>{const r=e.length;let i,n,s;return Lf(t)?$u:(i=t.state,0!==i.wrap&&i.mode!==cf?$u:i.mode===cf&&(n=1,n=el(n,e,r,0),n!==i.check)?Zu:(s=$f(t,e,r,r),s?(i.mode=Df,Wu):(i.havedict=1,Hu)))};var Jf=Nf,td=Yf,ed=Of,rd=Xf,id=Vf,nd=Zf,sd=Wf,ad=Qf,od=Kf,hd="pako inflate (from Nodeca project)",ld={inflateReset:Jf,inflateReset2:td,inflateResetKeep:ed,inflateInit:rd,inflateInit2:id,inflate:nd,inflateEnd:sd,inflateGetHeader:ad,inflateSetDictionary:od,inflateInfo:hd};function cd(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ud=cd;const fd=Object.prototype.toString,{Z_NO_FLUSH:dd,Z_FINISH:md,Z_OK:gd,Z_STREAM_END:pd,Z_NEED_DICT:wd,Z_STREAM_ERROR:bd,Z_DATA_ERROR:yd,Z_MEM_ERROR:_d}=ol;function vd(t){this.options=$c.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iu,this.strm.avail_out=0;let r=ld.inflateInit2(this.strm,e.windowBits);if(r!==gd)throw new Error(al[r]);if(this.header=new ud,ld.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"===typeof e.dictionary?e.dictionary=eu.string2buf(e.dictionary):"[object ArrayBuffer]"===fd.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ld.inflateSetDictionary(this.strm,e.dictionary),r!==gd)))throw new Error(al[r])}function xd(t,e){const r=new vd(e);if(r.push(t),r.err)throw r.msg||al[r.err];return r.result}function kd(t,e){return e=e||{},e.raw=!0,xd(t,e)}vd.prototype.push=function(t,e){const r=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(a=e===~~e?e:!0===e?md:dd,"[object ArrayBuffer]"===fd.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),s=ld.inflate(r,a),s===wd&&n&&(s=ld.inflateSetDictionary(r,n),s===gd?s=ld.inflate(r,a):s===yd&&(s=wd));while(r.avail_in>0&&s===pd&&r.state.wrap>0&&0!==t[r.next_in])ld.inflateReset(r),s=ld.inflate(r,a);switch(s){case bd:case yd:case wd:case _d:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(0===r.avail_out||s===pd))if("string"===this.options.to){let t=eu.utf8border(r.output,r.next_out),e=r.next_out-t,n=eu.buf2string(r.output,t);r.next_out=e,r.avail_out=i-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==gd||0!==o){if(s===pd)return s=ld.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},vd.prototype.onData=function(t){this.chunks.push(t)},vd.prototype.onEnd=function(t){t===gd&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=$c.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ad=vd,Md=xd,Ed=kd,Sd=xd,Rd=ol,Id={Inflate:Ad,inflate:Md,inflateRaw:Ed,ungzip:Sd,constants:Rd};const{Deflate:Dd,deflate:Cd,deflateRaw:Bd,gzip:Td}=ku,{Inflate:Ud,inflate:Pd,inflateRaw:Fd,ungzip:zd}=Id;var Ld=Pd;function Od(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r=Ld(e);return new DataView(r.buffer,r.byteOffset,r.byteLength)}const Nd={ignoreImageData:!1,onlyFirst:!1};class Yd extends b.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;this.decodeHeader();while(this._nextIFD)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw Gd("ifdCount",t)}get pageCount(){let t=0;this.decodeHeader();while(this._nextIFD)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw Gd("ifdCount",t)}decode(t={}){t=Object.assign({},Nd,t);const e=[];this.decodeHeader();while(this._nextIFD)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let r;if(this.seek(this._nextIFD),e)r=new Po;else{if(!t.kind)throw new Error("kind is missing");r=new ho(t.kind)}const i=this.readUint16();for(let n=0;n<i;n++)this.decodeIFDEntry(r);if(!t.ignoreImageData){if(!(r instanceof Po))throw new Error("must be a tiff ifd");this.decodeImageData(r)}return this._nextIFD=this.readUint32(),r}decodeIFDEntry(t){const e=this.offset,r=this.readUint16(),i=this.readUint16(),n=this.readUint32();if(i<1||i>12)return void this.skip(4);const s=co(i,n);s>4&&this.seek(this.readUint32());const a=uo(this,i,n);if(t.fields.set(r,a),34665===r||34853===r){let e=this.offset,i="exif";34665===r?i="exif":34853===r&&(i="gps"),this._nextIFD=a,t[i]=this.decodeIFD({kind:i,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw Gd("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw Gd("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,r=Math.pow(2,e)-1;for(let i=0;i<t.data.length;i++)t.data[i]=r-t.data[i]}}readStripData(t){const e=t.width,r=t.height,i=t.bitsPerSample,n=t.sampleFormat,s=e*r*t.samplesPerPixel,a=Vd(s,i,n),o=t.rowsPerStrip,h=o*e*t.samplesPerPixel,l=t.stripOffsets,c=t.stripByteCounts||Ka(t);let u=s,f=0;for(let d=0;d<l.length;d++){let e=new DataView(this.buffer,this.byteOffset+l[d],c[d]),r=u>h?h:u;u-=r;let s=e;switch(t.compression){case 1:break;case 5:s=To(e);break;case 8:s=Od(e);break;case 2:throw Gd("Compression","CCITT Group 3");case 32773:throw Gd("Compression","PackBits");default:throw Gd("Compression",t.compression)}f=this.fillUncompressed(i,n,a,s,f,r)}t.data=a}fillUncompressed(t,e,r,i,n,s){if(8===t)return Xd(r,i,n,s);if(16===t)return jd(r,i,n,s,this.isLittleEndian());if(32===t&&3===e)return Hd(r,i,n,s,this.isLittleEndian());throw Gd("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)Ja(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);to(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:r,maxSampleValue:i}=t;for(let t=0;t<e.length;t+=r){const n=e[t+r-1];for(let s=0;s<r-1;s++)e[t+s]=Math.round(e[t+s]*i/n)}}}}function Vd(t,e,r){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===r)return new Float32Array(t);throw Gd("bit depth / sample format",`${e} / ${r}`)}function Xd(t,e,r,i){for(let n=0;n<i;n++)t[r++]=e.getUint8(n);return r}function jd(t,e,r,i,n){for(let s=0;s<2*i;s+=2)t[r++]=e.getUint16(s,n);return r}function Hd(t,e,r,i,n){for(let s=0;s<4*i;s+=4)t[r++]=e.getFloat32(s,n);return r}function Gd(t,e){return new Error(`Unsupported ${t}: ${e}`)}function qd(t,e){const r=new Yd(t);return r.decode(e)}function $d(t={}){let{algorithm:e="matchToPrevious",ignoreBorder:r=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let i="matchToPrevious"===e,n=this[0],s=[];s[0]={position:[0,0],image:this[0]};let a=[0,0];for(let f=1;f<this.length;f++){let t=n.getBestMatch(this[f],{border:r});s[f]={position:[t[0]+a[0],t[1]+a[1]],image:this[f]},i&&(a[0]+=t[0],a[1]+=t[1],n=this[f])}let o=0,h=0,l=0,c=0;for(let f=0;f<s.length;f++){let t=s[f];t.position[0]>o&&(o=t.position[0]),t.position[0]<h&&(h=t.position[0]),t.position[1]>l&&(l=t.position[1]),t.position[1]<c&&(c=t.position[1])}h=0-h,c=0-c;for(let f=0;f<s.length;f++){let t=s[f];t.crop=t.image.crop({x:o-t.position[0],y:l-t.position[1],width:n.width-h-o,height:n.height-c-l})}let u=[];for(let f=0;f<s.length;f++)u[f]=s[f].crop;return new om(u)}function Zd(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let r=0;r<t.length;r++)t[r]=Math.min(t[r],this[e].min[r]);return t}function Wd(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let r=0;r<t.length;r++)t[r]=Math.max(t[r],this[e].max[r]);return t}r(72712);function Qd(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let r,i=0,n=0,s=e/2;while(1){if(t[i]>0){if(void 0!==r)return(r+i)/2;if(n+=t[i],n>s)return i;n===s&&(r=i)}i++}}function Kd(t){let e=0,r=0;for(let i=0;i<t.length;i++)e+=t[i],r+=t[i]*i;return 0===e?0:r/e}function Jd(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let r=0;r<t.length;r++){let i=t[r];e[r]=Qd(i)}return e}function tm(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let r=1;r<this.length;r++){let i=this[r].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=i[t]}return e}function em(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),r=e[0].length;for(let i=1;i<this.length;i++){let n=this[i].getHistograms(t);for(let t=0;t<e.length;t++)for(let i=0;i<r;i++)e[t][i]+=n[t][i]}return e}function rm(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let i=0;i<this.length;i++){let e=this[i];for(let r=0;r<this[0].data.length;r++)t[r]+=e.data[r]}let e=Hy.createFrom(this[0]),r=e.data;for(let i=0;i<this[0].data.length;i++)r[i]=t[i]/this.length;return e}function im(){this.checkProcessable("max",{bitDepth:[8,16]});let t=Hy.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let r=0;r<t.data.length;r++)t.data[r]=Math.max(e.data[r],t.data[r]);return t}function nm(){this.checkProcessable("max",{bitDepth:[8,16]});let t=Hy.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let r=0;r<t.data.length;r++)t.data[r]=Math.min(e.data[r],t.data[r]);return t}function sm(t){t.extendMethod("matchAndCrop",$d),t.extendMethod("getMin",Zd),t.extendMethod("getMax",Wd),t.extendMethod("getMedian",Jd),t.extendMethod("getHistogram",tm),t.extendMethod("getHistograms",em),t.extendMethod("getAverage",rm),t.extendMethod("getAverageImage",rm),t.extendMethod("getMaxImage",im),t.extendMethod("getMinImage",nm)}let am={configurable:!0,enumerable:!1,get:void 0};class om extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"===typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(Hy.load)).then((t=>new om(t)))}static extendMethod(t,e,r={}){let{inPlace:i=!1,returnThis:n=!0,partialArgs:s=[]}=r;return om.prototype[t]=i?function(...t){this.computed=null;let r=e.apply(this,[...s,...t]);return n?this:r}:function(...t){return e.apply(this,[...s,...t])},om}static extendProperty(t,e,r={}){let{partialArgs:i=[]}=r;return am.get=function(){if(null===this.computed)this.computed={};else if(ya()(t,this.computed))return this.computed[t];let r=e.apply(this,i);return this.computed[t]=r,r},Object.defineProperty(om.prototype,t,am),om}checkProcessable(t,e={}){if("string"!==typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let r=1;r<this.length;r++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[r].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[r].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[r].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[r].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[r].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[r].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(om.prototype.map=function(t,e){if("function"!==typeof t)throw new TypeError(`${t} is not a function`);let r=new om(this.length);for(let i=0;i<this.length;i++)r[i]=t.call(e,this[i],i,this);return r}),sm(om);const hm=/^data:[a-z]+\/(?:[a-z]+);base64,/;function lm(t,e){if("string"===typeof t)return um(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(cm(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(cm(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')}function cm(t,e,r){const i=Qa()(t);if(i)switch(i.mime){case"image/png":return fm(t);case"image/jpeg":return mm(t);case"image/tiff":return gm(t,r);default:return bm(n(i.mime))}return bm(n("application/octet-stream"));function n(r){return e||aa(t,r)}}function um(t,e){const r=t.slice(0,64).match(hm);let i;return i=null!==r?Promise.resolve(sa(t.slice(r[0].length))):ca(t,e),i.then((i=>{const n=new Uint8Array(i);return cm(n,r?t:void 0,e&&e.ignorePalette)}))}function fm(t){const e=Js(t);let r,i=e.channels,n=0;return 2===i||4===i?(r=i-1,n=1):r=i,e.palette?dm(e):new Hy(e.width,e.height,e.data,{components:r,alpha:n,bitDepth:e.depth})}function dm(t){const e=t.width*t.height,r=t.palette[0].length,i=new Uint8Array(e*r),n=8/t.depth,s=t.depth<8?n:1,a=parseInt("1".repeat(t.depth),2),o=4===r;let h=0;for(let l=0;l<e;l++){const e=Math.floor(l/s);let r=t.data[e];t.depth<8&&(r=r>>>t.depth*(n-1-l%n)&a);const c=t.palette[r];i[h++]=c[0],i[h++]=c[1],i[h++]=c[2],o&&(i[h++]=c[3])}return new Hy(t.width,t.height,i,{components:3,alpha:o,bitDepth:8})}function mm(t){const e=(0,Za.decode)(t);let r;e.exif&&(r=pm(e.exif));const i=(0,ea.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let n=new Hy(i.width,i.height,i.data,{meta:r});if(r&&r.tiff.tags.Orientation){const t=r.tiff.tags.Orientation;t>2&&(n=n.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(n=n.flipX())}return n}function gm(t,e){let r=qd(t);return 1===r.length?wm(r[0],e):new om(r.map((function(t){return wm(t,e)})))}function pm(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function wm(t,e){if(e||3!==t.type)return new Hy(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?Aa:ka,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:pm(t)});{const e=new Uint16Array(3*t.width*t.height),r=t.palette;let i=0;for(let n=0;n<t.data.length;n++){const s=t.data[n],a=r[s];e[i++]=a[0],e[i++]=a[1],e[i++]=a[2]}return new Hy(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:Aa,bitDepth:16,meta:pm(t)})}}function bm(t,e){return e=e||{},new Promise((function(r,i){let n=new ha;n.onload=function(){let t=n.width,i=n.height,s=la(t,i),a=s.getContext("2d");a.drawImage(n,0,0,t,i);let o=a.getImageData(0,0,t,i).data;r(new Hy(t,i,o,e))},n.onerror=function(){i(new Error(`Could not load ${t}`))},n.src=t}))}const ym={getValueXY(t,e,r){return this.data[(e*this.width+t)*this.channels+r]},setValueXY(t,e,r,i){return this.data[(e*this.width+t)*this.channels+r]=i,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,r){return this.data[t*this.channels+e]=r,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,r){return this.setPixel(e*this.width+t,r)},getPixel(t){const e=new Array(this.channels),r=t*this.channels;for(let i=0;i<this.channels;i++)e[i]=this.data[r+i];return e},setPixel(t,e){const r=t*this.channels;for(let i=0;i<e.length;i++)this.data[r+i]=e[i];return this.computed=null,this}};function _m(t){for(const e in ym)t.prototype[e]=ym[e]}function vm(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function xm(t,e,r,i={}){const{out:n}=e;if(void 0===n)return i.copy?t.clone():Hy.createFrom(t,r);{if(!Hy.isImage(n))throw new TypeError("out must be an Image object");const e=Object.assign(vm(t),r);for(const t in e)if(n[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${n[t]}")`);return n}}function km(t,e,r){if(void 0!==e.inPlace&&"boolean"!==typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return xm(t,e,null,r)}function Am(t={}){this.checkProcessable("abs",{bitDepth:[32]});const e=km(this,t);return Mm(this,e),e}function Mm(t,e){for(let r=0;r<t.data.length;r++)e.data[r]=Math.abs(t.data[r])}function Em(t,e){if(1===t.alpha&&1===e.alpha)for(let r=0;r<t.size;r++)e.data[r*e.channels+e.components]=t.data[r*t.channels+t.components]}function Sm(t={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=km(this,t);return 1===this.bitDepth?Rm(this,e):(Im(this,e),this!==e&&Em(this,e)),e}function Rm(t,e){for(let r=0;r<t.data.length;r++)e.data[r]=~t.data[r]}function Im(t,e){for(let r=0;r<t.data.length;r+=t.channels)for(let i=0;i<t.components;i++)e.data[r+i]=t.maxValue-t.data[r+i]}function Dm(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let r=t*this.channels+e,i=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[r+t];this.data[r+t]=this.data[i+t],this.data[i+t]=e}}}return this}function Cm(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let r=e*this.channels+t*this.width*this.channels,i=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[r+t];this.data[r+t]=this.data[i+t],this.data[i+t]=e}}return this}function Bm(t={}){const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const r=2*e+1,i=new Array(r);for(let n=0;n<r;n++){i[n]=new Array(r);for(let t=0;t<r;t++)i[n][t]=1/(r*r)}return this.convolution(i)}var Tm=r(30130),Um=r.n(Tm);function Pm(t,e={}){let{channels:r,allowAlpha:i,defaultAlpha:n}=e;return"boolean"!==typeof i&&(i=!0),"undefined"===typeof r?Fm(t,n):zm(t,r,i)}function Fm(t,e){let r=e?t.channels:t.components,i=new Array(r);for(let n=0;n<r;n++)i[n]=n;return i}function zm(t,e,r){Array.isArray(e)||(e=[e]);for(let i=0;i<e.length;i++)e[i]=Lm(t,e[i],r);return e}function Lm(t,e,r=!0){if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"===typeof e){switch(t.colorModel){case ka:break;case Aa:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2;break}break;case Ma:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2;break}break;case Ea:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2;break}break;case Sa:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3;break}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"===typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!r&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function Om(t={}){let{radius:e=1,border:r="copy",channels:i}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");i=Pm(this,i,!0);let n=e,s=e,a=Hy.createFrom(this),o=(2*n+1)*(2*s+1),h=new Array(o);for(let l=0;l<i.length;l++){let t=i[l];for(let e=s;e<this.height-s;e++)for(let r=n;r<this.width-n;r++){let i=0;for(let a=-s;a<=s;a++)for(let s=-n;s<=n;s++){let n=((e+a)*this.width+r+s)*this.channels+t;h[i++]=this.data[n]}let o=(e*this.width+r)*this.channels+t;a.data[o]=Um()(h)}}if(this.alpha&&!i.includes(this.channels))for(let l=this.components;l<this.data.length;l+=this.channels)a.data[l]=this.data[l];return a.setBorder({size:[n,s],algorithm:r}),a}function Nm(t={}){let{radius:e=1,sigma:r,channels:i,border:n="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const s=Ym(e,r);return this.convolution([s,s],{border:n,channels:i,algorithm:"separable"})}function Ym(t,e){const r=2*t+1,i=new Array(r),n=e||.3*(.5*(r-1)-1)+.8,s=-.5/(n*n);let a=0;for(let o=0;o<r;o++){const e=o-t,r=Math.exp(s*e*e);i[o]=r,a+=r}for(let o=0;o<r;o++)i[o]/=a;return i}const Vm=[[0,1,0],[1,-4,1],[0,1,0]],Xm=[[1,1,1],[1,-8,1],[1,1,1]],jm=[[-1,0,1],[-2,0,2],[-1,0,1]],Hm=[[-1,-2,-1],[0,0,0],[1,2,1]],Gm=[[3,0,-3],[10,0,-10],[3,0,-3]],qm=[[3,10,3],[0,0,0],[-3,-10,-3]],$m=[[-1,-2,0,2,1],[-2,-4,0,4,2],[0,0,0,0,0],[1,2,0,-2,-1],[2,4,0,-4,-2]],Zm=[[1,2,0,-2,-1],[2,4,0,-4,-2],[0,0,0,0,0],[-2,-4,0,4,2],[-1,-2,0,2,1]];var Wm=r(32933),Qm=r(33685),Km=r.n(Qm);function Jm(t){let e,r;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0===(1&t.length)||0===(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),r=Math.floor(t[0].length/2)}else{let i=Math.sqrt(t.length);if(!Km()(i))throw new RangeError("validateKernel: Kernel array should be a square");r=e=Math.floor(Math.sqrt(t.length)/2);let n=new Array(i);for(let e=0;e<i;e++){n[e]=new Array(i);for(let r=0;r<i;r++)n[e][r]=t[e*i+r]}t=n}return{kernel:t,kWidth:r,kHeight:e}}function tg(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function eg(t,e,r){if(void 0===r){const i=t.length+e.length-1;r=new Array(i)}rg(r);for(var i=0;i<t.length;i++)for(var n=0;n<e.length;n++)r[i+n]+=t[i]*e[n];return r}function rg(t){for(var e=0;e<t.length;e++)t[e]=0}r(15883),r(45232);function ig(t,e,r,i){const n=new Array(t.length);let s,a,o,h;h=e[1],o=(h.length-1)/2,a=new Array(r+h.length-1),s=new Array(r);for(let l=0;l<i;l++){for(let e=0;e<r;e++)s[e]=t[l*r+e];eg(s,h,a);for(let t=0;t<r;t++)n[l*r+t]=a[o+t]}h=e[0],o=(h.length-1)/2,a=new Array(i+h.length-1),s=new Array(i);for(let l=0;l<r;l++){for(let t=0;t<i;t++)s[t]=n[t*r+l];eg(s,h,a);for(let t=0;t<i;t++)n[t*r+l]=a[o+t]}return n}var ng=r(68742);ng.AbstractMatrix,ng.CHO,ng.CholeskyDecomposition,ng.DistanceMatrix,ng.EVD,ng.EigenvalueDecomposition,ng.LU,ng.LuDecomposition;const sg=ng.Matrix,ag=(ng.MatrixColumnSelectionView,ng.MatrixColumnView,ng.MatrixFlipColumnView,ng.MatrixFlipRowView,ng.MatrixRowSelectionView,ng.MatrixRowView,ng.MatrixSelectionView,ng.MatrixSubView,ng.MatrixTransposeView,ng.NIPALS,ng.Nipals,ng.QR,ng.QrDecomposition,ng.SVD),og=ng.SingularValueDecomposition;ng.SymmetricMatrix,ng.WrapperMatrix1D,ng.WrapperMatrix2D,ng.correlation,ng.covariance;ng.Matrix,ng.Matrix;ng.determinant;const hg=ng.inverse,lg=(ng.linearDependencies,ng.pseudoInverse,ng.solve);ng.wrap;function cg(t){const e=new ag(t,{autoTranspose:!0});if(1!==e.rank)return null;const r=Math.sqrt(e.s[0]),i=e.U.to2DArray().map((t=>t[0]*r)),n=e.V.to2DArray().map((t=>t[0]*r));return[i,n]}function ug(t,e={}){let{channels:r,bitDepth:i,normalize:n=!1,divisor:s=1,border:a="copy",algorithm:o="auto"}=e,h={};i&&(h.bitDepth=i);let l,c,u=Hy.createFrom(this,h);if(r=Pm(this,r,!0),"separable"!==o)({kernel:t}=Jm(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===o){let e=cg(t);null!==e?(o="separable",t=e):o=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===o?(l=Math.floor(t[0].length/2),c=Math.floor(t[1].length/2)):(l=Math.floor(t.length/2),c=Math.floor(t[0].length/2));let f,d,m,g,p,w,b=u.isClamped,y=new Array(this.height*this.width);for(g=0;g<r.length;g++){for(p=r[g],m=0;m<this.height;m++)for(d=0;d<this.width;d++)f=m*this.width+d,y[f]=this.data[f*this.channels+p];if("direct"===o)w=(0,Wm.direct)(y,t,{rows:this.height,cols:this.width,normalize:n,divisor:s});else if("separable"===o){if(w=ig(y,t,this.width,this.height),n){s=0;for(let e=0;e<t[0].length;e++)for(let r=0;r<t[1].length;r++)s+=t[0][e]*t[1][r]}if(1!==s)for(let t=0;t<w.length;t++)w[t]/=s}else w=(0,Wm.fft)(y,t,{rows:this.height,cols:this.width,normalize:n,divisor:s});for(m=0;m<this.height;m++)for(d=0;d<this.width;d++)f=m*this.width+d,u.data[f*this.channels+p]=b?tg(w[f],u):w[f]}if(this.alpha&&!r.includes(this.channels))for(d=this.components;d<this.data.length;d+=this.channels)u.data[d]=this.data[d];return"periodic"!==a&&u.setBorder({size:[c,l],algorithm:a}),u}function fg(t={}){let{direction:e="xy",border:r="copy",kernelX:i,kernelY:n,channels:s,bitDepth:a=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!i)throw new Error("kernelX option is missing");return ug.call(this,i,{channels:s,border:r,bitDepth:a});case"y":if(!n)throw new Error("kernelY option is missing");return ug.call(this,n,{channels:s,border:r,bitDepth:a});case"xy":{if(!i)throw new Error("kernelX option is missing");if(!n)throw new Error("kernelY option is missing");const t=ug.call(this,i,{channels:s,border:r,bitDepth:32}),e=ug.call(this,n,{channels:s,border:r,bitDepth:32});return t.hypotenuse(e,{bitDepth:a,channels:s})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function dg(t){return fg.call(this,Object.assign({},t,{kernelX:jm,kernelY:Hm}))}function mg(t){return fg.call(this,Object.assign({},t,{kernelX:Gm,kernelY:qm}))}var gg=r(56364),pg=r.n(gg);function wg(t={}){let{algorithm:e="range",channels:r,min:i=this.min,max:n=this.max}=t;switch(this.checkProcessable("level",{bitDepth:[8,16,32]}),r=Pm(this,{channels:r}),r.length!==this.channel&&(Array.isArray(i)&&i.length===this.channels&&(i=i.filter(((t,e)=>r.includes(e)))),Array.isArray(n)&&n.length===this.channels&&(n=n.filter(((t,e)=>r.includes(e))))),e){case"range":i<0&&(i=0),n>this.maxValue&&(n=this.maxValue),Array.isArray(i)||(i=pg()(r.length,i)),Array.isArray(n)||(n=pg()(r.length,n)),bg(this,i,n,r);break;default:throw new Error(`level: algorithm not implement: ${e}`)}return this}function bg(t,e,r,i){let n=1e-5,s=new Array(i.length);for(let a=0;a<i.length;a++)0===e[a]&&r[a]===t.maxValue||r[a]===e[a]?s[a]=0:s[a]=(t.maxValue+1-n)/(r[a]-e[a]),e[a]+=(.5-n/2)/s[a];for(let a=0;a<i.length;a++){let r=i[a];if(0!==s[a])for(let i=0;i<t.data.length;i+=t.channels)t.data[i+r]=Math.min(Math.max(0,(t.data[i+r]-e[a])*s[a]+.5|0),t.maxValue)}}var yg=r(84302),_g=r.n(yg);function vg(t){if(isNaN(t)){if(t instanceof Hy)return t.data;if(!_g()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function xg(t,e={}){let{channels:r}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),r=Pm(this,{channels:r}),t=vg(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]+t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.min(this.maxValue,this.data[r+e]+t|0)}return this}function kg(t,e={}){let{channels:r}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),r=Pm(this,{channels:r}),t=vg(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]-t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.max(0,this.data[r+e]-t|0)}return this}function Ag(t,e={}){let{channels:r,absolute:i=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let n=this.clone();r=Pm(this,{channels:r});for(let s=0;s<r.length;s++){let e=r[s];for(let r=e;r<this.data.length;r+=this.channels){let e=this.data[r]-t.data[r];n.data[r]=i?Math.abs(e):Math.max(e,0)}}return n}function Mg(t,e={}){let{bitDepth:r=this.bitDepth,channels:i}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let n=Hy.createFrom(this,{bitDepth:r});i=Pm(this,{channels:i});let s=n.isClamped;for(let a=0;a<i.length;a++){let e=i[a];for(let r=e;r<this.data.length;r+=this.channels){let e=Math.hypot(this.data[r],t.data[r]);n.data[r]=s?Math.min(Math.max(Math.round(e),0),n.maxValue):e}}return n}function Eg(t,e={}){let{channels:r}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(r=Pm(this,{channels:r}),t=vg(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]*t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.min(this.maxValue,this.data[r+e]*t|0)}return this}function Sg(t,e={}){let{channels:r}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),r=Pm(this,{channels:r}),t=vg(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]/t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.min(this.maxValue,this.data[r+e]/t|0)}return this}var Rg=r(57343);class Ig{constructor(){if(new.target===Ig)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"===typeof t)return this._predict(t);if((0,Rg.isAnyArray)(t)){const e=[];for(let r=0;r<t.length;r++)e.push(this._predict(t[r]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,Rg.isAnyArray)(t)||!(0,Rg.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const r=t.length,i=new Array(r);for(let f=0;f<r;f++)i[f]=this._predict(t[f]);let n=0,s=0,a=0,o=0,h=0,l=0,c=0;for(let f=0;f<r;f++)n+=i[f],s+=e[f],h+=i[f]*i[f],l+=e[f]*e[f],c+=i[f]*e[f],0!==e[f]&&(a+=(e[f]-i[f])*(e[f]-i[f])/e[f]),o+=(e[f]-i[f])*(e[f]-i[f]);const u=(r*c-n*s)/Math.sqrt((r*h-n*n)*(r*l-s*s));return{r:u,r2:u*u,chi2:a,rmsd:Math.sqrt(o/r)}}}var Dg=r(66981),Cg=r.n(Dg);const Bg={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class Tg extends Ig{constructor(t,e,r){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(Cg())(e.kernelType,e.kernelOptions);else{t=sg.checkMatrix(t),r=Object.assign({},Bg,r);const i=new(Cg())(r.kernelType,r.kernelOptions),n=i.compute(t),s=t.rows;n.add(sg.eye(s,s).mul(r.lambda)),this.alpha=lg(n,e),this.inputs=t,this.kernelType=r.kernelType,this.kernelOptions=r.kernelOptions,this.kernel=i}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new Tg(!0,t)}}function Ug(t,e,r){const i=new Tg(t,e,r),n=new Array(this.size);for(let o=0;o<this.width;o++)for(let t=0;t<this.height;t++)n[t*this.width+o]=[o,t];const s=i.predict(n),a=Hy.createFrom(this);for(let o=0;o<this.size;o++)a.data[o]=Math.min(this.maxValue,Math.max(0,s[o][0]));return a}function Pg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let i=!0;t:for(const s of e)for(const t of s)if(1!==t){i=!1;break t}let n=this;for(let s=0;s<r;s++)if(1===this.bitDepth)if(i){const t=n.clone();n=Og(n,t,e.length,e[0].length)}else{const t=Hy.createFrom(n);n=Lg(n,t,e)}else if(i){const t=Hy.createFrom(n);n=zg(n,t,e.length,e[0].length)}else{const t=Hy.createFrom(n);n=Fg(n,t,e)}return n}function Fg(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,a=(n-1)/2;for(let o=0;o<t.height;o++)for(let h=0;h<t.width;h++){let l=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+h,c=e-a+o;if(i<0||c<0||i>=t.width||c>=t.height)continue;const u=t.getValueXY(i,c,0);u>l&&(l=u)}e.setValueXY(h,o,0,l)}return e}function zg(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,a=[];for(let o=0;o<t.width;o++)a.push(0);for(let o=0;o<t.height;o++){for(let e=0;e<t.width;e++){let r=0;for(let i=Math.max(0,o-s);i<Math.min(t.height,o+s+1);i++){const n=t.getValueXY(e,i,0);n>r&&(r=n)}a[e]=r}for(let r=0;r<t.width;r++){let i=0;for(let e=Math.max(0,r-n);e<Math.min(t.width,r+n+1);e++)a[e]>i&&(i=a[e]);e.setValueXY(r,o,0,i)}}return e}function Lg(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,a=(n-1)/2;for(let o=0;o<t.height;o++)for(let h=0;h<t.width;h++){let l=0;t:for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+h,c=e-a+o;if(c<0||i<0||i>=t.width||c>=t.height)continue;const u=t.getBitXY(i,c);if(1===u){l=1;break t}}1===l&&e.setBitXY(h,o)}return e}function Og(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,a=[];for(let o=0;o<t.width;o++)a.push(1);for(let o=0;o<t.height;o++){for(let e=0;e<t.width;e++){a[e]=0;for(let r=Math.max(0,o-s);r<Math.min(t.height,o+s+1);r++)if(1===t.getBitXY(e,r)){a[e]=1;break}}for(let r=0;r<t.width;r++)if(1!==e.getBitXY(r,o))for(let i=Math.max(0,r-n);i<Math.min(t.width,r+n+1);i++)if(1===a[i]){e.setBitXY(r,o);break}}return e}function Ng(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let i=!0;t:for(const s of e)for(const t of s)if(1!==t){i=!1;break t}let n=this;for(let s=0;s<r;s++)if(1===this.bitDepth)if(i){const t=n.clone();n=jg(n,t,e.length,e[0].length)}else{const t=Hy.createFrom(n);n=Xg(n,t,e)}else if(i){const t=Hy.createFrom(n);n=Vg(n,t,e.length,e[0].length)}else{const t=Hy.createFrom(n);n=Yg(n,t,e)}return n}function Yg(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,a=(n-1)/2;for(let o=0;o<t.height;o++)for(let h=0;h<t.width;h++){let l=t.maxValue;for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+h,c=e-a+o;if(i<0||c<0||i>=t.width||c>=t.height)continue;const u=t.getValueXY(i,c,0);u<l&&(l=u)}e.setValueXY(h,o,0,l)}return e}function Vg(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,a=[];for(let o=0;o<t.width;o++)a.push(0);for(let o=0;o<t.height;o++){for(let e=0;e<t.width;e++){let r=t.maxValue;for(let i=Math.max(0,o-s);i<Math.min(t.height,o+s+1);i++){const n=t.getValueXY(e,i,0);n<r&&(r=n)}a[e]=r}for(let r=0;r<t.width;r++){let i=t.maxValue;for(let e=Math.max(0,r-n);e<Math.min(t.width,r+n+1);e++)a[e]<i&&(i=a[e]);e.setValueXY(r,o,0,i)}}return e}function Xg(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,a=(n-1)/2;for(let o=0;o<t.height;o++)for(let h=0;h<t.width;h++){let l=1;t:for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+h,c=e-a+o;if(c<0||i<0||i>=t.width||c>=t.height)continue;const u=t.getBitXY(i,c);if(0===u){l=0;break t}}1===l&&e.setBitXY(h,o)}return e}function jg(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,a=[];for(let o=0;o<t.width;o++)a.push(0);for(let o=0;o<t.height;o++){for(let e=0;e<t.width;e++){a[e]=1;for(let r=Math.max(0,o-s);r<Math.min(t.height,o+s+1);r++)if(0===t.getBitXY(e,r)){a[e]=0;break}}for(let r=0;r<t.width;r++)if(0!==e.getBitXY(r,o))for(let i=Math.max(0,r-n);i<Math.min(t.width,r+n+1);i++)if(0===a[i]){e.clearBitXY(r,o);break}}return e}function Hg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++)i=i.erode({kernel:e}),i=i.dilate({kernel:e});return i}function Gg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++)i=i.dilate({kernel:e}).erode({kernel:e});return i}function qg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2===0||e[0].length%2===0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++){let t=i.open({kernel:e});i=t.subtractImage(i,{absolute:!0})}return i}function $g(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++){const t=i.close({kernel:e});i=t.subtractImage(i,{absolute:!0})}return i}function Zg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++){let t=i.dilate({kernel:e}),r=i.erode({kernel:e});i=t.subtractImage(r,{absolute:!0})}return i}function Wg(t){let e=0,r=0,i=0,n=0,s=t[0][0],a=0;for(let l=1;l<t.length;l++)t[l][0]<s&&(s=t[l][0],a=l);let o=t[(a+1)%t.length][0],h=(a+1)%t.length;for(let l=1;l<t.length;l++)t[l][0]<o&&l!==a&&(o=t[l][0],h=l);return t[h][1]<t[a][1]?(e=t[h],n=t[a],a!==(h+1)%4?(r=t[(h+1)%4],i=t[(h+2)%4]):(r=t[(h+2)%4],i=t[(h+3)%4])):(n=t[h],e=t[a],h!==(a+1)%4?(r=t[(a+1)%4],i=t[(a+2)%4]):(r=t[(a+2)%4],i=t[(a+3)%4])),[e,r,i,n]}function Qg(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Kg(t,e){let r=[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]];return r}function Jg(t,e){let r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2];return r}function tp(t,e,r,i,n,s){let a=Math.max(Qg(t,e),Qg(i,r)),o=Math.max(Qg(t,i),Qg(e,r)),h=0,l=0,c=Math.ceil(n/2),u=Math.ceil(s/2),f=a/o,d=[t[0],t[1],1],m=[e[0],e[1],1],g=[i[0],i[1],1],p=[r[0],r[1],1],w=Jg(Kg(d,p),g)/Jg(Kg(m,p),g),b=Jg(Kg(d,p),m)/Jg(Kg(g,p),m),y=[w*m[0]-d[0],w*m[1]-d[1],w*m[2]-d[2]],_=[b*g[0]-d[0],b*g[1]-d[1],b*g[2]-d[2]],v=y[0],x=y[1],k=y[2],A=_[0],M=_[1],E=_[2],S=1/(k*E)*(v*A-(v*E+k*A)*c+k*E*c*c+(x*M-(x*E+k*M)*u+k*E*u*u));S=S>=0?Math.sqrt(S):Math.sqrt(-S);let R=new sg([[S,0,c],[0,S,u],[0,0,1]]),I=R.transpose(),D=hg(I),C=hg(R),B=sg.rowVector(y),T=sg.rowVector(_),U=Math.sqrt(Jg(B.mmul(D).mmul(C).to1DArray(),y)/Jg(T.mmul(D).mmul(C).to1DArray(),_));return 0===U||0===f?(h=Math.ceil(a),l=Math.ceil(o)):U<f?(h=Math.ceil(a),l=Math.ceil(h/U)):(l=Math.ceil(o),h=Math.ceil(U*l)),[h,l]}function ep(t,e,r,i,n,s,a,o,h,l,c,u){let[f,d]=[(r*t+i*e+n)/(h*t+l*e+1),(s*t+a*e+o)/(h*t+l*e+1)];return c.getValueXY(Math.floor(f),Math.floor(d),u)}function rp(t,e={}){let{calculateRatio:r=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let i,n,[s,a,o,h]=t,l=[s,a,o,h],[c,u,f,d]=Wg(l);r?[i,n]=tp(c,u,f,d,this.width,this.height):(i=Math.ceil(Math.max(Qg(c,u),Qg(d,f))),n=Math.ceil(Math.max(Qg(c,d),Qg(u,f))));let m=Hy.createFrom(this,{width:i,height:n}),[g,p]=c,[w,b]=u,[y,_]=f,[v,x]=d,[k,A]=[0,0],[M,E]=[0,i-1],[S,R]=[n-1,i-1],[I,D]=[n-1,0],C=new sg([[k,A,1,0,0,0,-k*g,-A*g],[M,E,1,0,0,0,-M*w,-E*w],[S,R,1,0,0,0,-S*y,-A*y],[I,D,1,0,0,0,-I*v,-D*v],[0,0,0,k,A,1,-k*p,-A*p],[0,0,0,M,E,1,-M*b,-E*b],[0,0,0,S,R,1,-S*_,-R*_],[0,0,0,I,D,1,-I*x,-D*x]]),B=sg.columnVector([g,w,y,v,p,b,_,x]),T=new og(C),U=T.solve(B),[P,F,z,L,O,N,Y,V]=U.to1DArray(),X=new sg(n,i);for(let j=0;j<this.channels;j++){for(let t=0;t<n;t++)for(let e=0;e<i;e++)X.set(t,e,ep(t,e,P,F,z,L,O,N,Y,V,this,j));m.setMatrix(X,{channel:j})}return m}function ip(t={}){let{x:e=0,y:r=0,width:i=this.width-e,height:n=this.height-r}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),r=Math.round(r),i=Math.round(i),n=Math.round(n),e>this.width-1||r>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${r}) out of range (${this.width-1}; ${this.height-1})`);if(i<=0||n<=0)throw new RangeError(`crop: width and height (width:${i}; height:${n}) must be positive numbers`);if(e<0||r<0)throw new RangeError(`crop: x and y (x:${e}, y:${r}) must be positive numbers`);if(i>this.width-e||n>this.height-r)throw new RangeError(`crop: (x: ${e}, y:${r}, width:${i}, height:${n}) size is out of range`);let s=this;if(1===this.bitDepth){const t=new Hy(i,n,{kind:"BINARY",parent:this});s=sp(this,t,e,r,i,n)}else{const t=Hy.createFrom(this,{width:i,height:n,position:[e,r]});s=np(this,t,e,r,i,n)}return s}function np(t,e,r,i,n,s){let a=n*t.channels,o=i+s,h=0,l=r*t.channels;for(let c=i;c<o;c++){let r=c*t.width*t.channels+l,i=r+a;for(;r<i;r++)e.data[h++]=t.data[r]}return e}function sp(t,e,r,i,n,s){let a=n*t.channels,o=i+s,h=0,l=r*t.channels;for(let c=i;c<o;c++){let r=c*t.width*t.channels+l,i=r+a;for(;r<i;r++)t.getBit(r)&&e.setBit(h),++h}return e}function ap(t={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let r=op(this,e,this.components);if(-1===r)throw new Error("Could not find new dimensions. Threshold may be too high.");let i=hp(this,e,this.components,r),n=lp(this,e,this.components,r),s=cp(this,e,this.components,r,i,n);return this.crop({x:r,y:i,width:s-r+1,height:n-i+1})}function op(t,e,r){for(let i=0;i<t.width;i++)for(let n=0;n<t.height;n++)if(t.getValueXY(i,n,r)>=e)return i;return-1}function hp(t,e,r,i){for(let n=0;n<t.height;n++)for(let s=i;s<t.width;s++)if(t.getValueXY(s,n,r)>=e)return n;return-1}function lp(t,e,r,i){for(let n=t.height-1;n>=0;n--)for(let s=i;s<t.width;s++)if(t.getValueXY(s,n,r)>=e)return n;return-1}function cp(t,e,r,i,n,s){for(let a=t.width-1;a>=i;a--)for(let i=n;i<=s;i++)if(t.getValueXY(a,i,r)>=e)return a;return-1}function up(t){if("string"===typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}function fp(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"===typeof t){let r=t[t.length-1];if("%"!==r)throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"===typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}function dp(t,e,r){t=up(t);let i=Math.round(t*e),n=Math.round(t*r);return i<=0&&(i=1),n<=0&&(n=1),{width:i,height:n}}function mp(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}function gp(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}function pp(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const wp={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function bp(t){if("string"!==typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!wp[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return wp[t]}function yp(t,e,r){const i=this.width/e,n=this.height/r;if(this.bitDepth>1)for(let s=0;s<e;s++){const e=Math.floor((s+.5)*i);for(let i=0;i<r;i++){const r=Math.floor((i+.5)*n);for(let n=0;n<this.channels;n++)t.setValueXY(s,i,n,this.getValueXY(e,r,n))}}else for(let s=0;s<e;s++){const e=Math.floor((s+.5)*i);for(let i=0;i<r;i++){const r=Math.floor((i+.5)*n);this.getBitXY(e,r)&&t.setBitXY(s,i)}}}function _p(t={}){const{factor:e=1,interpolation:r=wp.nearestneighbor,preserveAspectRatio:i=!0}=t,n=bp(r);let s=t.width,a=t.height;if(s||(s=a&&i?Math.round(a*(this.width/this.height)):this.width),a||(a=i?Math.round(s*(this.height/this.width)):this.height),({width:s,height:a}=dp(e,s,a)),s===this.width&&a===this.height){const t=this.clone();return t.position=[0,0],t}let o=Math.round((this.width-s)/2),h=Math.round((this.height-a)/2);const l=Hy.createFrom(this,{width:s,height:a,position:[o,h]});switch(n){case wp.nearestneighbor:yp.call(this,l,s,a);break;default:throw new Error(`unsupported resize interpolation: ${n}`)}return l}function vp(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[Aa]});let t=Hy.createFrom(this,{colorModel:Ea}),e=0,r=this.data;for(let i=0;i<r.length;i+=this.channels){let n=r[i],s=r[i+1],a=r[i+2],o=Math.min(n,s,a),h=Math.max(n,s,a),l=h-o,c=0,u=0===h?0:l/h,f=h;if(h!==o){switch(h){case n:c=(s-a)/l+(s<a?6:0);break;case s:c=(a-n)/l+2;break;case a:c=(n-s)/l+4;break;default:throw new Error("unreachable")}c/=6}t.data[e++]=c*this.maxValue,t.data[e++]=u*this.maxValue,t.data[e++]=f,this.alpha&&(t.data[e++]=r[i+3])}return t}function xp(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[Aa]});let t=Hy.createFrom(this,{colorModel:Ma}),e=Math.floor(this.maxValue/2),r=0,i=this.data;for(let n=0;n<i.length;n+=this.channels){let s=i[n],a=i[n+1],o=i[n+2],h=Math.max(s,a,o),l=Math.min(s,a,o),c=0,u=0,f=(h+l)/2;if(h!==l){let t=h-l;switch(u=f>e?t/(2-h-l):t/(h+l),h){case s:c=(a-o)/t+(a<o?6:0);break;case a:c=(o-s)/t+2;break;case o:c=(s-a)/t+4;break;default:throw new Error("unreachable")}c/=6}t.data[r++]=c*this.maxValue,t.data[r++]=u*this.maxValue,t.data[r++]=f,this.alpha&&(t.data[r++]=i[n+3])}return t}function kp(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[Aa]});let t=Hy.createFrom(this,{components:4,colorModel:Sa}),e=0,r=this.data;for(let i=0;i<r.length;i+=this.channels){let n=r[i],s=r[i+1],a=r[i+2],o=Math.min(this.maxValue-n,this.maxValue-s,this.maxValue-a),h=(this.maxValue-n-o)/(1-o/this.maxValue),l=(this.maxValue-s-o)/(1-o/this.maxValue),c=(this.maxValue-a-o)/(1-o/this.maxValue);t.data[e++]=Math.round(h),t.data[e++]=Math.round(l),t.data[e++]=Math.round(c),t.data[e++]=Math.round(o),this.alpha&&(t.data[e++]=r[i+3])}return t}function Ap(){return new Hy(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const Mp={luma709(t,e,r){return 6966*t+23436*e+2366*r>>15},luma601(t,e,r){return 9798*t+19235*e+3735*r>>15},maximum(t,e,r){return Math.max(t,e,r)},minimum(t,e,r){return Math.min(t,e,r)},average(t,e,r){return(t+e+r)/3|0},minmax(t,e,r){return(Math.max(t,e,r)+Math.min(t,e,r))/2},red(t){return t},green(t,e){return e},blue(t,e,r){return r},cyan(t,e,r,i){let n=Mp.black(t,e,r,i);return(i.maxValue-t-n)/(1-n/i.maxValue)|0},magenta(t,e,r,i){let n=Mp.black(t,e,r,i);return(i.maxValue-e-n)/(1-n/i.maxValue)|0},yellow(t,e,r,i){let n=Mp.black(t,e,r,i);return(i.maxValue-r-n)/(1-n/i.maxValue)|0},black(t,e,r,i){return Math.min(i.maxValue-t,i.maxValue-e,i.maxValue-r)},hue(t,e,r,i){let n=Mp.min(t,e,r),s=Mp.max(t,e,r);if(s===n)return 0;let a=0,o=s-n;switch(s){case t:a=(e-r)/o+(e<r?6:0);break;case e:a=(r-t)/o+2;break;case r:a=(t-e)/o+4;break;default:throw new Error("unreachable")}return a/6*i.maxValue|0},saturation(t,e,r,i){let n=Mp.min(t,e,r),s=Mp.max(t,e,r),a=s-n;return 0===s?0:a/s*i.maxValue},lightness(t,e,r){let i=Mp.min(t,e,r),n=Mp.max(t,e,r);return(n+i)/2}};Object.defineProperty(Mp,"luminosity",{enumerable:!1,value:Mp.lightness}),Object.defineProperty(Mp,"luminance",{enumerable:!1,value:Mp.lightness}),Object.defineProperty(Mp,"min",{enumerable:!1,value:Mp.minimum}),Object.defineProperty(Mp,"max",{enumerable:!1,value:Mp.maximum}),Object.defineProperty(Mp,"brightness",{enumerable:!1,value:Mp.maximum});const Ep={};function Sp(t={}){let{algorithm:e="luma709",keepAlpha:r=!1,mergeAlpha:i=!0}=t;if("string"!==typeof e&&"function"!==typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),r&=this.alpha,i&=this.alpha,r&&(i=!1);let n,s=xm(this,t,{components:1,alpha:r,colorModel:ka});if("function"===typeof e)n=e;else if(n=Mp[e.toLowerCase()],!n)throw new Error(`unsupported grey algorithm: ${e}`);let a=0;for(let o=0;o<this.data.length;o+=this.channels)i?s.data[a++]=tg(n(this.data[o],this.data[o+1],this.data[o+2],this)*this.data[o+this.components]/this.maxValue,this):(s.data[a++]=tg(n(this.data[o],this.data[o+1],this.data[o+2],this),this),s.alpha&&(s.data[a++]=this.data[o+this.components]));return s}function Rp(t){let e=0;for(let c=0;c<t.length;c++)if(0!==t[c]){e=c;break}let r=t.length-1;for(let c=t.length-1;c>=e;c--)if(0!==t[c]){r=c;break}let i=1/(r-e),n=new Array(t.length),s=0,a=0;for(let c=e;c<t.length;c++)s+=c*t[c],a+=t[c],n[c]=s/a;let o=new Array(t.length);s=a=0;for(let c=r;c>0;c--)s+=c*t[c],a+=t[c],o[c-1]=s/a;let h=-1,l=Number.MAX_VALUE;for(let c=0;c<t.length;c++){let e,r=0;for(let s=0;s<=c;s++)e=1/(1+i*Math.abs(s-n[c])),e<1e-6||e>.999999||(r+=t[s]*(-e*Math.log(e)-(1-e)*Math.log(1-e)));for(let n=c+1;n<t.length;n++)e=1/(1+i*Math.abs(n-o[c])),e<1e-6||e>.999999||(r+=t[n]*(-e*Math.log(e)-(1-e)*Math.log(1-e)));r<l&&(l=r,h=c)}return h}function Ip(t){let e=t.slice(),r=0;while(!Dp(e)){let i=0,n=0,s=e[0];for(let r=0;r<t.length-1;r++)i=n,n=s,s=e[r+1],e[r]=(i+n+s)/3;if(e[t.length-1]=(n+s)/3,r++,r>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let i=0;for(let n=1;n<t.length-1;n++)e[n-1]<e[n]&&e[n+1]<e[n]&&(i+=n);return Math.floor(i/2)}function Dp(t){let e=!1,r=0;for(let i=1;i<t.length-1;i++)if(t[i-1]<t[i]&&t[i+1]<t[i]&&(r++,r>2))return!1;return 2===r&&(e=!0),e}function Cp(t){let e,r,i,n,s=0;for(let a=1;a<t.length;a++)if(t[a]>0){s=a+1;break}while(1){e=0,i=0;for(let r=0;r<s;r++)i+=t[r],e+=t[r]*r;n=0,r=0;for(let e=s+1;e<t.length;e++)r+=t[e],n+=t[e]*e;if(i>0&&r>0&&(e/=i,n/=r,s===Math.round((e+n)/2)))break;if(s++,s>t.length-2)throw new Error("Threshold not found")}return s}function Bp(t,e){let r,i,n,s,a,o,h,l,c,u,f,d;f=.5,u=0;for(let m=0;m<t.length;m++)u+=m*t[m];u/=e,h=u;do{o=h,r=o+.5|0,i=0,s=0;for(let e=0;e<=r;e++)i+=e*t[e],s+=t[e];l=0===s?0:i/s,n=0,a=0;for(let e=r+1;e<t.length;e++)n+=e*t[e],a+=t[e];c=0===a?0:n/a,d=(l-c)/(Math.log(l)-Math.log(c)),h=d<-Number.EPSILON?d-.5|0:d+.5|0}while(Math.abs(h-o)>f);return r}function Tp(t,e){let r=new Array(t.length);for(let f=0;f<t.length;f++)r[f]=t[f]/e;let i=new Array(t.length),n=new Array(t.length);i[0]=r[0],n[0]=1-i[0];for(let f=1;f<t.length;f++)i[f]=i[f-1]+r[f],n[f]=1-i[f];let s=0;for(let f=0;f<t.length;f++)if(Math.abs(i[f])>=Number.EPSILON){s=f;break}let a=t.length-1;for(let f=t.length-1;f>=s;f--)if(Math.abs(n[f])>=Number.EPSILON){a=f;break}let o,h,l,c=-1,u=Number.MIN_VALUE;for(let f=s;f<=a;f++){h=0;for(let e=0;e<=f;e++)0!==t[e]&&(h-=r[e]/i[f]*Math.log(r[e]/i[f]));l=0;for(let e=f+1;e<t.length;e++)0!==t[e]&&(l-=r[e]/n[f]*Math.log(r[e]/n[f]));o=h+l,u<o&&(u=o,c=f)}return c}function Up(t,e){let r=0;for(let i=0;i<t.length;i++)r+=i*t[i];return Math.floor(r/e)}function Pp(t,e){let r,i,n,s,a,o,h,l,c,u,f,d,m=-2,g=0;for(let p=0;p<t.length;p++)g+=p*t[p];g/=e,r=g;while(r!==m){let e=Fp(t,r),g=Fp(t,t.length-1),p=zp(t,r),w=zp(t,t.length-1),b=Lp(t,r),y=Lp(t,t.length-1);if(i=p/e,n=(w-p)/(g-e),s=e/g,a=(g-e)/g,o=b/e-i*i,h=(y-b)/(g-e)-n*n,l=1/o-1/h,c=i/o-n/h,u=i*i/o-n*n/h+Math.log10(o*(a*a)/(h*(s*s))),f=c*c-l*u,f<0)return r;m=r,d=(c+Math.sqrt(f))/l,r=isNaN(d)?m:Math.floor(d)}return r}function Fp(t,e){let r=0;for(let i=0;i<=e;i++)r+=t[i];return r}function zp(t,e){let r=0;for(let i=0;i<=e;i++)r+=i*t[i];return r}function Lp(t,e){let r=0;for(let i=0;i<=e;i++)r+=i*i*t[i];return r}function Op(t){if(t.length<2)return 0;let e=0,r=-1,i=-1,n=new Array(t.length);for(let s=0;s<t.length;s++)n[s]=t[s],t[s]>0&&(i=s);while(!Vp(n))if(n=Np(n),e++,e>1e4)return r;return r=Yp(n,i),r}function Np(t){let e=new Array(t.length);for(let r=1;r<t.length-1;r++)e[r]=(t[r-1]+t[r]+t[r+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function Yp(t,e){let r;for(let i=1;i<e;i++)if(t[i-1]>t[i]&&t[i+1]>=t[i]){r=i;break}return r}function Vp(t){let e=t.length,r=!1,i=0;for(let n=1;n<e-1;n++)if(t[n-1]<t[n]&&t[n+1]<t[n]&&(i++,i>2))return!1;return 2===i&&(r=!0),r}function Xp(t,e){let r,i,n,s,a,o,h=1,l=0,c=0,u=0,f=0,d=-1,m=t.length,g=new Array(m);for(let p=0;p<m;p++)g[p]=t[p]/e;for(let p=0;p<m;p++)l+=p*g[p],c+=p*p*g[p],u+=p*p*p*g[p];i=h*c-l*l,n=(-c*c+l*u)/i,s=(h*-u+c*l)/i,a=.5*(-s-Math.sqrt(s*s-4*n)),o=.5*(-s+Math.sqrt(s*s-4*n)),r=(o-l)/(o-a);for(let p=0;p<m;p++)if(f+=g[p],f>r){d=p;break}return d}function jp(t,e){let r=0,i=0,n=0,s=0,a=0;for(let o=0;o<t.length;o++)a+=o*t[o];for(let o=0;o<t.length;o++){i+=t[o];const h=e-i;if(0===i||0===h)continue;r+=o*t[o];const l=(a-r)/h,c=i*h*(r/i-l)*(r/i-l);c>=n&&(s=o,n=c)}return s}function Hp(t){let e=-1,r=.5,i=new Array(t.length),n=Gp(t,t.length-1),s=1;for(let a=0;a<t.length;a++)i[a]=Math.abs(Gp(t,a)/n-r),i[a]<s&&(s=i[a],e=a);return e}function Gp(t,e){let r=0;for(let i=0;i<=e;i++)r+=t[i];return r}function qp(t,e){let r,i,n,s=new Array(t.length),a=new Array(t.length),o=new Array(t.length),h=0,l=0,c=0,u=0,f=0,d=0,m=.5,g=1/(1-m),p=2,w=1/(1-p);for(let v=0;v<t.length;v++)s[v]=t[v]/e;a[0]=s[0],o[0]=1-a[0];for(let v=1;v<t.length;v++)a[v]=a[v-1]+s[v],o[v]=1-a[v];i=0;for(let v=0;v<t.length;v++)if(Math.abs(a[v])>=Number.EPSILON){i=v;break}n=t.length-1;for(let v=t.length-1;v>=i;v--)if(Math.abs(o[v])>=Number.EPSILON){n=v;break}for(let v=i;v<=n;v++){let e=0,r=0,i=0;for(let o=0;o<=v;o++)0!==t[o]&&(e-=s[o]/a[v]*Math.log(s[o]/a[v])),r+=Math.sqrt(s[o]/a[v]),i+=s[o]*s[o]/(a[v]*a[v]);let n=0,m=0,p=0;for(let a=v+1;a<t.length;a++)0!==t[a]&&(n-=s[a]/o[v]*Math.log(s[a]/o[v])),m+=Math.sqrt(s[a]/o[v]),p+=s[a]*s[a]/(o[v]*o[v]);let b=e+n,y=g*(r*m>0?Math.log(r*m):0),_=w*(i*p>0?Math.log(i*p):0);b>u&&(u=b,h=v),y>f&&(f=y,l=v),_>d&&(d=_,c=v)}let b,y=[h,l,c];y.sort(((t,e)=>t-e)),b=Math.abs(y[0]-y[1])<=5?Math.abs(y[1]-y[2])<=5?[1,2,1]:[0,1,3]:Math.abs(y[1]-y[2])<=5?[3,1,0]:[1,2,1];let _=a[y[2]]-a[y[0]];return r=Math.round(y[0]*(a[y[0]]+.25*_*b[0])+.25*y[1]*_*b[1]+y[2]*(o[y[2]]+.25*_*b[2])),r}function $p(t,e){let r=new Array(t.length);for(let d=0;d<t.length;d++)r[d]=t[d]/e;let i=new Array(t.length),n=new Array(t.length);i[0]=r[0],n[0]=1-i[0];for(let d=1;d<t.length;d++)i[d]=i[d-1]+r[d],n[d]=1-i[d];let s=0;for(let d=0;d<t.length;d++)if(Math.abs(i[d])>=Number.EPSILON){s=d;break}let a=t.length-1;for(let d=t.length-1;d>=s;d--)if(Math.abs(n[d])>=Number.EPSILON){a=d;break}let o,h,l,c,u=-1,f=Number.MAX_VALUE;for(let d=s;d<=a;d++){l=0,o=.5/i[d];for(let t=1;t<=d;t++)l-=r[t]*Math.log(1-o*i[t-1]);l*=o,c=0,o=.5/n[d];for(let e=d+1;e<t.length;e++)c-=r[e]*Math.log(1-o*n[e]);c*=o,h=Math.abs(l-c),h<f&&(f=h,u=d)}return u}function Zp(t){let e=0,r=0,i=0,n=0;for(let u=0;u<t.length;u++)if(t[u]>0){e=u;break}e>0&&e--;for(let u=t.length-1;u>0;u--)if(t[u]>0){n=u;break}n<t.length-1&&n++;for(let u=0;u<t.length;u++)t[u]>r&&(i=u,r=t[u]);let s,a,o,h=!1;if(i-e<n-i){h=!0;let r=0,s=t.length-1;while(r<s){let e=t[r];t[r]=t[s],t[s]=e,r++,s--}e=t.length-1-n,i=t.length-1-i}if(e===i)return e;s=t[i],a=e-i,o=Math.sqrt(s*s+a*a),s/=o,a/=o,o=s*e+a*t[e];let l=e,c=0;for(let u=e+1;u<=i;u++){let e=s*u+a*t[u]-o;e>c&&(l=u,c=e)}if(l--,h){let e=0,r=t.length-1;while(e<r){let i=t[e];t[e]=t[r],t[r]=i,e++,r--}return t.length-1-l}return l}function Wp(t,e){let r=new Array(t.length);for(let l=0;l<t.length;l++)r[l]=t[l]/e;let i=new Array(t.length);i[0]=r[0];for(let l=1;l<t.length;l++)i[l]=i[l-1]+r[l];let n=new Array(t.length);n[0]=r[0]*r[0];for(let l=1;l<t.length;l++)n[l]=n[l-1]+r[l]*r[l];let s=new Array(t.length);s[t.length-1]=0;for(let l=t.length-2;l>=0;l--)s[l]=s[l+1]+r[l+1]*r[l+1];let a,o=-1,h=Number.MIN_VALUE;for(let l=0;l<t.length;l++)a=-1*(n[l]*s[l]>0?Math.log(n[l]*s[l]):0)+2*(i[l]*(1-i[l])>0?Math.log(i[l]*(1-i[l])):0),a>h&&(h=a,o=l);return o}Object.keys(Mp).forEach((t=>{Ep[t]=t}));const Qp={huang:Rp,intermodes:Ip,isodata:Cp,li:Bp,maxentropy:Tp,mean:Up,minerror:Pp,minimum:Op,moments:Xp,otsu:jp,percentile:Hp,renyientropy:qp,shanbhag:$p,triangle:Zp,yen:Wp},Kp={};function Jp(t={}){let{algorithm:e=Kp.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let r=Qp[e.toLowerCase()];if(r){let t=this.getHistogram();return r(t,this.size)}throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(Qp).forEach((t=>{Kp[t]=t}));const tw="threshold";function ew(t={}){let{algorithm:e=tw,threshold:r=.5,useAlpha:i=!0,invert:n=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),r=e===tw?fp(r,this.maxValue):Jp.call(this,t);let s=new Hy(this.width,this.height,{kind:"BINARY",parent:this}),a=0;if(this.alpha&&i)for(let o=0;o<this.data.length;o+=this.channels){let t=this.data[o]+(this.maxValue-this.data[o])*(this.maxValue-this.data[o+1])/this.maxValue;(n&&t<=r||!n&&t>=r)&&s.setBit(a),a++}else for(let o=0;o<this.data.length;o+=this.channels)(n&&this.data[o]<=r||!n&&this.data[o]>=r)&&s.setBit(a),a++;return s}function rw(t,e,r,i){let n=t.width,s=t.height,a=e.width,o=t.channels;for(let h=0;h<n;h++)for(let l=0;l<s;l++)for(let s=0;s<o;s++){let c=(l*n+h)*o+s,u=((i+l)*a+r+h)*o+s;e.data[u]=t.data[c]}}function iw(t={}){let{size:e=0,algorithm:r="copy",color:i}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===r){if(i.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=.001)}else i=pg()(this.channels,null);Array.isArray(e)||(e=[e,e]);let n=this.width+2*e[0],s=this.height+2*e[1],a=this.channels,o=Hy.createFrom(this,{width:n,height:s});rw(this,o,e[0],e[1]);for(let h=e[0];h<n-e[0];h++)for(let t=0;t<a;t++){let r=i[t]||o.data[(e[1]*n+h)*a+t];for(let i=0;i<e[1];i++)o.data[(i*n+h)*a+t]=r;r=i[t]||o.data[((s-e[1]-1)*n+h)*a+t];for(let i=s-e[1];i<s;i++)o.data[(i*n+h)*a+t]=r}for(let h=0;h<s;h++)for(let t=0;t<a;t++){let r=i[t]||o.data[(h*n+e[0])*a+t];for(let i=0;i<e[0];i++)o.data[(h*n+i)*a+t]=r;r=i[t]||o.data[(h*n+n-e[0]-1)*a+t];for(let i=n-e[0];i<n;i++)o.data[(h*n+i)*a+t]=r}return o}function nw(t=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=Hy.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function sw(t,e={}){const{interpolation:r=wp.nearestneighbor,width:i=this.width,height:n=this.height}=e;if("number"!==typeof t)throw new TypeError("degrees must be a number");const s=bp(r),a=t*Math.PI/180,o=Math.floor(Math.abs(i*Math.cos(a))+Math.abs(n*Math.sin(a))),h=Math.floor(Math.abs(n*Math.cos(a))+Math.abs(i*Math.sin(a))),l=Math.cos(-a),c=Math.sin(-a);let u=o/2,f=h/2;o%2===0?(u-=.5,h%2===0?f-=.5:f=Math.floor(f)):(u=Math.floor(u),h%2===0?f-=.5:f=Math.floor(f));const d=Math.floor(i/2-u),m=Math.floor(n/2-f);if(1===this.bitDepth){const t=new Hy(o,h,{kind:"BINARY",parent:this});switch(s){case wp.nearestneighbor:return ow(this,t,d,m,u,f,l,c);case wp.bilinear:return lw(this,t,d,m,u,f,l,c);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}else{const t=Hy.createFrom(this,{width:o,height:h});switch(s){case wp.nearestneighbor:return aw(this,t,d,m,u,f,l,c);case wp.bilinear:return hw(this,t,d,m,u,f,l,c);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}}function aw(t,e,r,i,n,s,a,o){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1)for(let c=0;c<t.channels;c++){let u=Math.round((h-n)*a-(l-s)*o+n)+r,f=Math.round((l-s)*a+(h-n)*o+s)+i;u<0||u>=t.width||f<0||f>=t.height?1===t.alpha&&c===t.channels-1?e.setValueXY(h,l,c,0):e.setValueXY(h,l,c,t.maxValue):e.setValueXY(h,l,c,t.getValueXY(u,f,c))}return e}function ow(t,e,r,i,n,s,a,o){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1){let c=Math.round((h-n)*a-(l-s)*o+n)+r,u=Math.round((l-s)*a+(h-n)*o+s)+i;(c<0||c>=t.width||u<0||u>=t.height||t.getBitXY(c,u))&&e.setBitXY(h,l)}return e}function hw(t,e,r,i,n,s,a,o){let h=t.width*t.channels;for(let l=0;l<e.height;l++)for(let c=0;c<e.width;c++){let u=(c-n)*a-(l-s)*o+n+r,f=(l-s)*a+(c-n)*o+s+i,d=0|u,m=0|f,g=u-d,p=f-m;for(let r=0;r<t.channels;r++)if(u<0||u>=t.width||f<0||f>=t.height)1===t.alpha&&r===t.channels-1?e.setValueXY(c,l,r,0):e.setValueXY(c,l,r,t.maxValue);else{let i=(m*t.width+d)*t.channels+r,n=t.data[i],s=t.data[i+t.channels],a=t.data[i+h],o=t.data[i+h+t.channels],u=n+g*(s-n)+p*(a-n)+g*p*(n-s-a+o)|0;e.setValueXY(c,l,r,u)}}return e}function lw(t,e,r,i,n,s,a,o){let h=t.width;for(let l=0;l<e.height;l++)for(let c=0;c<e.width;c++){let u=(c-n)*a-(l-s)*o+n+r,f=(l-s)*a+(c-n)*o+s+i,d=0|u,m=0|f,g=u-d,p=f-m;if(u<0||u>=t.width||f<0||f>=t.height)e.setBitXY(c,l);else{let r=m*t.width+d,i=t.getBit(r),n=t.getBit(r+1),s=t.getBit(r+h),a=t.getBit(r+1+h),o=i|g&n-i|p&s-i|g&p&i-n-s+a;o>0&&e.setBitXY(c,l)}}return e}function cw(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!==typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return fw.call(this);case 180:return dw.call(this);case 270:return uw.call(this);default:return sw.call(this,t,e)}}function uw(){if(1===this.bitDepth){const t=new Hy(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)this.getBitXY(i,r)&&t.setBitXY(r,e-i);return t}{const t=Hy.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)for(let n=0;n<this.channels;n++)t.setValueXY(r,e-i,n,this.getValueXY(i,r,n));return t}}function fw(){if(1===this.bitDepth){const t=new Hy(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)this.getBitXY(i,r)&&t.setBitXY(e-r,i);return t}{const t=Hy.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)for(let n=0;n<this.channels;n++)t.setValueXY(e-r,i,n,this.getValueXY(i,r,n));return t}}function dw(){if(1===this.bitDepth){const t=new Hy(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,r=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)this.getBitXY(n,i)&&t.setBitXY(e-n,r-i);return t}{const t=Hy.createFrom(this),e=t.width-1,r=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)for(let s=0;s<this.channels;s++)t.setValueXY(e-n,r-i,s,this.getValueXY(n,i,s));return t}}function mw(t,e={}){const r=vm(t);this.checkProcessable("insert",r);let{x:i=0,y:n=0}=e;const s=km(this,e,{copy:!0}),a=Math.min(s.height,n+t.height),o=Math.min(s.width,i+t.width);if(1===s.bitDepth)for(let h=n;h<a;h++)for(let e=i;e<o;e++){const r=t.getBitXY(e-i,h-n);r?s.setBitXY(e,h):s.clearBitXY(e,h)}else for(let h=n;h<a;h++)for(let e=i;e<o;e++)s.setPixelXY(e,h,t.getPixelXY(e-i,h-n));return s}function gw(t={}){let{size:e=0,algorithm:r="copy",color:i}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===r){if(i.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=.001)}else i=pg()(this.channels,null);Array.isArray(e)||(e=[e,e]);let n=e[0],s=e[1],a=this.channels;for(let o=n;o<this.width-n;o++)for(let t=0;t<a;t++){let e=i[t]||this.data[(o+this.width*s)*a+t];for(let r=0;r<s;r++)this.data[(r*this.width+o)*a+t]=e;e=i[t]||this.data[(o+this.width*(this.height-s-1))*a+t];for(let r=this.height-s;r<this.height;r++)this.data[(r*this.width+o)*a+t]=e}for(let o=0;o<this.height;o++)for(let t=0;t<a;t++){let e=i[t]||this.data[(o*this.width+n)*a+t];for(let r=0;r<n;r++)this.data[(o*this.width+r)*a+t]=e;e=i[t]||this.data[(o*this.width+this.width-n-1)*a+t];for(let r=this.width-n;r<this.width;r++)this.data[(o*this.width+r)*a+t]=e}return this}function pw(t={}){let{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new om([this.clone()]);let r=new om,i=this.data;if(this.alpha&&e)for(let n=0;n<this.components;n++){let t=Hy.createFrom(this,{components:1,alpha:!0,colorModel:ka}),e=0;for(let r=0;r<i.length;r+=this.channels)t.data[e++]=i[r+n],t.data[e++]=i[r+this.components];r.push(t)}else for(let n=0;n<this.channels;n++){let t=Hy.createFrom(this,{components:1,alpha:!1,colorModel:ka}),e=0;for(let r=0;r<i.length;r+=this.channels)t.data[e++]=i[r+n];r.push(t)}return r}function ww(t,e={}){let{keepAlpha:r=!1,mergeAlpha:i=!1}=e;r&=this.alpha,i&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=Lm(this,t);let n=Hy.createFrom(this,{components:1,alpha:r,colorModel:ka}),s=0;for(let a=0;a<this.data.length;a+=this.channels)i?n.data[s++]=this.data[a+t]*this.data[a+this.components]/this.maxValue:(n.data[s++]=this.data[a+t],r&&(n.data[s++]=this.data[a+this.components]));return n}function bw(t=yw,e={}){let{mergeAlpha:r=!1,keepAlpha:i=!1}=e;r&=this.alpha,i&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let n=Hy.createFrom(this,{components:1,alpha:i,colorModel:ka}),s=0;for(let a=0;a<this.size;a++){let e=t(this.getPixel(a));r?n.data[s++]=e*this.data[a*this.channels+this.components]/this.maxValue:(n.data[s++]=e,i&&(n.data[s++]=this.data[a*this.channels+this.components]))}return n}function yw(t){return(t[0]+t[1]+t[2])/3}function _w(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");t=Lm(this,t);let r=t;for(let i=0;i<e.data.length;i++)this.data[r]=e.data[i],r+=this.channels;return this}function vw(t,e={}){let{shift:r=[0,0],average:i,channels:n,defaultAlpha:s,normalize:a,border:o=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(o)||(o=[o,o]),n=Pm(this,{channels:n,defaultAlpha:s}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");"undefined"===typeof i&&(i=!0);let h=Math.max(o[0],-r[0]),l=Math.min(this.width-o[0],this.width-r[0]),c=Math.max(o[1],-r[1]),u=Math.min(this.height-o[1],this.height-r[1]),f=pg()(n.length,0);for(let d=0;d<n.length;d++){let e=n[d],i=a?this.sum[e]:Math.max(this.sum[e],t.sum[e]),s=a?t.sum[e]:Math.max(this.sum[e],t.sum[e]);if(0!==i&&0!==s)for(let n=h;n<l;n++)for(let a=c;a<u;a++){let o=n*this.multiplierX+a*this.multiplierY+e,h=o+r[0]*this.multiplierX+r[1]*this.multiplierY;f[d]+=Math.min(this.data[o]/i,t.data[h]/s)}}return i?f.reduce(((t,e)=>t+e))/f.length:f}function xw(t={}){let{sampling:e=[10,10],painted:r=!1,mask:i}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const n=e[0],s=e[1],a=[],o=[],h=this.width/n,l=this.height/s;let c=Math.floor(h/2);for(let f=0;f<n;f++){let t=Math.floor(l/2);for(let e=0;e<s;e++){let e=Math.round(c),r=Math.round(t);i&&!i.getBitXY(e,r)||(a.push([e,r]),o.push(this.getPixelXY(e,r))),t+=l}c+=h}const u={xyS:a,zS:o};return r&&(u.painted=this.rgba8().paintPoints(a)),u}function kw(t,e,r){const i=new Array(t);for(let n=0;n<t;n++)i[n]=new Array(e);if(r)for(let n=0;n<t;n++)for(let t=0;t<e;t++)i[n][t]=r;return i.width=t,i.height=e,Object.setPrototypeOf(i,kw.prototype),i}function Aw(t,e={}){let{border:r}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let i=new kw(t.width,t.height,-1/0),n=Math.floor(t.width/2),s=Math.floor(t.height/2),a=n,o=s,h=!1;while(!h){let e=i.localSearch(n,s,-1/0);for(let n=0;n<e.length;n++){let s=e[n],h=this.getSimilarity(t,{border:r,shift:[a-s[0],o-s[1]]});i[s[0]][s[1]]=h}let l=i.localMax(n,s);l.position[0]!==n||l.position[1]!==s?(n=l.position[0],s=l.position[1]):h=!0}return[n-a,s-o]}function Mw(t,e=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),mp(this,t),pp(this,e);let r=new Array(this.width),i=0,n=t*this.width*this.channels+e,s=n+this.width*this.channels;for(let a=n;a<s;a+=this.channels)r[i++]=this.data[a];return r}function Ew(t,e=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),gp(this,t),pp(this,e);let r=new Array(this.height),i=0,n=this.width*this.channels;for(let s=e+t*this.channels;s<this.data.length;s+=n)r[i++]=this.data[s];return r}function Sw(t={}){let{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let r=new sg(this.height,this.width);for(let i=0;i<this.height;i++)for(let t=0;t<this.width;t++)r.set(i,t,this.getValueXY(t,i,e));return r}function Rw(t,e={}){t=new sg(t);let{channel:r}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===r){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");r=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let i=0;i<this.height;i++)for(let e=0;e<this.width;e++)this.setValueXY(e,i,r,t.get(i,e));return this}function Iw(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let r=0;r<this.data.length;r+=this.channels){let i=new Array(this.components);for(let t=0;t<this.components;t++)i[t]=this.data[r+t];t[e++]=i}return t}function Dw(t){let e=this,r=e.getClosestCommonParent(t),i=e.getRelativePosition(r,{defaultFurther:!0}),n=Cw(e,i),s=t.getRelativePosition(r,{defaultFurther:!0}),a=Cw(t,s),o=Bw(n,a),h={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let l=0;l<o.length;l++){let r=o[l],n=[r[0]-i[0],r[1]-i[1]],a=[r[0]-s[0],r[1]-s[1]],c=e.getBitXY(n[0],n[1]),u=t.getBitXY(a[0],a[1]);1===c&&1===u&&h.commonWhitePixels.push(r)}for(let l=0;l<n.length;l++){let t,r;0!==l&&(t=Math.floor(l/e.width),r=l%e.width),1===e.getBitXY(t,r)&&h.whitePixelsMask1.push(n[l])}for(let l=0;l<a.length;l++){let e=0,r=0;0!==l&&(e=Math.floor(l/t.width),r=l%t.width),1===t.getBitXY(e,r)&&h.whitePixelsMask2.push(a[l])}return h}function Cw(t,e){let r=[];for(let i=0;i<t.height;i++)for(let n=0;n<t.width;n++){let t=[i,n];r.push([t[0]+e[0],t[1]+e[1]])}return r}function Bw(t,e){let r=0,i=0,n=[];while(r<t.length&&i<e.length)t[r][0]===e[i][0]&&t[r][1]===e[i][1]?(n.push(t[r]),r++,i++):t[r][0]<e[i][0]||t[r][0]===e[i][0]&&t[r][1]<e[i][1]?r++:i++;return n}function Tw(t){let e,r=Uw(this),i=Uw(t);if(e=r>=i?Pw(this,r):Pw(t,i),0===r||0===i)return e;let n=this,s=t;while(r!==i)if(r>i){if(n=n.parent,null===n)return e;r-=1}else{if(s=s.parent,null===s)return e;i-=1}while(n!==s&&null!==n&&null!==s)if(n=n.parent,s=s.parent,null===n||null===s)return e;return n!==s?e:n}function Uw(t){let e=0,r=t;while(null!=r.parent)r=r.parent,e++;return e}function Pw(t,e){let r=t;while(e>0)r=r.parent,e-=1;return r}kw.prototype.localMin=function(t,e){let r=this[t][e],i=[t,e];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]<r&&(r=this[n][t],i=[n,t]);return{position:i,value:r}},kw.prototype.localMax=function(t,e){let r=this[t][e],i=[t,e];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]>r&&(r=this[n][t],i=[n,t]);return{position:i,value:r}},kw.prototype.localSearch=function(t,e,r){let i=[];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]===r&&i.push([n,t]);return i};const Fw={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},zw=[[-1,0,1],[-2,0,2],[-1,0,1]],Lw=[[-1,-2,-1],[0,0,0],[1,2,1]],Ow={bitDepth:32,mode:"periodic"};function Nw(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},Fw,e);const r=t.width,i=t.height,n=t.maxValue,s={sigma:e.gaussianBlur,radius:3},a=t.gaussianFilter(s),o=a.convolution(Lw,Ow),h=a.convolution(zw,Ow),l=h.hypotenuse(o),c=t.constructor,u=new c(r,i,{kind:"GREY",bitDepth:32}),f=new c(r,i,{kind:"GREY",bitDepth:32}),d=new c(r,i,{kind:"GREY"});for(var m=1;m<r-1;m++)for(var g=1;g<i-1;g++){var p=(Math.round(Math.atan2(h.getValueXY(m,g,0),o.getValueXY(m,g,0))*(5/Math.PI))+5)%5;0===p&&(l.getValueXY(m,g,0)<=l.getValueXY(m,g-1,0)||l.getValueXY(m,g,0)<=l.getValueXY(m,g+1,0))||1===p&&(l.getValueXY(m,g,0)<=l.getValueXY(m-1,g+1,0)||l.getValueXY(m,g,0)<=l.getValueXY(m+1,g-1,0))||2===p&&(l.getValueXY(m,g,0)<=l.getValueXY(m-1,g,0)||l.getValueXY(m,g,0)<=l.getValueXY(m+1,g,0))||3===p&&(l.getValueXY(m,g,0)<=l.getValueXY(m-1,g-1,0)||l.getValueXY(m,g,0)<=l.getValueXY(m+1,g+1,0))||u.setValueXY(m,g,0,l.getValueXY(m,g,0))}for(m=0;m<r*i;++m){var w=u.data[m],b=0;w>e.highThreshold&&(b++,d.data[m]=n),w>e.lowThreshold&&b++,f.data[m]=b}var y=[];for(m=1;m<r-1;++m)for(g=1;g<i-1;++g)if(1===f.getValueXY(m,g,0))t:for(var _=m-1;_<m+2;++_)for(var v=g-1;v<g+2;++v)if(2===f.getValueXY(_,v,0)){y.push([m,g]),d.setValueXY(m,g,0,n);break t}while(y.length>0){var x=[];for(m=0;m<y.length;++m)for(g=-1;g<2;++g)for(_=-1;_<2;++_)if(0!==g||0!==_){var k=y[m][0]+g,A=y[m][1]+_;1===f.getValueXY(k,A,0)&&0===d.getValueXY(k,A,0)&&(x.push([k,A]),d.setValueXY(k,A,0,n))}y=x}return d}function Yw(t){return Nw(this,t)}function Vw(t,e={}){let{position:r}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!r&&(r=t.getRelativePosition(this),!r))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=Hy.createFrom(this,{width:t.width,height:t.height,alpha:1,position:r,parent:this});for(let i=0;i<t.width;i++)for(let n=0;n<t.height;n++){for(let t=0;t<this.channels;t++){let s=this.getValueXY(i+r[0],n+r[1],t);e.setValueXY(i,n,t,s)}t.getBitXY(i,n)||e.setValueXY(i,n,this.components,0)}return e}{let e=Hy.createFrom(this,{width:t.width,height:t.height,position:r,parent:this});for(let i=0;i<t.height;i++)for(let n=0;n<t.width;n++)t.getBitXY(n,i)&&this.getBitXY(n+r[0],i+r[1])&&e.setBitXY(n,i);return e}}var Xw=r(13578),jw=r.n(Xw);function Hw(t={}){const{x:e=0,y:r=0,inPlace:i=!0}=t,n=i?this:Hy.createFrom(this);this.checkProcessable("floodFill",{bitDepth:1});const s=this.getBitXY(e,r);if(s)return n;const a=new(jw());a.push(new Gw(e,r));while(a.length>0){const t=a.shift();n.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width;e++){if(n.getBitXY(e,t.y)||this.getBitXY(e,t.y))break;n.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&a.push(new Gw(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&a.push(new Gw(e,t.y-1))}for(let e=t.x-1;e>=0;e++){if(n.getBitXY(e,t.y)||this.getBitXY(e,t.y))break;n.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&a.push(new Gw(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&a.push(new Gw(e,t.y-1))}}return n}function Gw(t,e){this.x=t,this.y=e}function qw(){return qw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)({}).hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},qw.apply(null,arguments)}function $w(t,e,r){e/=100,r/=100;var i=[],n=r*e,s=t/60,a=n*(1-Math.abs(s%2-1)),o=r-n;return i=s>=0&&s<1?[n,a,0]:s>=1&&s<2?[a,n,0]:s>=2&&s<3?[0,n,a]:t>=3&&s<4?[0,a,n]:t>=4&&s<5?[a,0,n]:t>=5&&s<=6?[n,0,a]:[0,0,0],{r:Math.round(255*(i[0]+o)),g:Math.round(255*(i[1]+o)),b:Math.round(255*(i[2]+o))}}function Zw(t,e,r){return e*=(r<50?r:100-r)/100,{h:t,s:2*e/(r+e)*100,v:r+e}}function Ww(t,e,r){var i=Zw(t,e,r);return $w(i.h,i.s,i.v)}var Qw={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function Kw(t){return Jw(t)||ib(t)||rb(t)||tb(t)||eb(t)||nb(t)||sb(t)}function Jw(t){var e=Qw[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}function tb(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */).map(Number);return{r:r[0],g:r[1],b:r[2],a:100}}}function eb(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */).map(Number);return{r:r[0],g:r[1],b:r[2],a:100*r[3]}}}function rb(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}function ib(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}function nb(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */),i=parseInt(r[0],10),n=parseInt(r[1],10),s=parseInt(r[2],10),a=Ww(i,n,s);return qw({},a,{a:100})}}function sb(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */),i=parseInt(r[0],10),n=parseInt(r[1],10),s=parseInt(r[2],10),a=parseInt(100*parseFloat(r[3]),10),o=Ww(i,n,s);return qw({},o,{a:a})}}function ab(t){let e=Kw(t);return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function ob(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function hb(t,e,r){let i,n,s,a,o,h;return e/=100,r/=100,0===e?a=o=h=255*r:(n=r<=.5?r*(e+1):r+e-r*e,i=2*r-n,s=t/360,a=ob(i,n,s+1/3),o=ob(i,n,s),h=ob(i,n,s-1/3)),{r:a,g:o,b:h}}function lb(t){let e=new Array(t),r=0;for(let i=0;i<360;i+=360/t){r++;let t=hb(i,100,30+r%4*15);e[r-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}function cb(){return[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}function ub(t){let{color:e,colors:r,randomColors:i,numberColors:n=50}=t;if(e&&!Array.isArray(e)&&(e=ab(e)),e)return[e];if(r)return r=r.map((function(t){return Array.isArray(t)?t:ab(t)})),r;if(i){r=new Array(n);for(let t=0;t<n;t++)r[t]=cb()}return lb(n)}function fb(t,e,r={}){let{color:i="blue",colors:n,font:s="12px Helvetica",rotate:a=0}=r;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:Aa}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(i&&!Array.isArray(i)&&(i=ab(i)),n=n?n.map((function(t){return Array.isArray(t)?t:ab(t)})):[i],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]);let o=this.getCanvas(),h=o.getContext("2d");for(let l=0;l<t.length;l++){h.save();let r=n[l%n.length];h.fillStyle=`rgba(${r[0]},${r[1]},${r[2]},${r[3]/this.maxValue})`,h.font=s[l%s.length];let i=e[l];h.translate(i[0],i[1]),h.rotate(a[l%a.length]/180*Math.PI),h.fillText(t[l],0,0),h.restore()}return this.data=Uint8Array.from(h.getImageData(0,0,this.width,this.height).data),this}function db(t,e={}){let{alpha:r=255,labels:i=[],labelsPosition:n=[],labelColor:s="blue",labelFont:a="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:Aa});let o=ub(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let h=0;h<t.length;h++){let e=t[h],i=o[h%o.length];for(let t=0;t<e.width;t++)for(let n=0;n<e.height;n++)if(e.getBitXY(t,n))for(let s=0;s<Math.min(this.components,i.length);s++)if(255===r)this.setValueXY(t+e.position[0],n+e.position[1],s,i[s]);else{let a=this.getValueXY(t+e.position[0],n+e.position[1],s);a=Math.round((a*(255-r)+i[s]*r)/255),this.setValueXY(t+e.position[0],n+e.position[1],s,a)}}if(Array.isArray(i)&&i.length>0){let e=this.getCanvas(),r=e.getContext("2d");r.fillStyle=s,r.font=a;for(let s=0;s<Math.min(t.length,i.length);s++){let e=n[s]?n[s]:t[s].position;r.fillText(i[s],e[0],e[1])}this.data=Uint8Array.from(r.getImageData(0,0,this.width,this.height).data)}return this}function mb(t,e){let r=new Array(t);for(let i=0;i<t;i++)r[i]=new Array(e).fill(0);return r}const gb=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],pb=[[0,1,0],[1,1,1],[0,1,0]];class wb{constructor(t={}){let{kind:e="cross",shape:r,size:i,width:n,height:s,filled:a=!0}=t;if(i&&(n=i,s=i),r)switch(r.toLowerCase()){case"square":case"rectangle":this.matrix=bb(n,s,{filled:a});break;case"circle":case"ellipse":this.matrix=yb(n,s,{filled:a});break;case"triangle":this.matrix=_b(n,s,{filled:a});break;default:throw new Error(`Shape: unexpected shape: ${r}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=gb;break;case"smallcross":this.matrix=pb;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2|0,this.halfWidth=this.width/2|0}getPoints(){let t=this.matrix,e=[];for(let r=0;r<t.length;r++)for(let i=0;i<t[0].length;i++)t[r][i]&&e.push([i-this.halfWidth,r-this.halfHeight]);return e}getMask(){let t=new Hy(this.width,this.height,{kind:Fa});for(let e=0;e<this.matrix.length;e++)for(let r=0;r<this.matrix[0].length;r++)this.matrix[e][r]&&t.setBitXY(r,e);return t}}function bb(t,e,r){const i=mb(e,t);if(r.filled)for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[n][e]=1;else{for(let r of[0,e-1])for(let e=0;e<t;e++)i[r][e]=1;for(let r=0;r<e;r++)for(let e of[0,t-1])i[r][e]=1}return i}function yb(t,e,r){const i=mb(e,t,r);let n=1-e%2,s=1-t%2,a=Math.floor((t-1)/2),o=Math.floor((e-1)/2),h=a*a,l=o*o;if(r.filled)for(let c=0;c<=o;c++){let e=Math.floor(Math.sqrt(h-h*c*c/l));for(let r=a-e;r<=a;r++)i[o-c][r]=1,i[o+c+n][r]=1,i[o-c][t-r-1]=1,i[o+c+n][t-r-1]=1}else{for(let e=0;e<=o;e++){let r=Math.floor(Math.sqrt(h-h*e*e/l)),s=a-r;i[o-e][s]=1,i[o+e+n][s]=1,i[o-e][t-s-1]=1,i[o+e+n][t-s-1]=1}for(let t=0;t<=a;t++){let r=Math.floor(Math.sqrt(l-l*t*t/h)),n=o-r;i[n][a-t]=1,i[n][a+t+s]=1,i[e-n-1][a-t]=1,i[e-n-1][a+t+s]=1}}return i}function _b(t,e,r){if(!r.filled)throw new Error("Non filled triangle is not implemented");const i=mb(e,t,r);for(let n=0;n<e;n++){let r=Math.floor((1-n/e)*t/2);for(let e=r;e<t-r;e++)i[n][e]=1}return i}function vb(t,e={}){let{shape:r}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let i=ub(Object.assign({},e,{numberColors:t.length})),n=new wb(r).getPoints(),s=Math.min(this.channels,i[0].length);for(let a=0;a<t.length;a++){let e=i[a%i.length],r=t[a][0],o=t[a][1];for(let t=0;t<n.length;t++){let i=n[t][0],a=n[t][1];if(r+i>=0&&o+a>=0&&r+i<this.width&&o+a<this.height){let t=(r+i+(o+a)*this.width)*this.channels;for(let r=0;r<s;r++)this.data[t+r]=e[r]}}}return this}function xb(t,e={}){let{color:r=[this.maxValue,0,0],closed:i=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let n=Math.min(this.channels,r.length);for(let s=0;s<t.length-1+i;s++){let e=t[s],i=t[(s+1)%t.length],a=i[0]-e[0],o=i[1]-e[1],h=Math.max(Math.abs(a),Math.abs(o)),l=a/h,c=o/h,u=e[0],f=e[1];for(let t=0;t<=h;t++){let t=Math.round(u),e=Math.round(f);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let i=(t+e*this.width)*this.channels;for(let t=0;t<n;t++)this.data[i+t]=r[t]}u+=l,f+=c}}return this}function kb(t,e={}){let r=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let i=ub(Object.assign({},e,{numberColors:t.length}));for(let n=0;n<t.length;n++)r.color=i[n%i.length],this.paintPolyline(t[n],r);return this}function Ab(t,e={}){let{color:r=[this.maxValue,0,0],filled:i=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let n=Mb(t);if(!1===i)return this.paintPolyline(t,e);{let i=Array(this.height);for(let t=0;t<this.height;t++){i[t]=[];for(let e=0;e<this.width;e++)i[t].push(0)}for(let t=0;t<n.length;t++){const e=Eb(n[t],n[(t+1)%n.length]);for(let t=0;t<this.height;t++)for(let r=0;r<this.width;r++)Sb(r,t,e,this.height)&&(i[t][r]=0===i[t][r]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===i[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let i=Math.min(this.channels,r.length),n=(e+t*this.width)*this.channels;for(let t=0;t<i;t++)this.data[n+t]=r[t]}return this.paintPolyline(t,e)}}function Mb(t){let e=[];for(let r=0;r<t.length;r++)t[r][0]===t[(r+1)%t.length][0]&&t[r][1]===t[(r+1)%t.length][1]||t[r][0]===t[(r-1+t.length)%t.length][0]&&t[r][1]===t[(r-1+t.length)%t.length][1]||t[(r+1)%t.length][0]===t[(r-1+t.length)%t.length][0]&&t[(r-1+t.length)%t.length][1]===t[(r+1)%t.length][1]||e.push(t[r]);return e}function Eb(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const r=(e[1]-t[1])/(e[0]-t[0]),i=t[1]-r*t[0];return{a:r,b:i,vertical:!1}}}function Sb(t,e,r,i){if(!0===r.vertical)return r.b<=t;if(0===r.a)return!1;{const n=(e-r.b)/r.a;return n<t&&n>=0&&n<=i}}function Rb(t,e={}){let r=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let i=ub(Object.assign({},e,{numberColors:t.length}));for(let n=0;n<t.length;n++)r.color=i[n%i.length],this.paintPolygon(t[n],r);return this}function Ib(t={}){let{maxSlots:e=256,channel:r,useAlpha:i=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===r){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");r=0}return Cb.call(this,r,{useAlpha:i,maxSlots:e})}function Db(t={}){const{maxSlots:e=256,useAlpha:r=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let i=new Array(r?this.components:this.channels);for(let n=0;n<i.length;n++)i[n]=Cb.call(this,n,{useAlpha:r,maxSlots:e});return i}function Cb(t,e){let{useAlpha:r,maxSlots:i}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let i=this.getBitXY(e,r);0===i?t[0]+=1:1===i&&(t[1]+=1)}return t}let n=Math.log2(i);if(!Km()(n))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let s=0;this.bitDepth>n&&(s=this.bitDepth-n);let a=this.data,o=pg()(Math.pow(2,Math.min(this.bitDepth,n)),0);if(r&&this.alpha){let e=this.channels-t-1;for(let r=t;r<a.length;r+=this.channels)o[a[r]>>s]+=a[r+e]/this.maxValue}else for(let h=t;h<a.length;h+=this.channels)o[a[h]>>s]++;return o}function Bb(t={}){let{useAlpha:e=!0,nbSlots:r=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let i=Math.log(r)/Math.log(8);if(i!==Math.floor(i))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let n=this.bitDepth-i,s=this.data,a=pg()(Math.pow(8,i),0),o=Math.pow(2,2*i),h=Math.pow(2,i);for(let l=0;l<s.length;l+=this.channels){let t=(s[l]>>n)*o+(s[l+1]>>n)*h+(s[l+2]>>n);e&&this.alpha?a[t]+=s[l+this.channels-1]/this.maxValue:a[t]++}return a}function Tb(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=pg()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)this.data[e+r]<t[r]&&(t[r]=this.data[e+r]);return t}function Ub(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=pg()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)this.data[e+r]>t[r]&&(t[r]=this.data[e+r]);return t}function Pb(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=pg()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)t[r]+=this.data[e+r];return t}function Fb(t=0,e=0){this.checkProcessable("getMoment",{bitDepth:[1]});let r=0;for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++)1===this.getBitXY(i,n)&&(r+=i**t*n**e);return r}function zb(t={}){let{mask:e,region:r=3,removeClosePoints:i=0,invert:n=!1,maxEquals:s=2}=t,a=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),r*=4;let o=n?0:1,h=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],l=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],c=r<=8?1:2,u=[];for(let f=c;f<a.height-c;f++)for(let t=c;t<a.width-c;t++){if(e&&e.getBitXY(t,f)!==o)continue;let i=0,c=0,d=a.data[t+f*a.width];for(let e=0;e<r;e++)n?a.data[t+h[e]+(f+l[e])*a.width]>d&&i++:a.data[t+h[e]+(f+l[e])*a.width]<d&&i++,a.data[t+h[e]+(f+l[e])*a.width]===d&&c++;i+c===r&&c<=s&&u.push([t,f])}if(i>0)for(let f=0;f<u.length;f++)for(let t=f+1;t<u.length;t++)Math.sqrt(Math.pow(u[f][0]-u[t][0],2)+Math.pow(u[f][1]-u[t][1],2))<i&&(u[f][0]=u[f][0]+u[t][0]>>1,u[f][1]=u[f][1]+u[t][1]>>1,u.splice(t,1),t--);return u}function Lb(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let r=0;r<t.length;r++){let i=t[r];e[r]=Kd(i)}return e}function Ob(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let r=0;r<t.length;r++){let i=t[r];e[r]=Qd(i)}return e}function Nb(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)1===this.getBitXY(e,r)&&t.push([e,r]);return t}function Yb(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++)if(1===this.getBitXY(r,e)){t.push([r,e]),1!==this.getBitXY(r+1,e)?(t.push([r+1,e]),t.push([r+1,e+1]),1!==this.getBitXY(r,e+1)&&t.push([r,e+1])):1!==this.getBitXY(r,e+1)&&(t.push([r,e+1]),t.push([r+1,e+1]));while(r<this.width-2&&1===this.getBitXY(r+1,e)&&1===this.getBitXY(r+2,e))r++}return t}function Vb(t,e={}){if(this===t)return[0,0];let r=[0,0],i=this;while(i){if(i===t)return r;i.position&&(r[0]+=i.position[0],r[1]+=i.position[1]),i=i.parent}return!!e.defaultFurther&&r}function Xb(t={}){let{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let r=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&r++;return r}return this.size}function jb(t,e={}){const{sorted:r}=e;r||(t=t.slice().sort(Gb));const i=t.length,n=new Array(2*i);let s=0;for(let o=0;o<i;o++){const e=t[o];while(s>=2&&Hb(n[s-2],n[s-1],e)<=0)s--;n[s++]=e}const a=s+1;for(let o=i-2;o>=0;o--){const e=t[o];while(s>=a&&Hb(n[s-2],n[s-1],e)<=0)s--;n[s++]=e}return n.slice(0,s-1)}function Hb(t,e,r){return(e[1]-t[1])*(r[0]-t[0])-(e[0]-t[0])*(r[1]-t[1])}function Gb(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function qb(){return jb(this.extendedPoints,{sorted:!1})}function $b(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}function Zb(t,e){return[t[0]-e[0],t[1]-e[1]]}function Wb(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function Qb(t,e,r){void 0===r&&(r=new Array(e.length));let i=Math.cos(t),n=Math.sin(t);for(let s=0;s<r.length;++s)r[s]=[i*e[s][0]-n*e[s][1],n*e[s][0]+i*e[s][1]];return r}function Kb(t){let e=0;for(let r=0;r<t.length;r++){let i=t[r][0],n=t[r][1],s=t[r===t.length-1?0:r+1][0],a=t[r===t.length-1?0:r+1][1];e+=Math.sqrt((s-i)**2+(a-n)**2)}return e}function Jb(t){let e=0;for(let r=0;r<t.length;r++){let i=t[r][0],n=t[r===t.length-1?0:r+1][1],s=t[r===t.length-1?0:r+1][0],a=t[r][1];e+=i*n*.5,e-=s*a*.5}return Math.abs(e)}function ty(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let s=0;s<t.length;s++)t[s][0]<e&&(e=t[s][0]),t[s][0]>i&&(i=t[s][0]),t[s][1]<r&&(r=t[s][1]),t[s][1]>n&&(n=t[s][1]);return[[e,r],[i,n]]}function ey(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let r=ty(t),i=r[0][0],n=r[0][1];for(let s=0;s<t.length;s++)e[s][0]=t[s][0]-i,e[s][1]=t[s][1]-n;return e}function ry(t={}){const{originalPoints:e=qb.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const r=new Array(e.length);let i,n=1/0,s=0;for(let a=0;a<r.length;a++){let t=iy(e[a],e[(a+1)%r.length]);Qb(-t,e,r);let o=r[a][0],h=r[a][1],l=r[(a+1)%r.length][0],c=r[(a+1)%r.length][1],u=!0,f=0,d=0,m=0;for(let e=0;e<r.length;e++){let t=r[e][0],i=r[e][1],n=(t-o)/(l-o);!0===u?(u=!1,f=n,d=n):(n<f&&(f=n),n>d&&(d=n));let s=(-(l-o)*i+l*h-c*o)/(l-o);Math.abs(s)>Math.abs(m)&&(m=s)}let g=[o+f*(l-o),h],p=[o+d*(l-o),h],w=Math.abs(m*(f-d)*(l-o));w<n&&(s=t,n=w,i=[g,p,[p[0],p[1]-m],[g[0],g[1]-m]])}return Qb(s,i,i),i}function iy(t,e){let r=Zb(e,t),i=Wb(r),n=Math.acos(i[0]);return i[1]<0?-n:n}function ny(t){let e={inPlace:!0};t.extendMethod("invert",Sm),t.extendMethod("abs",Am),t.extendMethod("level",wg,e),t.extendMethod("add",xg,e),t.extendMethod("subtract",kg,e),t.extendMethod("subtractImage",Ag),t.extendMethod("multiply",Eg,e),t.extendMethod("divide",Sg,e),t.extendMethod("hypotenuse",Mg),t.extendMethod("background",Ug),t.extendMethod("flipX",Dm),t.extendMethod("flipY",Cm),t.extendMethod("blurFilter",Bm),t.extendMethod("medianFilter",Om),t.extendMethod("gaussianFilter",Nm),t.extendMethod("sobelFilter",dg),t.extendMethod("gradientFilter",fg),t.extendMethod("scharrFilter",mg),t.extendMethod("dilate",Pg),t.extendMethod("erode",Ng),t.extendMethod("open",Hg),t.extendMethod("close",Gg),t.extendMethod("topHat",qg),t.extendMethod("blackHat",$g),t.extendMethod("morphologicalGradient",Zg),t.extendMethod("warpingFourPoints",rp),t.extendMethod("crop",ip),t.extendMethod("cropAlpha",ap),t.extendMethod("resize",_p).extendMethod("scale",_p),t.extendMethod("hsv",vp),t.extendMethod("hsl",xp),t.extendMethod("cmyk",kp),t.extendMethod("rgba8",Ap),t.extendMethod("grey",Sp).extendMethod("gray",Sp),t.extendMethod("mask",ew),t.extendMethod("pad",iw),t.extendMethod("colorDepth",nw),t.extendMethod("setBorder",gw,e),t.extendMethod("rotate",cw),t.extendMethod("rotateLeft",uw),t.extendMethod("rotateRight",fw),t.extendMethod("insert",mw),t.extendMethod("getRow",Mw),t.extendMethod("getColumn",Ew),t.extendMethod("getMatrix",Sw),t.extendMethod("setMatrix",Rw),t.extendMethod("getPixelsArray",Iw),t.extendMethod("getIntersection",Dw),t.extendMethod("getClosestCommonParent",Tw),t.extendMethod("getThreshold",Jp),t.extendMethod("split",pw),t.extendMethod("getChannel",ww),t.extendMethod("combineChannels",bw),t.extendMethod("setChannel",_w),t.extendMethod("getSimilarity",vw),t.extendMethod("getPixelsGrid",xw),t.extendMethod("getBestMatch",Aw),t.extendMethod("cannyEdge",Yw),t.extendMethod("convolution",ug),t.extendMethod("extract",Vw),t.extendMethod("floodFill",Hw),t.extendMethod("paintLabels",fb,e),t.extendMethod("paintMasks",db,e),t.extendMethod("paintPoints",vb,e),t.extendMethod("paintPolyline",xb,e),t.extendMethod("paintPolylines",kb,e),t.extendMethod("paintPolygon",Ab,e),t.extendMethod("paintPolygons",Rb,e),t.extendMethod("countAlphaPixels",Xb),t.extendMethod("monotoneChainConvexHull",qb),t.extendMethod("minimalBoundingRectangle",ry),t.extendMethod("getHistogram",Ib).extendProperty("histogram",Ib),t.extendMethod("getHistograms",Db).extendProperty("histograms",Db),t.extendMethod("getColorHistogram",Bb).extendProperty("colorHistogram",Bb),t.extendMethod("getMin",Tb).extendProperty("min",Tb),t.extendMethod("getMax",Ub).extendProperty("max",Ub),t.extendMethod("getSum",Pb).extendProperty("sum",Pb),t.extendMethod("getMoment",Fb).extendProperty("moment",Fb),t.extendMethod("getLocalMaxima",zb),t.extendMethod("getMedian",Ob).extendProperty("median",Ob),t.extendMethod("getMean",Lb).extendProperty("mean",Lb),t.extendMethod("getPoints",Nb).extendProperty("points",Nb),t.extendMethod("getExtendedPoints",Yb).extendProperty("extendedPoints",Yb),t.extendMethod("getRelativePosition",Vb)}r(17642),r(58004),r(33853),r(45876),r(32475),r(15024),r(31698);var sy=r(3737),ay=r.n(sy);function oy(t,e=""){let r=e.split(".");for(let i of r){if(void 0===t[i])return;t=t[i]}return t}var hy=r(24113),ly=r.n(hy);function cy(t={}){const{originalPoints:e=qb.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const r=new Array(e.length);let i=1/0,n=0,s=[];for(let l=0;l<e.length;l++){let t=uy(e[l],e[(l+1)%e.length]);Qb(-t,e,r);let a=0,o=[];for(let i=0;i<e.length;i++){let t=Math.abs(r[l][1]-r[i][1]);t>a&&(a=t,o=[],o.push([r[i][0],r[l][1]],[r[i][0],r[i][1]]))}a<i&&(i=a,n=t,s=o)}Qb(n,s,s);let a=0,o=[],h=0;for(let l=0;l<e.length-1;l++)for(let t=l+1;t<e.length;t++){let r=(e[l][0]-e[t][0])**2+(e[l][1]-e[t][1])**2;r>h&&(h=r,a=Math.sqrt(r),o=[e[l],e[t]])}return{min:i,minLine:s,max:a,maxLine:o,aspectRatio:i/a}}function uy(t,e){let r=Zb(e,t),i=Wb(r),n=Math.acos(i[0]);return i[1]<0?-n:n}class fy{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(t={}){const{scale:e=1,kind:r=""}=t;let i;switch(r){case"contour":i=this.contourMask;break;case"box":i=this.boxMask;break;case"filled":i=this.filledMask;break;case"center":i=this.centerMask;break;case"mbr":i=this.mbrFilledMask;break;case"hull":i=this.convexHullFilledMask;break;case"hullContour":i=this.convexHullMask;break;case"mbrContour":i=this.mbrMask;break;case"feret":i=this.feretMask;break;default:i=this.mask}return e<1&&(i=i.resize({factor:e}),i.parent=this.mask.parent,i.position[0]+=this.minX,i.position[1]+=this.minY),i}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2|0,this.height/2|0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let r=this.internalIDs;for(let i=0;i<t.length;i++)r.includes(t[i])||(this.computed.externalIDs.push(t[i]),this.computed.externalLengths.push(e[i]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=dy(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=my(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=_y(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=gy(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=by(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=yy(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=py(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new Hy(this.width,this.height,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&r>0&&r<this.height-1&&this.map.data[e-1+this.minX+(r+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(r+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(r-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(r+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,r));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new Hy(this.width,this.height,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new Hy(this.width,this.height,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&t.setBitXY(e,r);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new Hy(this.width,this.height,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++){let i=e+this.minX+(r+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[i])&&t.setBitXY(e,r)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new wb({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let r=0;r<this.width;r++)for(let e=0;e<this.height;e++)this.map.data[r+this.minX+(e+this.minY)*this.map.width]===this.id&&(r>0&&r<this.width-1&&e>0&&e<this.height-1&&this.map.data[r-1+this.minX+(e+this.minY)*this.map.width]===this.id&&this.map.data[r+1+this.minX+(e+this.minY)*this.map.width]===this.id&&this.map.data[r+this.minX+(e-1+this.minY)*this.map.width]===this.id&&this.map.data[r+this.minX+(e+1+this.minY)*this.map.width]===this.id||(t.push([r,e]),t.push([r+1,e]),t.push([r,e+1]),t.push([r+1,e+1])));const e=jb(t);this.computed.convexHull={polyline:e,surface:Jb(e),perimeter:Kb(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new Hy(this.width+1,this.height+1,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new Hy(this.width,this.height,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});for(let r=0;r<this.width;r++)for(let i=0;i<this.height;i++)1!==ly()(t.polyline,[r,i])&&e.setBitXY(r,i);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=ry({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],r=t[1],i=t[2],n=Math.sqrt((e[0]-r[0])**2+(e[1]-r[1])**2),s=Math.sqrt((i[0]-r[0])**2+(i[1]-r[1])**2);this.computed.mbr={width:n,height:s,elongation:1-n/s,aspectRatio:n/s,surface:n*s,perimeter:2*(n+s),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=cy({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=wy(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new Hy(this.width+1,this.height+1,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=$b(this.mbr.rectangle);if(t.length>0){const e=ty(t),r=new Hy(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:Fa,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=ey(t),r.paintPolyline(t,{closed:!0}),this.computed.mbrMask=r}else this.computed.mbrMask=new Hy(1,1,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new Hy(this.width,this.height,{kind:Fa,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let r=0;r<this.width;r++)for(let i=0;i<this.height;i++)1!==ly()(e,[r,i])&&t.setBitXY(r,i);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let i=(e+this.minY)*this.map.width+r+this.minX;this.map.data[i]===this.id&&t.push([r,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const r=this.points;for(let i=0;i<r.length;i++)for(let n=i+1;n<r.length;n++){let s=Math.pow(r[i][0]-r[n][0],2)+Math.pow(r[i][1]-r[n][1],2);s>=e&&(e=s,t=[r[i],r[n]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}function dy(t){let e=t.map,r=e.data,i=new Set,n=new Map,s=new Set,a=[1,0,-1,0],o=[0,1,0,-1];for(let c=t.minX;c<=t.maxX;c++)for(let h=t.minY;h<=t.maxY;h++){let l=c+h*e.width;if(r[l]===t.id)for(let u=0;u<4;u++){let l=c+a[u],f=h+o[u];if(l>=0&&f>=0&&l<e.width&&f<e.height){let a=l+f*e.width;if(r[a]!==t.id&&!s.has(a)){s.add(a),i.add(r[a]);let t=n.get(r[a]);t?n.set(r[a],++t):n.set(r[a],1)}}}}let h=Array.from(i),l=h.map((function(t){return n.get(t)}));return{ids:h,lengths:l}}function my(t){let e=new Set,r=t.map,i=r.data;for(let n of[0,t.height-1])for(let s=0;s<t.width;s++){let a=(n+t.minY)*r.width+s+t.minX;if(s-t.minX>0&&i[a]===t.id&&i[a-1]!==t.id){let t=i[a-1];e.add(t)}if(r.width-s-t.minX>1&&i[a]===t.id&&i[a+1]!==t.id){let t=i[a+1];e.add(t)}}for(let n of[0,t.width-1])for(let s=0;s<t.height;s++){let a=(s+t.minY)*r.width+n+t.minX;if(s-t.minY>0&&i[a]===t.id&&i[a-r.width]!==t.id){let t=i[a-r.width];e.add(t)}if(r.height-s-t.minY>1&&i[a]===t.id&&i[a+r.width]!==t.id){let t=i[a+r.width];e.add(t)}}return Array.from(e)}function gy(t){let e=0,r=t.map,i=r.data,n=[0];t.height>1&&(n[1]=t.height-1);for(let a of n)for(let n=1;n<t.width-1;n++){let s=(a+t.minY)*r.width+n+t.minX;i[s]===t.id&&e++}let s=[0];t.width>1&&(s[1]=t.width-1);for(let a of s)for(let n=0;n<t.height;n++){let s=(n+t.minY)*r.width+a+t.minX;i[s]===t.id&&e++}return e}function py(t){let e=0,r=t.map,i=r.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let a=(s+t.minY)*r.width+n+t.minX;i[a]===t.id&&(i[a-1]===t.id&&i[a+1]===t.id&&i[a-r.width]===t.id&&i[a+r.width]===t.id||e++)}return e+t.box}function wy(t){let e=t.map,r=e.data,i=0,n=0,s=0,a=0;for(let o=0;o<t.width;o++)for(let h=0;h<t.height;h++){let l=(h+t.minY)*e.width+o+t.minX;if(r[l]===t.id){let c=0;switch((0===o||t.externalIDs.includes(r[l-1]))&&c++,(o===t.width-1||t.externalIDs.includes(r[l+1]))&&c++,(0===h||t.externalIDs.includes(r[l-e.width]))&&c++,(h===t.height-1||t.externalIDs.includes(r[l+e.width]))&&c++,c){case 1:i++;break;case 2:n++;break;case 3:s++;break;case 4:a++;break;default:}}}return{one:i,two:n,three:s,four:a}}function by(t){let e=0,r=t.map,i=r.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let a=(s+t.minY)*r.width+n+t.minX;i[a]===t.id&&(t.externalIDs.includes(i[a-1])||t.externalIDs.includes(i[a+1])||t.externalIDs.includes(i[a-r.width])||t.externalIDs.includes(i[a+r.width]))&&e++}return e+t.box}function yy(t){let e=0,r=t.map.width,i=t.map.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let a=(s+t.minY)*r+n+t.minX;t.internalIDs.includes(i[a])&&i[a]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}function _y(t){let e=[t.id],r=t.map,i=r.data;if(t.height>2)for(let s=0;s<t.width;s++){let n=t.minY*r.width+s+t.minX;if(e.includes(i[n])){let s=i[n+r.width];e.includes(s)||t.boxIDs.includes(s)||e.push(s)}}let n=new Array(4);for(let s=1;s<t.width-1;s++)for(let a=1;a<t.height-1;a++){let o=(a+t.minY)*r.width+s+t.minX;if(e.includes(i[o])){n[0]=i[o-1],n[1]=i[o+1],n[2]=i[o-r.width],n[3]=i[o+r.width];for(let r=0;r<4;r++){let i=n[r];e.includes(i)||t.boxIDs.includes(i)||e.push(i)}}}return e}class vy{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let a=0;a<t.length;a++)t[a]&&!e[t[a]]&&(e[t[a]]=!0,t[a]>0?this.roiMap.positive++:this.roiMap.negative++);let r={};for(let a in e)r[a]=new fy(this.roiMap,1*a);let i=this.roiMap.width,n=this.roiMap.height;for(let a=0;a<n;a++)for(let e=0;e<i;e++){let n=a*i+e;if(0!==t[n]){const i=t[n],s=r[i];e<s.minX&&(s.minX=e),e>s.maxX&&(s.maxX=e),a<s.minY&&(s.minY=a),a>s.maxY&&(s.maxY=a),s.meanX+=e,s.meanY+=a,s.surface++}}let s=[];for(let a in e)r[a].meanX/=r[a].surface,r[a].meanY/=r[a].surface,s.push(r[a]);return s}}function xy(t){let e=t.data,r=[1,0,-1,0],i=[0,1,0,-1],n=t.minMax,s=-n.min,a=n.max+s,o=[];for(let l=0;l<=a;l++)o.push(Object.create(null));for(let l=0;l<t.width;l++)for(let n=0;n<t.height;n++){let a=l+n*t.width,h=e[a];if(0!==h){let a=Object.create(null),c=!1;for(let u=0;u<4;u++){let f=l+r[u],d=n+i[u];if(f>=0&&d>=0&&f<t.width&&d<t.height){let r=e[f+d*t.width];h!==r&&(c=!0,0!==r&&void 0===a[r]&&(a[r]=!0,o[r+s][h]?o[r+s][h]++:o[r+s][h]=1))}else c=!0}c&&(o[h+s][h]?o[h+s][h]++:o[h+s][h]=1)}}let h={};for(let l=0;l<o.length;l++)Object.keys(o[l]).length>0&&(h[l-s]=o[l]);return h}function ky(t={}){const{algorithm:e="commonBorderLength",minCommonBorderLength:r=5,maxCommonBorderLength:i=100,minCommonBorderRatio:n=.3,maxCommonBorderRatio:s=1}=t;let a=function(t,e,n){return t[n]>=r&&t[n]<=i};"function"===typeof e&&(a=e),"commonborderratio"===e.toLowerCase()&&(a=function(t,e,r){let i=Math.min(t[r]/t[e],1);return i>=n&&i<=s});const o=this,h=o.commonBorderLength;let l={},c={};for(let p of Object.keys(h)){let t=h[p],e=Object.keys(t);for(let r of e)if(r!==p&&a(t,p,r)){let t=r;c[r]&&(t=c[r]);let e=p;if(c[p]&&(e=c[p]),Number(t)!==e){let r=Math.min(t,e),i=Math.max(t,e);if(l[r]||(l[r]={}),l[r][i]=!0,c[i]=r,l[i]){for(let t of Object.keys(l[i]))l[r][t]=!0,c[t]=r;delete l[i]}}}}let u=o.minMax,f=-u.min,d=u.max+f,m=new Array(d+1).fill(0);for(let p of Object.keys(c))m[Number(p)+f]=c[p];let g=o.data;for(let p=0;p<g.length;p++){let t=g[p];if(0!==t){let e=m[t+f];0!==e&&(g[p]=e)}}return o.computed={},o}class Ay{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let r=0;r<this.data.length;r++)this.data[r]<t&&(t=this.data[r]),this.data[r]>e&&(e=this.data[r]);return{min:t,max:e}}get commonBorderLength(){return xy(this)}mergeRoi(t={}){return ky.call(this,t)}mergeRois(t){const e=t[0],r=t.slice(1);for(let i=0;i<this.data.length;i++)r.includes(this.data[i])&&(this.data[i]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let r=0;r<this.data.length;r+=this.width){let i={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=i;let n={},s={},a=[],o=this.data[r],h=0;for(let t=r;t<r+this.width;t++){let e=this.data[t];o!==e&&(o=e,a.push(h),h=0),h++,e>0?(i.positivePixel++,n[e]||(n[e]=!0)):e<0?(i.negativePixel++,s[e]||(s[e]=!0)):i.zeroPixel++}a.push(h),i.medianChange=a.sort(((t,e)=>t-e))[Math.floor(a.length/2)],i.positiveRoiIDs=Object.keys(n),i.negativeRoiIDs=Object.keys(s),i.positiveRoi=i.positiveRoiIDs.length,i.negativeRoi=i.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let r=0;r<this.width;r++){let i={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=i;let n={},s={},a=[],o=this.data[r],h=0;for(let t=r;t<r+this.data.length;t+=this.width){let e=this.data[t];o!==e&&(o=e,a.push(h),h=0),h++,e>0?(i.positivePixel++,n[e]||(n[e]=!0)):e<0?(i.negativePixel++,s[e]||(s[e]=!0)):i.zeroPixel++}a.push(h),i.medianChange=a.sort(((t,e)=>t-e))[Math.floor(a.length/2)],i.positiveRoiIDs=Object.keys(n),i.negativeRoiIDs=Object.keys(s),i.positiveRoi=i.positiveRoiIDs.length,i.negativeRoi=i.negativeRoiIDs.length}return t}}function My(t,e={}){const{allowCorners:r=!1}=e,i=65535;let n=new Int16Array(t.size),s=0,a=0,o=new Uint16Array(i+1),h=new Uint16Array(i+1);for(let c=0;c<t.width;c++)for(let e=0;e<t.height;e++)0===n[e*t.width+c]&&l(c,e);function l(e,l){let c=0,u=0,f=t.getBitXY(e,l),d=f?++s:--a;if(s>32767||a<-32768)throw new Error("Too many regions of interest");o[0]=e,h[0]=l;while(c<=u){let e=o[c&i],s=h[c&i];if(n[s*t.width+e]=d,e>0&&0===n[s*t.width+e-1]&&t.getBitXY(e-1,s)===f&&(u++,o[u&i]=e-1,h[u&i]=s,n[s*t.width+e-1]=-32768),s>0&&0===n[(s-1)*t.width+e]&&t.getBitXY(e,s-1)===f&&(u++,o[u&i]=e,h[u&i]=s-1,n[(s-1)*t.width+e]=-32768),e<t.width-1&&0===n[s*t.width+e+1]&&t.getBitXY(e+1,s)===f&&(u++,o[u&i]=e+1,h[u&i]=s,n[s*t.width+e+1]=-32768),s<t.height-1&&0===n[(s+1)*t.width+e]&&t.getBitXY(e,s+1)===f&&(u++,o[u&i]=e,h[u&i]=s+1,n[(s+1)*t.width+e]=-32768),r&&(e>0&&s>0&&0===n[(s-1)*t.width+e-1]&&t.getBitXY(e-1,s-1)===f&&(u++,o[u&i]=e-1,h[u&i]=s-1,n[(s-1)*t.width+e-1]=-32768),e<t.width-1&&s>0&&0===n[(s-1)*t.width+e+1]&&t.getBitXY(e+1,s-1)===f&&(u++,o[u&i]=e+1,h[u&i]=s-1,n[(s-1)*t.width+e+1]=-32768),e>0&&s<t.height-1&&0===n[(s+1)*t.width+e-1]&&t.getBitXY(e-1,s+1)===f&&(u++,o[u&i]=e-1,h[u&i]=s+1,n[(s+1)*t.width+e-1]=-32768),e<t.width-1&&s<t.height-1&&0===n[(s+1)*t.width+e+1]&&t.getBitXY(e+1,s+1)===f&&(u++,o[u&i]=e+1,h[u&i]=s+1,n[(s+1)*t.width+e+1]=-32768)),c++,u-c>i)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new Ay(t,n)}var Ey=r(44078),Sy=r.n(Ey);const Ry=[-1,0],Iy=[0,-1],Dy=[null,null],Cy=[-1,-1,0,1],By=[0,-1,-1,-1],Ty=[null,null,null,null];function Uy(t,e={}){const{allowCorners:r=!1}=e;let i,n,s,a=4;if(r&&(a=8),8===a)i=Cy,n=By,s=Ty;else{if(4!==a)throw new RangeError(`unsupported neighbours count: ${a}`);i=Ry,n=Iy,s=Dy}const o=t.size,h=t.width,l=t.height,c=new Array(o),u=new Uint32Array(o),f=new(Sy());let d=1;for(let m=0;m<l;m++)for(let e=0;e<h;e++){const r=e+m*h;if(t.getBit(r)){let t=null;for(let r=0;r<s.length;r++){const a=e+i[r],o=m+n[r];if(a>=0&&o>=0&&a<h&&o<l){const e=a+o*h;let i=c[e];i?(s[r]=i,(!t||s[r].value<t.value)&&(t=s[r])):s[r]=null}}if(t){c[r]=t;for(let e=0;e<s.length;e++)s[e]&&s[e]!==t&&f.union(t,s[e])}else c[r]=f.add(d++)}}for(let m=0;m<l;m++)for(let e=0;e<h;e++){const r=e+m*h;t.getBit(r)&&(u[r]=f.find(c[r]).value)}return new Ay(t,u)}function Py(t={}){let{allowCorner:e=!0,onlyTop:r=!1,invert:i=!1}=t,n=this;n.checkProcessable("fromMaxima",{components:[1]});const s=1,a=2;let o=0,h=0,l=new Int16Array(n.size),c=new Int8Array(n.size),u=new Float32Array(n.size),f=1048575,d=new Uint16Array(f+1),m=new Uint16Array(f+1),g=0,p=0,w=new Uint16Array(f+1),b=new Uint16Array(f+1),y=0,_=0;v(n,{maxima:!i});while(g<p){let t=d[g&f],e=m[g&f];k(t,e,a),g++}return new Ay(n,l);function v({maxima:t=!0}){for(let r=1;r<n.height-1;r++)for(let i=1;i<n.width-1;i++){let a=i+r*n.width;if(0===c[a]){let c=t?n.data[a]:-n.data[i+r*n.width];if(n.data[r*n.width+i-1]>c)continue;if(n.data[r*n.width+i+1]>c)continue;if(n.data[(r-1)*n.width+i]>c)continue;if(n.data[(r+1)*n.width+i]>c)continue;if(e){if(n.data[(r-1)*n.width+i-1]>c)continue;if(n.data[(r-1)*n.width+i+1]>c)continue;if(n.data[(r+1)*n.width+i-1]>c)continue;if(n.data[(r+1)*n.width+i+1]>c)continue}l[a]=t?++o:--h;let u=x(i,r,s);u||(t?--o:++h)}}}function x(t,e){let r=p;y=0,_=1,w[0]=t,b[0]=e;let i=!0;while(y<_){let t=w[y&f],e=b[y&f];i&=k(t,e,s),y++}if(!i){for(let t=0;t<_;t++){let e=w[t&f],r=b[t&f],i=r*n.width+e;l[i]=0}p=r}return i}function k(t,e,i){let o=l[e*n.width+t],h=n.data[e*n.width+t];for(let g=e-1;g<=e+1;g++)for(let e=t-1;e<=t+1;e++){let t=g*n.width+e;if(0===c[t])switch(c[t]=1,u[t]=n.data[t]-h,i){case s:if(0===u[t]){if(0===e||0===g||e===n.width-1||g===n.height-1)return!1;l[t]=o,w[_&f]=e,b[_&f]=g,_++}else{if(u[t]>0)return!1;r||(l[t]=o,d[p&f]=e,m[p&f]=g,p++)}break;case a:u[t]<=0&&(l[t]=o,d[p&f]=e,m[p&f]=g,p++);break;default:throw new Error("unreachable")}}return!0}}function Fy(t,e={}){let r=new wb(e),i=new Int16Array(this.size),n=0,s=r.getPoints();for(let a=0;a<t.length;a++){n++;let e=t[a][0],r=t[a][1];for(let t=0;t<s.length;t++){let a=s[t][0],o=s[t][1];e+a>=0&&r+o>=0&&e+a<this.width&&r+o<this.height&&(i[e+a+(r+o)*this.width]=n)}}return new Ay(this,i)}var zy=r(24310),Ly=r.n(zy);const Oy=[1,0,-1,0,1,1,-1,-1],Ny=[0,1,0,-1,1,-1,1,-1];function Yy(t={}){let{points:e,mask:r,image:i,fillMaxValue:n=this.maxValue,invert:s=!1}=t,a=i||this;a.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),s=!s,e||(e=a.getLocalMaxima({invert:s,mask:r}));let o=s?0:1,h=new Int16Array(a.size),l=a.width,c=a.height,u=new(Ly())({comparator:(t,e)=>t[2]-e[2],strategy:Ly().BinaryHeapStrategy});for(let f=0;f<e.length;f++){let t=e[f][0]+e[f][1]*l;h[t]=f+1;let r=a.data[t];(s&&r<=n||!s&&r>=n)&&u.queue([e[f][0],e[f][1],r])}while(u.length>0){let t=u.dequeue(),e=t[0]+t[1]*l;for(let i=0;i<4;i++){let f=t[0]+Oy[i],d=t[1]+Ny[i];if(f>=0&&d>=0&&f<l&&d<c){let c=f+d*l;if(!r||r.getBit(c)===o){let r=a.data[c];(s&&r<=n||!s&&r>=n)&&0===h[c]&&(h[c]=h[e],u.queue([t[0]+Oy[i],t[1]+Ny[i],r]))}}}}return new Ay(a,h)}class Vy{constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(t={}){let e=Object.assign({},this._options,t),r=Py.call(this._image,t);this._layers[e.label]=new vy(r,e)}fromPoints(t,e={}){let r=Object.assign({},this._options,e),i=Fy.call(this._image,t,e);return this._layers[r.label]=new vy(i,r),this}putMap(t,e={}){let r=new Ay(this._image,t),i=Object.assign({},this._options,e);return this._layers[i.label]=new vy(r,i),this}fromWaterShed(t={}){let e=Object.assign({},this._options,t),r=Yy.call(this._image,t);this._layers[e.label]=new vy(r,e)}fromMask(t,e={}){let r=Object.assign({},this._options,e),i=My.call(this._image,t,e);return this._layers[r.label]=new vy(i,r),this}fromMaskConnectedComponentLabelingAlgorithm(t,e={}){let r=Object.assign({},this._options,e),i=Uy.call(this._image,t,e);return this._layers[r.label]=new vy(i,r),this}getMap(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(t={}){return this.getMap(t).rowsInfo()}colsInfo(t={}){return this.getMap(t).rowsInfo()}getRoiIds(t={}){let e=this.getRois(t);if(e){let t=new Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r].id;return t}throw new Error("ROIs not found")}getRois(t={}){let{label:e=this._options.label,positive:r=!0,negative:i=!0,minSurface:n=0,maxSurface:s=Number.POSITIVE_INFINITY,minWidth:a=0,maxWidth:o=Number.POSITIVE_INFINITY,minHeight:h=0,maxHeight:l=Number.POSITIVE_INFINITY,minRatio:c=0,maxRatio:u=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const f=this._layers[e].roi,d=[];for(const m of f)(m.id<0&&i||m.id>0&&r)&&m.surface>=n&&m.surface<=s&&m.width>=a&&m.width<=o&&m.height>=h&&m.height<=l&&m.ratio>=c&&m.ratio<=u&&d.push(m);return d}getRoi(t,e={}){const{label:r=this._options.label}=e;if(!this._layers[r])throw new Error(`this Roi layer (${r}) does not exist`);const i=this._layers[r].roi.find((e=>e.id===t));if(!i)throw new Error(`found no Roi with id ${t}`);return i}getMasks(t={}){let e=this.getRois(t),r=new Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i].getMask(t);return r}getAnalysisMasks(t={}){const{analysisProperty:e}=t;let r=`${e}Mask`,i=this.getRois(t);return 0!==i.length&&i[0][r]?i.map((t=>t[r])):[]}getData(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(t={}){let{labelProperty:e,analysisProperty:r}=t;this._painted||(this._painted=this._image.rgba8());let i=this.getMasks(t);if(e){const r=this.getRois(t);t.labels=r.map((t=>oy(t,e)));const i=Math.max(...t.labels);let n=!1,s=!1;if(e.includes("surface")?n=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(s=!0),isFinite(i)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(s||n)){e=n?`${t.unit}^2`:t.unit;let r=n?"m^2":"m",i=n?t.pixelSize**2:t.pixelSize;const s=ay().swiftConverter(r,e);t.labels=t.labels.map((t=>s(i*t)))}t.labels=i>50?t.labels.map((t=>Math.round(t)+e)):i>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=r.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(i,t),r){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(t={}){let e=new Hy(this._image.width,this._image.height,{kind:"BINARY"}),r=this.getMasks(t);for(let i=0;i<r.length;i++){let t=r[i];for(let r=0;r<t.width;r++)for(let i=0;i<t.height;i++)t.getBitXY(r,i)&&e.setBitXY(r+t.position[0],i+t.position[1])}return e}resetPainted(t={}){const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(t={}){const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t,e={}){if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const r=this.getMap(e);return r.mergeRois(t),this.putMap(r.data,e),this}findCorrespondingRoi(t,e={}){let r=this.getRois(e),i=[];for(let n=0;n<r.length;n++){let e=r[n],s=e.minX,a=e.minY,o=e.points,h=Math.sign(e.id),l=Xy(s,a,o,t,h);i.push(l)}return i}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function Xy(t,e,r,i,n){let s={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let a=0;a<r.length;a++){let n=r[a],o=n[0],h=n[1],l=o+t+(h+e)*i.width,c=i.data[l];(c>0||c<0)&&(s.id.includes(c)?s.surface[s.id.indexOf(c)]+=1:(s.id.push(c),s.surface.push(1)))}for(let a=0;a<s.id.length;a++){let t=Math.sign(s.id[a]);t===n?s.same+=s.surface[a]:s.opposite+=s.surface[a],s.roiSurfaceCovered[a]=s.surface[a]/r.length}return s.total=s.opposite+s.same,s}const jy=Object.prototype.toString;class Hy{constructor(t,e,r,i){if(1===arguments.length?(i=t,({width:t,height:e,data:r}=i)):r&&!r.length&&(i=r,({data:r}=i)),void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i={}),"object"!==typeof i||null===i)throw new TypeError("options must be an object");if(!Number.isInteger(t)||t<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new RangeError("height must be a positive integer");const{kind:n=Na}=i;if("string"!==typeof n)throw new TypeError("kind must be a string");const s=ja(n),a=Object.assign({},i);for(const m in s)void 0===a[m]&&(a[m]=s[m]);Ga(a);const{components:o,bitDepth:h,colorModel:l}=a,c=a.alpha+0,u=t*e,f=o+c,d=32===h?Number.MAX_VALUE:2**h-1;if(void 0===r)r=$a(u,o,c,f,h,d);else{const t=qa(u,f,h);if(r.length!==t)throw new RangeError(`incorrect data size: ${r.length}. Should be ${t}`)}this.width=t,this.height=e,this.data=r,this.size=u,this.components=o,this.alpha=c,this.bitDepth=h,this.maxValue=d,this.colorModel=l,this.channels=f,this.meta=i.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:i.parent||null}),this.position=i.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===jy.call(t)}static fromCanvas(t){const e=t.getContext("2d"),r=e.getImageData(0,0,t.width,t.height);return new Hy(r.width,r.height,r.data)}static createFrom(t,e){const r=vm(t);return Object.assign(r,{parent:t,position:[0,0]},e),new Hy(r)}getRoiManager(t){return new Vy(this,t)}clone(){const t=this.data.slice();return new Hy(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let i=(e*this.width+r)*this.channels;t.call(this,i)}}}function Gy(t,e,r){let i,n,s,a,o=new Array(e);r||(r=100),r*=-1;let h=(e-1)/2,l=2*t*t;for(i=0;i<e;i++)for(o[i]=new Array(e),a=(i-h)*(i-h),n=0;n<e;n++)s=(n-h)*(n-h),o[i][n]=Math.round(r*(1-(s+a)/l)*Math.exp(-(s+a)/l));return o}_m(Hy),u(Hy),wa(Hy),Hy.prototype.checkProcessable=f,Hy.prototype.getRGBAData=Ra,Hy.load=lm,Hy.extendMethod=va,Hy.extendProperty=xa,ny(Hy);var qy=r(67266),$y=r.n(qy);const Zy={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function Wy(t,e,r){e=Object.assign({},Zy,e);const i=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const n=Qy(i,t,e);return"function"===typeof r&&n.then(r),n}))):Qy(i,t,e)}function Qy(t,e,r){return t.post("data",[e,r]).then((function(t){for(let e in t)t[e]=new Hy(t[e]);return t}))}function Ky(){worker.on("data",(function(t,e,r){e=new IJS(e);const i={},n=[],s=e.grey(),a=s.sobelFilter();d("sobel",a);const o=a.level().mask({threshold:r.threshold});d("mask",o);const h=a.getRoiManager();h.fromMask(o);const l=h.getMask(r.roi);d("realMask",l);const c=s.getPixelsGrid({sampling:r.sampling,mask:l}),u=e.getBackground(c.xyS,c.zS,r.regression);d("background",u);const f=e.subtract(u);function d(t,e){r.include.includes(t)&&(i[t]=e,n.push(e.data.buffer))}i.result=f,n.push(f.data.buffer),t(i,n)}))}const Jy={run:Wy,work:Ky};var t_=Jy;function e_(t){t.extendMethod("background",t_)}class r_{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!==typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let r,i,n={};function s(...t){return r||(this.checkUrl(),i=this.url,r=new($y())(e.work,{deps:i}),n.manager=r),e.run.call(n,...t)}s.reset=function(){r&&(r.terminate(),r=new($y())(e.work,{deps:i}),n.manager=r)},r_.prototype[t]=s}}e_(r_);var i_=new r_;const n_={grey:Ep,threshold:Kp}},59070:function(t,e,r){"use strict";r(17642),r(58004),r(33853),r(45876),r(32475),r(15024),r(31698);const i=r(331),n=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),s=t=>{const e=i(t);return n.has(e&&e.ext)?e:null};t.exports=s,t.exports["default"]=s,Object.defineProperty(s,"minimumBytes",{value:i.minimumBytes})},10036:function(t,e,r){"use strict";r.r(e),r.d(e,{IOBuffer:function(){return l}});r(16280),r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(88021);function i(t,e="utf8"){const r=new TextDecoder(e);return r.decode(t)}const n=new TextEncoder;function s(t){return n.encode(t)}const a=8192,o=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),h={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class l{constructor(t=a,e={}){let r=!1;"number"===typeof t?t=new ArrayBuffer(t):(r=!0,this.lastWrittenByte=t.byteLength);const i=e.offset?e.offset>>>0:0,n=t.byteLength-i;let s=i;(ArrayBuffer.isView(t)||t instanceof l)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+i),t=t.buffer),this.lastWrittenByte=r?n:0,this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,n),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=this.offset+t,r=2*e,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const r=h[e].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,n=this.buffer.slice(i,i+r);if(this.littleEndian===o&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(i,i+r));t.reverse();const n=new h[e](t.buffer);return this.offset+=r,n.reverse(),n}const s=new h[e](n);return this.offset+=r,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let r=0;r<t;r++)e+=this.readChar();return e}readUtf8(t=1){return i(this.readBytes(t))}decodeText(t=1,e="utf-8"){return i(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(s(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},88021:function(t,e,r){"use strict";r(16280),r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(13611),function(t){if(t["TextEncoder"]&&t["TextDecoder"])return!1;function e(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function r(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let r=0;const i=t.length;let n=0,s=Math.max(32,i+(i>>1)+7),a=new Uint8Array(s>>3<<3);while(r<i){let e=t.charCodeAt(r++);if(e>=55296&&e<=56319){if(r<i){const i=t.charCodeAt(r);56320===(64512&i)&&(++r,e=((1023&e)<<10)+(1023&i)+65536)}if(e>=55296&&e<=56319)continue}if(n+4>a.length){s+=8,s*=1+r/t.length*2,s=s>>3<<3;const e=new Uint8Array(s);e.set(a),a=e}if(0!==(4294967168&e)){if(0===(4294965248&e))a[n++]=e>>6&31|192;else if(0===(4294901760&e))a[n++]=e>>12&15|224,a[n++]=e>>6&63|128;else{if(0!==(4292870144&e))continue;a[n++]=e>>18&7|240,a[n++]=e>>12&63|128,a[n++]=e>>6&63|128}a[n++]=63&e|128}else a[n++]=e}return a.slice(0,n)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1}),r.prototype.decode=function(t,e={stream:!1}){if(e["stream"])throw new Error("Failed to decode: the 'stream' option is unsupported.");const r=new Uint8Array(t);let i=0;const n=r.length,s=[];while(i<n){const t=r[i++];if(0===t)break;if(0===(128&t))s.push(t);else if(192===(224&t)){const e=63&r[i++];s.push((31&t)<<6|e)}else if(224===(240&t)){const e=63&r[i++],n=63&r[i++];s.push((31&t)<<12|e<<6|n)}else if(240===(248&t)){const e=63&r[i++],n=63&r[i++],a=63&r[i++];let o=(7&t)<<18|e<<12|n<<6|a;o>65535&&(o-=65536,s.push(o>>>10&1023|55296),o=56320|1023&o),s.push(o)}}return String.fromCharCode.apply(null,s)},t["TextEncoder"]=e,t["TextDecoder"]=r}("undefined"!==typeof window?window:"undefined"!==typeof self?self:this)},57343:function(t,e,r){"use strict";r.r(e),r.d(e,{isAnyArray:function(){return n}});const i=Object.prototype.toString;function n(t){const e=i.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},84302:function(t){"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},94010:function(t){"use strict";t.exports=Number.isFinite||function(t){return!("number"!==typeof t||t!==t||t===1/0||t===-1/0)}},33685:function(t,e,r){var i=r(94010);t.exports=Number.isInteger||function(t){return"number"===typeof t&&i(t)&&Math.floor(t)===t}},6696:function(t,e,r){var i=r(16128),n=r(27144);t.exports={encode:i,decode:n}},27144:function(t,e,r){r(16280),r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577);var i=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,r=799,i=3406,n=2276,s=1567,a=3784,o=5793,h=2896;function l(){}function c(t,e){var r,i,n=0,s=[],a=16;while(a>0&&!t[a-1])a--;s.push({children:[],index:0});var o,h=s[0];for(r=0;r<a;r++){for(i=0;i<t[r];i++){h=s.pop(),h.children[h.index]=e[n];while(h.index>0){if(0===s.length)throw new Error("Could not recreate Huffman Table");h=s.pop()}h.index++,s.push(h);while(s.length<=r)s.push(o={children:[],index:0}),h.children[h.index]=o.children,h=o;n++}r+1<a&&(s.push(o={children:[],index:0}),h.children[h.index]=o.children,h=o)}return s[0].children}function u(e,r,i,n,s,a,o,h,l,c){i.precision,i.samplesPerLine,i.scanLines;var u=i.mcusPerLine,f=i.progressive,d=(i.maxH,i.maxV,r),m=0,g=0;function p(){if(g>0)return g--,m>>g&1;if(m=e[r++],255==m){var t=e[r++];if(t)throw new Error("unexpected marker: "+(m<<8|t).toString(16))}return g=7,m>>>7}function w(t){var e,r=t;while(null!==(e=p())){if(r=r[e],"number"===typeof r)return r;if("object"!==typeof r)throw new Error("invalid huffman sequence")}return null}function b(t){var e=0;while(t>0){var r=p();if(null===r)return;e=e<<1|r,t--}return e}function y(t){var e=b(t);return e>=1<<t-1?e:e+(-1<<t)+1}function _(e,r){var i=w(e.huffmanTableDC),n=0===i?0:y(i);r[0]=e.pred+=n;var s=1;while(s<64){var a=w(e.huffmanTableAC),o=15&a,h=a>>4;if(0!==o){s+=h;var l=t[s];r[l]=y(o),s++}else{if(h<15)break;s+=16}}}function v(t,e){var r=w(t.huffmanTableDC),i=0===r?0:y(r)<<l;e[0]=t.pred+=i}function x(t,e){e[0]|=p()<<l}var k=0;function A(e,r){if(k>0)k--;else{var i=a,n=o;while(i<=n){var s=w(e.huffmanTableAC),h=15&s,c=s>>4;if(0!==h){i+=c;var u=t[i];r[u]=y(h)*(1<<l),i++}else{if(c<15){k=b(c)+(1<<c)-1;break}i+=16}}}}var M,E=0;function S(e,r){var i=a,n=o,s=0;while(i<=n){var h=t[i],c=r[h]<0?-1:1;switch(E){case 0:var u=w(e.huffmanTableAC),f=15&u;s=u>>4;if(0===f)s<15?(k=b(s)+(1<<s),E=4):(s=16,E=1);else{if(1!==f)throw new Error("invalid ACn encoding");M=y(f),E=s?2:3}continue;case 1:case 2:r[h]?r[h]+=(p()<<l)*c:(s--,0===s&&(E=2==E?3:0));break;case 3:r[h]?r[h]+=(p()<<l)*c:(r[h]=M<<l,E=0);break;case 4:r[h]&&(r[h]+=(p()<<l)*c);break}i++}4===E&&(k--,0===k&&(E=0))}function R(t,e,r,i,n){var s=r/u|0,a=r%u,o=s*t.v+i,h=a*t.h+n;void 0===t.blocks[o]&&c.tolerantDecoding||e(t,t.blocks[o][h])}function I(t,e,r){var i=r/t.blocksPerLine|0,n=r%t.blocksPerLine;void 0===t.blocks[i]&&c.tolerantDecoding||e(t,t.blocks[i][n])}var D,C,B,T,U,P,F=n.length;P=f?0===a?0===h?v:x:0===h?A:S:_;var z,L,O,N,Y=0;L=1==F?n[0].blocksPerLine*n[0].blocksPerColumn:u*i.mcusPerColumn,s||(s=L);while(Y<L){for(C=0;C<F;C++)n[C].pred=0;if(k=0,1==F)for(D=n[0],U=0;U<s;U++)I(D,P,Y),Y++;else for(U=0;U<s;U++){for(C=0;C<F;C++)for(D=n[C],O=D.h,N=D.v,B=0;B<N;B++)for(T=0;T<O;T++)R(D,P,Y,B,T);if(Y++,Y===L)break}if(Y===L)do{if(255===e[r]&&0!==e[r+1])break;r+=1}while(r<e.length-2);if(g=0,z=e[r]<<8|e[r+1],z<65280)throw new Error("marker was not found");if(!(z>=65488&&z<=65495))break;r+=2}return r-d}function f(t,l){var c,u,f=[],d=l.blocksPerLine,m=l.blocksPerColumn,g=d<<3,w=new Int32Array(64),b=new Uint8Array(64);function y(t,c,u){var f,d,m,g,p,w,b,y,_,v,x=l.quantizationTable,k=u;for(v=0;v<64;v++)k[v]=t[v]*x[v];for(v=0;v<8;++v){var A=8*v;0!=k[1+A]||0!=k[2+A]||0!=k[3+A]||0!=k[4+A]||0!=k[5+A]||0!=k[6+A]||0!=k[7+A]?(f=o*k[0+A]+128>>8,d=o*k[4+A]+128>>8,m=k[2+A],g=k[6+A],p=h*(k[1+A]-k[7+A])+128>>8,y=h*(k[1+A]+k[7+A])+128>>8,w=k[3+A]<<4,b=k[5+A]<<4,_=f-d+1>>1,f=f+d+1>>1,d=_,_=m*a+g*s+128>>8,m=m*s-g*a+128>>8,g=_,_=p-b+1>>1,p=p+b+1>>1,b=_,_=y+w+1>>1,w=y-w+1>>1,y=_,_=f-g+1>>1,f=f+g+1>>1,g=_,_=d-m+1>>1,d=d+m+1>>1,m=_,_=p*n+y*i+2048>>12,p=p*i-y*n+2048>>12,y=_,_=w*r+b*e+2048>>12,w=w*e-b*r+2048>>12,b=_,k[0+A]=f+y,k[7+A]=f-y,k[1+A]=d+b,k[6+A]=d-b,k[2+A]=m+w,k[5+A]=m-w,k[3+A]=g+p,k[4+A]=g-p):(_=o*k[0+A]+512>>10,k[0+A]=_,k[1+A]=_,k[2+A]=_,k[3+A]=_,k[4+A]=_,k[5+A]=_,k[6+A]=_,k[7+A]=_)}for(v=0;v<8;++v){var M=v;0!=k[8+M]||0!=k[16+M]||0!=k[24+M]||0!=k[32+M]||0!=k[40+M]||0!=k[48+M]||0!=k[56+M]?(f=o*k[0+M]+2048>>12,d=o*k[32+M]+2048>>12,m=k[16+M],g=k[48+M],p=h*(k[8+M]-k[56+M])+2048>>12,y=h*(k[8+M]+k[56+M])+2048>>12,w=k[24+M],b=k[40+M],_=f-d+1>>1,f=f+d+1>>1,d=_,_=m*a+g*s+2048>>12,m=m*s-g*a+2048>>12,g=_,_=p-b+1>>1,p=p+b+1>>1,b=_,_=y+w+1>>1,w=y-w+1>>1,y=_,_=f-g+1>>1,f=f+g+1>>1,g=_,_=d-m+1>>1,d=d+m+1>>1,m=_,_=p*n+y*i+2048>>12,p=p*i-y*n+2048>>12,y=_,_=w*r+b*e+2048>>12,w=w*e-b*r+2048>>12,b=_,k[0+M]=f+y,k[56+M]=f-y,k[8+M]=d+b,k[48+M]=d-b,k[16+M]=m+w,k[40+M]=m-w,k[24+M]=g+p,k[32+M]=g-p):(_=o*u[v+0]+8192>>14,k[0+M]=_,k[8+M]=_,k[16+M]=_,k[24+M]=_,k[32+M]=_,k[40+M]=_,k[48+M]=_,k[56+M]=_)}for(v=0;v<64;++v){var E=128+(k[v]+8>>4);c[v]=E<0?0:E>255?255:E}}p(g*m*8);for(var _=0;_<m;_++){var v=_<<3;for(c=0;c<8;c++)f.push(new Uint8Array(g));for(var x=0;x<d;x++){y(l.blocks[_][x],b,w);var k=0,A=x<<3;for(u=0;u<8;u++){var M=f[v+u];for(c=0;c<8;c++)M[A+c]=b[k++]}}}return f}function d(t){return t<0?0:t>255?255:t}l.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var r=1e3*this.opts.maxResolutionInMP*1e3,i=0;e.length;function n(){var t=e[i]<<8|e[i+1];return i+=2,t}function s(){var t=n(),r=e.subarray(i,i+t-2);return i+=r.length,r}function a(t){var e,r,i=1,n=1;for(r in t.components)t.components.hasOwnProperty(r)&&(e=t.components[r],i<e.h&&(i=e.h),n<e.v&&(n=e.v));var s=Math.ceil(t.samplesPerLine/8/i),a=Math.ceil(t.scanLines/8/n);for(r in t.components)if(t.components.hasOwnProperty(r)){e=t.components[r];var o=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/i),h=Math.ceil(Math.ceil(t.scanLines/8)*e.v/n),l=s*e.h,c=a*e.v,u=c*l,f=[];p(256*u);for(var d=0;d<c;d++){for(var m=[],g=0;g<l;g++)m.push(new Int32Array(64));f.push(m)}e.blocksPerLine=o,e.blocksPerColumn=h,e.blocks=f}t.maxH=i,t.maxV=n,t.mcusPerLine=s,t.mcusPerColumn=a}var o,h,l=null,d=null,m=[],g=[],w=[],b=[],y=n(),_=-1;if(this.comments=[],65496!=y)throw new Error("SOI not found");y=n();while(65497!=y){switch(y){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=s();if(65534===y){var x=String.fromCharCode.apply(null,v);this.comments.push(x)}65504===y&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(l={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65505===y&&69===v[0]&&120===v[1]&&105===v[2]&&102===v[3]&&0===v[4]&&(this.exifBuffer=v.subarray(5,v.length)),65518===y&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(d={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:var k=n(),A=k+i-2;while(i<A){var M=e[i++];p(256);var E=new Int32Array(64);if(M>>4===0)for(Z=0;Z<64;Z++){var S=t[Z];E[S]=e[i++]}else{if(M>>4!==1)throw new Error("DQT: invalid table spec");for(Z=0;Z<64;Z++){S=t[Z];E[S]=n()}}m[15&M]=E}break;case 65472:case 65473:case 65474:n(),o={},o.extended=65473===y,o.progressive=65474===y,o.precision=e[i++],o.scanLines=n(),o.samplesPerLine=n(),o.components={},o.componentsOrder=[];var R=o.scanLines*o.samplesPerLine;if(R>r){var I=Math.ceil((R-r)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${I}MP`)}var D,C=e[i++];for(q=0;q<C;q++){D=e[i];var B=e[i+1]>>4,T=15&e[i+1],U=e[i+2];if(B<=0||T<=0)throw new Error("Invalid sampling factor, expected values above 0");o.componentsOrder.push(D),o.components[D]={h:B,v:T,quantizationIdx:U},i+=3}a(o),g.push(o);break;case 65476:var P=n();for(q=2;q<P;){var F=e[i++],z=new Uint8Array(16),L=0;for(Z=0;Z<16;Z++,i++)L+=z[Z]=e[i];p(16+L);var O=new Uint8Array(L);for(Z=0;Z<L;Z++,i++)O[Z]=e[i];q+=17+L,(F>>4===0?b:w)[15&F]=c(z,O)}break;case 65501:n(),h=n();break;case 65500:n(),n();break;case 65498:n();var N=e[i++],Y=[];for(q=0;q<N;q++){W=o.components[e[i++]];var V=e[i++];W.huffmanTableDC=b[V>>4],W.huffmanTableAC=w[15&V],Y.push(W)}var X=e[i++],j=e[i++],H=e[i++],G=u(e,i,o,Y,h,X,j,H>>4,15&H,this.opts);i+=G;break;case 65535:255!==e[i]&&i--;break;default:if(255==e[i-3]&&e[i-2]>=192&&e[i-2]<=254){i-=3;break}if(224===y||225==y){if(-1!==_)throw new Error(`first unknown JPEG marker at offset ${_.toString(16)}, second unknown JPEG marker ${y.toString(16)} at offset ${(i-1).toString(16)}`);_=i-1;const t=n();if(255===e[i+t-2]){i+=t-2;break}}throw new Error("unknown JPEG marker "+y.toString(16))}y=n()}if(1!=g.length)throw new Error("only single frame JPEGs supported");for(var q=0;q<g.length;q++){var $=g[q].components;for(var Z in $)$[Z].quantizationTable=m[$[Z].quantizationIdx],delete $[Z].quantizationIdx}this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=l,this.adobe=d,this.components=[];for(q=0;q<o.componentsOrder.length;q++){var W=o.components[o.componentsOrder[q]];this.components.push({lines:f(o,W),scaleX:W.h/o.maxH,scaleY:W.v/o.maxV})}},getData:function(t,e){var r,i,n,s,a,o,h,l,c,u,f,m,g,w,b,y,_,v,x,k,A,M=this.width/t,E=this.height/e,S=0,R=t*e*this.components.length;p(R);var I=new Uint8Array(R);switch(this.components.length){case 1:for(r=this.components[0],u=0;u<e;u++)for(a=r.lines[0|u*r.scaleY*E],c=0;c<t;c++)f=a[0|c*r.scaleX*M],I[S++]=f;break;case 2:for(r=this.components[0],i=this.components[1],u=0;u<e;u++)for(a=r.lines[0|u*r.scaleY*E],o=i.lines[0|u*i.scaleY*E],c=0;c<t;c++)f=a[0|c*r.scaleX*M],I[S++]=f,f=o[0|c*i.scaleX*M],I[S++]=f;break;case 3:for(A=!0,this.adobe&&this.adobe.transformCode?A=!0:"undefined"!==typeof this.opts.colorTransform&&(A=!!this.opts.colorTransform),r=this.components[0],i=this.components[1],n=this.components[2],u=0;u<e;u++)for(a=r.lines[0|u*r.scaleY*E],o=i.lines[0|u*i.scaleY*E],h=n.lines[0|u*n.scaleY*E],c=0;c<t;c++)A?(f=a[0|c*r.scaleX*M],m=o[0|c*i.scaleX*M],g=h[0|c*n.scaleX*M],v=d(f+1.402*(g-128)),x=d(f-.3441363*(m-128)-.71413636*(g-128)),k=d(f+1.772*(m-128))):(v=a[0|c*r.scaleX*M],x=o[0|c*i.scaleX*M],k=h[0|c*n.scaleX*M]),I[S++]=v,I[S++]=x,I[S++]=k;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(A=!1,this.adobe&&this.adobe.transformCode?A=!0:"undefined"!==typeof this.opts.colorTransform&&(A=!!this.opts.colorTransform),r=this.components[0],i=this.components[1],n=this.components[2],s=this.components[3],u=0;u<e;u++)for(a=r.lines[0|u*r.scaleY*E],o=i.lines[0|u*i.scaleY*E],h=n.lines[0|u*n.scaleY*E],l=s.lines[0|u*s.scaleY*E],c=0;c<t;c++)A?(f=a[0|c*r.scaleX*M],m=o[0|c*i.scaleX*M],g=h[0|c*n.scaleX*M],w=l[0|c*s.scaleX*M],b=255-d(f+1.402*(g-128)),y=255-d(f-.3441363*(m-128)-.71413636*(g-128)),_=255-d(f+1.772*(m-128))):(b=a[0|c*r.scaleX*M],y=o[0|c*i.scaleX*M],_=h[0|c*n.scaleX*M],w=l[0|c*s.scaleX*M]),I[S++]=255-b,I[S++]=255-y,I[S++]=255-_,I[S++]=255-w;break;default:throw new Error("Unsupported color mode")}return I},copyToImageData:function(t,e){var r,i,n,s,a,o,h,l,c,u=t.width,f=t.height,m=t.data,g=this.getData(u,f),p=0,w=0;switch(this.components.length){case 1:for(i=0;i<f;i++)for(r=0;r<u;r++)n=g[p++],m[w++]=n,m[w++]=n,m[w++]=n,e&&(m[w++]=255);break;case 3:for(i=0;i<f;i++)for(r=0;r<u;r++)h=g[p++],l=g[p++],c=g[p++],m[w++]=h,m[w++]=l,m[w++]=c,e&&(m[w++]=255);break;case 4:for(i=0;i<f;i++)for(r=0;r<u;r++)a=g[p++],o=g[p++],n=g[p++],s=g[p++],h=255-d(a*(1-s/255)+s),l=255-d(o*(1-s/255)+s),c=255-d(n*(1-s/255)+s),m[w++]=h,m[w++]=l,m[w++]=c,e&&(m[w++]=255);break;default:throw new Error("Unsupported color mode")}}};var m=0,g=0;function p(t=0){var e=m+t;if(e>g){var r=Math.ceil((e-g)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${r}MB`)}m=e}return l.resetMaxMemoryUsage=function(t){m=0,g=t},l.getBytesAllocated=function(){return m},l.requestMemoryAllocation=p,l}();function n(t,e={}){var r={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},n={...r,...e},s=new Uint8Array(t),a=new i;a.opts=n,i.resetMaxMemoryUsage(1024*n.maxMemoryUsageInMB*1024),a.parse(s);var o=n.formatAsRGBA?4:3,h=a.width*a.height*o;try{i.requestMemoryAllocation(h);var l={width:a.width,height:a.height,exifBuffer:a.exifBuffer,data:n.useTArray?new Uint8Array(h):Buffer.alloc(h)};a.comments.length>0&&(l["comments"]=a.comments)}catch(c){if(c instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+h);if(c instanceof ReferenceError&&"Buffer is not defined"===c.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw c}return a.copyToImageData(l,n.formatAsRGBA),l}t.exports=n},16128:function(t,e,r){r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577);function i(t){Math.round;var e,r,i,n,s,a=Math.floor,o=new Array(64),h=new Array(64),l=new Array(64),c=new Array(64),u=new Array(65535),f=new Array(65535),d=new Array(64),m=new Array(64),g=[],p=0,w=7,b=new Array(64),y=new Array(64),_=new Array(64),v=new Array(256),x=new Array(2048),k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],C=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function B(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var i=a((e[r]*t+50)/100);i<1?i=1:i>255&&(i=255),o[k[r]]=i}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=a((n[s]*t+50)/100);u<1?u=1:u>255&&(u=255),h[k[s]]=u}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],d=0,m=0;m<8;m++)for(var g=0;g<8;g++)l[d]=1/(o[k[d]]*f[m]*f[g]*8),c[d]=1/(h[k[d]]*f[m]*f[g]*8),d++}function T(t,e){for(var r=0,i=0,n=new Array,s=1;s<=16;s++){for(var a=1;a<=t[s];a++)n[e[i]]=[],n[e[i]][0]=r,n[e[i]][1]=s,i++,r++;r*=2}return n}function U(){e=T(A,M),r=T(R,I),i=T(E,S),n=T(D,C)}function P(){for(var t=1,e=2,r=1;r<=15;r++){for(var i=t;i<e;i++)f[32767+i]=r,u[32767+i]=[],u[32767+i][1]=r,u[32767+i][0]=i;for(var n=-(e-1);n<=-t;n++)f[32767+n]=r,u[32767+n]=[],u[32767+n][1]=r,u[32767+n][0]=e-1+n;t<<=1,e<<=1}}function F(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256|0]=38470*t,x[t+512|0]=7471*t+32768,x[t+768|0]=-11059*t,x[t+1024|0]=-21709*t,x[t+1280|0]=32768*t+8421375,x[t+1536|0]=-27439*t,x[t+1792|0]=-5329*t}function z(t){var e=t[0],r=t[1]-1;while(r>=0)e&1<<r&&(p|=1<<w),r--,w--,w<0&&(255==p?(L(255),L(0)):L(p),w=7,p=0)}function L(t){g.push(t)}function O(t){L(t>>8&255),L(255&t)}function N(t,e){var r,i,n,s,a,o,h,l,c,u,f=0,m=8,g=64;for(c=0;c<m;++c){r=t[f],i=t[f+1],n=t[f+2],s=t[f+3],a=t[f+4],o=t[f+5],h=t[f+6],l=t[f+7];var p=r+l,w=r-l,b=i+h,y=i-h,_=n+o,v=n-o,x=s+a,k=s-a,A=p+x,M=p-x,E=b+_,S=b-_;t[f]=A+E,t[f+4]=A-E;var R=.707106781*(S+M);t[f+2]=M+R,t[f+6]=M-R,A=k+v,E=v+y,S=y+w;var I=.382683433*(A-S),D=.5411961*A+I,C=1.306562965*S+I,B=.707106781*E,T=w+B,U=w-B;t[f+5]=U+D,t[f+3]=U-D,t[f+1]=T+C,t[f+7]=T-C,f+=8}for(f=0,c=0;c<m;++c){r=t[f],i=t[f+8],n=t[f+16],s=t[f+24],a=t[f+32],o=t[f+40],h=t[f+48],l=t[f+56];var P=r+l,F=r-l,z=i+h,L=i-h,O=n+o,N=n-o,Y=s+a,V=s-a,X=P+Y,j=P-Y,H=z+O,G=z-O;t[f]=X+H,t[f+32]=X-H;var q=.707106781*(G+j);t[f+16]=j+q,t[f+48]=j-q,X=V+N,H=N+L,G=L+F;var $=.382683433*(X-G),Z=.5411961*X+$,W=1.306562965*G+$,Q=.707106781*H,K=F+Q,J=F-Q;t[f+40]=J+Z,t[f+24]=J-Z,t[f+8]=K+W,t[f+56]=K-W,f++}for(c=0;c<g;++c)u=t[c]*e[c],d[c]=u>0?u+.5|0:u-.5|0;return d}function Y(){O(65504),O(16),L(74),L(70),L(73),L(70),L(0),L(1),L(1),L(0),O(1),O(1),L(0),L(0)}function V(t){if(t){O(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?O(t.length+2):(O(t.length+5+2),L(69),L(120),L(105),L(102),L(0));for(var e=0;e<t.length;e++)L(t[e])}}function X(t,e){O(65472),O(17),L(8),O(e),O(t),L(3),L(1),L(17),L(0),L(2),L(17),L(1),L(3),L(17),L(1)}function j(){O(65499),O(132),L(0);for(var t=0;t<64;t++)L(o[t]);L(1);for(var e=0;e<64;e++)L(h[e])}function H(){O(65476),O(418),L(0);for(var t=0;t<16;t++)L(A[t+1]);for(var e=0;e<=11;e++)L(M[e]);L(16);for(var r=0;r<16;r++)L(E[r+1]);for(var i=0;i<=161;i++)L(S[i]);L(1);for(var n=0;n<16;n++)L(R[n+1]);for(var s=0;s<=11;s++)L(I[s]);L(17);for(var a=0;a<16;a++)L(D[a+1]);for(var o=0;o<=161;o++)L(C[o])}function G(t){"undefined"!==typeof t&&t.constructor===Array&&t.forEach((t=>{if("string"===typeof t){O(65534);var e,r=t.length;for(O(r+2),e=0;e<r;e++)L(t.charCodeAt(e))}}))}function q(){O(65498),O(12),L(3),L(1),L(0),L(2),L(17),L(3),L(17),L(0),L(63),L(0)}function $(t,e,r,i,n){for(var s,a=n[0],o=n[240],h=16,l=63,c=64,d=N(t,e),g=0;g<c;++g)m[k[g]]=d[g];var p=m[0]-r;r=m[0],0==p?z(i[0]):(s=32767+p,z(i[f[s]]),z(u[s]));for(var w=63;w>0&&0==m[w];w--);if(0==w)return z(a),r;var b,y=1;while(y<=w){for(var _=y;0==m[y]&&y<=w;++y);var v=y-_;if(v>=h){b=v>>4;for(var x=1;x<=b;++x)z(o);v&=15}s=32767+m[y],z(n[(v<<4)+f[s]]),z(u[s]),y++}return w!=l&&z(a),r}function Z(){for(var t=String.fromCharCode,e=0;e<256;e++)v[e]=t(e)}function W(t){if(t<=0&&(t=1),t>100&&(t=100),s!=t){var e=0;e=t<50?Math.floor(5e3/t):Math.floor(200-2*t),B(e),s=t}}function Q(){var e=(new Date).getTime();t||(t=50),Z(),U(),P(),F(),W(t);(new Date).getTime()}this.encode=function(t,s){(new Date).getTime();s&&W(s),g=new Array,p=0,w=7,O(65496),Y(),G(t.comments),V(t.exifBuffer),j(),X(t.width,t.height),H(),q();var a=0,o=0,h=0;p=0,w=7,this.encode.displayName="_encode_";var u,f,d,m,v,k,A,M,E,S=t.data,R=t.width,I=t.height,D=4*R,C=0;while(C<I){u=0;while(u<D){for(v=D*C+u,k=v,A=-1,M=0,E=0;E<64;E++)M=E>>3,A=4*(7&E),k=v+M*D+A,C+M>=I&&(k-=D*(C+1+M-I)),u+A>=D&&(k-=u+A-D+4),f=S[k++],d=S[k++],m=S[k++],b[E]=(x[f]+x[d+256|0]+x[m+512|0]>>16)-128,y[E]=(x[f+768|0]+x[d+1024|0]+x[m+1280|0]>>16)-128,_[E]=(x[f+1280|0]+x[d+1536|0]+x[m+1792|0]>>16)-128;a=$(b,l,a,e,i),o=$(y,c,o,r,n),h=$(_,c,h,r,n),u+=32}C+=8}if(w>=0){var B=[];B[1]=w+1,B[0]=(1<<w+1)-1,z(B)}return O(65497),Buffer.from(g)},Q()}function n(t,e){"undefined"===typeof e&&(e=50);var r=new i(e),n=r.encode(t,e);return{data:n,width:t.width,height:t.height}}t.exports=n},24310:function(t,e,r){r(16280),r(44114),r(13611),function(e){t.exports=e()}((function(){return function t(e,r,i){function n(a,o){if(!r[a]){if(!e[a]){var h=void 0;if(!o&&h)return require(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};e[a][0].call(c.exports,(function(t){var r=e[a][1][t];return n(r||t)}),c,c.exports,t,e,r,i)}return r[a].exports}for(var s=void 0,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,r){var i,n,s,a,o,h=function(t,e){for(var r in e)l.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;i=t("./PriorityQueue/AbstractPriorityQueue"),n=t("./PriorityQueue/ArrayStrategy"),a=t("./PriorityQueue/BinaryHeapStrategy"),s=t("./PriorityQueue/BHeapStrategy"),o=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=a),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return h(e,t),e}(i),o.ArrayStrategy=n,o.BinaryHeapStrategy=a,o.BHeapStrategy=s,e.exports=o},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,r){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,r){var i;i=function(t,e,r){var i,n,s;n=0,i=t.length;while(n<i)s=n+i>>>1,r(t[s],e)>=0?n=s+1:i=s;return n},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=i(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,r){e.exports=function(){function t(t){var e,r,i,n,s,a,o,h;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,o=0;while(1<<o<this.pageSize)o+=1;if(1<<o!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=o,this._emptyMemoryPageTemplate=e=[],r=0,s=this.pageSize;0<=s?r<s:r>s;0<=s?++r:--r)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(a=t.initialValues,i=0,n=a.length;i<n;i++)h=a[i],this.queue(h)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var r;r=t>>this._shift;while(r>=this._memory.length)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[r][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var r,i,n,s;r=this.comparator;while(t>1){if(i=t&this._mask,t<this.pageSize||i>3?n=t&~this._mask|i>>1:i<2?(n=t-this.pageSize>>this._shift,n+=n&~(this._mask>>1),n|=this.pageSize>>1):n=t-2,s=this._read(n),r(s,e)<0)break;this._write(n,e),this._write(t,s),t=n}},t.prototype._bubbleDown=function(t,e){var r,i,n,s,a;a=this.comparator;while(t<this.length)if(t>this._mask&&!(t&this._mask-1)?r=i=t+2:t&this.pageSize>>1?(r=(t&~this._mask)>>1,r|=t&this._mask>>1,r=r+1<<this._shift,i=r+1):(r=t+(t&this._mask),i=r+1),r!==i&&i<=this.length)if(n=this._read(r),s=this._read(i),a(n,e)<0&&a(n,s)<=0)this._write(r,e),this._write(t,n),t=r;else{if(!(a(s,e)<0))break;this._write(i,e),this._write(t,s),t=i}else{if(!(r<=this.length))break;if(n=this._read(r),!(a(n,e)<0))break;this._write(r,e),this._write(t,n),t=r}},t}()},{}],5:[function(t,e,r){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,r;if(this.data.length>0)for(t=e=1,r=this.data.length;1<=r?e<r:e>r;t=1<=r?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){var e,r;while(t>0){if(e=t-1>>>1,!(this.comparator(this.data[t],this.data[e])<0))break;r=this.data[e],this.data[e]=this.data[t],this.data[t]=r,t=e}},t.prototype._bubbleDown=function(t){var e,r,i,n,s;e=this.data.length-1;while(1){if(r=1+(t<<1),n=r+1,i=t,r<=e&&this.comparator(this.data[r],this.data[i])<0&&(i=r),n<=e&&this.comparator(this.data[n],this.data[i])<0&&(i=n),i===t)break;s=this.data[i],this.data[i]=this.data[t],this.data[t]=s,t=i}},t}()},{}]},{},[1])(1)}))},3737:function(t,e,r){r(16280),r(44114),r(72712),r(13611),function(e,r){t.exports=r()}(0,(function(){"use strict";function t(t){return"string"===typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function r(t){return e(t)}function i(t){return t}function n(t){var e={};return t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}))}function s(t,e){if(e.length!==t.length)return!1;for(var r=0;r<t.length;r++){if(e[r].compareArray&&!e[r].compareArray(t[r]))return!1;if(e[r]!==t[r])return!1}return!0}function a(t,e){Object.keys(e).forEach((function(r){t[r]=e[r]}))}function o(){for(var t=1,e=0,r=0;r<arguments.length;r++){var i=arguments[r];e+=c(i),t*=i}return 0!==e?l(t,e):t}function h(t,e){if(0===e)throw new Error("Divide by zero");var r=Math.pow(10,c(e)),i=r/(r*e);return o(t,i)}function l(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function c(t){if(!isFinite(t))return 0;var e=0;while(t%1!==0)t*=10,e++;return e}function u(){var t;if(!this)return t=Object.create(u.prototype),u.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function f(t,e){throw new u("Incompatible units: "+t+" and "+e)}u.prototype=Object.create(Error.prototype,{constructor:{value:u}});var d={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","μ","µ","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","Ω","Ω"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},m=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],g="<1>",p=[g];function w(t,e){var i=e[1],n=e[3]||[],s=e[4]||[];if(!r(i))throw new u(t+": Invalid unit definition. 'scalar' must be a number");n.forEach((function(e){if(void 0===d[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),s.forEach((function(e){if(void 0===d[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var b={},y={},_={},v={},x={};for(var k in d)if(d.hasOwnProperty(k)){var A=d[k];if("prefix"===A[2]){b[k]=A[1];for(var M=0;M<A[0].length;M++)y[A[0][M]]=k}else{w(k,A),_[k]={scalar:A[1],numerator:A[3],denominator:A[4]};for(var E=0;E<A[0].length;E++)v[A[0][E]]=k}x[k]=A[0][0]}function S(t){var e,r=[],i=Object.keys(d);if("undefined"===typeof t)for(e=0;e<i.length;e++)-1===["","prefix"].indexOf(d[i[e]][2])&&r.push(i[e].substr(1,i[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new u("Kind not recognized");for(e=0;e<i.length;e++)d[i[e]][2]===t&&r.push(i[e].substr(1,i[e].length-2))}return r.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))}function R(t){if(!v[t])throw new u("Unit not recognized");return d[v[t]][0]}var I=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function D(){if(this.signature)return this.signature;for(var t=C.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function C(){if(!this.isBase())return C.call(this.toBase());for(var t,e,r=new Array(I.length),i=0;i<r.length;i++)r[i]=0;for(var n=0;n<this.numerator.length;n++)(t=d[this.numerator[n]])&&(e=I.indexOf(t[2]),e>=0&&(r[e]=r[e]+1));for(var s=0;s<this.denominator.length;s++)(t=d[this.denominator[s]])&&(e=I.indexOf(t[2]),e>=0&&(r[e]=r[e]-1));return r}var B="[+-]",T="\\d+",U=B+"?"+T,P="\\."+T,F="(?:"+T+"(?:"+P+")?)|(?:"+P+")",z="[Ee]"+U,L="(?:"+F+")(?:"+z+")?",O=B+"?\\s*"+L,N="("+O+")?\\s*([^/]*)(?:/(.+))?",Y=new RegExp("^"+N+"$"),V="\\^|\\*{2}",X="[01234]",j=new RegExp("([^ \\*\\d]+?)(?:"+V+")?(-?"+X+"(?![a-zA-Z]))"),H=new RegExp("([^ \\*\\d]+?)(?:"+V+")?("+X+"(?![a-zA-Z]))");function G(e){t(e)||(e=e.toString()),e=e.trim();var r=Y.exec(e);if(!r)throw new u(e+": Quantity not recognized");var i=r[1];i?(i=i.replace(/\s/g,""),this.scalar=parseFloat(i)):this.scalar=1;var n,s,a,o=r[2],h=r[3];while(r=j.exec(o)){if(n=parseFloat(r[2]),isNaN(n))throw new u("Unit exponent is not a number");if(0===n&&!Q.test(r[1]))throw new u("Unit not recognized");s=r[1]+" ",a="";for(var l=0;l<Math.abs(n);l++)a+=s;n>=0?o=o.replace(r[0],a):(h=h?h+a:a,o=o.replace(r[0],""))}while(r=H.exec(h)){if(n=parseFloat(r[2]),isNaN(n))throw new u("Unit exponent is not a number");if(0===n&&!Q.test(r[1]))throw new u("Unit not recognized");s=r[1]+" ",a="";for(var c=0;c<n;c++)a+=s;h=h.replace(r[0],a)}o&&(this.numerator=tt(o.trim())),h&&(this.denominator=tt(h.trim()))}var q=Object.keys(y).sort((function(t,e){return e.length-t.length})).join("|"),$=Object.keys(v).sort((function(t,e){return e.length-t.length})).join("|"),Z="\\b|$",W="("+q+")??("+$+")(?:"+Z+")",Q=new RegExp("^\\s*("+W+"[\\s\\*]*)+$"),K=new RegExp(W,"g"),J={};function tt(t){var e=J[t];if(e)return e;var r,i=[];if(!Q.test(t))throw new u("Unit not recognized");while(r=K.exec(t))i.push(r.slice(1));return i=i.map((function(t){return y[t[0]]?[y[t[0]],v[t[1]]]:[v[t[1]]]})),i=i.reduce((function(t,e){return t.concat(e)}),[]),i=i.filter((function(t){return t})),J[t]=i,i}function et(e){if(!t(e))throw new u("Argument should be a string");try{return this(e)}catch(r){return null}}function rt(t){return t instanceof it}function it(t,e){if(nt.apply(null,arguments),!rt(this))return new it(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=p,this.denominator=p,st(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:p,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:p):e?(G.call(this,e),this.scalar=t):G.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new u("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new u("Cannot multiply by temperatures");if(!s(this.denominator,p))throw new u("Cannot divide with temperatures")}if(this.initValue=t,at.call(this),this.isTemperature()&&this.baseScalar<0)throw new u("Temperatures must not be less than absolute zero")}function nt(e,i){if(i){if(!r(e)||!t(i))throw new u("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||r(e)||rt(e)||st(e)))throw new u("Only string, number or quantity accepted as single initialization value")}function st(t){return t&&"object"===typeof t&&t.hasOwnProperty("scalar")}function at(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=D.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}it.prototype={constructor:it};var ot={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function ht(){return n(Object.keys(ot).map((function(t){return ot[t]})))}function lt(t,e){var r=t.units(),i=e.to(r),n=it(ft(r));return it({scalar:t.scalar-i.scalar,numerator:n.numerator,denominator:n.denominator})}function ct(t,e){var r=e.to(ft(t.units()));return it({scalar:t.scalar-r.scalar,numerator:t.numerator,denominator:t.denominator})}function ut(t,e){var r=e.to(ft(t.units()));return it({scalar:t.scalar+r.scalar,numerator:t.numerator,denominator:t.denominator})}function ft(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new u("Unknown type for temp conversion from: "+t)}function dt(t,e){var r,i=mt(t),n=e.units();if("degK"===n)r=i.scalar;else if("degC"===n)r=i.scalar;else if("degF"===n)r=9*i.scalar/5;else{if("degR"!==n)throw new u("Unknown type for degree conversion to: "+n);r=9*i.scalar/5}return it({scalar:r,numerator:e.numerator,denominator:e.denominator})}function mt(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar;else if("tempF"===r)e=5*t.scalar/9;else{if("tempR"!==r)throw new u("Unknown type for temp conversion from: "+r);e=5*t.scalar/9}return it({scalar:e,numerator:["<kelvin>"],denominator:p})}function gt(t,e){var r,i=e.units();if("tempK"===i)r=t.baseScalar;else if("tempC"===i)r=t.baseScalar-273.15;else if("tempF"===i)r=9*t.baseScalar/5-459.67;else{if("tempR"!==i)throw new u("Unknown type for temp conversion to: "+i);r=9*t.baseScalar/5}return it({scalar:r,numerator:e.numerator,denominator:e.denominator})}function pt(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar+273.15;else if("tempF"===r)e=5*(t.scalar+459.67)/9;else{if("tempR"!==r)throw new u("Unknown type for temp conversion from: "+r);e=5*t.scalar/9}return it({scalar:e,numerator:["<temp-K>"],denominator:p})}function wt(t,e){var r,n=it(t),s=it(e);return n.eq(s)?i:(r=n.isTemperature()?function(t){return n.mul(t).to(s).scalar}:function(t){return t*n.baseScalar/s.baseScalar},function(t){var e,i,n;if(Array.isArray(t)){for(i=t.length,n=[],e=0;e<i;e++)n.push(r(t[e]));return n}return r(t)})}it.prototype.kind=function(){return ot[this.signature.toString()]},a(it.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&s(this.denominator,p)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),a(it.prototype,{to:function(e){var r,i;if(void 0===e||null===e)return this;if(!t(e))return this.to(e.units());if(r=this._conversionCache[e],r)return r;if(i=it(e),i.units()===this.units())return this;if(this.isCompatible(i))if(i.isTemperature())i=gt(this,i);else if(i.isDegrees())i=dt(this,i);else{var n=h(this.baseScalar,i.baseScalar);i=it({scalar:n,numerator:i.numerator,denominator:i.denominator})}else this.isInverse(i)?i=this.inverse().to(e):f(this.units(),i.units());return this._conversionCache[e]=i,i},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return pt(this);var t=bt[this.units()];return t||(t=yt(this.numerator,this.denominator),bt[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new u("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=it(e)),r(e)&&(e=it(e+" "+this.units())),this.isUnitless()?e.isUnitless()||f(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new u("Divide by zero");var i=o(Math.round(this.scalar/e.scalar),e.scalar);return it(i+this.units())}});var bt={};function yt(t,e){for(var r,i=[],n=[],s=1,a=0;a<t.length;a++)r=t[a],b[r]?s=o(s,b[r]):_[r]&&(s*=_[r].scalar,_[r].numerator&&i.push(_[r].numerator),_[r].denominator&&n.push(_[r].denominator));for(var h=0;h<e.length;h++)r=e[h],b[r]?s/=b[r]:_[r]&&(s/=_[r].scalar,_[r].numerator&&n.push(_[r].numerator),_[r].denominator&&i.push(_[r].denominator));return i=i.reduce((function(t,e){return t.concat(e)}),[]),n=n.reduce((function(t,e){return t.concat(e)}),[]),it({scalar:s,numerator:i,denominator:n})}function _t(t,e,r,i){function n(t){return t!==g}t=t.filter(n),r=r.filter(n),e=e.filter(n),i=i.filter(n);var s={};function a(t,e){for(var r,i,n,a=0;a<t.length;a++)if(b[t[a]]?(r=t[a+1],i=t[a],n=b[i],a++):(r=t[a],i=null,n=1),r&&r!==g)if(s[r]){s[r][0]+=e;var o=s[r][2]?b[s[r][2]]:1;s[r][1===e?3:4]*=h(n,o)}else s[r]=[e,r,i,1,1]}a(t,1),a(e,-1),a(r,1),a(i,-1);var o=[],l=[],c=1;for(var u in s)if(s.hasOwnProperty(u)){var f,d=s[u];if(d[0]>0)for(f=0;f<d[0];f++)o.push(null===d[2]?d[1]:[d[2],d[1]]);else if(d[0]<0)for(f=0;f<-d[0];f++)l.push(null===d[2]?d[1]:[d[2],d[1]]);c*=h(d[3],d[4])}return 0===o.length&&(o=p),0===l.length&&(l=p),o=o.reduce((function(t,e){return t.concat(e)}),[]),l=l.reduce((function(t,e){return t.concat(e)}),[]),[o,l,c]}function vt(){}function xt(t,e){return(t+" "+e).trim()}it.parse=et,it.getUnits=S,it.getAliases=R,it.mulSafe=o,it.divSafe=h,it.getKinds=ht,it.swiftConverter=wt,it.Error=u,a(it.prototype,{add:function(e){if(t(e)&&(e=it(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new u("Cannot add two temperatures");return this.isTemperature()?ut(this,e):e.isTemperature()?ut(e,this):it({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=it(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return lt(this,e);if(this.isTemperature())return ct(this,e);if(e.isTemperature())throw new u("Cannot subtract a temperature from a differential degree unit");return it({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(r(e))return it({scalar:o(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=it(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new u("Cannot multiply by temperatures");var i=this,n=e;i.isCompatible(n)&&400!==i.signature&&(n=n.to(i));var s=_t(i.numerator,i.denominator,n.numerator,n.denominator);return it({scalar:o(i.scalar,n.scalar,s[2]),numerator:s[0],denominator:s[1]})},div:function(e){if(r(e)){if(0===e)throw new u("Divide by zero");return it({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=it(e)),0===e.scalar)throw new u("Divide by zero");if(e.isTemperature())throw new u("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new u("Cannot divide with temperatures");var i=this,n=e;i.isCompatible(n)&&400!==i.signature&&(n=n.to(i));var s=_t(i.numerator,i.denominator,n.denominator,n.numerator);return it({scalar:o(i.scalar,s[2])/n.scalar,numerator:s[0],denominator:s[1]})},inverse:function(){if(this.isTemperature())throw new u("Cannot divide with temperatures");if(0===this.scalar)throw new u("Divide by zero");return it({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),a(it.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(it(e)):(this.isCompatible(e)||f(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),a(it.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return s(t,p)}))},isCompatible:function(e){return t(e)?this.isCompatible(it(e)):!!rt(e)&&(void 0!==e.signature&&this.signature===e.signature)},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==g&&-1===m.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),vt.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,r,i){if(e){var n=e[r];return i===t.length-1?n?n.data:void 0:n}}),this)},vt.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(r,i,n){var s=r[i];return void 0===s&&(s=r[i]={}),n===t.length-1?(s.data=e,e):s}),this)},it.formatter=xt,a(it.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=s(this.numerator,p),e=s(this.denominator,p);if(t&&e)return this._units="",this._units;var r=At(this.numerator),i=At(this.denominator);return this._units=r+(e?"":"/"+i),this._units},toString:function(e,i){var n;if(r(e))n=this.units(),i=e;else if(t(e))n=e;else if(rt(e))return this.toPrec(e).toString(i);var s=this.to(n),a=void 0!==i?l(s.scalar,i):s.scalar;return s=(a+" "+s.units()).trim(),s},format:function(t,e){1===arguments.length&&"function"===typeof t&&(e=t,t=void 0),e=e||it.formatter;var r=this.to(t);return e.call(this,r.scalar,r.units())}});var kt=new vt;function At(t){var e=kt.get(t);if(e)return e;var r=s(t,p);return e=r?"1":Et(Mt(t)).join("*"),kt.set(t,e),e}function Mt(t){for(var e,r,i=[],n=0;n<t.length;n++)e=t[n],r=t[n+1],b[e]?(i.push(x[e]+x[r]),n++):i.push(x[e]);return i}function Et(t){var e=t.reduce((function(t,e){var r=t[e];return r||t.push(r=t[e]=[e,0]),r[1]++,t}),[]);return e.map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}return it.version="1.8.0",it}))},30130:function(t){(function(){function e(t){for(var e=0,n=t.length-1,s=void 0,a=void 0,o=void 0,h=i(e,n);1;){if(n<=e)return t[h];if(n==e+1)return t[e]>t[n]&&r(t,e,n),t[h];for(s=i(e,n),t[s]>t[n]&&r(t,s,n),t[e]>t[n]&&r(t,e,n),t[s]>t[e]&&r(t,s,e),r(t,s,e+1),a=e+1,o=n;1;){do{a++}while(t[e]>t[a]);do{o--}while(t[o]>t[e]);if(o<a)break;r(t,a,o)}r(t,e,o),o<=h&&(e=a),o>=h&&(n=o-1)}}var r=function(t,e,r){var i;return i=[t[r],t[e]],t[e]=i[0],t[r]=i[1],i},i=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e})()},1351:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return a}});r(16280);var i=r(57343);function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,s=e.toIndex,a=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>t.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],h=n+1;h<a;h++)t[h]>o&&(o=t[h]);return o}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,s=e.toIndex,a=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>t.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],h=n+1;h<a;h++)t[h]<o&&(o=t[h]);return o}function a(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!(0,i.isAnyArray)(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var a=s(t),o=n(t);if(a===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=r.min,l=void 0===h?r.autoMinMax?a:0:h,c=r.max,u=void 0===c?r.autoMinMax?o:1:c;if(l>=u)throw new RangeError("min option must be smaller than max option");for(var f=(u-l)/(o-a),d=0;d<t.length;d++)e[d]=(t[d]-a)*f+l;return e}},44078:function(t){"use strict";class e{constructor(){this.nodes=new Map}add(t){var e=this.nodes.get(t);return e||(e=new r(t),this.nodes.set(t,e)),e}union(t,e){const r=this.find(t),i=this.find(e);r!==i&&(r.rank<i.rank?r.parent=i:r.rank>i.rank?i.parent=r:(i.parent=r,r.rank++))}find(t){var e=t;while(null!==e.parent)e=e.parent;var r=t;while(null!==r.parent){var i=r;r=r.parent,i.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}function r(t){this.value=t,this.parent=null,this.rank=0}t.exports=e},20919:function(t,e,r){"use strict";function i(t,e){let r=0;for(let i=0;i<t.length;i++)r+=(t[i]-e[i])*(t[i]-e[i]);return r}function n(t,e){return Math.sqrt(i(t,e))}r.r(e),r.d(e,{euclidean:function(){return n},squaredEuclidean:function(){return i}})},74570:function(t,e,r){"use strict";var i=r(9144),n={DEBUG:!1,ifft2DArray:function(t,e,r){var n=new Array(e*r),s=e/2,a=2*(r-1);i.init(s);for(var o={re:new Array(s),im:new Array(s)},h=0;h<r;h++){for(var l=s-1;l>=0;l--)o.re[l]=t[2*l*r+h],o.im[l]=t[(2*l+1)*r+h];i.bt(o.re,o.im);for(l=s-1;l>=0;l--)n[2*l*r+h]=o.re[l],n[(2*l+1)*r+h]=o.im[l]}var c=new Array(s*a);i.init(a);var u={re:new Array(a),im:new Array(a)},f=a*s;for(l=0;l<e;l+=2){u.re[0]=n[l*r],u.im[0]=n[(l+1)*r];for(h=1;h<r;h++)u.re[h]=n[l*r+h],u.im[h]=n[(l+1)*r+h],u.re[a-h]=n[l*r+h],u.im[a-h]=-n[(l+1)*r+h];i.bt(u.re,u.im);var d=l/2*a;for(h=a-1;h>=0;h--)c[d+h]=u.re[h]/f}return c},fft2DArray:function(t,e,r,n){Object.assign({},{inplace:!0});var s=r/2+1,a=2*e,o=new Array(a*s);i.init(r);for(var h,l,c,u,f,d={re:new Array(r),im:new Array(r)},m={re:new Array(r),im:new Array(r)},g={re:new Array(r),im:new Array(r)},p=0;p<e/2;p++){h=2*p*r,d.re=t.slice(h,h+r),h=(2*p+1)*r,d.im=t.slice(h,h+r),i.fft1d(d.re,d.im),this.reconstructTwoRealFFT(d,m,g),l=4*p*s,c=(4*p+1)*s,u=(4*p+2)*s,f=(4*p+3)*s;for(var w=s-1;w>=0;w--)o[l+w]=m.re[w],o[c+w]=m.im[w],o[u+w]=g.re[w],o[f+w]=g.im[w]}m=null,g=null;var b=new Array(a*s);i.init(e);for(var y={re:new Array(e),im:new Array(e)},_=s-1;_>=0;_--){for(p=e-1;p>=0;p--)y.re[p]=o[2*p*s+_],y.im[p]=o[(2*p+1)*s+_],isNaN(y.re[p])&&(y.re[p]=0),isNaN(y.im[p])&&(y.im[p]=0);i.fft1d(y.re,y.im);for(p=e-1;p>=0;p--)b[2*p*s+_]=y.re[p],b[(2*p+1)*s+_]=y.im[p]}return b},reconstructTwoRealFFT:function(t,e,r){var i,n,s,a,o,h=t.re.length;e.re[0]=t.re[0],e.im[0]=0,r.re[0]=t.im[0],r.im[0]=0;for(var l=h/2;l>0;l--)o=h-l,i=.5*(t.re[l]-t.re[o]),n=.5*(t.re[l]+t.re[o]),s=.5*(t.im[l]-t.im[o]),a=.5*(t.im[l]+t.im[o]),e.re[l]=n,e.im[l]=s,e.re[o]=n,e.im[o]=-s,r.re[l]=a,r.im[l]=-i,r.re[o]=a,r.im[o]=i},convolute2DI:function(t,e,r,i){for(var n,s,a=0;a<r/2;a++)for(var o=0;o<i;o++)n=t[2*a*i+o]*e[2*a*i+o]-t[(2*a+1)*i+o]*e[(2*a+1)*i+o],s=t[2*a*i+o]*e[(2*a+1)*i+o]+t[(2*a+1)*i+o]*e[2*a*i+o],t[2*a*i+o]=n,t[(2*a+1)*i+o]=s},convolute:function(t,e,r,i,n){for(var s=new Array(i*r),a=0;a<r*i;a++)s[a]=t[a];s=this.fft2DArray(s,r,i);var o,h,l=e.length,c=e[0].length,u=new Array(i*r);for(a=0;a<i*r;a++)u[a]=0;for(var f=Math.floor((l-1)/2),d=Math.floor((c-1)/2),m=0;m<l;m++){o=(m-f+r)%r;for(var g=0;g<c;g++)h=(g-d+i)%i,u[o*i+h]=e[m][g]}u=this.fft2DArray(u,r,i);var p=2*r,w=i/2+1;return this.convolute2DI(s,u,p,w),this.ifft2DArray(s,p,w)},toRadix2:function(t,e,r){var i,n,s,a,o=r,h=e;if(0===r||0!==(r&r-1)){o=0;while(r>>++o!=0);o=1<<o,o-r}if(0===e||0!==(e&e-1)){h=0;while(e>>++h!=0);h=1<<h,(h-e)*o}if(h==e&&o==r)return{data:t,rows:e,cols:r};var l=new Array(h*o),c=Math.floor((h-e)/2)-e,u=Math.floor((o-r)/2)-r;for(i=0;i<h;i++)for(s=i*o,a=(i-c)%e*r,n=0;n<o;n++)l[s+n]=t[a+(n-u)%r];return{data:l,rows:h,cols:o}},crop:function(t,e,r,i,n,s){if(e==i&&r==n)return t;Object.assign({},s);var a,o,h,l,c=new Array(n*i),u=Math.floor((e-i)/2),f=Math.floor((r-n)/2);for(h=0;h<i;h++)for(a=h*n,o=(h+u)*r,l=0;l<n;l++)c[a+l]=t[o+(l+f)];return c}};t.exports=n},9144:function(t,e,r){r(16280),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577);(function(){var t;t=e;var r={release:"0.3.0",date:"2013-03"};t.toString=function(){return"version "+r.release+", released "+r.date};for(var i=0,n=null,s=null,a={init:function(t){if(0===t||0!==(t&t-1))throw new Error("init: radix-2 required");i=t,a._initArray(),a._makeBitReversalTable(),a._makeCosSinTable()},fft1d:function(t,e){a.fft(t,e,1)},ifft1d:function(t,e){var r=1/i;a.fft(t,e,-1);for(var n=0;n<i;n++)t[n]*=r,e[n]*=r},bt1d:function(t,e){a.fft(t,e,-1)},fft2d:function(t,e){for(var r=[],n=[],s=0,o=0;o<i;o++){s=o*i;for(var h=0;h<i;h++)r[h]=t[h+s],n[h]=e[h+s];a.fft1d(r,n);for(var l=0;l<i;l++)t[l+s]=r[l],e[l+s]=n[l]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)s=c+u*i,r[u]=t[s],n[u]=e[s];a.fft1d(r,n);for(var f=0;f<i;f++)s=c+f*i,t[s]=r[f],e[s]=n[f]}},ifft2d:function(t,e){for(var r=[],n=[],s=0,o=0;o<i;o++){s=o*i;for(var h=0;h<i;h++)r[h]=t[h+s],n[h]=e[h+s];a.ifft1d(r,n);for(var l=0;l<i;l++)t[l+s]=r[l],e[l+s]=n[l]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)s=c+u*i,r[u]=t[s],n[u]=e[s];a.ifft1d(r,n);for(var f=0;f<i;f++)s=c+f*i,t[s]=r[f],e[s]=n[f]}},fft:function(t,e,r){for(var a,o,h,l,c,u,f,d,m,g=i>>2,p=0;p<i;p++)l=n[p],p<l&&(c=t[p],t[p]=t[l],t[l]=c,c=e[p],e[p]=e[l],e[l]=c);for(var w=1;w<i;w<<=1){o=0,a=i/(w<<1);for(var b=0;b<w;b++){u=s[o+g],f=r*s[o];for(var y=b;y<i;y+=w<<1)h=y+w,d=u*t[h]+f*e[h],m=u*e[h]-f*t[h],t[h]=t[y]-d,t[y]+=d,e[h]=e[y]-m,e[y]+=m;o+=a}}},_initArray:function(){n="undefined"!==typeof Uint32Array?new Uint32Array(i):[],s="undefined"!==typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,r=0;n[0]=0;while(++t<i){r=i>>1;while(r<=e)e-=r,r>>=1;e+=r,n[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,r=i>>3,n=t+e,a=Math.sin(Math.PI/i),o=2*a*a,h=Math.sqrt(o*(2-o)),l=s[e]=1,c=s[0]=0;a=2*o;for(var u=1;u<r;u++)l-=o,o+=a*l,c+=h,h-=a*c,s[u]=c,s[e-u]=l;0!==r&&(s[r]=Math.sqrt(.5));for(var f=0;f<e;f++)s[t-f]=s[f];for(var d=0;d<n;d++)s[d+t]=-s[d]}},o=["init","fft1d","ifft1d","fft2d","ifft2d"],h=0;h<o.length;h++)t[o[h]]=a[o[h]];return t.bt=a.bt1d,t.fft=a.fft1d,t.ifft=a.ifft1d,t}).call(this)},903:function(t,e,r){"use strict";e.FFTUtils=r(74570),r(9144)},81134:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(20919),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const r=i(t,e);return Math.exp(-r/this.divisor)}}t.exports=s},16248:function(t){"use strict";const e={degree:1,constant:1,scale:1};class r{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var r=0,i=0;i<t.length;i++)r+=t[i]*e[i];return Math.pow(this.scale*r+this.constant,this.degree)}}t.exports=r},60530:function(t){"use strict";const e={alpha:.01,constant:-Math.E};class r{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var r=0,i=0;i<t.length;i++)r+=t[i]*e[i];return Math.tanh(this.alpha*r+this.constant)}}t.exports=r},66981:function(t,e,r){"use strict";r(16280);const{Matrix:i,MatrixTransposeView:n}=r(68742),s=r(81134),a=r(16248),o=r(60530),h=r(22262),l=r(97312),c=r(54136),u=r(57981),f=r(65218),d=r(49574),m=r(98438),g={gaussian:s,rbf:s,polynomial:a,poly:a,anova:h,cauchy:l,exponential:c,histogram:u,min:u,laplacian:f,multiquadratic:d,rational:m,sigmoid:o,mlp:o};class p{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"===typeof t){t=t.toLowerCase();var r=g[t];if(!r)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new r(e)}else{if("object"!==typeof t||"function"!==typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=i.checkMatrix(t),e=void 0===e?t:i.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new n(e));const r=new i(t.rows,e.rows);if(t===e)for(let i=0;i<t.rows;i++)for(let e=i;e<t.rows;e++){const n=this.kernelFunction.compute(t.getRow(i),t.getRow(e));r.set(i,e,n),r.set(e,i,n)}else for(let i=0;i<t.rows;i++)for(let n=0;n<e.rows;n++)r.set(i,n,this.kernelFunction.compute(t.getRow(i),e.getRow(n)));return r}}t.exports=p},22262:function(t){"use strict";const e={sigma:1,degree:1};class r{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var r=0,i=Math.min(t.length,e.length),n=1;n<=i;++n)r+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[n-1],n)-Math.pow(e[n-1],n),2)),this.degree);return r}}t.exports=r},97312:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(20919),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma}compute(t,e){return 1/(1+i(t,e)/(this.sigma*this.sigma))}}t.exports=s},54136:function(t,e,r){"use strict";const{euclidean:i}=r(20919),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const r=i(t,e);return Math.exp(-r/this.divisor)}}t.exports=s},57981:function(t){"use strict";class e{compute(t,e){for(var r=Math.min(t.length,e.length),i=0,n=0;n<r;++n)i+=Math.min(t[n],e[n]);return i}}t.exports=e},65218:function(t,e,r){"use strict";const{euclidean:i}=r(20919),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma}compute(t,e){const r=i(t,e);return Math.exp(-r/this.sigma)}}t.exports=s},49574:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(20919),n={constant:1};class s{constructor(t){t=Object.assign({},n,t),this.constant=t.constant}compute(t,e){return Math.sqrt(i(t,e)+this.constant*this.constant)}}t.exports=s},98438:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(20919),n={constant:1};class s{constructor(t){t=Object.assign({},n,t),this.constant=t.constant}compute(t,e){const r=i(t,e);return 1-r/(r+this.constant)}}t.exports=s},32933:function(t,e,r){r(16280);var i=r(903).FFTUtils;function n(t,e,r){var n,s,a=o(t),h=a.data,l=Object.assign({normalize:!1,divisor:1,rows:a.rows,cols:a.cols},r);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+n+" "+s);n=l.rows,s=l.cols;var c,u,f=l.divisor,d=e.length,m=e[0].length;if(l.normalize)for(f=0,c=0;c<d;c++)for(u=0;u<m;u++)f+=e[c][u];if(0===f)throw new RangeError("convolution: The divisor is equal to zero");var g=i.toRadix2(h,n,s),p=i.convolute(g.data,e,g.rows,g.cols);if(p=i.crop(p,g.rows,g.cols,n,s),0!=f&&1!=f)for(c=0;c<p.length;c++)p[c]/=f;return p}function s(t,e,r){var i,n,s=o(t),a=s.data,h=Object.assign({normalize:!1,divisor:1,rows:s.rows,cols:s.cols},r);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+i+" "+n);i=h.rows,n=h.cols;var l,c,u,f,d,m,g,p,w,b=h.divisor,y=e.length,_=e[0].length;if(h.normalize)for(b=0,l=0;l<y;l++)for(c=0;c<_;c++)b+=e[l][c];if(0===b)throw new RangeError("convolution: The divisor is equal to zero");var v=new Array(i*n),x=Math.floor(y/2),k=Math.floor(_/2);for(f=0;f<i;f++)for(u=0;u<n;u++){for(m=0,c=0;c<y;c++)for(l=0;l<_;l++)g=e[y-c-1][_-l-1],p=(f+c-x+i)%i,w=(u+l-k+n)%n,d=p*n+w,m+=a[d]*g;d=f*n+u,v[d]=m/b}return v}function a(t,e,r){var i=1e3;r&&r.factor&&(i=r.factor);var n,s,a,o,h=new Array(e);i*=-1;var l=(e-1)/2,c=2*t*t;for(n=0;n<e;n++)for(h[n]=new Array(e),o=(n-l)*(n-l),s=0;s<e;s++)a=-((s-l)*(s-l)+o)/c,h[n][s]=Math.round(i*(1+a)*Math.exp(a));return h}function o(t){var e,r,i=t;if("number"!=typeof t[0]){e=t.length,r=t[0].length,i=new Array(e*r);for(var n=0;n<e;n++)for(var s=0;s<r;s++)i[n*r+s]=t[n][s]}else{var a=Math.sqrt(t.length);Number.isInteger(a)&&(e=a,r=a)}return{data:i,rows:e,cols:r}}t.exports={fft:n,direct:s,kernelFactory:{LoG:a},matrix2Array:o}},68742:function(t,e,r){"use strict";var i=r(67826)["default"],n=r(43325)["default"],s=r(59577)["default"],a=r(82887)["default"],o=r(74550)["default"],h=r(5987)["default"];r(16280),r(44114),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),Object.defineProperty(e,"__esModule",{value:!0});var l=r(57343),c=r(1351);const u=" ".repeat(2),f=" ".repeat(4);function d(){return m(this)}function m(t,e={}){const{maxRows:r=15,maxColumns:i=10,maxNumSize:n=8,padMinus:s="auto"}=e;return`${t.constructor.name} {\n${u}[\n${f}${g(t,r,i,n,s)}\n${u}]\n${u}rows: ${t.rows}\n${u}columns: ${t.columns}\n}`}function g(t,e,r,i,n){const{rows:s,columns:a}=t,o=Math.min(s,e),h=Math.min(a,r),l=[];if("auto"===n){n=!1;t:for(let e=0;e<o;e++)for(let r=0;r<h;r++)if(t.get(e,r)<0){n=!0;break t}}for(let c=0;c<o;c++){let e=[];for(let r=0;r<h;r++)e.push(p(t.get(c,r),i,n));l.push(`${e.join(" ")}`)}return h!==a&&(l[l.length-1]+=` ... ${a-r} more columns`),o!==s&&l.push(`... ${s-e} more rows`),l.join(`\n${f}`)}function p(t,e,r){return(t>=0&&r?` ${w(t,e-1)}`:w(t,e)).padEnd(e)}function w(t,e){let r=t.toString();if(r.length<=e)return r;let i=t.toFixed(e);if(i.length>e&&(i=t.toFixed(Math.max(0,e-(i.length-e)))),i.length<=e&&!i.startsWith("0.000")&&!i.startsWith("-0.000"))return i;let n=t.toExponential(e);return n.length>e&&(n=t.toExponential(Math.max(0,e-(n.length-e)))),n.slice(0)}function b(t,e){t.prototype.add=function(t){return"number"===typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){const i=new e(t);return i.add(r)},t.prototype.sub=function(t){return"number"===typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){const i=new e(t);return i.sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"===typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){const i=new e(t);return i.mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"===typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){const i=new e(t);return i.div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"===typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){const i=new e(t);return i.mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"===typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){const i=new e(t);return i.and(r)},t.prototype.or=function(t){return"number"===typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){const i=new e(t);return i.or(r)},t.prototype.xor=function(t){return"number"===typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){const i=new e(t);return i.xor(r)},t.prototype.leftShift=function(t){return"number"===typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){const i=new e(t);return i.leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"===typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){const i=new e(t);return i.signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"===typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){const i=new e(t);return i.rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){const r=new e(t);return r.not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){const r=new e(t);return r.abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){const r=new e(t);return r.acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){const r=new e(t);return r.acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){const r=new e(t);return r.asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){const r=new e(t);return r.asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){const r=new e(t);return r.atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){const r=new e(t);return r.atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){const r=new e(t);return r.cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){const r=new e(t);return r.ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){const r=new e(t);return r.clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){const r=new e(t);return r.cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){const r=new e(t);return r.cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){const r=new e(t);return r.exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){const r=new e(t);return r.expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){const r=new e(t);return r.floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){const r=new e(t);return r.fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){const r=new e(t);return r.log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){const r=new e(t);return r.log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){const r=new e(t);return r.log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){const r=new e(t);return r.log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){const r=new e(t);return r.round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){const r=new e(t);return r.sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){const r=new e(t);return r.sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){const r=new e(t);return r.sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){const r=new e(t);return r.sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){const r=new e(t);return r.tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){const r=new e(t);return r.tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){const r=new e(t);return r.trunc()},t.pow=function(t,r){const i=new e(t);return i.pow(r)},t.prototype.pow=function(t){return"number"===typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}function y(t,e,r){let i=r?t.rows:t.rows-1;if(e<0||e>i)throw new RangeError("Row index out of range")}function _(t,e,r){let i=r?t.columns:t.columns-1;if(e<0||e>i)throw new RangeError("Column index out of range")}function v(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function x(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function k(t,e){if(!l.isAnyArray(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}function A(t,e){if(!l.isAnyArray(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}function M(t,e,r,i,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(S("startRow",e),S("endRow",r),S("startColumn",i),S("endColumn",n),e>r||i>n||e<0||e>=t.rows||r<0||r>=t.rows||i<0||i>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function E(t,e=0){let r=[];for(let i=0;i<t;i++)r.push(e);return r}function S(t,e){if("number"!==typeof e)throw new TypeError(`${t} must be a number`)}function R(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}function I(t){let e=E(t.rows);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[r]+=t.get(r,i);return e}function D(t){let e=E(t.columns);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[i]+=t.get(r,i);return e}function C(t){let e=0;for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)e+=t.get(r,i);return e}function B(t){let e=E(t.rows,1);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[r]*=t.get(r,i);return e}function T(t){let e=E(t.columns,1);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[i]*=t.get(r,i);return e}function U(t){let e=1;for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)e*=t.get(r,i);return e}function P(t,e,r){const i=t.rows,n=t.columns,s=[];for(let a=0;a<i;a++){let i=0,o=0,h=0;for(let e=0;e<n;e++)h=t.get(a,e)-r[a],i+=h,o+=h*h;e?s.push((o-i*i/n)/(n-1)):s.push((o-i*i/n)/n)}return s}function F(t,e,r){const i=t.rows,n=t.columns,s=[];for(let a=0;a<n;a++){let n=0,o=0,h=0;for(let e=0;e<i;e++)h=t.get(e,a)-r[a],n+=h,o+=h*h;e?s.push((o-n*n/i)/(i-1)):s.push((o-n*n/i)/i)}return s}function z(t,e,r){const i=t.rows,n=t.columns,s=i*n;let a=0,o=0,h=0;for(let l=0;l<i;l++)for(let e=0;e<n;e++)h=t.get(l,e)-r,a+=h,o+=h*h;return e?(o-a*a/s)/(s-1):(o-a*a/s)/s}function L(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)-e[r])}function O(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)-e[i])}function N(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)-e)}function Y(t){const e=[];for(let r=0;r<t.rows;r++){let i=0;for(let e=0;e<t.columns;e++)i+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(i))}return e}function V(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)/e[r])}function X(t){const e=[];for(let r=0;r<t.columns;r++){let i=0;for(let e=0;e<t.rows;e++)i+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(i))}return e}function j(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)/e[i])}function H(t){const e=t.size-1;let r=0;for(let i=0;i<t.columns;i++)for(let n=0;n<t.rows;n++)r+=t.get(n,i)**2/e;return Math.sqrt(r)}function G(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)/e)}class q{static from1DArray(t,e,r){let i=t*e;if(i!==r.length)throw new RangeError("data length does not match given dimensions");let n=new Q(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.set(s,t,r[s*e+t]);return n}static rowVector(t){let e=new Q(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new Q(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new Q(t,e)}static ones(t,e){return new Q(t,e).fill(1)}static rand(t,e,r={}){if("object"!==typeof r)throw new TypeError("options must be an object");const{random:i=Math.random}=r;let n=new Q(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.set(s,t,i());return n}static randInt(t,e,r={}){if("object"!==typeof r)throw new TypeError("options must be an object");const{min:i=0,max:n=1e3,random:s=Math.random}=r;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(n))throw new TypeError("max must be an integer");if(i>=n)throw new RangeError("min must be smaller than max");let a=n-i,o=new Q(t,e);for(let h=0;h<t;h++)for(let t=0;t<e;t++){let e=i+Math.round(s()*a);o.set(h,t,e)}return o}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let i=Math.min(t,e),n=this.zeros(t,e);for(let s=0;s<i;s++)n.set(s,s,r);return n}static diag(t,e,r){let i=t.length;void 0===e&&(e=i),void 0===r&&(r=e);let n=Math.min(i,e,r),s=this.zeros(e,r);for(let a=0;a<n;a++)s.set(a,a,t[a]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,i=t.columns,n=new Q(r,i);for(let s=0;s<r;s++)for(let r=0;r<i;r++)n.set(s,r,Math.min(t.get(s,r),e.get(s,r)));return n}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,i=t.columns,n=new this(r,i);for(let s=0;s<r;s++)for(let r=0;r<i;r++)n.set(s,r,Math.max(t.get(s,r),e.get(s,r)));return n}static checkMatrix(t){return q.isMatrix(t)?t:new Q(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!==typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,i=!0,n=!1;while(t<this.rows&&i){e=0,n=!1;while(e<this.columns&&!1===n)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(i=!1,n=!0);t++}return i}isReducedEchelonForm(){let t=0,e=0,r=-1,i=!0,n=!1;while(t<this.rows&&i){e=0,n=!1;while(e<this.columns&&!1===n)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(i=!1,n=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(i=!1);t++}return i}echelonForm(){let t=this.clone(),e=0,r=0;while(e<t.rows&&r<t.columns){let i=e;for(let n=e;n<t.rows;n++)t.get(n,r)>t.get(i,r)&&(i=n);if(0===t.get(i,r))r++;else{t.swapRows(e,i);let n=t.get(e,r);for(let i=r;i<t.columns;i++)t.set(e,i,t.get(e,i)/n);for(let i=e+1;i<t.rows;i++){let n=t.get(i,r)/t.get(e,r);t.set(i,r,0);for(let s=r+1;s<t.columns;s++)t.set(i,s,t.get(i,s)-t.get(e,s)*n)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,i=r-1;while(i>=0)if(0===t.maxRow(i))i--;else{let n=0,s=!1;while(n<r&&!1===s)1===t.get(i,n)?s=!0:n++;for(let r=0;r<i;r++){let s=t.get(r,n);for(let a=n;a<e;a++){let e=t.get(r,a)-s*t.get(i,a);t.set(r,a,e)}}i--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let i=new Q(this.rows*e,this.columns*r);for(let n=0;n<e;n++)for(let t=0;t<r;t++)i.setSubMatrix(this,this.rows*n,this.columns*t);return i}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){y(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return Q.rowVector(this.getRow(t))}setRow(t,e){y(this,t),e=v(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){y(this,t),y(this,e);for(let r=0;r<this.columns;r++){let i=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,i)}return this}getColumn(t){_(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return Q.columnVector(this.getColumn(t))}setColumn(t,e){_(this,t),e=x(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){_(this,t),_(this,e);for(let r=0;r<this.rows;r++){let i=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,i)}return this}addRowVector(t){t=v(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=v(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=v(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=v(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){y(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){_(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){R(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>t&&(t=this.get(r,i),e[0]=r,e[1]=i);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){R(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<t&&(t=this.get(r,i),e[0]=r,e[1]=i);return e}maxRow(t){if(y(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){y(this,t),R(this);let e=this.get(t,0),r=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i),r[1]=i);return r}minRow(t){if(y(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){y(this,t),R(this);let e=this.get(t,0),r=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i),r[1]=i);return r}maxColumn(t){if(_(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){_(this,t),R(this);let e=this.get(0,t),r=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t),r[0]=i);return r}minColumn(t){if(_(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){_(this,t),R(this);let e=this.get(0,t),r=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t),r[0]=i);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){q.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let i=0;i<e.length;i++)r+=e[i]*t[i];return r}mmul(t){t=Q.checkMatrix(t);let e=this.rows,r=this.columns,i=t.columns,n=new Q(e,i),s=new Float64Array(r);for(let a=0;a<i;a++){for(let e=0;e<r;e++)s[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let i=0;i<r;i++)e+=this.get(t,i)*s[i];n.set(t,a,e)}}return n}strassen2x2(t){t=Q.checkMatrix(t);let e=new Q(2,2);const r=this.get(0,0),i=t.get(0,0),n=this.get(0,1),s=t.get(0,1),a=this.get(1,0),o=t.get(1,0),h=this.get(1,1),l=t.get(1,1),c=(r+h)*(i+l),u=(a+h)*i,f=r*(s-l),d=h*(o-i),m=(r+n)*l,g=(a-r)*(i+s),p=(n-h)*(o+l),w=c+d-m+p,b=f+m,y=u+d,_=c-u+f+g;return e.set(0,0,w),e.set(0,1,b),e.set(1,0,y),e.set(1,1,_),e}strassen3x3(t){t=Q.checkMatrix(t);let e=new Q(3,3);const r=this.get(0,0),i=this.get(0,1),n=this.get(0,2),s=this.get(1,0),a=this.get(1,1),o=this.get(1,2),h=this.get(2,0),l=this.get(2,1),c=this.get(2,2),u=t.get(0,0),f=t.get(0,1),d=t.get(0,2),m=t.get(1,0),g=t.get(1,1),p=t.get(1,2),w=t.get(2,0),b=t.get(2,1),y=t.get(2,2),_=(r+i+n-s-a-l-c)*g,v=(r-s)*(-f+g),x=a*(-u+f+m-g-p-w+y),k=(-r+s+a)*(u-f+g),A=(s+a)*(-u+f),M=r*u,E=(-r+h+l)*(u-d+p),S=(-r+h)*(d-p),R=(h+l)*(-u+d),I=(r+i+n-a-o-h-l)*p,D=l*(-u+d+m-g-p-w+b),C=(-n+l+c)*(g+w-b),B=(n-c)*(g-b),T=n*w,U=(l+c)*(-w+b),P=(-n+a+o)*(p+w-y),F=(n-o)*(p-y),z=(a+o)*(-w+y),L=i*m,O=o*b,N=s*d,Y=h*f,V=c*y,X=M+T+L,j=_+k+A+M+C+T+U,H=M+E+R+I+T+P+z,G=v+x+k+M+T+P+F,q=v+k+A+M+O,$=T+P+F+z+N,Z=M+E+S+D+C+B+T,W=C+B+T+U+Y,K=M+E+S+R+V;return e.set(0,0,X),e.set(0,1,j),e.set(0,2,H),e.set(1,0,G),e.set(1,1,q),e.set(1,2,$),e.set(2,0,Z),e.set(2,1,W),e.set(2,2,K),e}mmulStrassen(t){t=Q.checkMatrix(t);let e=this.clone(),r=e.rows,i=e.columns,n=t.rows,s=t.columns;function a(t,e,r){let i=t.rows,n=t.columns;if(i===e&&n===r)return t;{let i=q.zeros(e,r);return i=i.setSubMatrix(t,0,0),i}}i!==n&&console.warn(`Multiplying ${r} x ${i} and ${n} x ${s} matrix: dimensions do not match.`);let o=Math.max(r,n),h=Math.max(i,s);function l(t,e,r,i){if(r<=512||i<=512)return t.mmul(e);r%2===1&&i%2===1?(t=a(t,r+1,i+1),e=a(e,r+1,i+1)):r%2===1?(t=a(t,r+1,i),e=a(e,r+1,i)):i%2===1&&(t=a(t,r,i+1),e=a(e,r,i+1));let n=parseInt(t.rows/2,10),s=parseInt(t.columns/2,10),o=t.subMatrix(0,n-1,0,s-1),h=e.subMatrix(0,n-1,0,s-1),c=t.subMatrix(0,n-1,s,t.columns-1),u=e.subMatrix(0,n-1,s,e.columns-1),f=t.subMatrix(n,t.rows-1,0,s-1),d=e.subMatrix(n,e.rows-1,0,s-1),m=t.subMatrix(n,t.rows-1,s,t.columns-1),g=e.subMatrix(n,e.rows-1,s,e.columns-1),p=l(q.add(o,m),q.add(h,g),n,s),w=l(q.add(f,m),h,n,s),b=l(o,q.sub(u,g),n,s),y=l(m,q.sub(d,h),n,s),_=l(q.add(o,c),g,n,s),v=l(q.sub(f,o),q.add(h,u),n,s),x=l(q.sub(c,m),q.add(d,g),n,s),k=q.add(p,y);k.sub(_),k.add(x);let A=q.add(b,_),M=q.add(w,y),E=q.sub(p,w);E.add(b),E.add(v);let S=q.zeros(2*k.rows,2*k.columns);return S=S.setSubMatrix(k,0,0),S=S.setSubMatrix(A,k.rows,0),S=S.setSubMatrix(M,0,k.columns),S=S.setSubMatrix(E,k.rows,k.columns),S.subMatrix(0,r-1,0,i-1)}return e=a(e,o,h),t=a(t,o,h),l(e,t,o,h)}scaleRows(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let i=new Q(this.rows,this.columns);for(let n=0;n<this.rows;n++){const t=this.getRow(n);t.length>0&&c(t,{min:e,max:r,output:t}),i.setRow(n,t)}return i}scaleColumns(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let i=new Q(this.rows,this.columns);for(let n=0;n<this.columns;n++){const t=this.getColumn(n);t.length&&c(t,{min:e,max:r,output:t}),i.setColumn(n,t)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),i=this.get(e,this.columns-1-r);this.set(e,r,i),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),i=this.get(this.rows-1-r,e);this.set(r,e,i),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=Q.checkMatrix(t);let e=this.rows,r=this.columns,i=t.rows,n=t.columns,s=new Q(e*i,r*n);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<i;r++)for(let o=0;o<n;o++)s.set(i*a+r,n*e+o,this.get(a,e)*t.get(r,o));return s}kroneckerSum(t){if(t=Q.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,i=this.kroneckerProduct(Q.eye(r,r)),n=Q.eye(e,e).kroneckerProduct(t);return i.add(n)}transpose(){let t=new Q(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=$){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=$){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,i){M(this,t,e,r,i);let n=new Q(e-t+1,i-r+1);for(let s=t;s<=e;s++)for(let e=r;e<=i;e++)n.set(s-t,e-r,this.get(s,e));return n}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let i=new Q(t.length,r-e+1);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.rows)throw new RangeError(`Row index out of range: ${t[n]}`);i.set(n,s-e,this.get(t[n],s))}return i}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let i=new Q(r-e+1,t.length);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.columns)throw new RangeError(`Column index out of range: ${t[n]}`);i.set(s-e,n,this.get(s,t[n]))}return i}setSubMatrix(t,e,r){if(t=Q.checkMatrix(t),t.isEmpty())return this;let i=e+t.rows-1,n=r+t.columns-1;M(this,e,i,r,n);for(let s=0;s<t.rows;s++)for(let i=0;i<t.columns;i++)this.set(e+s,r+i,t.get(s,i));return this}selection(t,e){k(this,t),A(this,e);let r=new Q(t.length,e.length);for(let i=0;i<t.length;i++){let n=t[i];for(let t=0;t<e.length;t++){let s=e[t];r.set(i,t,this.get(n,s))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new Q(this.rows,this.columns))}static copy(t,e){for(const[r,i,n]of t.entries())e.set(r,i,n);return e}sum(t){switch(t){case"row":return I(this);case"column":return D(this);case void 0:return C(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return B(this);case"column":return T(this);case void 0:return U(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:i=this.mean(t)}=e;if("boolean"!==typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!l.isAnyArray(i))throw new TypeError("mean must be an array");return P(this,r,i);case"column":if(!l.isAnyArray(i))throw new TypeError("mean must be an array");return F(this,r,i);case void 0:if("number"!==typeof i)throw new TypeError("mean must be a number");return z(this,r,i);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"===typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let i=0;i<r.length;i++)r[i]=Math.sqrt(r[i]);return r}center(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!l.isAnyArray(r))throw new TypeError("center must be an array");return L(this,r),this;case"column":if(!l.isAnyArray(r))throw new TypeError("center must be an array");return O(this,r),this;case void 0:if("number"!==typeof r)throw new TypeError("center must be a number");return N(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=Y(this);else if(!l.isAnyArray(r))throw new TypeError("scale must be an array");return V(this,r),this;case"column":if(void 0===r)r=X(this);else if(!l.isAnyArray(r))throw new TypeError("scale must be an array");return j(this,r),this;case void 0:if(void 0===r)r=H(this);else if("number"!==typeof r)throw new TypeError("scale must be a number");return G(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return m(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function $(t,e){return t-e}function Z(t){return t.every((t=>"number"===typeof t))}q.prototype.klass="Matrix","undefined"!==typeof Symbol&&(q.prototype[Symbol.for("nodejs.util.inspect.custom")]=d),q.random=q.rand,q.randomInt=q.randInt,q.diagonal=q.diag,q.prototype.diagonal=q.prototype.diag,q.identity=q.eye,q.prototype.negate=q.prototype.neg,q.prototype.tensorProduct=q.prototype.kroneckerProduct;var W=new WeakSet;class Q extends q{constructor(t,e){if(super(),a(this,W),o(this,"data",void 0),Q.isMatrix(t))h(W,this,K).call(this,t.rows,t.columns),Q.copy(t,this);else if(Number.isInteger(t)&&t>=0)h(W,this,K).call(this,t,e);else{if(!l.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,e=t?r[0].length:0,"number"!==typeof e)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<t;i++){if(r[i].length!==e)throw new RangeError("Inconsistent array dimensions");if(!Z(r[i]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[i]))}this.rows=t,this.columns=e}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return y(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),y(this,t,!0),e=Float64Array.from(v(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){_(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let i=0;i<t;i++)r[i]=this.data[e][i];for(let i=t+1;i<this.columns;i++)r[i-1]=this.data[e][i];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){"undefined"===typeof e&&(e=t,t=this.columns),_(this,t,!0),e=x(this,e);for(let r=0;r<this.rows;r++){const i=new Float64Array(this.columns+1);let n=0;for(;n<t;n++)i[n]=this.data[r][n];for(i[n++]=e[r];n<this.columns+1;n++)i[n]=this.data[r][n-1];this.data[r]=i}return this.columns+=1,this}}function K(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}b(q,Q);var J=new WeakMap;class tt extends q{get size(){return s(J,this).size}get rows(){return s(J,this).rows}get columns(){return s(J,this).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return Q.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),i(this,J,void 0),Q.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");n(J,this,Q.copy(t,new Q(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)n(J,this,new Q(t,t));else if(n(J,this,new Q(t)),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new tt(this.diagonalSize);for(const[e,r,i]of this.upperRightEntries())t.set(e,r,i);return t}toMatrix(){return new Q(this)}get(t,e){return s(J,this).get(t,e)}set(t,e,r){return s(J,this).set(t,e,r),s(J,this).set(e,t,r),this}removeCross(t){return s(J,this).removeRow(t),s(J,this).removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),s(J,this).addRow(t,r),s(J,this).addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,i]of t.entries())i||e.push(r);e.reverse();for(const r of e)this.removeCross(r);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,i=0,n=0;n<e.length;n++)e[n]=this.get(i,r),++r>=t&&(r=++i);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const i=new tt(r);for(let n=0,s=0,a=0;a<e;a++)i.set(n,s,t[a]),++n>=r&&(n=++s);return i}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}tt.prototype.klassType="SymmetricMatrix";class et extends tt{static isDistanceMatrix(t){return tt.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),e=e.slice(),e[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new tt(this)}clone(){const t=new et(this.diagonalSize);for(const[e,r,i]of this.upperRightEntries())e!==r&&t.set(e,r,i);return t}toCompact(){const{diagonalSize:t}=this,e=(t-1)*t/2,r=new Array(e);for(let i=1,n=0,s=0;s<r.length;s++)r[s]=this.get(n,i),++i>=t&&(i=1+ ++n);return r}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const i=new this(r);for(let n=1,s=0,a=0;a<e;a++)i.set(n,s,t[a]),++n>=r&&(n=1+ ++s);return i}}et.prototype.klassSubType="DistanceMatrix";class rt extends q{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class it extends rt{constructor(t,e){_(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class nt extends rt{constructor(t,e){A(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class st extends rt{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}class at extends rt{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class ot extends rt{constructor(t,e){y(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class ht extends rt{constructor(t,e){k(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class lt extends rt{constructor(t,e,r){k(t,e),A(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class ct extends rt{constructor(t,e,r,i,n){M(t,e,r,i,n),super(t,r-e+1,n-i+1),this.startRow=e,this.startColumn=i}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class ut extends rt{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class ft extends q{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let i=this._calculateIndex(t,e);return this.data[i]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class dt extends q{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mt(t,e){if(l.isAnyArray(t))return t[0]&&l.isAnyArray(t[0])?new dt(t):new ft(t,e);throw new Error("the argument is not an array")}class gt{constructor(t){t=dt.checkMatrix(t);let e,r,i,n,s,a,o,h,l,c=t.clone(),u=c.rows,f=c.columns,d=new Float64Array(u),m=1;for(e=0;e<u;e++)d[e]=e;for(h=new Float64Array(u),r=0;r<f;r++){for(e=0;e<u;e++)h[e]=c.get(e,r);for(e=0;e<u;e++){for(l=Math.min(e,r),s=0,i=0;i<l;i++)s+=c.get(e,i)*h[i];h[e]-=s,c.set(e,r,h[e])}for(n=r,e=r+1;e<u;e++)Math.abs(h[e])>Math.abs(h[n])&&(n=e);if(n!==r){for(i=0;i<f;i++)a=c.get(n,i),c.set(n,i,c.get(r,i)),c.set(r,i,a);o=d[n],d[n]=d[r],d[r]=o,m=-m}if(r<u&&0!==c.get(r,r))for(e=r+1;e<u;e++)c.set(e,r,c.get(e,r)/c.get(r,r))}this.LU=c,this.pivotVector=d,this.pivotSign=m}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=Q.checkMatrix(t);let e=this.LU,r=e.rows;if(r!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i,n,s,a=t.columns,o=t.subMatrixRow(this.pivotVector,0,a-1),h=e.columns;for(s=0;s<h;s++)for(i=s+1;i<h;i++)for(n=0;n<a;n++)o.set(i,n,o.get(i,n)-o.get(s,n)*e.get(i,s));for(s=h-1;s>=0;s--){for(n=0;n<a;n++)o.set(s,n,o.get(s,n)/e.get(s,s));for(i=0;i<s;i++)for(n=0;n<a;n++)o.set(i,n,o.get(i,n)-o.get(s,n)*e.get(i,s))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let i=0;i<r;i++)e*=t.get(i,i);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,i=new Q(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n>e?i.set(n,e,t.get(n,e)):n===e?i.set(n,e,1):i.set(n,e,0);return i}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,i=new Q(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n<=e?i.set(n,e,t.get(n,e)):i.set(n,e,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function pt(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wt{constructor(t){t=dt.checkMatrix(t);let e,r,i,n,s=t.clone(),a=t.rows,o=t.columns,h=new Float64Array(o);for(i=0;i<o;i++){let t=0;for(e=i;e<a;e++)t=pt(t,s.get(e,i));if(0!==t){for(s.get(i,i)<0&&(t=-t),e=i;e<a;e++)s.set(e,i,s.get(e,i)/t);for(s.set(i,i,s.get(i,i)+1),r=i+1;r<o;r++){for(n=0,e=i;e<a;e++)n+=s.get(e,i)*s.get(e,r);for(n=-n/s.get(i,i),e=i;e<a;e++)s.set(e,r,s.get(e,r)+n*s.get(e,i))}}h[i]=-t}this.QR=s,this.Rdiag=h}solve(t){t=Q.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i,n,s,a,o=t.columns,h=t.clone(),l=e.columns;for(s=0;s<l;s++)for(n=0;n<o;n++){for(a=0,i=s;i<r;i++)a+=e.get(i,s)*h.get(i,n);for(a=-a/e.get(s,s),i=s;i<r;i++)h.set(i,n,h.get(i,n)+a*e.get(i,s))}for(s=l-1;s>=0;s--){for(n=0;n<o;n++)h.set(s,n,h.get(s,n)/this.Rdiag[s]);for(i=0;i<s;i++)for(n=0;n<o;n++)h.set(i,n,h.get(i,n)-h.get(s,n)*e.get(i,s))}return h.subMatrix(0,l-1,0,o-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,i=r.columns,n=new Q(i,i);for(t=0;t<i;t++)for(e=0;e<i;e++)t<e?n.set(t,e,r.get(t,e)):t===e?n.set(t,e,this.Rdiag[t]):n.set(t,e,0);return n}get orthogonalMatrix(){let t,e,r,i,n=this.QR,s=n.rows,a=n.columns,o=new Q(s,a);for(r=a-1;r>=0;r--){for(t=0;t<s;t++)o.set(t,r,0);for(o.set(r,r,1),e=r;e<a;e++)if(0!==n.get(r,r)){for(i=0,t=r;t<s;t++)i+=n.get(t,r)*o.get(t,e);for(i=-i/n.get(r,r),t=r;t<s;t++)o.set(t,e,o.get(t,e)+i*n.get(t,r))}}return o}}class bt{constructor(t,e={}){if(t=dt.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,i=t.columns;const{computeLeftSingularVectors:n=!0,computeRightSingularVectors:s=!0,autoTranspose:a=!1}=e;let o,h=Boolean(n),l=Boolean(s),c=!1;if(r<i)if(a){o=t.transpose(),r=o.rows,i=o.columns,c=!0;let e=h;h=l,l=e}else o=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else o=t.clone();let u=Math.min(r,i),f=Math.min(r+1,i),d=new Float64Array(f),m=new Q(r,u),g=new Q(i,i),p=new Float64Array(i),w=new Float64Array(r),b=new Float64Array(f);for(let M=0;M<f;M++)b[M]=M;let y=Math.min(r-1,i),_=Math.max(0,Math.min(i-2,r)),v=Math.max(y,_);for(let M=0;M<v;M++){if(M<y){d[M]=0;for(let t=M;t<r;t++)d[M]=pt(d[M],o.get(t,M));if(0!==d[M]){o.get(M,M)<0&&(d[M]=-d[M]);for(let t=M;t<r;t++)o.set(t,M,o.get(t,M)/d[M]);o.set(M,M,o.get(M,M)+1)}d[M]=-d[M]}for(let t=M+1;t<i;t++){if(M<y&&0!==d[M]){let e=0;for(let i=M;i<r;i++)e+=o.get(i,M)*o.get(i,t);e=-e/o.get(M,M);for(let i=M;i<r;i++)o.set(i,t,o.get(i,t)+e*o.get(i,M))}p[t]=o.get(M,t)}if(h&&M<y)for(let t=M;t<r;t++)m.set(t,M,o.get(t,M));if(M<_){p[M]=0;for(let t=M+1;t<i;t++)p[M]=pt(p[M],p[t]);if(0!==p[M]){p[M+1]<0&&(p[M]=0-p[M]);for(let t=M+1;t<i;t++)p[t]/=p[M];p[M+1]+=1}if(p[M]=-p[M],M+1<r&&0!==p[M]){for(let t=M+1;t<r;t++)w[t]=0;for(let t=M+1;t<r;t++)for(let e=M+1;e<i;e++)w[t]+=p[e]*o.get(t,e);for(let t=M+1;t<i;t++){let e=-p[t]/p[M+1];for(let i=M+1;i<r;i++)o.set(i,t,o.get(i,t)+e*w[i])}}if(l)for(let t=M+1;t<i;t++)g.set(t,M,p[t])}}let x=Math.min(i,r+1);if(y<i&&(d[y]=o.get(y,y)),r<x&&(d[x-1]=0),_+1<x&&(p[_]=o.get(_,x-1)),p[x-1]=0,h){for(let t=y;t<u;t++){for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<u;e++){let i=0;for(let n=t;n<r;n++)i+=m.get(n,t)*m.get(n,e);i=-i/m.get(t,t);for(let n=t;n<r;n++)m.set(n,e,m.get(n,e)+i*m.get(n,t))}for(let e=t;e<r;e++)m.set(e,t,-m.get(e,t));m.set(t,t,1+m.get(t,t));for(let e=0;e<t-1;e++)m.set(e,t,0)}else{for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}}if(l)for(let M=i-1;M>=0;M--){if(M<_&&0!==p[M])for(let t=M+1;t<i;t++){let e=0;for(let r=M+1;r<i;r++)e+=g.get(r,M)*g.get(r,t);e=-e/g.get(M+1,M);for(let r=M+1;r<i;r++)g.set(r,t,g.get(r,t)+e*g.get(r,M))}for(let t=0;t<i;t++)g.set(t,M,0);g.set(M,M,1)}let k=x-1,A=Number.EPSILON;while(x>0){let t,e;for(t=x-2;t>=-1;t--){if(-1===t)break;const e=Number.MIN_VALUE+A*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===x-2)e=4;else{let r;for(r=x-1;r>=t;r--){if(r===t)break;let e=(r!==x?Math.abs(p[r]):0)+(r!==t+1?Math.abs(p[r-1]):0);if(Math.abs(d[r])<=A*e){d[r]=0;break}}r===t?e=3:r===x-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=p[x-2];p[x-2]=0;for(let r=x-2;r>=t;r--){let n=pt(d[r],e),s=d[r]/n,a=e/n;if(d[r]=n,r!==t&&(e=-a*p[r-1],p[r-1]=s*p[r-1]),l)for(let t=0;t<i;t++)n=s*g.get(t,r)+a*g.get(t,x-1),g.set(t,x-1,-a*g.get(t,r)+s*g.get(t,x-1)),g.set(t,r,n)}break}case 2:{let e=p[t-1];p[t-1]=0;for(let i=t;i<x;i++){let n=pt(d[i],e),s=d[i]/n,a=e/n;if(d[i]=n,e=-a*p[i],p[i]=s*p[i],h)for(let e=0;e<r;e++)n=s*m.get(e,i)+a*m.get(e,t-1),m.set(e,t-1,-a*m.get(e,i)+s*m.get(e,t-1)),m.set(e,i,n)}break}case 3:{const e=Math.max(Math.abs(d[x-1]),Math.abs(d[x-2]),Math.abs(p[x-2]),Math.abs(d[t]),Math.abs(p[t])),n=d[x-1]/e,s=d[x-2]/e,a=p[x-2]/e,o=d[t]/e,c=p[t]/e,u=((s+n)*(s-n)+a*a)/2,f=n*a*(n*a);let w=0;0===u&&0===f||(w=u<0?0-Math.sqrt(u*u+f):Math.sqrt(u*u+f),w=f/(u+w));let b=(o+n)*(o-n)+w,y=o*c;for(let _=t;_<x-1;_++){let e=pt(b,y);0===e&&(e=Number.MIN_VALUE);let n=b/e,s=y/e;if(_!==t&&(p[_-1]=e),b=n*d[_]+s*p[_],p[_]=n*p[_]-s*d[_],y=s*d[_+1],d[_+1]=n*d[_+1],l)for(let t=0;t<i;t++)e=n*g.get(t,_)+s*g.get(t,_+1),g.set(t,_+1,-s*g.get(t,_)+n*g.get(t,_+1)),g.set(t,_,e);if(e=pt(b,y),0===e&&(e=Number.MIN_VALUE),n=b/e,s=y/e,d[_]=e,b=n*p[_]+s*d[_+1],d[_+1]=-s*p[_]+n*d[_+1],y=s*p[_+1],p[_+1]=n*p[_+1],h&&_<r-1)for(let t=0;t<r;t++)e=n*m.get(t,_)+s*m.get(t,_+1),m.set(t,_+1,-s*m.get(t,_)+n*m.get(t,_+1)),m.set(t,_,e)}p[x-2]=b;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,l))for(let e=0;e<=k;e++)g.set(e,t,-g.get(e,t));while(t<k){if(d[t]>=d[t+1])break;let e=d[t];if(d[t]=d[t+1],d[t+1]=e,l&&t<i-1)for(let r=0;r<i;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);if(h&&t<r-1)for(let i=0;i<r;i++)e=m.get(i,t+1),m.set(i,t+1,m.get(i,t)),m.set(i,t,e);t++}x--;break}}if(c){let t=g;g=m,m=t}this.m=r,this.n=i,this.s=d,this.U=m,this.V=g}solve(t){let e=t,r=this.threshold,i=this.s.length,n=Q.zeros(i,i);for(let u=0;u<i;u++)Math.abs(this.s[u])<=r?n.set(u,u,0):n.set(u,u,1/this.s[u]);let s=this.U,a=this.rightSingularVectors,o=a.mmul(n),h=a.rows,l=s.rows,c=Q.zeros(h,l);for(let u=0;u<h;u++)for(let t=0;t<l;t++){let e=0;for(let r=0;r<i;r++)e+=o.get(u,r)*s.get(t,r);c.set(u,t,e)}return c.mmul(e)}solveForDiagonal(t){return this.solve(Q.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,i=t.columns,n=new Q(r,this.s.length);for(let l=0;l<r;l++)for(let r=0;r<i;r++)Math.abs(this.s[r])>e&&n.set(l,r,t.get(l,r)/this.s[r]);let s=this.U,a=s.rows,o=s.columns,h=new Q(r,a);for(let l=0;l<r;l++)for(let t=0;t<a;t++){let e=0;for(let r=0;r<o;r++)e+=n.get(l,r)*s.get(t,r);h.set(l,t,e)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let i=0,n=r.length;i<n;i++)r[i]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Q.diag(this.s)}}function yt(t,e=!1){return t=dt.checkMatrix(t),e?new bt(t).inverse():_t(t,Q.eye(t.rows))}function _t(t,e,r=!1){return t=dt.checkMatrix(t),e=dt.checkMatrix(e),r?new bt(t).solve(e):t.isSquare()?new gt(t).solve(e):new wt(t).solve(e)}function vt(t){if(t=Q.checkMatrix(t),t.isSquare()){if(0===t.columns)return 1;let e,r,i,n;if(2===t.columns)return e=t.get(0,0),r=t.get(0,1),i=t.get(1,0),n=t.get(1,1),e*n-r*i;if(3===t.columns){let n,s,a;return n=new lt(t,[1,2],[1,2]),s=new lt(t,[1,2],[0,2]),a=new lt(t,[1,2],[0,1]),e=t.get(0,0),r=t.get(0,1),i=t.get(0,2),e*vt(n)-r*vt(s)+i*vt(a)}return new gt(t).determinant}throw Error("determinant can only be calculated for a square matrix")}function xt(t,e){let r=[];for(let i=0;i<t;i++)i!==e&&r.push(i);return r}function kt(t,e,r,i=1e-9,n=1e-9){if(t>n)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<i&&t.set(e,0,0);return t.to1DArray()}}function At(t,e={}){const{thresholdValue:r=1e-9,thresholdError:i=1e-9}=e;t=Q.checkMatrix(t);let n=t.rows,s=new Q(n,n);for(let a=0;a<n;a++){let e=Q.columnVector(t.getRow(a)),o=t.subMatrixRow(xt(n,a)).transpose(),h=new bt(o),l=h.solve(e),c=Q.sub(e,o.mmul(l)).abs().max();s.setRow(a,kt(c,l,a,r,i))}return s}function Mt(t,e=Number.EPSILON){if(t=Q.checkMatrix(t),t.isEmpty())return t.transpose();let r=new bt(t,{autoTranspose:!0}),i=r.leftSingularVectors,n=r.rightSingularVectors,s=r.diagonal;for(let a=0;a<s.length;a++)Math.abs(s[a])>e?s[a]=1/s[a]:s[a]=0;return n.mmul(Q.diag(s).mmul(i.transpose()))}function Et(t,e=t,r={}){t=new Q(t);let i=!1;if("object"!==typeof e||Q.isMatrix(e)||l.isAnyArray(e)?e=new Q(e):(r=e,e=t,i=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:n=!0}=r;n&&(t=t.center("column"),i||(e=e.center("column")));const s=t.transpose().mmul(e);for(let a=0;a<s.rows;a++)for(let e=0;e<s.columns;e++)s.set(a,e,s.get(a,e)*(1/(t.rows-1)));return s}function St(t,e=t,r={}){t=new Q(t);let i=!1;if("object"!==typeof e||Q.isMatrix(e)||l.isAnyArray(e)?e=new Q(e):(r=e,e=t,i=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:n=!0,scale:s=!0}=r;n&&(t.center("column"),i||e.center("column")),s&&(t.scale("column"),i||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),o=i?a:e.standardDeviation("column",{unbiased:!0}),h=t.transpose().mmul(e);for(let l=0;l<h.rows;l++)for(let e=0;e<h.columns;e++)h.set(l,e,h.get(l,e)*(1/(a[l]*o[e]))*(1/(t.rows-1)));return h}class Rt{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(t=dt.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let i,n,s=t.columns,a=new Q(s,s),o=new Float64Array(s),h=new Float64Array(s),l=t,c=!1;if(c=!!r||t.isSymmetric(),c){for(i=0;i<s;i++)for(n=0;n<s;n++)a.set(i,n,l.get(i,n));It(s,h,o,a),Dt(s,h,o,a)}else{let t=new Q(s,s),e=new Float64Array(s);for(n=0;n<s;n++)for(i=0;i<s;i++)t.set(i,n,l.get(i,n));Ct(s,t,e,a),Bt(s,h,o,a,t)}this.n=s,this.e=h,this.d=o,this.V=a}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,i=this.e,n=this.d,s=new Q(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)s.set(t,e,0);s.set(t,t,n[t]),i[t]>0?s.set(t,t+1,i[t]):i[t]<0&&s.set(t,t-1,i[t])}return s}}function It(t,e,r,i){let n,s,a,o,h,l,c,u;for(h=0;h<t;h++)r[h]=i.get(t-1,h);for(o=t-1;o>0;o--){for(u=0,a=0,l=0;l<o;l++)u+=Math.abs(r[l]);if(0===u)for(e[o]=r[o-1],h=0;h<o;h++)r[h]=i.get(o-1,h),i.set(o,h,0),i.set(h,o,0);else{for(l=0;l<o;l++)r[l]/=u,a+=r[l]*r[l];for(n=r[o-1],s=Math.sqrt(a),n>0&&(s=-s),e[o]=u*s,a-=n*s,r[o-1]=n-s,h=0;h<o;h++)e[h]=0;for(h=0;h<o;h++){for(n=r[h],i.set(h,o,n),s=e[h]+i.get(h,h)*n,l=h+1;l<=o-1;l++)s+=i.get(l,h)*r[l],e[l]+=i.get(l,h)*n;e[h]=s}for(n=0,h=0;h<o;h++)e[h]/=a,n+=e[h]*r[h];for(c=n/(a+a),h=0;h<o;h++)e[h]-=c*r[h];for(h=0;h<o;h++){for(n=r[h],s=e[h],l=h;l<=o-1;l++)i.set(l,h,i.get(l,h)-(n*e[l]+s*r[l]));r[h]=i.get(o-1,h),i.set(o,h,0)}}r[o]=a}for(o=0;o<t-1;o++){if(i.set(t-1,o,i.get(o,o)),i.set(o,o,1),a=r[o+1],0!==a){for(l=0;l<=o;l++)r[l]=i.get(l,o+1)/a;for(h=0;h<=o;h++){for(s=0,l=0;l<=o;l++)s+=i.get(l,o+1)*i.get(l,h);for(l=0;l<=o;l++)i.set(l,h,i.get(l,h)-s*r[l])}}for(l=0;l<=o;l++)i.set(l,o+1,0)}for(h=0;h<t;h++)r[h]=i.get(t-1,h),i.set(t-1,h,0);i.set(t-1,t-1,1),e[0]=0}function Dt(t,e,r,i){let n,s,a,o,h,l,c,u,f,d,m,g,p,w,b,y;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;let _=0,v=0,x=Number.EPSILON;for(l=0;l<t;l++){v=Math.max(v,Math.abs(r[l])+Math.abs(e[l])),c=l;while(c<t){if(Math.abs(e[c])<=x*v)break;c++}if(c>l)do{for(n=r[l],u=(r[l+1]-n)/(2*e[l]),f=pt(u,1),u<0&&(f=-f),r[l]=e[l]/(u+f),r[l+1]=e[l]*(u+f),d=r[l+1],s=n-r[l],a=l+2;a<t;a++)r[a]-=s;for(_+=s,u=r[c],m=1,g=m,p=m,w=e[l+1],b=0,y=0,a=c-1;a>=l;a--)for(p=g,g=m,y=b,n=m*e[a],s=m*u,f=pt(u,e[a]),e[a+1]=b*f,b=e[a]/f,m=u/f,u=m*r[a]-b*n,r[a+1]=s+b*(m*n+b*r[a]),h=0;h<t;h++)s=i.get(h,a+1),i.set(h,a+1,b*i.get(h,a)+m*s),i.set(h,a,m*i.get(h,a)-b*s);u=-b*y*p*w*e[l]/d,e[l]=b*u,r[l]=m*u}while(Math.abs(e[l])>x*v);r[l]=r[l]+_,e[l]=0}for(a=0;a<t-1;a++){for(h=a,u=r[a],o=a+1;o<t;o++)r[o]<u&&(h=o,u=r[o]);if(h!==a)for(r[h]=r[a],r[a]=u,o=0;o<t;o++)u=i.get(o,a),i.set(o,a,i.get(o,h)),i.set(o,h,u)}}function Ct(t,e,r,i){let n,s,a,o,h,l,c,u=0,f=t-1;for(l=u+1;l<=f-1;l++){for(c=0,o=l;o<=f;o++)c+=Math.abs(e.get(o,l-1));if(0!==c){for(a=0,o=f;o>=l;o--)r[o]=e.get(o,l-1)/c,a+=r[o]*r[o];for(s=Math.sqrt(a),r[l]>0&&(s=-s),a-=r[l]*s,r[l]=r[l]-s,h=l;h<t;h++){for(n=0,o=f;o>=l;o--)n+=r[o]*e.get(o,h);for(n/=a,o=l;o<=f;o++)e.set(o,h,e.get(o,h)-n*r[o])}for(o=0;o<=f;o++){for(n=0,h=f;h>=l;h--)n+=r[h]*e.get(o,h);for(n/=a,h=l;h<=f;h++)e.set(o,h,e.get(o,h)-n*r[h])}r[l]=c*r[l],e.set(l,l-1,c*s)}}for(o=0;o<t;o++)for(h=0;h<t;h++)i.set(o,h,o===h?1:0);for(l=f-1;l>=u+1;l--)if(0!==e.get(l,l-1)){for(o=l+1;o<=f;o++)r[o]=e.get(o,l-1);for(h=l;h<=f;h++){for(s=0,o=l;o<=f;o++)s+=r[o]*i.get(o,h);for(s=s/r[l]/e.get(l,l-1),o=l;o<=f;o++)i.set(o,h,i.get(o,h)+s*r[o])}}}function Bt(t,e,r,i,n){let s,a,o,h,l,c,u,f,d,m,g,p,w,b,y,_=t-1,v=0,x=t-1,k=Number.EPSILON,A=0,M=0,E=0,S=0,R=0,I=0,D=0,C=0;for(s=0;s<t;s++)for((s<v||s>x)&&(r[s]=n.get(s,s),e[s]=0),a=Math.max(s-1,0);a<t;a++)M+=Math.abs(n.get(s,a));while(_>=v){h=_;while(h>v){if(I=Math.abs(n.get(h-1,h-1))+Math.abs(n.get(h,h)),0===I&&(I=M),Math.abs(n.get(h,h-1))<k*I)break;h--}if(h===_)n.set(_,_,n.get(_,_)+A),r[_]=n.get(_,_),e[_]=0,_--,C=0;else if(h===_-1){if(u=n.get(_,_-1)*n.get(_-1,_),E=(n.get(_-1,_-1)-n.get(_,_))/2,S=E*E+u,D=Math.sqrt(Math.abs(S)),n.set(_,_,n.get(_,_)+A),n.set(_-1,_-1,n.get(_-1,_-1)+A),f=n.get(_,_),S>=0){for(D=E>=0?E+D:E-D,r[_-1]=f+D,r[_]=r[_-1],0!==D&&(r[_]=f-u/D),e[_-1]=0,e[_]=0,f=n.get(_,_-1),I=Math.abs(f)+Math.abs(D),E=f/I,S=D/I,R=Math.sqrt(E*E+S*S),E/=R,S/=R,a=_-1;a<t;a++)D=n.get(_-1,a),n.set(_-1,a,S*D+E*n.get(_,a)),n.set(_,a,S*n.get(_,a)-E*D);for(s=0;s<=_;s++)D=n.get(s,_-1),n.set(s,_-1,S*D+E*n.get(s,_)),n.set(s,_,S*n.get(s,_)-E*D);for(s=v;s<=x;s++)D=i.get(s,_-1),i.set(s,_-1,S*D+E*i.get(s,_)),i.set(s,_,S*i.get(s,_)-E*D)}else r[_-1]=f+E,r[_]=f+E,e[_-1]=D,e[_]=-D;_-=2,C=0}else{if(f=n.get(_,_),d=0,u=0,h<_&&(d=n.get(_-1,_-1),u=n.get(_,_-1)*n.get(_-1,_)),10===C){for(A+=f,s=v;s<=_;s++)n.set(s,s,n.get(s,s)-f);I=Math.abs(n.get(_,_-1))+Math.abs(n.get(_-1,_-2)),f=d=.75*I,u=-.4375*I*I}if(30===C&&(I=(d-f)/2,I=I*I+u,I>0)){for(I=Math.sqrt(I),d<f&&(I=-I),I=f-u/((d-f)/2+I),s=v;s<=_;s++)n.set(s,s,n.get(s,s)-I);A+=I,f=d=u=.964}C+=1,l=_-2;while(l>=h){if(D=n.get(l,l),R=f-D,I=d-D,E=(R*I-u)/n.get(l+1,l)+n.get(l,l+1),S=n.get(l+1,l+1)-D-R-I,R=n.get(l+2,l+1),I=Math.abs(E)+Math.abs(S)+Math.abs(R),E/=I,S/=I,R/=I,l===h)break;if(Math.abs(n.get(l,l-1))*(Math.abs(S)+Math.abs(R))<k*(Math.abs(E)*(Math.abs(n.get(l-1,l-1))+Math.abs(D)+Math.abs(n.get(l+1,l+1)))))break;l--}for(s=l+2;s<=_;s++)n.set(s,s-2,0),s>l+2&&n.set(s,s-3,0);for(o=l;o<=_-1;o++){if(b=o!==_-1,o!==l&&(E=n.get(o,o-1),S=n.get(o+1,o-1),R=b?n.get(o+2,o-1):0,f=Math.abs(E)+Math.abs(S)+Math.abs(R),0!==f&&(E/=f,S/=f,R/=f)),0===f)break;if(I=Math.sqrt(E*E+S*S+R*R),E<0&&(I=-I),0!==I){for(o!==l?n.set(o,o-1,-I*f):h!==l&&n.set(o,o-1,-n.get(o,o-1)),E+=I,f=E/I,d=S/I,D=R/I,S/=E,R/=E,a=o;a<t;a++)E=n.get(o,a)+S*n.get(o+1,a),b&&(E+=R*n.get(o+2,a),n.set(o+2,a,n.get(o+2,a)-E*D)),n.set(o,a,n.get(o,a)-E*f),n.set(o+1,a,n.get(o+1,a)-E*d);for(s=0;s<=Math.min(_,o+3);s++)E=f*n.get(s,o)+d*n.get(s,o+1),b&&(E+=D*n.get(s,o+2),n.set(s,o+2,n.get(s,o+2)-E*R)),n.set(s,o,n.get(s,o)-E),n.set(s,o+1,n.get(s,o+1)-E*S);for(s=v;s<=x;s++)E=f*i.get(s,o)+d*i.get(s,o+1),b&&(E+=D*i.get(s,o+2),i.set(s,o+2,i.get(s,o+2)-E*R)),i.set(s,o,i.get(s,o)-E),i.set(s,o+1,i.get(s,o+1)-E*S)}}}}if(0!==M){for(_=t-1;_>=0;_--)if(E=r[_],S=e[_],0===S)for(h=_,n.set(_,_,1),s=_-1;s>=0;s--){for(u=n.get(s,s)-E,R=0,a=h;a<=_;a++)R+=n.get(s,a)*n.get(a,_);if(e[s]<0)D=u,I=R;else if(h=s,0===e[s]?n.set(s,_,0!==u?-R/u:-R/(k*M)):(f=n.get(s,s+1),d=n.get(s+1,s),S=(r[s]-E)*(r[s]-E)+e[s]*e[s],c=(f*I-D*R)/S,n.set(s,_,c),n.set(s+1,_,Math.abs(f)>Math.abs(D)?(-R-u*c)/f:(-I-d*c)/D)),c=Math.abs(n.get(s,_)),k*c*c>1)for(a=s;a<=_;a++)n.set(a,_,n.get(a,_)/c)}else if(S<0)for(h=_-1,Math.abs(n.get(_,_-1))>Math.abs(n.get(_-1,_))?(n.set(_-1,_-1,S/n.get(_,_-1)),n.set(_-1,_,-(n.get(_,_)-E)/n.get(_,_-1))):(y=Tt(0,-n.get(_-1,_),n.get(_-1,_-1)-E,S),n.set(_-1,_-1,y[0]),n.set(_-1,_,y[1])),n.set(_,_-1,0),n.set(_,_,1),s=_-2;s>=0;s--){for(m=0,g=0,a=h;a<=_;a++)m+=n.get(s,a)*n.get(a,_-1),g+=n.get(s,a)*n.get(a,_);if(u=n.get(s,s)-E,e[s]<0)D=u,R=m,I=g;else if(h=s,0===e[s]?(y=Tt(-m,-g,u,S),n.set(s,_-1,y[0]),n.set(s,_,y[1])):(f=n.get(s,s+1),d=n.get(s+1,s),p=(r[s]-E)*(r[s]-E)+e[s]*e[s]-S*S,w=2*(r[s]-E)*S,0===p&&0===w&&(p=k*M*(Math.abs(u)+Math.abs(S)+Math.abs(f)+Math.abs(d)+Math.abs(D))),y=Tt(f*R-D*m+S*g,f*I-D*g-S*m,p,w),n.set(s,_-1,y[0]),n.set(s,_,y[1]),Math.abs(f)>Math.abs(D)+Math.abs(S)?(n.set(s+1,_-1,(-m-u*n.get(s,_-1)+S*n.get(s,_))/f),n.set(s+1,_,(-g-u*n.get(s,_)-S*n.get(s,_-1))/f)):(y=Tt(-R-d*n.get(s,_-1),-I-d*n.get(s,_),D,S),n.set(s+1,_-1,y[0]),n.set(s+1,_,y[1]))),c=Math.max(Math.abs(n.get(s,_-1)),Math.abs(n.get(s,_))),k*c*c>1)for(a=s;a<=_;a++)n.set(a,_-1,n.get(a,_-1)/c),n.set(a,_,n.get(a,_)/c)}for(s=0;s<t;s++)if(s<v||s>x)for(a=s;a<t;a++)i.set(s,a,n.get(s,a));for(a=t-1;a>=v;a--)for(s=v;s<=x;s++){for(D=0,o=v;o<=Math.min(a,x);o++)D+=i.get(s,o)*n.get(o,a);i.set(s,a,D)}}}function Tt(t,e,r,i){let n,s;return Math.abs(r)>Math.abs(i)?(n=i/r,s=r+n*i,[(t+n*e)/s,(e-n*t)/s]):(n=r/i,s=i+n*r,[(n*t+e)/s,(n*e-t)/s])}class Ut{constructor(t){if(t=dt.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");let e,r,i,n=t,s=n.rows,a=new Q(s,s),o=!0;for(r=0;r<s;r++){let t=0;for(i=0;i<r;i++){let s=0;for(e=0;e<i;e++)s+=a.get(i,e)*a.get(r,e);s=(n.get(r,i)-s)/a.get(i,i),a.set(r,i,s),t+=s*s}for(t=n.get(r,r)-t,o&=t>0,a.set(r,r,Math.sqrt(Math.max(t,0))),i=r+1;i<s;i++)a.set(r,i,0)}this.L=a,this.positiveDefinite=Boolean(o)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=dt.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let i,n,s,a=t.columns,o=t.clone();for(s=0;s<r;s++)for(n=0;n<a;n++){for(i=0;i<s;i++)o.set(s,n,o.get(s,n)-o.get(i,n)*e.get(s,i));o.set(s,n,o.get(s,n)/e.get(s,s))}for(s=r-1;s>=0;s--)for(n=0;n<a;n++){for(i=s+1;i<r;i++)o.set(s,n,o.get(s,n)-o.get(i,n)*e.get(i,s));o.set(s,n,o.get(s,n)/e.get(s,s))}return o}get lowerTriangularMatrix(){return this.L}}class Pt{constructor(t,e={}){t=dt.checkMatrix(t);let{Y:r}=e;const{scaleScores:i=!1,maxIterations:n=1e3,terminationCriteria:s=1e-10}=e;let a;if(r){if(r=l.isAnyArray(r)&&"number"===typeof r[0]?Q.columnVector(r):dt.checkMatrix(r),r.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=r.getColumnVector(0)}else a=t.getColumnVector(0);let o,h,c,u,f=1;for(let l=0;l<n&&f>s;l++)c=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),c=c.div(c.norm()),o=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),l>0&&(f=o.clone().sub(u).pow(2).sum()),u=o.clone(),r?(h=r.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),h=h.div(h.norm()),a=r.mmul(h).div(h.transpose().mmul(h).get(0,0))):a=o;if(r){let e=t.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0));e=e.div(e.norm());let i=t.clone().sub(o.clone().mmul(e.transpose())),n=a.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),s=r.clone().sub(o.clone().mulS(n.get(0,0)).mmul(h.transpose()));this.t=o,this.p=e.transpose(),this.w=c.transpose(),this.q=h,this.u=a,this.s=o.transpose().mmul(o),this.xResidual=i,this.yResidual=s,this.betas=n}else this.w=c.transpose(),this.s=o.transpose().mmul(o).sqrt(),this.t=i?o.clone().div(this.s.get(0,0)):o,this.xResidual=t.sub(o.mmul(c.transpose()))}}e.AbstractMatrix=q,e.CHO=Ut,e.CholeskyDecomposition=Ut,e.DistanceMatrix=et,e.EVD=Rt,e.EigenvalueDecomposition=Rt,e.LU=gt,e.LuDecomposition=gt,e.Matrix=Q,e.MatrixColumnSelectionView=nt,e.MatrixColumnView=it,e.MatrixFlipColumnView=st,e.MatrixFlipRowView=at,e.MatrixRowSelectionView=ht,e.MatrixRowView=ot,e.MatrixSelectionView=lt,e.MatrixSubView=ct,e.MatrixTransposeView=ut,e.NIPALS=Pt,e.Nipals=Pt,e.QR=wt,e.QrDecomposition=wt,e.SVD=bt,e.SingularValueDecomposition=bt,e.SymmetricMatrix=tt,e.WrapperMatrix1D=ft,e.WrapperMatrix2D=dt,e.correlation=St,e.covariance=Et,e["default"]=Q,e.determinant=vt,e.inverse=yt,e.linearDependencies=At,e.pseudoInverse=Mt,e.solve=_t,e.wrap=mt},56364:function(t){function e(t,e){t=t||0;for(var r=new Array(t),i=0;i<t;i++)r[i]=e;return r}t.exports=e},45232:function(t){function e(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1)}t.exports=e},8998:function(t,e,r){"use strict";r(44114);var i=r(74686),n=r(87294),s=r(24272),a=r(19757),o=5,h=11102230246251565e-32,l=(3+16*h)*h,c=(7+56*h)*h;function u(t,e,r,i){return function(r,n,s){var a=t(t(e(n[1],s[0]),e(-s[1],n[0])),t(e(r[1],n[0]),e(-n[1],r[0]))),o=t(e(r[1],s[0]),e(-s[1],r[0])),h=i(a,o);return h[h.length-1]}}function f(t,e,r,i){return function(n,s,a,o){var h=t(t(r(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]),t(r(t(e(s[1],o[0]),e(-o[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),o[2]))),t(r(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),o[2])))),l=t(t(r(t(e(a[1],o[0]),e(-o[1],a[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),o[2]))),t(r(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),a[2])))),c=i(h,l);return c[c.length-1]}}function d(t,e,r,i){return function(n,s,a,o,h){var l=t(t(t(r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),a[2]),t(r(t(e(a[1],h[0]),e(-h[1],a[0])),-o[2]),r(t(e(a[1],o[0]),e(-o[1],a[0])),h[2]))),s[3]),t(r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),s[2]),t(r(t(e(s[1],h[0]),e(-h[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),h[2]))),-a[3]),r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),s[2]),t(r(t(e(s[1],h[0]),e(-h[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),h[2]))),o[3]))),t(r(t(r(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]),t(r(t(e(s[1],o[0]),e(-o[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),o[2]))),-h[3]),t(r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),s[2]),t(r(t(e(s[1],h[0]),e(-h[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),h[2]))),n[3]),r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),n[2]),t(r(t(e(n[1],h[0]),e(-h[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),h[2]))),-s[3])))),t(t(r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),n[2]),t(r(t(e(n[1],h[0]),e(-h[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),h[2]))),o[3]),t(r(t(r(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),o[2]))),-h[3]),r(t(r(t(e(a[1],o[0]),e(-o[1],a[0])),s[2]),t(r(t(e(s[1],o[0]),e(-o[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),o[2]))),n[3]))),t(r(t(r(t(e(a[1],o[0]),e(-o[1],a[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),o[2]))),-s[3]),t(r(t(r(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),o[2]))),a[3]),r(t(r(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),a[2]))),-o[3]))))),c=t(t(t(r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),a[2]),t(r(t(e(a[1],h[0]),e(-h[1],a[0])),-o[2]),r(t(e(a[1],o[0]),e(-o[1],a[0])),h[2]))),n[3]),r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),n[2]),t(r(t(e(n[1],h[0]),e(-h[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),h[2]))),-a[3])),t(r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),n[2]),t(r(t(e(n[1],h[0]),e(-h[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),h[2]))),o[3]),r(t(r(t(e(a[1],o[0]),e(-o[1],a[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),o[2]))),-h[3]))),t(t(r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),s[2]),t(r(t(e(s[1],h[0]),e(-h[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),h[2]))),n[3]),r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),n[2]),t(r(t(e(n[1],h[0]),e(-h[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),h[2]))),-s[3])),t(r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),n[2]),t(r(t(e(n[1],h[0]),e(-h[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),h[2]))),a[3]),r(t(r(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),a[2]))),-h[3])))),u=i(l,c);return u[u.length-1]}}function m(t){var e=3===t?u:4===t?f:d;return e(n,i,s,a)}var g=m(3),p=m(4),w=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,r){var i,n=(t[1]-r[1])*(e[0]-r[0]),s=(t[0]-r[0])*(e[1]-r[1]),a=n-s;if(n>0){if(s<=0)return a;i=n+s}else{if(!(n<0))return a;if(s>=0)return a;i=-(n+s)}var o=l*i;return a>=o||a<=-o?a:g(t,e,r)},function(t,e,r,i){var n=t[0]-i[0],s=e[0]-i[0],a=r[0]-i[0],o=t[1]-i[1],h=e[1]-i[1],l=r[1]-i[1],u=t[2]-i[2],f=e[2]-i[2],d=r[2]-i[2],m=s*l,g=a*h,w=a*o,b=n*l,y=n*h,_=s*o,v=u*(m-g)+f*(w-b)+d*(y-_),x=(Math.abs(m)+Math.abs(g))*Math.abs(u)+(Math.abs(w)+Math.abs(b))*Math.abs(f)+(Math.abs(y)+Math.abs(_))*Math.abs(d),k=c*x;return v>k||-v>k?v:p(t,e,r,i)}];function b(t){var e=w[t.length];return e||(e=w[t.length]=m(t.length)),e.apply(void 0,t)}function y(t,e,r,i,n,s,a){return function(e,r,o,h,l){switch(arguments.length){case 0:case 1:return 0;case 2:return i(e,r);case 3:return n(e,r,o);case 4:return s(e,r,o,h);case 5:return a(e,r,o,h,l)}for(var c=new Array(arguments.length),u=0;u<arguments.length;++u)c[u]=arguments[u];return t(c)}}function _(){while(w.length<=o)w.push(m(w.length));t.exports=y.apply(void 0,[b].concat(w));for(var e=0;e<=o;++e)t.exports[e]=w[e]}_()},24113:function(t,e,r){t.exports=n;var i=r(8998);function n(t,e){for(var r=e[0],n=e[1],s=t.length,a=1,o=s,h=0,l=s-1;h<o;l=h++){var c=t[h],u=t[l],f=c[1],d=u[1];if(d<f){if(d<n&&n<f){var m=i(c,u,e);if(0===m)return 0;a^=0<m|0}else if(n===f){var g=t[(h+1)%s],p=g[1];if(f<p){m=i(c,u,e);if(0===m)return 0;a^=0<m|0}}}else if(f<d){if(f<n&&n<d){m=i(c,u,e);if(0===m)return 0;a^=m<0|0}else if(n===f){g=t[(h+1)%s],p=g[1];if(p<f){m=i(c,u,e);if(0===m)return 0;a^=m<0|0}}}else if(n===f){var w=Math.min(c[0],u[0]),b=Math.max(c[0],u[0]);if(0===h){while(l>0){var y=(l+s-1)%s,_=t[y];if(_[1]!==n)break;var v=_[0];w=Math.min(w,v),b=Math.max(b,v),l=y}if(0===l)return w<=r&&r<=b?0:1;o=l+1}var x=t[(l+s-1)%s][1];while(h+1<o){_=t[h+1];if(_[1]!==n)break;v=_[0];w=Math.min(w,v),b=Math.max(b,v),h+=1}if(w<=r&&r<=b)return 0;var k=t[(h+1)%s][1];r<w&&x<n!==k<n&&(a^=1)}}return 2*a-1}},24272:function(t,e,r){"use strict";var i=r(74686),n=r(2510);function s(t,e){var r=t.length;if(1===r){var s=i(t[0],e);return s[0]?s:[s[1]]}var a=new Array(2*r),o=[.1,.1],h=[.1,.1],l=0;i(t[0],e,o),o[0]&&(a[l++]=o[0]);for(var c=1;c<r;++c){i(t[c],e,h);var u=o[1];n(u,h[0],o),o[0]&&(a[l++]=o[0]);var f=h[1],d=o[1],m=f+d,g=m-f,p=d-g;o[1]=m,p&&(a[l++]=p)}return o[1]&&(a[l++]=o[1]),0===l&&(a[l++]=0),a.length=l,a}t.exports=s},19757:function(t){"use strict";function e(t,e){var r=t+e,i=r-t,n=r-i,s=e-i,a=t-n,o=a+s;return o?[o,r]:[r]}function r(t,r){var i=0|t.length,n=0|r.length;if(1===i&&1===n)return e(t[0],-r[0]);var s,a,o=i+n,h=new Array(o),l=0,c=0,u=0,f=Math.abs,d=t[c],m=f(d),g=-r[u],p=f(g);m<p?(a=d,c+=1,c<i&&(d=t[c],m=f(d))):(a=g,u+=1,u<n&&(g=-r[u],p=f(g))),c<i&&m<p||u>=n?(s=d,c+=1,c<i&&(d=t[c],m=f(d))):(s=g,u+=1,u<n&&(g=-r[u],p=f(g)));var w,b,y,_,v,x=s+a,k=x-s,A=a-k,M=A,E=x;while(c<i&&u<n)m<p?(s=d,c+=1,c<i&&(d=t[c],m=f(d))):(s=g,u+=1,u<n&&(g=-r[u],p=f(g))),a=M,x=s+a,k=x-s,A=a-k,A&&(h[l++]=A),w=E+x,b=w-E,y=w-b,_=x-b,v=E-y,M=v+_,E=w;while(c<i)s=d,a=M,x=s+a,k=x-s,A=a-k,A&&(h[l++]=A),w=E+x,b=w-E,y=w-b,_=x-b,v=E-y,M=v+_,E=w,c+=1,c<i&&(d=t[c]);while(u<n)s=g,a=M,x=s+a,k=x-s,A=a-k,A&&(h[l++]=A),w=E+x,b=w-E,y=w-b,_=x-b,v=E-y,M=v+_,E=w,u+=1,u<n&&(g=-r[u]);return M&&(h[l++]=M),E&&(h[l++]=E),l||(h[l++]=0),h.length=l,h}t.exports=r},87294:function(t){"use strict";function e(t,e){var r=t+e,i=r-t,n=r-i,s=e-i,a=t-n,o=a+s;return o?[o,r]:[r]}function r(t,r){var i=0|t.length,n=0|r.length;if(1===i&&1===n)return e(t[0],r[0]);var s,a,o=i+n,h=new Array(o),l=0,c=0,u=0,f=Math.abs,d=t[c],m=f(d),g=r[u],p=f(g);m<p?(a=d,c+=1,c<i&&(d=t[c],m=f(d))):(a=g,u+=1,u<n&&(g=r[u],p=f(g))),c<i&&m<p||u>=n?(s=d,c+=1,c<i&&(d=t[c],m=f(d))):(s=g,u+=1,u<n&&(g=r[u],p=f(g)));var w,b,y,_,v,x=s+a,k=x-s,A=a-k,M=A,E=x;while(c<i&&u<n)m<p?(s=d,c+=1,c<i&&(d=t[c],m=f(d))):(s=g,u+=1,u<n&&(g=r[u],p=f(g))),a=M,x=s+a,k=x-s,A=a-k,A&&(h[l++]=A),w=E+x,b=w-E,y=w-b,_=x-b,v=E-y,M=v+_,E=w;while(c<i)s=d,a=M,x=s+a,k=x-s,A=a-k,A&&(h[l++]=A),w=E+x,b=w-E,y=w-b,_=x-b,v=E-y,M=v+_,E=w,c+=1,c<i&&(d=t[c]);while(u<n)s=g,a=M,x=s+a,k=x-s,A=a-k,A&&(h[l++]=A),w=E+x,b=w-E,y=w-b,_=x-b,v=E-y,M=v+_,E=w,u+=1,u<n&&(g=r[u]);return M&&(h[l++]=M),E&&(h[l++]=E),l||(h[l++]=0),h.length=l,h}t.exports=r},74686:function(t){"use strict";t.exports=r;var e=+(Math.pow(2,27)+1);function r(t,r,i){var n=t*r,s=e*t,a=s-t,o=s-a,h=t-o,l=e*r,c=l-r,u=l-c,f=r-u,d=n-o*u,m=d-h*u,g=m-o*f,p=h*f-g;return i?(i[0]=p,i[1]=n,i):[p,n]}},2510:function(t){"use strict";function e(t,e,r){var i=t+e,n=i-t,s=i-n,a=e-n,o=t-s;return r?(r[0]=o+a,r[1]=i,r):[o+a,i]}t.exports=e},67266:function(t,e,r){"use strict";r(16280),r(44114),r(14603),r(47566),r(98721);var i=r(89108),n=navigator.hardwareConcurrency||1;Function.prototype;function s(t,e){if("string"!==typeof t&&"function"!==typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!==typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(n-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,n):this._numWorkers=n,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var r=e.deps;"string"===typeof r&&(r=[r]),Array.isArray(r)||(r=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(r)}s.prototype._init=function(t){for(var e=i.newWorkerURL(this._workerCode,t),r=0;r<this._numWorkers;r++){var n=new Worker(e);n.onmessage=this._onmessage.bind(this,n),n.onerror=this._onerror.bind(this,n),n.running=!1,n.id=r,this._workers.set(n,null)}URL.revokeObjectURL(e)},s.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var r=this._workers.get(t);r&&r[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},s.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var r=this._workers.get(t);r&&r[0](e.data.data),this._workers.set(t,null),this._exec()}},s.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var r=this._waiting[e];if("number"!==typeof r[4]||r[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:r[0],args:r[1]},r[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,r[3]),this._working++;break}}}},s.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},s.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var r=[];for(var i of this._workers.keys())r.push(this.post(t,e,[],i.id));return Promise.all(r)},s.prototype.post=function(t,e,r,i){void 0===e&&(e=[]),void 0===r&&(r=[]),Array.isArray(e)||(e=[e]),Array.isArray(r)||(r=[r]);var n=this;return new Promise((function(s,a){if(n._terminated)throw new Error("Cannot post (terminated)");n._waiting.push([t,e,r,[s,a],i]),n._exec()}))},t.exports=s},89108:function(t,e,r){"use strict";r(16280),r(13611),r(14603),r(47566),r(98721);var i=function(){self.window=self;function t(){this._listeners={}}t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!==typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,r){void 0===r?r=[]:Array.isArray(r)||(r=[r]),self.postMessage({id:t,data:e},r)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(r,i){e._send(t.data.id,r,i)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}},n=i.toString().split('"CODE";');e.newWorkerURL=function(t,e){var r=new Blob(["(",n[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",n[1],")();"],{type:"application/javascript"});return URL.createObjectURL(r)}},95866:function(t,e,r){"use strict";r(16280),r(14603),r(47566),r(98721);class i{static downloadText(t,e,r="text/plain"){const i=new Blob([t],{type:r});this.downloadBlob(i,e)}static downloadJSON(t,e="data.json"){const r=JSON.stringify(t,null,2);this.downloadText(r,e,"application/json")}static downloadCSV(t,e="data.csv",r=null){let i="";r&&r.length>0&&(i+=r.join(",")+"\n"),t.forEach((t=>{if(Array.isArray(t))i+=t.map((t=>`"${t}"`)).join(",")+"\n";else if("object"===typeof t){const e=r?r.map((e=>t[e]||"")):Object.values(t);i+=e.map((t=>`"${t}"`)).join(",")+"\n"}}));const n="\ufeff";this.downloadText(n+i,e,"text/csv;charset=utf-8")}static downloadImage(t,e="image.png"){const r=document.createElement("a");r.download=e,r.href=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}static downloadCanvas(t,e="canvas.png",r="image/png",i=1){const n=t.toDataURL(r,i);this.downloadImage(n,e)}static downloadBlob(t,e){const r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}static downloadURL(t,e){const r=document.createElement("a");r.href=t,r.download=e,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)}static async downloadZip(t,e="files.zip"){const i=(await r.e(4813).then(r.t.bind(r,44813,23))).default,n=new i;t.forEach((t=>{t.content,Blob,n.file(t.name,t.content)}));try{const t=await n.generateAsync({type:"blob"});return this.downloadBlob(t,e),!0}catch(s){return console.error("生成ZIP文件失败:",s),!1}}static async fetchBlob(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.blob()}catch(e){throw console.error("获取文件失败:",e),e}}static generateTimestampFilename(t,e){const r=(new Date).toISOString().replace(/[:.]/g,"-").slice(0,-5);return`${t}_${r}.${e}`}static formatFileSize(t){if(0===t)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(2))+" "+r[i]}}e.A=i},75912:function(t,e,r){"use strict";r(16280),r(14603),r(47566),r(98721);var i=r(44813),n=r.n(i);class s{static formatBytes(t){if(0===t)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(2))+" "+r[i]}static getFileExtension(t){return t.slice(2+(t.lastIndexOf(".")-1>>>0))}static getExt(t){return t.split(".").pop().toLowerCase()}static getFileNameWithoutExtension(t){return t.replace(/\.[^/.]+$/,"")}static getBaseName(t){const e=-1===t.lastIndexOf(".")?t:t.substring(0,t.lastIndexOf("."));return e}static isImageFile(t){const e=["jpg","jpeg","png","gif","bmp","webp","svg"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static isVideoFile(t){const e=["mp4","avi","mov","wmv","flv","webm","mkv"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static isAudioFile(t){const e=["mp3","wav","flac","aac","ogg","wma"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static isDocumentFile(t){const e=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static generateUniqueFileName(t){const e=Date.now(),r=Math.random().toString(36).substring(2,8),i=this.getFileExtension(t),n=this.getFileNameWithoutExtension(t);return`${n}_${e}_${r}.${i}`}static fileToBase64(t){return new Promise(((e,r)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>e(i.result),i.onerror=t=>r(t)}))}static downloadFile(t,e){const r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}static blobToFile(t,e){return new File([t],e,{type:t.type})}static fileToBlob(t){return t instanceof Blob?t:new Blob([t],{type:t.type})}static isBlob(t){return t instanceof Blob}static async getBlobByUrl(t){if(s.isBlob(t))return t;try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok: "+e.statusText);return await e.blob()}catch(e){throw console.error("Error fetching the blob:",e),e}}static async download(t,e){let r=null;r=s.isBlob(t)?t:await s.getBlobByUrl(t);const i=URL.createObjectURL(r),n=document.createElement("a");n.href=i,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}static async downloadAsZip(t,e=(new Date).getTime()+".zip",r="file_url",i="save_name"){const a=new(n());for(const n of t){const t=await s.getBlobByUrl(n[r]);a.file(n[i],t)}try{const t=await a.generateAsync({type:"blob"});await s.download(t,e)}catch(o){console.error("Error while generating zip:",o)}}static compressImage(t,e=.8,r=1920,i=1080){return new Promise((n=>{const s=document.createElement("canvas"),a=s.getContext("2d"),o=new Image;o.onload=()=>{let{width:h,height:l}=o;h>r&&(l=l*r/h,h=r),l>i&&(h=h*i/l,l=i),s.width=h,s.height=l,a.drawImage(o,0,0,h,l),s.toBlob((e=>{const r=new File([e],t.name,{type:t.type,lastModified:Date.now()});n(r)}),t.type,e)},o.src=URL.createObjectURL(t)}))}}e.A=s},90679:function(t,e,r){"use strict";var i=r(1625),n=TypeError;t.exports=function(t,e){if(i(e,t))return t;throw new n("Incorrect invocation")}},55002:function(t){"use strict";t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},64979:function(t,e,r){"use strict";var i=r(46518),n=r(44576),s=r(97751),a=r(6980),o=r(24913).f,h=r(39297),l=r(90679),c=r(23167),u=r(32603),f=r(55002),d=r(16193),m=r(43724),g=r(96395),p="DOMException",w=s("Error"),b=s(p),y=function(){l(this,_);var t=arguments.length,e=u(t<1?void 0:arguments[0]),r=u(t<2?void 0:arguments[1],"Error"),i=new b(e,r),n=new w(e);return n.name=p,o(i,"stack",a(1,d(n.stack,1))),c(i,this,y),i},_=y.prototype=b.prototype,v="stack"in new w(p),x="stack"in new b(1,2),k=b&&m&&Object.getOwnPropertyDescriptor(n,p),A=!!k&&!(k.writable&&k.configurable),M=v&&!A&&!x;i({global:!0,constructor:!0,forced:g||M},{DOMException:M?y:b});var E=s(p),S=E.prototype;if(S.constructor!==E)for(var R in g||o(S,"constructor",a(1,E)),f)if(h(f,R)){var I=f[R],D=I.s;h(E,D)||o(E,D,a(6,I.c))}},5987:function(t,e,r){function i(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}r(16280),t.exports=i,t.exports.__esModule=!0,t.exports["default"]=t.exports},84428:function(t,e,r){function i(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}r(16280),t.exports=i,t.exports.__esModule=!0,t.exports["default"]=t.exports},59577:function(t,e,r){var i=r(5987);function n(t,e){return t.get(i(t,e))}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},67826:function(t,e,r){var i=r(84428);function n(t,e,r){i(t,e),e.set(t,r)}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},43325:function(t,e,r){var i=r(5987);function n(t,e,r){return t.set(i(t,e),r),r}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},82887:function(t,e,r){var i=r(84428);function n(t,e){i(t,e),e.add(t)}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},74550:function(t,e,r){var i=r(20081);function n(t,e,r){return(e=i(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},74612:function(t,e,r){r(16280);var i=r(47045)["default"];function n(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},20081:function(t,e,r){var i=r(47045)["default"],n=r(74612);function s(t){var e=n(t,"string");return"symbol"==i(e)?e:e+""}t.exports=s,t.exports.__esModule=!0,t.exports["default"]=t.exports},47045:function(t){function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports["default"]=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports["default"]=t.exports},77753:function(t){"use strict";t.exports={version:"1.0.1"}}}]);
//# sourceMappingURL=926.9bdb857e.js.map