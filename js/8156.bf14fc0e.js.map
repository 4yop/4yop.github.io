{"version":3,"file":"js/8156.bf14fc0e.js","mappings":"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","sources":["webpack://web-tool-vue/./src/views/img/ColorAnalyzeView.vue","webpack://web-tool-vue/src/views/img/ColorAnalyzeView.vue","webpack://web-tool-vue/./src/views/img/ColorAnalyzeView.vue?37a6","webpack://web-tool-vue/./src/views/img/ColorAnalyzeView.vue?e8d7","webpack://web-tool-vue/./src/util/ExcelUtil.js","webpack://web-tool-vue/./node_modules/core-js/internals/regexp-flags.js","webpack://web-tool-vue/./node_modules/core-js/modules/es.regexp.flags.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"modern-bg\"},[_c('el-row',{attrs:{\"gutter\":0,\"justify\":\"center\"}},[_c('el-col',{attrs:{\"xs\":{span: 24, offset: 0},\"sm\":{span: 22, offset: 1},\"md\":{span: 18, offset: 3},\"lg\":{span: 14, offset: 5},\"xl\":{span: 12, offset: 6}}},[_c('el-card',{staticClass:\"modern-card\",attrs:{\"shadow\":\"hover\"}},[_c('div',{staticClass:\"upload-row\"},[_c('el-upload',{attrs:{\"action\":\"#\",\"auto-upload\":false,\"multiple\":true,\"show-file-list\":false,\"accept\":\"image/*\",\"on-change\":_vm.handleUploadChange}},[_c('el-button',{attrs:{\"type\":\"primary\",\"round\":\"\"}},[_vm._v(\"选择图片\")])],1),_c('el-button',{attrs:{\"type\":\"success\",\"round\":\"\",\"disabled\":_vm.imgs.length === 0},on:{\"click\":_vm.handleAnalyzeAll}},[_vm._v(\"批量分析\")]),_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.$refs.imgTable.clearSelection()}}},[_vm._v(\"全不选\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\",\"disabled\":_vm.multipleSelection.length === 0},on:{\"click\":_vm.handleBatchDelete}},[_vm._v(\"批量删除\")]),_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"mini\",\"disabled\":_vm.imgs.filter(img => img.analyzed).length === 0},on:{\"click\":_vm.handleExportExcel}},[_vm._v(\"导出Excel\")])],1),_c('div',{staticStyle:{\"margin-top\":\"24px\"}},[_c('div',{staticClass:\"table-scroll-x\"},[_c('el-table',{ref:\"imgTable\",staticStyle:{\"width\":\"auto\",\"min-width\":\"900px\",\"margin\":\"0 auto\"},attrs:{\"data\":_vm.imgs,\"border\":\"\"},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"50\"}}),_c('el-table-column',{attrs:{\"label\":\"原图\",\"align\":\"center\",\"width\":\"120\",\"fixed\":\"left\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.img)?_c('el-image',{staticStyle:{\"width\":\"120px\",\"border-radius\":\"10px\",\"box-shadow\":\"0 2px 8px rgba(0,0,0,0.08)\"},attrs:{\"src\":scope.row.img,\"alt\":scope.row.imgFile.name,\"preview-src-list\":_vm.imgs.map(i => i.img)}}):_vm._e(),(scope.row.imgFile)?_c('p',{staticClass:\"img-info\"},[_vm._v(\"大小:\"+_vm._s(scope.row.imgFile.size)+\"B\")]):_vm._e()]}}])}),_c('el-table-column',{attrs:{\"label\":\"主色\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.mainColor)?_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\",\"justify-content\":\"center\",\"gap\":\"8px\"}},[_c('span',{style:(`display:inline-block;width:32px;height:32px;border-radius:6px;background:rgb(${scope.row.mainColor})`)}),_c('el-tooltip',{attrs:{\"content\":\"点击复制\",\"placement\":\"top\"}},[_c('span',{staticStyle:{\"cursor\":\"pointer\",\"user-select\":\"all\"},on:{\"click\":function($event){_vm.copyColor('rgb(' + scope.row.mainColor.join(', ') + ')')}}},[_vm._v(\"rgb(\"+_vm._s(scope.row.mainColor.join(', '))+\")\")])]),_c('el-tooltip',{attrs:{\"content\":\"点击复制\",\"placement\":\"top\"}},[_c('span',{staticStyle:{\"color\":\"#888\",\"cursor\":\"pointer\",\"user-select\":\"all\"},on:{\"click\":function($event){_vm.copyColor('#' + _vm.getHexColor(scope.row.mainColor))}}},[_vm._v(\"#\"+_vm._s(_vm.getHexColor(scope.row.mainColor)))])])],1):_c('span',[_vm._v(\"--\")])]}}])}),_c('el-table-column',{attrs:{\"label\":\"平均色\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.avgColor)?_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\",\"justify-content\":\"center\",\"gap\":\"8px\"}},[_c('span',{style:(`display:inline-block;width:32px;height:32px;border-radius:6px;background:rgb(${scope.row.avgColor})`)}),_c('el-tooltip',{attrs:{\"content\":\"点击复制\",\"placement\":\"top\"}},[_c('span',{staticStyle:{\"cursor\":\"pointer\",\"user-select\":\"all\"},on:{\"click\":function($event){_vm.copyColor('rgb(' + scope.row.avgColor.join(', ') + ')')}}},[_vm._v(\"rgb(\"+_vm._s(scope.row.avgColor.join(', '))+\")\")])]),_c('el-tooltip',{attrs:{\"content\":\"点击复制\",\"placement\":\"top\"}},[_c('span',{staticStyle:{\"color\":\"#888\",\"cursor\":\"pointer\",\"user-select\":\"all\"},on:{\"click\":function($event){_vm.copyColor('#' + _vm.getHexColor(scope.row.avgColor))}}},[_vm._v(\"#\"+_vm._s(_vm.getHexColor(scope.row.avgColor)))])])],1):_c('span',[_vm._v(\"--\")])]}}])}),_c('el-table-column',{attrs:{\"label\":\"说明\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('h2',{staticStyle:{\"color\":\"red\"}},[_vm._v(_vm._s(scope.row.msg))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\",\"width\":\"90\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.handleDeleteRow(scope.$index)}}},[_vm._v(\"删除\")])]}}])})],1)],1)])])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\r\nimport { ColorUtil } from '@/util/ColorUtil'\r\nimport { ClipboardUtil } from '@/util/ClipboardUtil'\r\nimport { ExcelUtil } from '@/util/ExcelUtil'\r\n\r\nexport default {\r\n  name: 'ColorAnalyzeView',\r\n  metaInfo: {\r\n    title: '图片主色与平均色提取 - 免费色彩分析工具',\r\n    meta: [\r\n      { name: 'description', content: '自动分析图片主色调、平均色值及调色板，用于网页配色、视觉设计参考。' },\r\n      { name: 'keywords', content: '提取主色,色彩分析,在线配色工具,图片平均色,图像颜色识别' }\r\n    ]\r\n  },\r\n  data() {\r\n    return {\r\n\r\n      imgs: [],\r\n      multipleSelection: []\r\n    }\r\n  },\r\n  methods: {\r\n    // 适配 el-upload\r\n    handleUploadChange(file, fileList) {\r\n      this.imgs = [];\r\n      for (const f of fileList) {\r\n        const rawFile = f.raw || f;\r\n        let imgInfo = {\r\n          img: URL.createObjectURL(rawFile),\r\n          imgFile: rawFile,\r\n          mainColor: null,\r\n          avgColor: null,\r\n          analyzed: false,\r\n          msg: '',\r\n        };\r\n        this.imgs.push(imgInfo);\r\n      }\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n    },\r\n    handleDeleteRow(index) {\r\n      URL.revokeObjectURL(this.imgs[index].img);\r\n      this.imgs.splice(index, 1);\r\n    },\r\n    handleBatchDelete() {\r\n      this.multipleSelection.forEach(img => {\r\n        URL.revokeObjectURL(img.img);\r\n      });\r\n      this.imgs = this.imgs.filter(img => !this.multipleSelection.includes(img));\r\n      this.multipleSelection = [];\r\n    },\r\n    async handleAnalyzeAll() {\r\n      for (const img of this.imgs) {\r\n        await this.analyzeColor(img);\r\n      }\r\n    },\r\n    async analyzeColor(item) {\r\n      if (item.analyzed) return;\r\n      item.msg = '分析中...';\r\n      try {\r\n        const mainColor = await ColorUtil.getImageMainColor(item.imgFile);\r\n        const avgColor = await ColorUtil.getImageAvgColor(item.imgFile);\r\n        item.mainColor = mainColor;\r\n        item.avgColor = avgColor;\r\n        item.analyzed = true;\r\n        item.msg = '完成';\r\n      } catch (e) {\r\n        item.msg = '分析失败';\r\n        console.error('颜色分析失败:', e);\r\n      }\r\n    },\r\n\r\n\r\n    async copyColor(text) {\r\n      try {\r\n        const success = await ClipboardUtil.copyText(text);\r\n        if (success) {\r\n          this.$message.success('已复制: ' + text);\r\n        } else {\r\n          this.$message.error('复制失败');\r\n        }\r\n      } catch (error) {\r\n        this.$message.error('复制失败: ' + error.message);\r\n      }\r\n    },\r\n    async handleDownloadZip() {\r\n      // 移除打包下载功能\r\n    },\r\n    handleExportExcel() {\r\n      try {\r\n        ExcelUtil.exportColorAnalysis(this.imgs);\r\n        this.$message.success('Excel导出成功！');\r\n      } catch (error) {\r\n        this.$message.error('导出失败: ' + error.message);\r\n      }\r\n    },\r\n\r\n    // 获取HEX颜色值（用于模板显示）\r\n    getHexColor(rgb) {\r\n      if (!rgb || rgb.length !== 3) return '';\r\n      return rgb.map(x => x.toString(16).padStart(2, '0')).join('').toUpperCase();\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"modern-bg\">\r\n    <el-row :gutter=\"0\" justify=\"center\">\r\n      <el-col :xs=\"{span: 24, offset: 0}\" :sm=\"{span: 22, offset: 1}\" :md=\"{span: 18, offset: 3}\" :lg=\"{span: 14, offset: 5}\" :xl=\"{span: 12, offset: 6}\">\r\n        <el-card shadow=\"hover\" class=\"modern-card\">\r\n          <div class=\"upload-row\">\r\n            <el-upload\r\n              action=\"#\"\r\n              :auto-upload=\"false\"\r\n              :multiple=\"true\"\r\n              :show-file-list=\"false\"\r\n              accept=\"image/*\"\r\n              :on-change=\"handleUploadChange\"\r\n            >\r\n              <el-button type=\"primary\" round>选择图片</el-button>\r\n            </el-upload>\r\n            <el-button type=\"success\" round :disabled=\"imgs.length === 0\" @click=\"handleAnalyzeAll\">批量分析</el-button>\r\n            <el-button size=\"mini\" @click=\"$refs.imgTable.clearSelection()\">全不选</el-button>\r\n            <el-button type=\"danger\" size=\"mini\" :disabled=\"multipleSelection.length === 0\" @click=\"handleBatchDelete\">批量删除</el-button>\r\n            <!-- 移除打包下载按钮 -->\r\n            <el-button type=\"success\" size=\"mini\" :disabled=\"imgs.filter(img => img.analyzed).length === 0\" @click=\"handleExportExcel\">导出Excel</el-button>\r\n          </div>\r\n          <div style=\"margin-top: 24px;\">\r\n            <div class=\"table-scroll-x\">\r\n              <el-table ref=\"imgTable\" :data=\"imgs\" border style=\"width: auto; min-width: 900px; margin: 0 auto;\" @selection-change=\"handleSelectionChange\">\r\n                <el-table-column type=\"selection\" width=\"50\"></el-table-column>\r\n                <el-table-column label=\"原图\" align=\"center\" width=\"120\" fixed=\"left\">\r\n                  <template slot-scope=\"scope\">\r\n                    <el-image\r\n                      style=\"width: 120px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);\"\r\n                      :src=\"scope.row.img\"\r\n                      v-if=\"scope.row.img\"\r\n                      :alt=\"scope.row.imgFile.name\"\r\n                      :preview-src-list=\"imgs.map(i => i.img)\"\r\n                    />\r\n                    <p class=\"img-info\" v-if=\"scope.row.imgFile\">大小:{{scope.row.imgFile.size}}B</p>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"主色\" align=\"center\">\r\n                  <template slot-scope=\"scope\">\r\n                    <div v-if=\"scope.row.mainColor\" style=\"display:flex;align-items:center;justify-content:center;gap:8px;\">\r\n                      <span :style=\"`display:inline-block;width:32px;height:32px;border-radius:6px;background:rgb(${scope.row.mainColor})`\"></span>\r\n                      <el-tooltip content=\"点击复制\" placement=\"top\">\r\n                        <span style=\"cursor:pointer;user-select:all;\" @click=\"copyColor('rgb(' + scope.row.mainColor.join(', ') + ')')\">rgb({{scope.row.mainColor.join(', ')}})</span>\r\n                      </el-tooltip>\r\n                      <el-tooltip content=\"点击复制\" placement=\"top\">\r\n                        <span style=\"color:#888;cursor:pointer;user-select:all;\" @click=\"copyColor('#' + getHexColor(scope.row.mainColor))\">#{{getHexColor(scope.row.mainColor)}}</span>\r\n                      </el-tooltip>\r\n                    </div>\r\n                    <span v-else>--</span>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"平均色\" align=\"center\">\r\n                  <template slot-scope=\"scope\">\r\n                    <div v-if=\"scope.row.avgColor\" style=\"display:flex;align-items:center;justify-content:center;gap:8px;\">\r\n                      <span :style=\"`display:inline-block;width:32px;height:32px;border-radius:6px;background:rgb(${scope.row.avgColor})`\"></span>\r\n                      <el-tooltip content=\"点击复制\" placement=\"top\">\r\n                        <span style=\"cursor:pointer;user-select:all;\" @click=\"copyColor('rgb(' + scope.row.avgColor.join(', ') + ')')\">rgb({{scope.row.avgColor.join(', ')}})</span>\r\n                      </el-tooltip>\r\n                      <el-tooltip content=\"点击复制\" placement=\"top\">\r\n                        <span style=\"color:#888;cursor:pointer;user-select:all;\" @click=\"copyColor('#' + getHexColor(scope.row.avgColor))\">#{{getHexColor(scope.row.avgColor)}}</span>\r\n                      </el-tooltip>\r\n                    </div>\r\n                    <span v-else>--</span>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"说明\" align=\"center\">\r\n                  <template slot-scope=\"scope\">\r\n                    <h2 style=\"color: red;\">{{scope.row.msg}}</h2>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"操作\" align=\"center\" width=\"90\">\r\n                  <template slot-scope=\"scope\">\r\n                    <el-button type=\"danger\" size=\"mini\" @click=\"handleDeleteRow(scope.$index)\">删除</el-button>\r\n                  </template>\r\n                </el-table-column>\r\n              </el-table>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.modern-bg {\r\n  //min-height: 100vh;\r\n  background: #f6f8fa;\r\n  //padding: 32px 0;\r\n}\r\n.modern-card {\r\n  border-radius: 16px;\r\n  box-shadow: 0 4px 24px rgba(0,0,0,0.08);\r\n  margin-bottom: 32px;\r\n}\r\n.upload-row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16px;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n}\r\n.img-info {\r\n  font-size: 13px;\r\n  color: #888;\r\n  margin: 4px 0 0 0;\r\n}\r\n.img-mask-wrap {\r\n  display: inline-block;\r\n  position: relative;\r\n  max-width: 100%;\r\n  max-height: 320px;\r\n}\r\n.scramble-mask-overlay {\r\n  position: absolute;\r\n  left: 0; top: 0; right: 0; bottom: 0;\r\n  background: rgba(255,255,255,0.85);\r\n  z-index: 10;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 10px;\r\n  pointer-events: auto;\r\n}\r\n.table-scroll-x {\r\n  width: 100%;\r\n  overflow-x: auto;\r\n}\r\n@media screen and (max-width: 768px) {\r\n  .modern-card > .el-card__body {\r\n    padding: 5px !important;\r\n  }\r\n  .el-table th.el-table__cell > .cell {\r\n    padding-left: 5px !important;\r\n    padding-right: 5px !important;\r\n  }\r\n}\r\n</style> ","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ColorAnalyzeView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ColorAnalyzeView.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ColorAnalyzeView.vue?vue&type=template&id=5bdcecc8&scoped=true\"\nimport script from \"./ColorAnalyzeView.vue?vue&type=script&lang=js\"\nexport * from \"./ColorAnalyzeView.vue?vue&type=script&lang=js\"\nimport style0 from \"./ColorAnalyzeView.vue?vue&type=style&index=0&id=5bdcecc8&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5bdcecc8\",\n  null\n  \n)\n\nexport default component.exports","import * as XLSX from 'xlsx';\n\n/**\n * Excel处理工具类\n */\nexport class ExcelUtil {\n    /**\n     * 导出数据到Excel\n     * @param {Array} data - 数据数组\n     * @param {string} filename - 文件名\n     * @param {string} sheetName - 工作表名称\n     * @param {Object} options - 选项\n     */\n    static exportToExcel(data, filename = 'export.xlsx', sheetName = 'Sheet1', options = {}) {\n        try {\n            if (!data || data.length === 0) {\n                throw new Error('导出数据不能为空');\n            }\n\n            // 创建工作簿\n            const wb = XLSX.utils.book_new();\n            \n            // 创建工作表\n            const ws = XLSX.utils.json_to_sheet(data, options);\n            \n            // 添加工作表到工作簿\n            XLSX.utils.book_append_sheet(wb, ws, sheetName);\n            \n            // 导出文件\n            XLSX.writeFile(wb, filename);\n            \n            return true;\n        } catch (error) {\n            console.error('Excel导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * 导出OCR识别结果到Excel\n     * @param {Array} imgs - 图片数组\n     * @param {string} filename - 文件名\n     */\n    static exportOcrResults(imgs, filename = 'ocr_results.xlsx') {\n        const data = imgs\n            .filter(img => img.recognizedText && img.recognizedText.trim())\n            .map((img, index) => ({\n                '序号': index + 1,\n                '文件名': img.imgFile ? img.imgFile.name : `图片${index + 1}`,\n                '识别状态': img.status,\n                '识别文字': img.recognizedText,\n                '用时(秒)': img.duration || 0,\n                '错误信息': img.errorMessage || ''\n            }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的识别结果');\n        }\n\n        return this.exportToExcel(data, filename, 'OCR识别结果');\n    }\n\n    /**\n     * 导出颜色分析结果到Excel\n     * @param {Array} colors - 颜色数组\n     * @param {string} filename - 文件名\n     */\n    static exportColorResults(colors, filename = 'color_analysis.xlsx') {\n        const data = colors.map((color, index) => ({\n            '序号': index + 1,\n            'RGB': `rgb(${color.rgb.join(', ')})`,\n            'HEX': `#${color.hex}`,\n            'HSL': color.hsl ? `hsl(${color.hsl.join(', ')})` : '',\n            '占比': color.percentage ? `${color.percentage}%` : '',\n            '像素数': color.count || 0\n        }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的颜色数据');\n        }\n\n        return this.exportToExcel(data, filename, '颜色分析结果');\n    }\n\n    /**\n     * 导出EXIF信息到Excel\n     * @param {Object} exifData - EXIF数据\n     * @param {string} filename - 文件名\n     */\n    static exportExifData(exifData, filename = 'exif_data.xlsx') {\n        const data = Object.entries(exifData).map(([key, value]) => ({\n            '属性': key,\n            '值': value\n        }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的EXIF数据');\n        }\n\n        return this.exportToExcel(data, filename, 'EXIF信息');\n    }\n\n    /**\n     * 导出二维码识别结果到Excel\n     * @param {Array} qrResults - 二维码结果数组\n     * @param {string} filename - 文件名\n     */\n    static exportQrResults(qrResults, filename = 'qr_results.xlsx') {\n        const data = qrResults\n            .filter(result => result.text && result.text.trim())\n            .map((result, index) => ({\n                '序号': index + 1,\n                '文件名': result.fileName || `图片${index + 1}`,\n                '二维码内容': result.text,\n                '格式': result.format || 'QR_CODE',\n                '识别状态': result.status || '成功'\n            }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的二维码识别结果');\n        }\n\n        return this.exportToExcel(data, filename, '二维码识别结果');\n    }\n\n    /**\n     * 读取Excel文件\n     * @param {File} file - Excel文件\n     * @returns {Promise<Object>} Excel数据\n     */\n    static readExcelFile(file) {\n        return new Promise((resolve, reject) => {\n            if (!file) {\n                reject(new Error('文件不能为空'));\n                return;\n            }\n\n            const reader = new FileReader();\n            \n            reader.onload = (e) => {\n                try {\n                    const data = new Uint8Array(e.target.result);\n                    const workbook = XLSX.read(data, { type: 'array' });\n                    \n                    const result = {};\n                    workbook.SheetNames.forEach(sheetName => {\n                        const worksheet = workbook.Sheets[sheetName];\n                        result[sheetName] = XLSX.utils.sheet_to_json(worksheet);\n                    });\n                    \n                    resolve(result);\n                } catch (error) {\n                    reject(new Error(`Excel文件读取失败: ${error.message}`));\n                }\n            };\n            \n            reader.onerror = () => {\n                reject(new Error('文件读取失败'));\n            };\n            \n            reader.readAsArrayBuffer(file);\n        });\n    }\n\n    /**\n     * 创建带样式的Excel工作表\n     * @param {Array} data - 数据数组\n     * @param {Object} styles - 样式配置\n     * @returns {Object} 工作表对象\n     */\n    static createStyledWorksheet(data, styles = {}) {\n        const ws = XLSX.utils.json_to_sheet(data);\n        \n        // 设置列宽\n        if (styles.columnWidths) {\n            ws['!cols'] = styles.columnWidths.map(width => ({ wch: width }));\n        }\n        \n        // 设置行高\n        if (styles.rowHeights) {\n            ws['!rows'] = styles.rowHeights.map(height => ({ hpt: height }));\n        }\n        \n        return ws;\n    }\n\n    /**\n     * 批量导出多个工作表\n     * @param {Array} sheets - 工作表数组 [{name, data, options}]\n     * @param {string} filename - 文件名\n     */\n    static exportMultipleSheets(sheets, filename = 'export.xlsx') {\n        try {\n            if (!sheets || sheets.length === 0) {\n                throw new Error('工作表数据不能为空');\n            }\n\n            const wb = XLSX.utils.book_new();\n            \n            sheets.forEach(sheet => {\n                if (!sheet.name || !sheet.data) {\n                    throw new Error('工作表必须包含name和data属性');\n                }\n                \n                const ws = XLSX.utils.json_to_sheet(sheet.data, sheet.options || {});\n                XLSX.utils.book_append_sheet(wb, ws, sheet.name);\n            });\n            \n            XLSX.writeFile(wb, filename);\n            \n            return true;\n        } catch (error) {\n            console.error('多工作表导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * 将数据转换为CSV格式\n     * @param {Array} data - 数据数组\n     * @param {string} delimiter - 分隔符\n     * @returns {string} CSV字符串\n     */\n    static dataToCSV(data, delimiter = ',') {\n        if (!data || data.length === 0) {\n            return '';\n        }\n\n        const headers = Object.keys(data[0]);\n        const csvContent = [\n            headers.join(delimiter),\n            ...data.map(row => \n                headers.map(header => {\n                    const value = row[header];\n                    // 如果值包含分隔符、换行符或引号，需要用引号包围\n                    if (typeof value === 'string' && \n                        (value.includes(delimiter) || value.includes('\\n') || value.includes('\"'))) {\n                        return `\"${value.replace(/\"/g, '\"\"')}\"`;\n                    }\n                    return value;\n                }).join(delimiter)\n            )\n        ].join('\\n');\n\n        return csvContent;\n    }\n\n    /**\n     * 导出CSV文件\n     * @param {Array} data - 数据数组\n     * @param {string} filename - 文件名\n     * @param {string} delimiter - 分隔符\n     */\n    static exportToCSV(data, filename = 'export.csv', delimiter = ',') {\n        try {\n            const csvContent = this.dataToCSV(data, delimiter);\n\n            if (!csvContent) {\n                throw new Error('没有可导出的数据');\n            }\n\n            const blob = new Blob(['\\ufeff' + csvContent], {\n                type: 'text/csv;charset=utf-8;'\n            });\n\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(blob);\n            link.download = filename;\n            link.style.display = 'none';\n\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n\n            URL.revokeObjectURL(link.href);\n\n            return true;\n        } catch (error) {\n            console.error('CSV导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * 导出图片颜色分析结果到Excel\n     * @param {Array} colorResults - 颜色分析结果数组\n     * @param {string} filename - 文件名\n     */\n    static exportColorAnalysis(colorResults, filename) {\n        try {\n            if (!colorResults || colorResults.length === 0) {\n                throw new Error('没有可导出的颜色分析结果');\n            }\n\n            // 过滤出已分析的结果\n            const analyzedResults = colorResults.filter(result => result.analyzed);\n\n            if (analyzedResults.length === 0) {\n                throw new Error('没有已完成分析的图片');\n            }\n\n            // 准备数据\n            const header = ['文件名', '主色RGB', '主色HEX', '平均色RGB', '平均色HEX'];\n            const data = analyzedResults.map(result => [\n                result.imgFile.name,\n                result.mainColor ? `rgb(${result.mainColor.join(', ')})` : '',\n                result.mainColor ? '#' + this.rgbToHex(result.mainColor) : '',\n                result.avgColor ? `rgb(${result.avgColor.join(', ')})` : '',\n                result.avgColor ? '#' + this.rgbToHex(result.avgColor) : ''\n            ]);\n\n            // 创建工作表\n            const ws = XLSX.utils.aoa_to_sheet([header, ...data]);\n\n            // 设置单元格样式\n            this.setColorCellStyles(ws, data);\n\n            // 设置列宽\n            ws['!cols'] = [\n                { wch: 20 }, // 文件名\n                { wch: 18 }, // 主色RGB\n                { wch: 14 }, // 主色HEX\n                { wch: 18 }, // 平均色RGB\n                { wch: 14 }  // 平均色HEX\n            ];\n\n            // 创建工作簿并导出\n            const wb = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(wb, ws, '主色平均色');\n\n            // 生成文件名\n            const finalFilename = filename || this.generateTimestampFilename('图片主色平均色', 'xlsx');\n            XLSX.writeFile(wb, finalFilename);\n\n            return true;\n        } catch (error) {\n            console.error('颜色分析结果导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * RGB转HEX（内部使用）\n     * @param {Array} rgb - RGB数组\n     * @returns {string} HEX字符串\n     */\n    static rgbToHex(rgb) {\n        if (!rgb || rgb.length !== 3) return '';\n        return rgb.map(x => x.toString(16).padStart(2, '0')).join('').toUpperCase();\n    }\n\n    /**\n     * 设置颜色单元格样式\n     * @param {Object} ws - 工作表对象\n     * @param {Array} data - 数据数组\n     */\n    static setColorCellStyles(ws, data) {\n        const mainRgbColIdx = 1, mainHexColIdx = 2, avgRgbColIdx = 3, avgHexColIdx = 4;\n\n        for (let i = 1; i <= data.length; i++) {\n            const mainHex = data[i-1][mainHexColIdx];\n            const avgHex = data[i-1][avgHexColIdx];\n\n            // 设置主色RGB单元格样式\n            if (mainHex) {\n                const mainRgbCell = ws[XLSX.utils.encode_cell({c: mainRgbColIdx, r: i})];\n                const mainHexCell = ws[XLSX.utils.encode_cell({c: mainHexColIdx, r: i})];\n\n                if (mainRgbCell) {\n                    mainRgbCell.s = {\n                        fill: { fgColor: { rgb: mainHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(mainHex) } }\n                    };\n                }\n\n                if (mainHexCell) {\n                    mainHexCell.s = {\n                        fill: { fgColor: { rgb: mainHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(mainHex) } }\n                    };\n                }\n            }\n\n            // 设置平均色RGB单元格样式\n            if (avgHex) {\n                const avgRgbCell = ws[XLSX.utils.encode_cell({c: avgRgbColIdx, r: i})];\n                const avgHexCell = ws[XLSX.utils.encode_cell({c: avgHexColIdx, r: i})];\n\n                if (avgRgbCell) {\n                    avgRgbCell.s = {\n                        fill: { fgColor: { rgb: avgHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(avgHex) } }\n                    };\n                }\n\n                if (avgHexCell) {\n                    avgHexCell.s = {\n                        fill: { fgColor: { rgb: avgHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(avgHex) } }\n                    };\n                }\n            }\n        }\n    }\n\n    /**\n     * 计算对比色（YIQ公式）\n     * @param {string} hex - HEX颜色值\n     * @returns {string} 对比色（000000 或 FFFFFF）\n     */\n    static getContrastYIQ(hex) {\n        let r = 0, g = 0, b = 0;\n\n        if (hex.length === 7) { // #RRGGBB\n            r = parseInt(hex.substr(1,2),16);\n            g = parseInt(hex.substr(3,2),16);\n            b = parseInt(hex.substr(5,2),16);\n        } else if (hex.length === 4) { // #RGB\n            r = parseInt(hex[1]+hex[1],16);\n            g = parseInt(hex[2]+hex[2],16);\n            b = parseInt(hex[3]+hex[3],16);\n        }\n\n        // YIQ公式\n        const yiq = (r*299 + g*587 + b*114) / 1000;\n        return yiq >= 128 ? '000000' : 'FFFFFF';\n    }\n\n    /**\n     * 生成带时间戳的文件名\n     * @param {string} baseName - 基础文件名\n     * @param {string} extension - 文件扩展名\n     * @returns {string} 完整文件名\n     */\n    static generateTimestampFilename(baseName, extension) {\n        const now = new Date();\n        const pad = n => n.toString().padStart(2, '0');\n        const timeStr = `${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}_${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;\n        return `${baseName}_${timeStr}.${extension}`;\n    }\n}\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.hasIndices) result += 'd';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.unicodeSets) result += 'v';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar defineBuiltInAccessor = require('../internals/define-built-in-accessor');\nvar regExpFlags = require('../internals/regexp-flags');\nvar fails = require('../internals/fails');\n\n// babel-minify and Closure Compiler transpiles RegExp('.', 'd') -> /./d and it causes SyntaxError\nvar RegExp = globalThis.RegExp;\nvar RegExpPrototype = RegExp.prototype;\n\nvar FORCED = DESCRIPTORS && fails(function () {\n  var INDICES_SUPPORT = true;\n  try {\n    RegExp('.', 'd');\n  } catch (error) {\n    INDICES_SUPPORT = false;\n  }\n\n  var O = {};\n  // modern V8 bug\n  var calls = '';\n  var expected = INDICES_SUPPORT ? 'dgimsy' : 'gimsy';\n\n  var addGetter = function (key, chr) {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty(O, key, { get: function () {\n      calls += chr;\n      return true;\n    } });\n  };\n\n  var pairs = {\n    dotAll: 's',\n    global: 'g',\n    ignoreCase: 'i',\n    multiline: 'm',\n    sticky: 'y'\n  };\n\n  if (INDICES_SUPPORT) pairs.hasIndices = 'd';\n\n  for (var key in pairs) addGetter(key, pairs[key]);\n\n  // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n  var result = Object.getOwnPropertyDescriptor(RegExpPrototype, 'flags').get.call(O);\n\n  return result !== expected || calls !== expected;\n});\n\n// `RegExp.prototype.flags` getter\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nif (FORCED) defineBuiltInAccessor(RegExpPrototype, 'flags', {\n  configurable: true,\n  get: regExpFlags\n});\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","span","offset","handleUploadChange","_v","imgs","length","on","handleAnalyzeAll","$event","$refs","imgTable","clearSelection","multipleSelection","handleBatchDelete","filter","img","analyzed","handleExportExcel","staticStyle","ref","handleSelectionChange","scopedSlots","_u","key","fn","scope","row","imgFile","name","map","i","_e","_s","size","mainColor","style","copyColor","join","getHexColor","avgColor","msg","handleDeleteRow","$index","staticRenderFns","metaInfo","title","meta","content","data","methods","file","fileList","f","rawFile","raw","imgInfo","URL","createObjectURL","push","val","index","revokeObjectURL","splice","forEach","includes","analyzeColor","item","ColorUtil","getImageMainColor","getImageAvgColor","e","console","error","text","success","ClipboardUtil","copyText","$message","message","handleDownloadZip","ExcelUtil","exportColorAnalysis","rgb","x","toString","padStart","toUpperCase","component","exportToExcel","filename","sheetName","options","Error","wb","XLSX","book_new","ws","json_to_sheet","book_append_sheet","exportOcrResults","recognizedText","trim","status","duration","errorMessage","exportColorResults","colors","color","hex","hsl","percentage","count","exportExifData","exifData","Object","entries","value","exportQrResults","qrResults","result","fileName","format","readExcelFile","Promise","resolve","reject","reader","FileReader","onload","Uint8Array","target","workbook","type","SheetNames","worksheet","Sheets","sheet_to_json","onerror","readAsArrayBuffer","createStyledWorksheet","styles","columnWidths","width","wch","rowHeights","height","hpt","exportMultipleSheets","sheets","sheet","dataToCSV","delimiter","headers","keys","csvContent","header","replace","exportToCSV","blob","Blob","link","document","createElement","href","download","display","body","appendChild","click","removeChild","colorResults","analyzedResults","rgbToHex","aoa_to_sheet","setColorCellStyles","finalFilename","generateTimestampFilename","mainRgbColIdx","mainHexColIdx","avgRgbColIdx","avgHexColIdx","mainHex","avgHex","mainRgbCell","encode_cell","c","r","mainHexCell","s","fill","fgColor","font","getContrastYIQ","avgRgbCell","avgHexCell","g","b","parseInt","substr","yiq","baseName","extension","now","Date","pad","n","timeStr","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","anObject","module","exports","that","hasIndices","global","ignoreCase","multiline","dotAll","unicode","unicodeSets","sticky","globalThis","DESCRIPTORS","defineBuiltInAccessor","regExpFlags","fails","RegExp","RegExpPrototype","prototype","FORCED","INDICES_SUPPORT","O","calls","expected","addGetter","chr","defineProperty","get","pairs","getOwnPropertyDescriptor","call","configurable"],"sourceRoot":""}