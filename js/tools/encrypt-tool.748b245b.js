(function(){"use strict";var t={35204:function(t,e,n){var r=n(66848),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",[e("h1",[t._v("加密 / 解密 工具（AES-GCM + PBKDF2）")]),e("p",{staticClass:"muted"},[t._v("说明：此页面既可用于把加密为密文 JSON（作者用），也可以把密文粘贴进来并用密码解密查看（读者用）。")]),e("div",{staticClass:"panel"},[e("h2",[t._v("1) 加密（把明文变成密文 JSON）")]),e("div",{staticClass:"row"},[e("label",{staticClass:"muted"},[t._v("明文（粘贴或直接编辑）：")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.plain,expression:"plain"}],attrs:{id:"plain",placeholder:"在这里粘贴你的..."},domProps:{value:t.plain},on:{input:function(e){e.target.composing||(t.plain=e.target.value)}}})]),e("div",{staticClass:"two",staticStyle:{"margin-bottom":"8px"}},[e("div",[e("label",{staticClass:"muted"},[t._v("加密密码：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pass,expression:"pass"}],attrs:{id:"enc-pass",type:"text",placeholder:"输入一个密码（）"},domProps:{value:t.pass},on:{input:function(e){e.target.composing||(t.pass=e.target.value)}}})]),e("div",[e("label",{staticClass:"muted"},[t._v("PBKDF2 迭代次数（默认 150000，越高越慢越安全）：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.iter,expression:"iter"}],attrs:{id:"iter",type:"number"},domProps:{value:t.iter},on:{input:function(e){e.target.composing||(t.iter=e.target.value)}}})])]),e("div",{staticClass:"row"},[e("button",{attrs:{id:"btn-encrypt",disabled:t.btnEncryptDisabled},on:{click:t.clickBtnEncrypt}},[t._v(" "+t._s(t.btnEncryptDisabled?"加密中...":"生成密文（加密）")+" ")]),e("div",{staticClass:"muted"},[t._v("生成的密文是可复制的 JSON 字符串，包含 salt/iv/ciphertext（Base64 编码）。把它发并告诉他们密码即可。")]),e("label",{staticClass:"muted"},[t._v("密文（JSON，复制并保存）：")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:this.cipherOutput,expression:"this.cipherOutput"}],attrs:{id:"cipher-output",readonly:"",placeholder:"密文将在这里显示"},domProps:{value:this.cipherOutput},on:{input:function(e){e.target.composing||t.$set(this,"cipherOutput",e.target.value)}}})])]),e("hr"),e("div",{staticClass:"panel",staticStyle:{"margin-top":"12px"}},[e("h2",[t._v("2) 解密（读者用：粘入密文并输入密码）")]),e("div",{staticClass:"row"},[e("label",{staticClass:"muted"},[t._v("粘贴密文 JSON：")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.cipherText,expression:"cipherText"}],attrs:{id:"cipher-input",placeholder:'例如：{"salt":"...","iv":"...","ct":"...","iter":150000}'},domProps:{value:t.cipherText},on:{input:function(e){e.target.composing||(t.cipherText=e.target.value)}}}),e("label",{staticClass:"muted"},[t._v("输入密码以解密：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.decPass,expression:"decPass"}],attrs:{id:"dec-pass",type:"text",placeholder:"输入你收到的密码"},domProps:{value:t.decPass},on:{input:function(e){e.target.composing||(t.decPass=e.target.value)}}}),e("button",{attrs:{id:"btn-decrypt",disabled:t.btnEncryptDisabled},on:{click:t.clickBtnDecrypt}},[t._v(" "+t._s(t.btnEncryptDisabled?"解密中...":"解密并显示")+" ")]),e("div",{staticStyle:{"margin-top":"8px"},attrs:{id:"dec-result"},domProps:{innerHTML:t._s(t.decResult)}})])]),e("hr"),e("div",{staticClass:"muted",staticStyle:{"margin-top":"12px"}},[t._v(" 技术说明：使用 PBKDF2（salt + 150k 迭代）派生 AES-GCM 256 位密钥；生成随机 salt(16B) 和 iv(12B)。密文以 Base64 存储在 JSON 中，可直接保存/传输。 ")])])])},a=[];n(16280),n(16573),n(78100),n(77936),n(48140),n(21903),n(91134),n(28845),n(37467),n(44732),n(79577),n(64979);function s(t){return btoa(String.fromCharCode(...new Uint8Array(t)))}function o(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n.buffer}async function c(t,e,n=15e4){const r=new TextEncoder,i=await crypto.subtle.importKey("raw",r.encode(t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:n,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function l(t,e,n=15e4){const r=new TextEncoder,i=crypto.getRandomValues(new Uint8Array(16)),a=crypto.getRandomValues(new Uint8Array(12)),o=await c(e,i.buffer,n),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},o,r.encode(t));return{salt:s(i.buffer),iv:s(a.buffer),ct:s(l),iter:n,alg:"AES-GCM-PBKDF2-SHA256"}}async function u(t,e){if(!t||!t.ct||!t.salt||!t.iv)throw new Error("密文格式错误");const n=t.iter||15e4,r=o(t.salt),i=o(t.iv),a=o(t.ct),s=await c(e,r,n),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:i},s,a),u=new TextDecoder;return u.decode(l)}function d(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var p={data(){return{plain:"",pass:"",iter:15e4,cipherOutput:"",btnEncryptDisabled:!1,cipherText:"",decPass:"",decResult:"",btnDecryptDisabled:!1}},methods:{async clickBtnDecrypt(){if(this.decResult="",!this.cipherText)return void alert("请粘贴密文 JSON");if(!this.decPass)return void alert("请输入密码");let t;try{t=JSON.parse(this.cipherText)}catch(e){return void alert("密文不是合法 JSON")}try{this.btnDecryptDisabled=!0;const e=await u(t,this.decPass);this.decResult="<h3 class='ok'>解密成功 — 如下：</h3><div style='margin-top:8px'><pre>"+d(e)+"</pre></div>"}catch(e){console.error(e),this.decResult="<div class='err'>解密失败：密码错误或密文已损坏"+e.message+"</div>"}finally{this.btnDecryptDisabled=!1}},async clickBtnEncrypt(){if(this.plain)if(this.pass)try{this.btnEncryptDisabled=!0;const t=await l(this.plain,this.pass,this.iter);this.cipherOutput=JSON.stringify(t),alert("已生成密文 JSON")}catch(t){console.error(t),alert("加密失败："+t.message)}finally{this.btnEncryptDisabled=!1}else alert("请设置一个密码");else alert("明文不能为空")}}},v=p,f=n(81656),h=(0,f.A)(v,i,a,!1,null,null,null),m=h.exports;r["default"].config.productionTip=!1,new r["default"]({render:t=>t(m),mounted(){document.dispatchEvent(new Event("render-event"))}}).$mount("#app")}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,function(){n.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){n.amdO={}}(),function(){var t=[];n.O=function(e,r,i,a){if(!r){var s=1/0;for(u=0;u<t.length;u++){r=t[u][0],i=t[u][1],a=t[u][2];for(var o=!0,c=0;c<r.length;c++)(!1&a||s>=a)&&Object.keys(n.O).every((function(t){return n.O[t](r[c])}))?r.splice(c--,1):(o=!1,a<s&&(s=a));if(o){t.splice(u--,1);var l=i();void 0!==l&&(e=l)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[r,i,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){n.j=4956}(),function(){var t={4956:0};n.O.j=function(e){return 0===t[e]};var e=function(e,r){var i,a,s=r[0],o=r[1],c=r[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(c)var u=c(n)}for(e&&e(r);l<s.length;l++)a=s[l],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(u)},r=self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=n.O(void 0,[504],(function(){return n(35204)}));r=n.O(r)})();