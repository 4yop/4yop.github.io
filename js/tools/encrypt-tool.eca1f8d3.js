(function(){"use strict";var t={35204:function(t,e,r){var n=r(66848),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",[e("h1",[t._v("加密 / 解密 工具（AES-GCM + PBKDF2）")]),e("p",{staticClass:"muted"},[t._v("说明：此页面既可用于把加密为密文 JSON（作者用），也可以把密文粘贴进来并用密码解密查看（读者用）。")]),e("div",{staticClass:"panel"},[e("h2",[t._v("1) 加密（把明文变成密文 JSON）")]),e("div",{staticClass:"row"},[e("label",{staticClass:"muted"},[t._v("明文（粘贴或直接编辑）：")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.plain,expression:"plain"}],attrs:{id:"plain",placeholder:"在这里粘贴你的..."},domProps:{value:t.plain},on:{input:function(e){e.target.composing||(t.plain=e.target.value)}}})]),e("div",{staticClass:"two",staticStyle:{"margin-bottom":"8px"}},[e("div",[e("label",{staticClass:"muted"},[t._v("加密密码：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pass,expression:"pass"}],attrs:{id:"enc-pass",type:"text",placeholder:"输入一个密码（）"},domProps:{value:t.pass},on:{input:function(e){e.target.composing||(t.pass=e.target.value)}}})]),e("div",[e("label",{staticClass:"muted"},[t._v("PBKDF2 迭代次数（默认 150000，越高越慢越安全）：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.iter,expression:"iter"}],attrs:{id:"iter",type:"number"},domProps:{value:t.iter},on:{input:function(e){e.target.composing||(t.iter=e.target.value)}}})])]),e("div",{staticClass:"row"},[e("button",{attrs:{id:"btn-encrypt",disabled:t.btnEncryptDisabled},on:{click:t.clickBtnEncrypt}},[t._v(" "+t._s(t.btnEncryptDisabled?"加密中...":"生成密文（加密）")+" ")]),e("div",{staticClass:"muted"},[t._v("生成的密文是可复制的 JSON 字符串，包含 salt/iv/ciphertext（Base64 编码）。把它发并告诉他们密码即可。")]),e("label",{staticClass:"muted"},[t._v("密文（JSON，复制并保存）：")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:this.cipherOutput,expression:"this.cipherOutput"}],attrs:{id:"cipher-output",readonly:"",placeholder:"密文将在这里显示"},domProps:{value:this.cipherOutput},on:{input:function(e){e.target.composing||t.$set(this,"cipherOutput",e.target.value)}}})])]),e("hr"),e("div",{staticClass:"panel",staticStyle:{"margin-top":"12px"}},[e("h2",[t._v("2) 解密（读者用：粘入密文并输入密码）")]),e("div",{staticClass:"row"},[e("label",{staticClass:"muted"},[t._v("粘贴密文 JSON：")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.cipherText,expression:"cipherText"}],attrs:{id:"cipher-input",placeholder:'例如：{"salt":"...","iv":"...","ct":"...","iter":150000}'},domProps:{value:t.cipherText},on:{input:function(e){e.target.composing||(t.cipherText=e.target.value)}}}),e("label",{staticClass:"muted"},[t._v("输入密码以解密：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.decPass,expression:"decPass"}],attrs:{id:"dec-pass",type:"text",placeholder:"输入你收到的密码"},domProps:{value:t.decPass},on:{input:function(e){e.target.composing||(t.decPass=e.target.value)}}}),e("button",{attrs:{id:"btn-decrypt",disabled:t.btnEncryptDisabled},on:{click:t.clickBtnDecrypt}},[t._v(" "+t._s(t.btnEncryptDisabled?"解密中...":"解密并显示")+" ")]),e("div",{staticStyle:{"margin-top":"8px"},attrs:{id:"dec-result"},domProps:{innerHTML:t._s(t.decResult)}})])]),e("hr"),e("div",{staticClass:"muted",staticStyle:{"margin-top":"12px"}},[t._v(" 技术说明：使用 PBKDF2（salt + 150k 迭代）派生 AES-GCM 256 位密钥；生成随机 salt(16B) 和 iv(12B)。密文以 Base64 存储在 JSON 中，可直接保存/传输。 ")])])])},a=[];r(16280),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(64979);function s(t){return btoa(String.fromCharCode(...new Uint8Array(t)))}function o(t){const e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r.buffer}async function c(t,e,r=15e4){const n=new TextEncoder,i=await crypto.subtle.importKey("raw",n.encode(t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:r,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function l(t,e,r=15e4){const n=new TextEncoder,i=crypto.getRandomValues(new Uint8Array(16)),a=crypto.getRandomValues(new Uint8Array(12)),o=await c(e,i.buffer,r),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},o,n.encode(t));return{salt:s(i.buffer),iv:s(a.buffer),ct:s(l),iter:r,alg:"AES-GCM-PBKDF2-SHA256"}}async function u(t,e){if(!t||!t.ct||!t.salt||!t.iv)throw new Error("密文格式错误");const r=t.iter||15e4,n=o(t.salt),i=o(t.iv),a=o(t.ct),s=await c(e,n,r),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:i},s,a),u=new TextDecoder;return u.decode(l)}function d(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var p={data(){return{plain:"",pass:"",iter:15e4,cipherOutput:"",btnEncryptDisabled:!1,cipherText:"",decPass:"",decResult:"",btnDecryptDisabled:!1}},methods:{async clickBtnDecrypt(){if(this.decResult="",!this.cipherText)return void alert("请粘贴密文 JSON");if(!this.decPass)return void alert("请输入密码");let t;try{t=JSON.parse(this.cipherText)}catch(e){return void alert("密文不是合法 JSON")}try{this.btnDecryptDisabled=!0;const e=await u(t,this.decPass);this.decResult="<h3 class='ok'>解密成功 — 如下：</h3><div style='margin-top:8px'><pre>"+d(e)+"</pre></div>"}catch(e){console.error(e),this.decResult="<div class='err'>解密失败：密码错误或密文已损坏"+e.message+"</div>"}finally{this.btnDecryptDisabled=!1}},async clickBtnEncrypt(){if(this.plain)if(this.pass)try{this.btnEncryptDisabled=!0;const t=await l(this.plain,this.pass,this.iter);this.cipherOutput=JSON.stringify(t),alert("已生成密文 JSON")}catch(t){console.error(t),alert("加密失败："+t.message)}finally{this.btnEncryptDisabled=!1}else alert("请设置一个密码");else alert("明文不能为空")}}},v=p,f=r(81656),h=(0,f.A)(v,i,a,!1,null,null,null),m=h.exports;n["default"].config.productionTip=!1,new n["default"]({render:t=>t(m),mounted(){document.dispatchEvent(new Event("render-event"))}}).$mount("#app")}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var a=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=t,function(){r.amdO={}}(),function(){var t=[];r.O=function(e,n,i,a){if(!n){var s=1/0;for(u=0;u<t.length;u++){n=t[u][0],i=t[u][1],a=t[u][2];for(var o=!0,c=0;c<n.length;c++)(!1&a||s>=a)&&Object.keys(r.O).every((function(t){return r.O[t](n[c])}))?n.splice(c--,1):(o=!1,a<s&&(s=a));if(o){t.splice(u--,1);var l=i();void 0!==l&&(e=l)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[n,i,a]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){r.j=1865}(),function(){var t={1865:0};r.O.j=function(e){return 0===t[e]};var e=function(e,n){var i,a,s=n[0],o=n[1],c=n[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(c)var u=c(r)}for(e&&e(n);l<s.length;l++)a=s[l],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(u)},n=self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=r.O(void 0,[504],(function(){return r(35204)}));n=r.O(n)})();