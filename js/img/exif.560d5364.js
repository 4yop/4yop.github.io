(function(){"use strict";var e={90108:function(e,t,n){var l=n(66848),i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modern-bg"},[t("el-row",{attrs:{gutter:0,justify:"center"}},[t("el-col",{attrs:{xs:{span:24,offset:0},sm:{span:22,offset:1},md:{span:20,offset:2},lg:{span:18,offset:3},xl:{span:16,offset:4}}},[t("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"upload-row"},[t("el-upload",{attrs:{action:"#","auto-upload":!1,multiple:!0,"show-file-list":!1,accept:"image/*",disabled:e.loading,"on-change":e.handleUploadChange}},[t("el-button",{attrs:{type:"primary",round:"",disabled:e.loading}},[e._v("选择图片")])],1),t("el-button",{attrs:{type:"success",size:"mini",disabled:0===e.imgs.length||e.loading},on:{click:e.handleParseAllExif}},[e._v("开始解析")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.$refs.imgTable.clearSelection()}}},[e._v("全不选")]),t("el-button",{attrs:{type:"danger",size:"mini",disabled:0===e.multipleSelection.length},on:{click:e.handleBatchDelete}},[e._v("批量删除")]),t("el-button",{attrs:{type:"success",size:"mini",disabled:0===e.imgs.length},on:{click:e.handleExportExcel}},[e._v("导出为Excel")])],1),t("div",{staticStyle:{"margin-top":"24px"}},[t("div",{staticClass:"table-scroll-x"},[t("el-table",{ref:"imgTable",staticStyle:{width:"auto","min-width":"900px",margin:"0 auto"},attrs:{data:e.imgs,border:"","show-summary":"","summary-method":()=>[],"scrollbar-always-on":!0},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"50"}}),t("el-table-column",{attrs:{label:"状态",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",[e._v(e._s(n.row.status))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDeleteRow(n.$index)}}},[e._v("删除")])]}}])}),t("el-table-column",{attrs:{label:"图片",align:"center",width:"100",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-image",{staticStyle:{width:"60px",height:"60px","border-radius":"8px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},attrs:{src:n.row.previewUrl,"preview-src-list":e.imgs.map((e=>e.previewUrl)),alt:n.row.name}})]}}])}),t("el-table-column",{attrs:{label:"文件名",prop:"name",align:"center",width:"180"}}),t("el-table-column",{attrs:{label:"地图",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.mapUrl?t("a",{attrs:{href:n.row.mapUrl,target:"_blank"}},[e._v("查看")]):t("span",{staticStyle:{color:"#ccc"}},[e._v("-")])]}}])}),e._l(e.exifKeys,(function(n){return t("el-table-column",{key:n.key,attrs:{label:n.label,align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return["GPSLatitude"===n.key||"GPSLongitude"===n.key?t("span",[e._v(" "+e._s(e.toDecimal(l.row.exif[n.key])||"")+" ")]):t("span",[e._v(" "+e._s(l.row.exif[n.key]||"")+" ")])]}}],null,!0)})}))],2)],1)])])],1)],1)],1)},a=[],r=(n(44114),n(14603),n(47566),n(98721),n(75453)),o=n(93230),s={name:"ExifView",metaInfo:{title:"查看图片拍摄信息(EXIF) - 支持GPS/时间/设备型号",meta:[{name:"description",content:"上传图片后，读取其 EXIF 元数据，显示拍摄设备、时间、光圈、快门、GPS等信息，支持JPG/HEIC。"},{name:"keywords",content:"EXIF查看,图片拍摄信息,GPS位置,EXIF数据,在线EXIF解析,照片元信息"}]},data(){return{imgs:[],multipleSelection:[],loading:!1,exifKeys:[{key:"GPSLatitude",label:"纬度"},{key:"GPSLongitude",label:"经度"},{key:"GPSAltitude",label:"海拔"},{key:"GPSLatitudeRef",label:"纬度参考"},{key:"GPSLongitudeRef",label:"经度参考"},{key:"GPSAltitudeRef",label:"海拔参考"},{key:"GPSDateStamp",label:"GPS日期"},{key:"GPSTimeStamp",label:"GPS时间"},{key:"Make",label:"相机品牌"},{key:"Model",label:"相机型号"},{key:"LensModel",label:"镜头型号"},{key:"Software",label:"拍摄软件"},{key:"DateTimeOriginal",label:"拍摄时间"},{key:"ModifyDate",label:"修改时间"},{key:"CreateDate",label:"创建时间"},{key:"FNumber",label:"光圈"},{key:"ExposureTime",label:"快门"},{key:"ISOSpeedRatings",label:"感光度"},{key:"ISO",label:"感光度"},{key:"FocalLength",label:"焦距"},{key:"FocalLengthIn35mmFormat",label:"等效35mm焦距"},{key:"ExposureCompensation",label:"曝光补偿"},{key:"ExposureProgram",label:"曝光程序"},{key:"MeteringMode",label:"测光模式"},{key:"Flash",label:"闪光灯"},{key:"WhiteBalance",label:"白平衡"},{key:"Orientation",label:"方向"},{key:"ImageWidth",label:"宽度"},{key:"ImageHeight",label:"高度"},{key:"PixelXDimension",label:"像素宽度"},{key:"PixelYDimension",label:"像素高度"}]}},methods:{toDecimal(e){return Array.isArray(e)?(e[0]||0)+(e[1]||0)/60+(e[2]||0)/3600:Number(e)},async handleUploadChange(e,t){this.imgs.forEach((e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl))),this.imgs=[],this.loading=!1;for(const n of t){const e=n.raw||n;this.imgs.push({file:e,name:e.name,exif:{},previewUrl:URL.createObjectURL(e),status:""})}},async handleParseAllExif(){this.loading=!0;const e="W5YBZ-JQ3EQ-VMQ5U-GQQ54-PFVDQ-LUBGC";for(let n=0;n<this.imgs.length;n++){const l=this.imgs[n];l.status="解析中...";try{l.exif=await r.Ay.parse(l.file),l.status="完成";const t=this.toDecimal(l.exif.GPSLatitude),n=this.toDecimal(l.exif.GPSLongitude);"number"!==typeof t||isNaN(t)||"number"!==typeof n||isNaN(n)?l.mapUrl="":l.mapUrl=`https://apis.map.qq.com/tools/poimarker?type=0&marker=coord:${t},${n};title:${l.name};addr:这里拍的&key=${e}&referer=web-tool`;const i=this.exifKeys.map((e=>e.key));l.otherExif=Object.entries(l.exif).filter((([e])=>!i.includes(e))).map((([e,t])=>`${e}: ${t}`)).join("; ")}catch(t){l.exif={error:"无法解析EXIF"},l.status="失败",l.mapUrl="",l.otherExif=""}}this.loading=!1},handleSelectionChange(e){this.multipleSelection=e},handleDeleteRow(e){const t=this.imgs[e];t.previewUrl&&URL.revokeObjectURL(t.previewUrl),this.imgs.splice(e,1)},handleBatchDelete(){this.multipleSelection.forEach((e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl))),this.imgs=this.imgs.filter((e=>!this.multipleSelection.includes(e))),this.multipleSelection=[]},handleExportExcel(){if(0===this.imgs.length)return void this.$message.warning("没有可导出的图片！");const e=["文件名",...this.exifKeys.map((e=>e.label))],t=this.imgs.map((e=>{const t=e.exif||{};return[`'${e.name}`,...this.exifKeys.map((e=>void 0!==t[e.key]&&null!==t[e.key]?`'${t[e.key]}`:""))]})),n=o.Wp.aoa_to_sheet([e,...t]),l=o.Wp.book_new();o.Wp.book_append_sheet(l,n,"EXIF信息");const i=new Date,a=e=>e.toString().padStart(2,"0"),r=`${i.getFullYear()}${a(i.getMonth()+1)}${a(i.getDate())}_${a(i.getHours())}${a(i.getMinutes())}${a(i.getSeconds())}`;o._h(l,`图片EXIF信息_${r}.xlsx`)},beforeDestroy(){this.imgs.forEach((e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl)))}}},c=s,u=n(81656),d=(0,u.A)(c,i,a,!1,null,"b038dede",null),f=d.exports,p=n(89143),m=n.n(p);l["default"].config.productionTip=!1,l["default"].use(m()),new l["default"]({render:e=>e(f),mounted(){document.dispatchEvent(new Event("render-event"))}}).$mount("#app")}},t={};function n(l){var i=t[l];if(void 0!==i)return i.exports;var a=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,function(){n.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){n.amdO={}}(),function(){var e=[];n.O=function(t,l,i,a){if(!l){var r=1/0;for(u=0;u<e.length;u++){l=e[u][0],i=e[u][1],a=e[u][2];for(var o=!0,s=0;s<l.length;s++)(!1&a||r>=a)&&Object.keys(n.O).every((function(e){return n.O[e](l[s])}))?l.splice(s--,1):(o=!1,a<r&&(r=a));if(o){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[l,i,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.j=6648}(),function(){var e={6648:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var i,a,r=l[0],o=l[1],s=l[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(s)var u=s(n)}for(t&&t(l);c<r.length;c++)a=r[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},l=self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[504],(function(){return n(90108)}));l=n.O(l)})();