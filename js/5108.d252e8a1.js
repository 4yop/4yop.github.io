"use strict";(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[5108],{59872:function(e,t,o){o.r(t),o.d(t,{default:function(){return u}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modern-bg"},[t("el-row",{attrs:{gutter:0,justify:"center"}},[t("el-col",{attrs:{xs:{span:24,offset:0},sm:{span:22,offset:1},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:12,offset:6}}},[t("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"upload-row"},[t("el-upload",{attrs:{action:"#","auto-upload":!1,multiple:!0,"show-file-list":!1,accept:"image/*","on-change":e.handleUploadChange}},[t("el-button",{attrs:{type:"primary",round:""}},[e._v("选择图片")])],1),t("el-button",{attrs:{type:"success",round:"",disabled:0===e.imgs.length},on:{click:e.handleAnalyzeAll}},[e._v("批量分析")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.$refs.imgTable.clearSelection()}}},[e._v("全不选")]),t("el-button",{attrs:{type:"danger",size:"mini",disabled:0===e.multipleSelection.length},on:{click:e.handleBatchDelete}},[e._v("批量删除")]),t("el-button",{attrs:{type:"success",size:"mini",disabled:0===e.imgs.filter((e=>e.analyzed)).length},on:{click:e.handleExportExcel}},[e._v("导出Excel")])],1),t("div",{staticStyle:{"margin-top":"24px"}},[t("div",{staticClass:"table-scroll-x"},[t("el-table",{ref:"imgTable",staticStyle:{width:"auto","min-width":"900px",margin:"0 auto"},attrs:{data:e.imgs,border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"50"}}),t("el-table-column",{attrs:{label:"原图",align:"center",width:"120",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.img?t("el-image",{staticStyle:{width:"120px","border-radius":"10px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},attrs:{src:o.row.img,alt:o.row.imgFile.name,"preview-src-list":e.imgs.map((e=>e.img))}}):e._e(),o.row.imgFile?t("p",{staticClass:"img-info"},[e._v("大小:"+e._s(o.row.imgFile.size)+"B")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"主色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.mainColor?t("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center",gap:"8px"}},[t("span",{style:`display:inline-block;width:32px;height:32px;border-radius:6px;background:rgb(${o.row.mainColor})`}),t("el-tooltip",{attrs:{content:"点击复制",placement:"top"}},[t("span",{staticStyle:{cursor:"pointer","user-select":"all"},on:{click:function(t){e.copyColor("rgb("+o.row.mainColor.join(", ")+")")}}},[e._v("rgb("+e._s(o.row.mainColor.join(", "))+")")])]),t("el-tooltip",{attrs:{content:"点击复制",placement:"top"}},[t("span",{staticStyle:{color:"#888",cursor:"pointer","user-select":"all"},on:{click:function(t){e.copyColor("#"+e.getHexColor(o.row.mainColor))}}},[e._v("#"+e._s(e.getHexColor(o.row.mainColor)))])])],1):t("span",[e._v("--")])]}}])}),t("el-table-column",{attrs:{label:"平均色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.avgColor?t("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center",gap:"8px"}},[t("span",{style:`display:inline-block;width:32px;height:32px;border-radius:6px;background:rgb(${o.row.avgColor})`}),t("el-tooltip",{attrs:{content:"点击复制",placement:"top"}},[t("span",{staticStyle:{cursor:"pointer","user-select":"all"},on:{click:function(t){e.copyColor("rgb("+o.row.avgColor.join(", ")+")")}}},[e._v("rgb("+e._s(o.row.avgColor.join(", "))+")")])]),t("el-tooltip",{attrs:{content:"点击复制",placement:"top"}},[t("span",{staticStyle:{color:"#888",cursor:"pointer","user-select":"all"},on:{click:function(t){e.copyColor("#"+e.getHexColor(o.row.avgColor))}}},[e._v("#"+e._s(e.getHexColor(o.row.avgColor)))])])],1):t("span",[e._v("--")])]}}])}),t("el-table-column",{attrs:{label:"说明",align:"center"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("h2",{staticStyle:{color:"red"}},[e._v(e._s(o.row.msg))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDeleteRow(o.$index)}}},[e._v("删除")])]}}])})],1)],1)])])],1)],1)],1)},n=[],l=(o(44114),o(14603),o(47566),o(98721),o(54623)),s=o(46834),a=o(92007),i={name:"ColorAnalyzeView",data(){return{metaInfo:{title:"图片主色与平均色提取 - 免费色彩分析工具",meta:[{name:"description",content:"自动分析图片主色调、平均色值及调色板，用于网页配色、视觉设计参考。"},{name:"keywords",content:"提取主色,色彩分析,在线配色工具,图片平均色,图像颜色识别"}]},imgs:[],multipleSelection:[]}},methods:{handleUploadChange(e,t){this.imgs=[];for(const o of t){const e=o.raw||o;let t={img:URL.createObjectURL(e),imgFile:e,mainColor:null,avgColor:null,analyzed:!1,msg:""};this.imgs.push(t)}},handleSelectionChange(e){this.multipleSelection=e},handleDeleteRow(e){URL.revokeObjectURL(this.imgs[e].img),this.imgs.splice(e,1)},handleBatchDelete(){this.multipleSelection.forEach((e=>{URL.revokeObjectURL(e.img)})),this.imgs=this.imgs.filter((e=>!this.multipleSelection.includes(e))),this.multipleSelection=[]},async handleAnalyzeAll(){for(const e of this.imgs)await this.analyzeColor(e)},async analyzeColor(e){if(!e.analyzed){e.msg="分析中...";try{const t=await l.I.getImageMainColor(e.imgFile),o=await l.I.getImageAvgColor(e.imgFile);e.mainColor=t,e.avgColor=o,e.analyzed=!0,e.msg="完成"}catch(t){e.msg="分析失败",console.error("颜色分析失败:",t)}}},async copyColor(e){try{const t=await s.V.copyText(e);t?this.$message.success("已复制: "+e):this.$message.error("复制失败")}catch(t){this.$message.error("复制失败: "+t.message)}},async handleDownloadZip(){},handleExportExcel(){try{a.m.exportColorAnalysis(this.imgs),this.$message.success("Excel导出成功！")}catch(e){this.$message.error("导出失败: "+e.message)}},getHexColor(e){return e&&3===e.length?e.map((e=>e.toString(16).padStart(2,"0"))).join("").toUpperCase():""}}},c=i,g=o(81656),p=(0,g.A)(c,r,n,!1,null,"780e3250",null),u=p.exports},92007:function(e,t,o){o.d(t,{m:function(){return n}});o(16280),o(16573),o(78100),o(77936),o(48140),o(21903),o(91134),o(28845),o(37467),o(44732),o(79577),o(14603),o(47566),o(98721);var r=o(93230);class n{static exportToExcel(e,t="export.xlsx",o="Sheet1",n={}){try{if(!e||0===e.length)throw new Error("导出数据不能为空");const l=r.Wp.book_new(),s=r.Wp.json_to_sheet(e,n);return r.Wp.book_append_sheet(l,s,o),r._h(l,t),!0}catch(l){throw console.error("Excel导出失败:",l),l}}static exportOcrResults(e,t="ocr_results.xlsx"){const o=e.filter((e=>e.recognizedText&&e.recognizedText.trim())).map(((e,t)=>({"序号":t+1,"文件名":e.imgFile?e.imgFile.name:`图片${t+1}`,"识别状态":e.status,"识别文字":e.recognizedText,"用时(秒)":e.duration||0,"错误信息":e.errorMessage||""})));if(0===o.length)throw new Error("没有可导出的识别结果");return this.exportToExcel(o,t,"OCR识别结果")}static exportColorResults(e,t="color_analysis.xlsx"){const o=e.map(((e,t)=>({"序号":t+1,RGB:`rgb(${e.rgb.join(", ")})`,HEX:`#${e.hex}`,HSL:e.hsl?`hsl(${e.hsl.join(", ")})`:"","占比":e.percentage?`${e.percentage}%`:"","像素数":e.count||0})));if(0===o.length)throw new Error("没有可导出的颜色数据");return this.exportToExcel(o,t,"颜色分析结果")}static exportExifData(e,t="exif_data.xlsx"){const o=Object.entries(e).map((([e,t])=>({"属性":e,"值":t})));if(0===o.length)throw new Error("没有可导出的EXIF数据");return this.exportToExcel(o,t,"EXIF信息")}static exportQrResults(e,t="qr_results.xlsx"){const o=e.filter((e=>e.text&&e.text.trim())).map(((e,t)=>({"序号":t+1,"文件名":e.fileName||`图片${t+1}`,"二维码内容":e.text,"格式":e.format||"QR_CODE","识别状态":e.status||"成功"})));if(0===o.length)throw new Error("没有可导出的二维码识别结果");return this.exportToExcel(o,t,"二维码识别结果")}static readExcelFile(e){return new Promise(((t,o)=>{if(!e)return void o(new Error("文件不能为空"));const n=new FileReader;n.onload=e=>{try{const o=new Uint8Array(e.target.result),n=r.LF(o,{type:"array"}),l={};n.SheetNames.forEach((e=>{const t=n.Sheets[e];l[e]=r.Wp.sheet_to_json(t)})),t(l)}catch(n){o(new Error(`Excel文件读取失败: ${n.message}`))}},n.onerror=()=>{o(new Error("文件读取失败"))},n.readAsArrayBuffer(e)}))}static createStyledWorksheet(e,t={}){const o=r.Wp.json_to_sheet(e);return t.columnWidths&&(o["!cols"]=t.columnWidths.map((e=>({wch:e})))),t.rowHeights&&(o["!rows"]=t.rowHeights.map((e=>({hpt:e})))),o}static exportMultipleSheets(e,t="export.xlsx"){try{if(!e||0===e.length)throw new Error("工作表数据不能为空");const o=r.Wp.book_new();return e.forEach((e=>{if(!e.name||!e.data)throw new Error("工作表必须包含name和data属性");const t=r.Wp.json_to_sheet(e.data,e.options||{});r.Wp.book_append_sheet(o,t,e.name)})),r._h(o,t),!0}catch(o){throw console.error("多工作表导出失败:",o),o}}static dataToCSV(e,t=","){if(!e||0===e.length)return"";const o=Object.keys(e[0]),r=[o.join(t),...e.map((e=>o.map((o=>{const r=e[o];return"string"===typeof r&&(r.includes(t)||r.includes("\n")||r.includes('"'))?`"${r.replace(/"/g,'""')}"`:r})).join(t)))].join("\n");return r}static exportToCSV(e,t="export.csv",o=","){try{const r=this.dataToCSV(e,o);if(!r)throw new Error("没有可导出的数据");const n=new Blob(["\ufeff"+r],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");return l.href=URL.createObjectURL(n),l.download=t,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(l.href),!0}catch(r){throw console.error("CSV导出失败:",r),r}}static exportColorAnalysis(e,t){try{if(!e||0===e.length)throw new Error("没有可导出的颜色分析结果");const o=e.filter((e=>e.analyzed));if(0===o.length)throw new Error("没有已完成分析的图片");const n=["文件名","主色RGB","主色HEX","平均色RGB","平均色HEX"],l=o.map((e=>[e.imgFile.name,e.mainColor?`rgb(${e.mainColor.join(", ")})`:"",e.mainColor?"#"+this.rgbToHex(e.mainColor):"",e.avgColor?`rgb(${e.avgColor.join(", ")})`:"",e.avgColor?"#"+this.rgbToHex(e.avgColor):""])),s=r.Wp.aoa_to_sheet([n,...l]);this.setColorCellStyles(s,l),s["!cols"]=[{wch:20},{wch:18},{wch:14},{wch:18},{wch:14}];const a=r.Wp.book_new();r.Wp.book_append_sheet(a,s,"主色平均色");const i=t||this.generateTimestampFilename("图片主色平均色","xlsx");return r._h(a,i),!0}catch(o){throw console.error("颜色分析结果导出失败:",o),o}}static rgbToHex(e){return e&&3===e.length?e.map((e=>e.toString(16).padStart(2,"0"))).join("").toUpperCase():""}static setColorCellStyles(e,t){const o=1,n=2,l=3,s=4;for(let a=1;a<=t.length;a++){const i=t[a-1][n],c=t[a-1][s];if(i){const t=e[r.Wp.encode_cell({c:o,r:a})],l=e[r.Wp.encode_cell({c:n,r:a})];t&&(t.s={fill:{fgColor:{rgb:i.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(i)}}}),l&&(l.s={fill:{fgColor:{rgb:i.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(i)}}})}if(c){const t=e[r.Wp.encode_cell({c:l,r:a})],o=e[r.Wp.encode_cell({c:s,r:a})];t&&(t.s={fill:{fgColor:{rgb:c.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(c)}}}),o&&(o.s={fill:{fgColor:{rgb:c.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(c)}}})}}}static getContrastYIQ(e){let t=0,o=0,r=0;7===e.length?(t=parseInt(e.substr(1,2),16),o=parseInt(e.substr(3,2),16),r=parseInt(e.substr(5,2),16)):4===e.length&&(t=parseInt(e[1]+e[1],16),o=parseInt(e[2]+e[2],16),r=parseInt(e[3]+e[3],16));const n=(299*t+587*o+114*r)/1e3;return n>=128?"000000":"FFFFFF"}static generateTimestampFilename(e,t){const o=new Date,r=e=>e.toString().padStart(2,"0"),n=`${o.getFullYear()}${r(o.getMonth()+1)}${r(o.getDate())}_${r(o.getHours())}${r(o.getMinutes())}${r(o.getSeconds())}`;return`${e}_${n}.${t}`}}},67979:function(e,t,o){var r=o(28551);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},69479:function(e,t,o){var r=o(44576),n=o(43724),l=o(62106),s=o(67979),a=o(79039),i=r.RegExp,c=i.prototype,g=n&&a((function(){var e=!0;try{i(".","d")}catch(g){e=!1}var t={},o="",r=e?"dgimsy":"gimsy",n=function(e,r){Object.defineProperty(t,e,{get:function(){return o+=r,!0}})},l={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var s in e&&(l.hasIndices="d"),l)n(s,l[s]);var a=Object.getOwnPropertyDescriptor(c,"flags").get.call(t);return a!==r||o!==r}));g&&l(c,"flags",{configurable:!0,get:s})}}]);
//# sourceMappingURL=5108.d252e8a1.js.map