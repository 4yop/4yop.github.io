"use strict";(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[1506],{1506:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modern-bg"},[e("el-row",{attrs:{gutter:0,justify:"center"}},[e("el-col",{attrs:{xs:{span:24,offset:0},sm:{span:22,offset:1},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:12,offset:6}}},[e("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"upload-row"},[e("el-upload",{attrs:{action:"#","auto-upload":!1,multiple:!1,"show-file-list":!1,accept:"image/*","on-change":t.handleUploadChange,disabled:t.loading}},[e("el-button",{attrs:{type:"primary",round:"",disabled:t.loading}},[t._v("选择图片")])],1),e("el-select",{staticStyle:{width:"120px","margin-left":"16px"},attrs:{filterable:"",placeholder:"切割份数",disabled:t.loading},model:{value:t.n,callback:function(e){t.n=e},expression:"n"}},t._l(t.nOptions,(function(t){return e("el-option",{key:t,attrs:{label:t+"份",value:t}})})),1),e("el-button",{attrs:{type:"success",round:"",disabled:!t.file||t.loading},on:{click:t.handleScramble}},[t._v("切割并打乱")]),t.scrambledUrl?e("el-button",{attrs:{type:"primary",size:"mini",disabled:t.loading},on:{click:t.handleDownload}},[t._v("下载拼图")]):t._e()],1),t.loading||t.progress>0?e("el-progress",{staticStyle:{margin:"16px 0"},attrs:{percentage:t.progress,status:"success","stroke-width":16,"text-inside":""}}):t._e(),t.error?e("div",{staticStyle:{color:"#f56c6c",margin:"12px 0","text-align":"center"}},[t._v(t._s(t.error))]):t._e(),e("el-row",{staticStyle:{"margin-top":"24px"},attrs:{gutter:16}},[e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{"text-align":"center"}},[e("div",{staticStyle:{"font-weight":"600","margin-bottom":"8px"}},[t._v("原图预览")]),t.imgUrl?e("el-image",{staticStyle:{"max-width":"100%","max-height":"320px","border-radius":"10px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},attrs:{src:t.imgUrl,"preview-src-list":t.loading?[]:[t.imgUrl,t.scrambledUrl],fit:"contain"}}):e("div",{staticStyle:{color:"#ccc"}},[t._v("请上传图片")])],1)]),e("el-col",{staticStyle:{position:"relative"},attrs:{span:12}},[e("div",{staticStyle:{"text-align":"center"}},[e("div",{staticStyle:{"font-weight":"600","margin-bottom":"8px"}},[t._v("打乱拼图预览")]),e("div",{staticClass:"img-mask-wrap"},[e("div",{staticClass:"img-mask-inner",staticStyle:{position:"relative"}},[t.scrambledUrl?e("el-image",{ref:"scrambledImg",staticStyle:{"max-width":"100%","border-radius":"10px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)",background:"#f0f9eb"},attrs:{src:t.scrambledUrl,"max-height":"auto",fit:"contain","preview-src-list":t.loading?[]:[t.scrambledUrl,t.imgUrl]}}):t._e(),t.showMask&&t.loading?e("div",{staticClass:"scramble-mask-overlay",style:t.scrambleMaskStyle},[e("div",{staticClass:"scramble-mask-content"})]):t._e(),t.loading&&t.progress>0&&t.progress<100?e("div",{staticClass:"scramble-progress-overlay"},[e("span",[t._v(t._s(t.progressText))])]):t._e()],1)])])])],1)],1)],1)],1)],1)},r=[],o=(a(16280),a(14603),a(47566),a(98721),a(95866)),i={name:"ScrambleView",metaInfo:{title:"图片切割打乱工具 - 生成混乱拼图效果",meta:[{name:"description",content:"将图片均匀分块并打乱顺序，可用于生成拼图谜题、视觉干扰图或趣味图像实验。"},{name:"keywords",content:"图片打乱,图片碎片,拼图工具,在线图像切割,图像干扰"}]},data(){return{file:null,imgUrl:"",n:9,nOptions:[],scrambledUrl:"",loading:!1,error:"",showMask:!1,progress:0,progressText:"",scrambleMaskStyle:{}}},created(){window.__PRERENDER_INJECTED__||(this.nOptions=Array.from({length:100},((t,e)=>(e+2)*(e+2))).filter((t=>t<=1e6)))},methods:{handleUploadChange(t,e){e.length>0?(this.file=e[e.length-1].raw||e[e.length-1],this.imgUrl=URL.createObjectURL(this.file),this.scrambledUrl="",this.error=""):(this.file=null,this.imgUrl="",this.scrambledUrl="",this.error="")},async handleScramble(){if(!this.file||!this.n)return;const t=Math.sqrt(this.n);if(t%1===0){this.loading=!0,this.showMask=!0,this.progress=0,this.progressText="切割图片中...",this.error="";try{const t=await this.splitAndShuffleImage(this.file,this.n);this.scrambledUrl=t}catch(e){this.error="处理失败："+(e.message||e)}this.loading=!1,this.showMask=!1,this.progress=0,this.progressText=""}else this.$message.error("份数必须是完全平方数（如4、9、16、25...）")},async splitAndShuffleImage(t,e){const a=Math.sqrt(e);if(a%1!==0)throw new Error("N 必须是完全平方数");const s=await this.loadImageFromFile(t),r=Math.floor(s.width/a),o=Math.floor(s.height/a),i=Array.from({length:e},((t,e)=>e));for(let c=e-1;c>0;c--){const t=Math.floor(Math.random()*(c+1));[i[c],i[t]]=[i[t],i[c]]}const l=document.createElement("canvas");l.width=r*a,l.height=o*a;const n=l.getContext("2d");for(let c=0;c<e;c++){const t=i[c],l=t%a*r,d=Math.floor(t/a)*o,h=document.createElement("canvas");h.width=r,h.height=o;const m=h.getContext("2d");m.drawImage(s,l,d,r,o,0,0,r,o);const g=c%a*r,p=Math.floor(c/a)*o;n.drawImage(h,g,p),this.progress=Math.round((c+1)/e*100),this.progressText=`切割合并 ${c+1}/${e}`,await new Promise((t=>setTimeout(t,0)))}return this.progress=100,this.progressText="完成",await this.$nextTick(),l.toDataURL("image/png")},loadImageFromFile(t){return new Promise(((e,a)=>{const s=new window.Image;s.onload=()=>e(s),s.onerror=a,s.src=URL.createObjectURL(t)}))},handleDownload(){this.scrambledUrl&&o.A.downloadImage(this.scrambledUrl,"scrambled.png")}},beforeDestroy(){this.imgUrl&&URL.revokeObjectURL(this.imgUrl),this.imgUrl="",this.scrambledUrl=""},watch:{showMask(t){t&&this.$nextTick((()=>{const t=this.$refs.scrambledImg&&this.$refs.scrambledImg.$el;t&&(this.scrambleMaskStyle={width:t.offsetWidth+"px",height:t.offsetHeight+"px",borderRadius:"10px"})}))}}},l=i,n=a(81656),c=(0,n.A)(l,s,r,!1,null,"0c93bea1",null),d=c.exports},95866:function(t,e,a){a(16280),a(14603),a(47566),a(98721);class s{static downloadText(t,e,a="text/plain"){const s=new Blob([t],{type:a});this.downloadBlob(s,e)}static downloadJSON(t,e="data.json"){const a=JSON.stringify(t,null,2);this.downloadText(a,e,"application/json")}static downloadCSV(t,e="data.csv",a=null){let s="";a&&a.length>0&&(s+=a.join(",")+"\n"),t.forEach((t=>{if(Array.isArray(t))s+=t.map((t=>`"${t}"`)).join(",")+"\n";else if("object"===typeof t){const e=a?a.map((e=>t[e]||"")):Object.values(t);s+=e.map((t=>`"${t}"`)).join(",")+"\n"}}));const r="\ufeff";this.downloadText(r+s,e,"text/csv;charset=utf-8")}static downloadImage(t,e="image.png"){const a=document.createElement("a");a.download=e,a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}static downloadCanvas(t,e="canvas.png",a="image/png",s=1){const r=t.toDataURL(a,s);this.downloadImage(r,e)}static downloadBlob(t,e){const a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}static downloadURL(t,e){const a=document.createElement("a");a.href=t,a.download=e,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}static async downloadZip(t,e="files.zip"){const s=(await a.e(4813).then(a.t.bind(a,44813,23))).default,r=new s;t.forEach((t=>{t.content,Blob,r.file(t.name,t.content)}));try{const t=await r.generateAsync({type:"blob"});return this.downloadBlob(t,e),!0}catch(o){return console.error("生成ZIP文件失败:",o),!1}}static async fetchBlob(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.blob()}catch(e){throw console.error("获取文件失败:",e),e}}static generateTimestampFilename(t,e){const a=(new Date).toISOString().replace(/[:.]/g,"-").slice(0,-5);return`${t}_${a}.${e}`}static formatFileSize(t){if(0===t)return"0 Bytes";const e=1024,a=["Bytes","KB","MB","GB","TB"],s=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,s)).toFixed(2))+" "+a[s]}}e.A=s}}]);
//# sourceMappingURL=1506.4888b9c8.js.map