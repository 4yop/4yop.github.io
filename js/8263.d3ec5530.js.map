{"version":3,"file":"js/8263.d3ec5530.js","mappings":"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","sources":["webpack://web-tool-vue/./src/views/tools/M3u8DownloaderView.vue","webpack://web-tool-vue/src/views/tools/M3u8DownloaderView.vue","webpack://web-tool-vue/./src/views/tools/M3u8DownloaderView.vue?ee04","webpack://web-tool-vue/./src/views/tools/M3u8DownloaderView.vue?1e3e"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('section',{attrs:{\"id\":\"m-app\"}},[_c('section',{staticClass:\"m-p-action g-box\"},[_vm._v(_vm._s(_vm.tips))]),_c('div',{staticClass:\"m-p-temp-url\"},[_vm._v(\"测试链接：https://upyun.luckly-mjw.cn/Assets/media-source/example/media/index.m3u8\")]),_c('section',{staticClass:\"m-p-input-container\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.task.url),expression:\"task.url\"}],attrs:{\"type\":\"text\",\"placeholder\":\"请输入 m3u8 链接\"},domProps:{\"value\":(_vm.task.url)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.task, \"url\", $event.target.value)}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.task.title),expression:\"task.title\"}],attrs:{\"type\":\"text\",\"placeholder\":\"请输入保存名\"},domProps:{\"value\":(_vm.task.title)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.task, \"title\", $event.target.value)}}}),_c('div',{on:{\"click\":function($event){return _vm.addTask()}}},[_vm._v(\"添加任务(\"+_vm._s(_vm.taskCount)+\")\")])]),_c('div',{staticClass:\"m-p-temp-url\"},[_vm._v(\"当前任务:\")]),_c('section',{staticClass:\"m-p-input-container\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.url),expression:\"url\"}],attrs:{\"type\":\"text\",\"disabled\":\"\",\"placeholder\":\"请输入 m3u8 链接\"},domProps:{\"value\":(_vm.url)},on:{\"input\":function($event){if($event.target.composing)return;_vm.url=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.title),expression:\"title\"}],attrs:{\"type\":\"text\",\"disabled\":\"\",\"placeholder\":\"请输入保存名\"},domProps:{\"value\":(_vm.title)},on:{\"input\":function($event){if($event.target.composing)return;_vm.title=$event.target.value}}}),((!_vm.downloading || _vm.rangeDownload.isShowRange) && false )?[(!_vm.rangeDownload.isShowRange)?_c('div',{on:{\"click\":function($event){return _vm.getM3U8(true)}}},[_vm._v(\"特定范围下载\")]):[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.rangeDownload.startSegment),expression:\"rangeDownload.startSegment\"}],staticClass:\"range-input\",attrs:{\"type\":\"number\",\"disabled\":_vm.downloading,\"placeholder\":\"起始片段\"},domProps:{\"value\":(_vm.rangeDownload.startSegment)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.rangeDownload, \"startSegment\", $event.target.value)}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.rangeDownload.endSegment),expression:\"rangeDownload.endSegment\"}],staticClass:\"range-input\",attrs:{\"type\":\"number\",\"disabled\":_vm.downloading,\"placeholder\":\"截止片段\"},domProps:{\"value\":(_vm.rangeDownload.endSegment)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.rangeDownload, \"endSegment\", $event.target.value)}}})]]:_vm._e(),(!_vm.downloading)?[_c('div',{on:{\"click\":function($event){return _vm.start()}}},[_vm._v(\"原格式下载\")]),(false)?_c('div',{on:{\"click\":_vm.getMP4}},[_vm._v(\"转码为MP4下载\")]):_vm._e()]:(_vm.finishNum === _vm.rangeDownload.targetSegment && _vm.rangeDownload.targetSegment > 0)?_c('div',{staticClass:\"disable\"},[_vm._v(\"下载完成\")]):_c('div',{on:{\"click\":_vm.togglePause}},[_vm._v(_vm._s(_vm.isPause ? '恢复下载' : '暂停下载'))])],2),(!_vm.downloading && _vm.isSupperStreamWrite)?_c('div',{staticClass:\"m-p-stream\",on:{\"click\":function($event){return _vm.streamDownload(false)}}},[_vm._v(\"特大视频原格式下载，边下载边保存，彻底解决大文件下载内存不足问题 \")]):_vm._e(),(!_vm.downloading && _vm.isSupperStreamWrite)?_c('div',{staticClass:\"m-p-stream\",on:{\"click\":function($event){return _vm.streamDownload(true)}}},[_vm._v(\"特大视频 MP4 格式下载，边下载边保存，彻底解决大文件下载内存不足问题 \")]):_vm._e(),(_vm.finishList.length > 0)?[_c('div',{staticClass:\"m-p-line\"}),(_vm.mediaFileList.length && !_vm.streamWriter)?_c('div',{staticClass:\"m-p-force\",on:{\"click\":_vm.forceDownload}},[_vm._v(\"强制下载现有片段\")]):_vm._e(),_c('div',{staticClass:\"m-p-tips\"},[_vm._v(\"待下载碎片总量：\"+_vm._s(_vm.rangeDownload.targetSegment)+\"，已下载：\"+_vm._s(_vm.finishNum)+\"，错误：\"+_vm._s(_vm.errorNum)+\"，进度：\"+_vm._s((_vm.finishNum / _vm.rangeDownload.targetSegment * 100).toFixed(2))+\"%\")]),_c('div',{staticClass:\"m-p-tips\",class:[_vm.errorNum ? 'error-tips' : '']},[_vm._v(\"若某视频碎片下载发生错误，将标记为红色，可点击相应图标进行重试\")]),_c('section',{staticClass:\"m-p-segment\"},_vm._l((_vm.finishList),function(item,index){return _c('div',{key:index,staticClass:\"item\",class:[item.status],attrs:{\"title\":item.title},on:{\"click\":function($event){return _vm.retry(index)}}},[_vm._v(_vm._s(index + 1))])}),0)]:_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <section id=\"m-app\" v-cloak>\n    <!--顶部操作提示-->\n    <section class=\"m-p-action g-box\">{{tips}}</section>\n\n\n    <div class=\"m-p-temp-url\">测试链接：https://upyun.luckly-mjw.cn/Assets/media-source/example/media/index.m3u8</div>\n    <section class=\"m-p-input-container\">\n      <input type=\"text\" v-model=\"task.url\"  placeholder=\"请输入 m3u8 链接\">\n      <input type=\"text\" v-model=\"task.title\" placeholder=\"请输入保存名\">\n      <div @click=\"addTask()\">添加任务({{taskCount}})</div>\n    </section>\n    <div class=\"m-p-temp-url\">当前任务:</div>\n    <section class=\"m-p-input-container\">\n\n      <input type=\"text\" v-model=\"url\" disabled placeholder=\"请输入 m3u8 链接\">\n      <input type=\"text\" v-model=\"title\" disabled placeholder=\"请输入保存名\">\n      <!--范围查询-->\n      <template v-if=\"(!downloading || rangeDownload.isShowRange) && false \">\n\n        <div  v-if=\"!rangeDownload.isShowRange\" @click=\"getM3U8(true)\">特定范围下载</div>\n        <template v-else>\n          <input class=\"range-input\" type=\"number\" v-model=\"rangeDownload.startSegment\" :disabled=\"downloading\" placeholder=\"起始片段\">\n          <input class=\"range-input\" type=\"number\" v-model=\"rangeDownload.endSegment\" :disabled=\"downloading\" placeholder=\"截止片段\">\n        </template>\n      </template>\n\n      <!--还未开始下载-->\n      <template v-if=\"!downloading\">\n        <!--@click=\"getM3U8(false)\"-->\n        <div @click=\"start()\">原格式下载</div>\n        <div v-if=\"false\" @click=\"getMP4\">转码为MP4下载</div>\n      </template>\n      <div v-else-if=\"finishNum === rangeDownload.targetSegment && rangeDownload.targetSegment > 0\" class=\"disable\">下载完成</div>\n      <div v-else @click=\"togglePause\">{{ isPause ? '恢复下载' : '暂停下载' }}</div>\n    </section>\n    <div v-if=\"!downloading && isSupperStreamWrite\" class=\"m-p-stream\" @click=\"streamDownload(false)\">特大视频原格式下载，边下载边保存，彻底解决大文件下载内存不足问题 </div>\n    <div v-if=\"!downloading && isSupperStreamWrite\" class=\"m-p-stream\" @click=\"streamDownload(true)\">特大视频 MP4 格式下载，边下载边保存，彻底解决大文件下载内存不足问题 </div>\n\n\n\n\n    <template v-if=\"finishList.length > 0\">\n      <div class=\"m-p-line\"></div>\n      <!-- <div class=\"m-p-retry\" v-if=\"errorNum && downloadIndex >= rangeDownload.targetSegment\" @click=\"retryAll\">重新下载错误片段</div> -->\n      <div class=\"m-p-force\" v-if=\"mediaFileList.length && !streamWriter\" @click=\"forceDownload\">强制下载现有片段</div>\n      <div class=\"m-p-tips\">待下载碎片总量：{{ rangeDownload.targetSegment }}，已下载：{{ finishNum }}，错误：{{ errorNum }}，进度：{{ (finishNum / rangeDownload.targetSegment * 100).toFixed(2) }}%</div>\n      <div class=\"m-p-tips\" :class=\"[errorNum ? 'error-tips' : '']\">若某视频碎片下载发生错误，将标记为红色，可点击相应图标进行重试</div>\n      <section class=\"m-p-segment\">\n        <div class=\"item\" v-for=\"(item, index) in finishList\" :key=\"index\" :class=\"[item.status]\" :title=\"item.title\" @click=\"retry(index)\">{{ index + 1 }}</div>\n      </section>\n    </template>\n\n  </section>\n</template>\n\n<script src=\"/lib/mux-mp4.js\"></script>\n<script src=\"/lib/aes-decryptor.js\"></script>\n<script src=\"/lib/stream-saver.js\"></script>\n<script>\n\nexport default {\n  name: 'M3u8DownloaderView',\n  metaInfo: {\n    title: 'M3U8视频下载器 - 在线视频下载工具',\n    meta: [\n      { name: 'description', content: 'M3U8视频下载器，支持解析M3U8播放列表并下载视频文件，提供多种下载工具命令。' },\n      { name: 'keywords', content: 'M3U8下载,视频下载,在线视频,播放列表下载,FFmpeg' }\n    ]\n  },\n  data() {\n    return {\n      task : {url :'',title:''},\n      taskCount : 0,\n      url: '', // 在线链接\n      tips: 'm3u8 视频在线提取工具', // 顶部提示\n      title: '', // 视频标题\n      isPause: false, // 是否暂停下载\n      isGetMP4: false, // 是否转码为 MP4 下载\n      durationSecond: 0, // 视频持续时长\n      isShowRefer: false, // 是否显示推送\n      downloading: false, // 是否下载中\n      beginTime: '', // 开始下载的时间\n      errorNum: 0, // 错误数\n      finishNum: 0, // 已下载数\n      downloadIndex: 0, // 当前下载片段\n      finishList: [], // 下载完成项目\n      tsUrlList: [], // ts URL数组\n      mediaFileList: [], // 下载的媒体数组\n      isSupperStreamWrite: window.streamSaver && !window.streamSaver.useBlobFallback, // 当前浏览器是否支持流式下载\n      streamWriter: null, // 文件流写入器\n      streamDownloadIndex: 0, // 文件流写入器，正准备写入第几个视频片段\n      rangeDownload: { // 特定范围下载\n        isShowRange: false, // 是否显示范围下载\n        startSegment: '', // 起始片段\n        endSegment: '', // 截止片段\n        targetSegment: 1, // 待下载片段\n      },\n      aesConf: { // AES 视频解密配置\n        method: '', // 加密算法\n        uri: '', // key 所在文件路径\n        iv: '', // 偏移值\n        key: '', // 秘钥\n        decryptor: null, // 解码器对象\n\n        stringToBuffer: function (str) {\n          return new TextEncoder().encode(str)\n        },\n      },\n    }\n  },\n  created() {\n    this.getSource();\n    window.addEventListener('keyup', this.onKeyup)\n    setInterval(this.retryAll.bind(this), 2000) // 每两秒重新下载一遍错误片段，实现错误自动重试\n    setInterval(()=>{\n      this.check();\n    },3 * 1000);\n\n    setTimeout(()=>{\n      this.start();\n    },1000);\n  },\n\n  beforeDestroy() {\n    window.removeEventListener('keyup', this.onKeyup)\n  },\n  computed: {\n\n  },\n  methods: {\n    start() {\n      let tasks = this.getTask();\n      if (tasks.length <= 0) return;\n      this.url = tasks[0].url;\n      this.title = tasks[0].title;\n      this.getM3U8(false);\n    },\n    check() {\n      if (!this.downloading) return;\n      if (this.finishNum === this.rangeDownload.targetSegment && this.rangeDownload.targetSegment > 0 )\n      {\n        let tasks = this.getTask();\n        for (let i = 0; i < tasks.length; i++) {\n          if (tasks[i].url === this.url) {\n            tasks.splice(i, 1); // 删除第i个元素\n            break; // 删除后退出循环\n          }\n        }\n        localStorage.setItem('tasks', JSON.stringify(tasks));\n        history.go(0);\n      }\n    },\n    getTask() {\n      let tasks = JSON.parse(localStorage.getItem('tasks')) || [];\n      this.taskCount = tasks.length;\n      return tasks;\n    },\n    addTask () {\n      if (!this.task.url || !this.task.title) {\n        return alert('链接或名称，填写');\n      }\n      let tasks = this.getTask();\n      if (tasks.some(task => task.url === this.task.url)) {\n        alert('已存在一样的')\n        return;\n      }\n      //判断是否存在url了\n      tasks.push({\n        url : this.task.url,\n        title : this.task.title,\n      });\n      localStorage.setItem('tasks',JSON.stringify(tasks));\n      this.task.url = '';\n      this.task.title = '';\n      this.getTask();\n    },\n\n    // 获取链接中携带的资源链接\n    getSource() {\n      let { href } = location\n      if (href.indexOf('?source=') > -1) {\n        this.url = href.split('?source=')[1]\n      }\n    },\n\n    // 获取顶部 window title，因可能存在跨域问题，故使用 try catch 进行保护\n    getDocumentTitle() {\n      return this.title\n    },\n\n    // 退出弹窗\n    onKeyup(event) {\n      if (event.keyCode === 13) { // 键入ESC\n        this.getM3U8()\n      }\n    },\n\n    // ajax 请求\n    ajax(options) {\n      options = options || {};\n      let xhr = new XMLHttpRequest();\n      if (options.type === 'file') {\n        xhr.responseType = 'arraybuffer';\n      }\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n          let status = xhr.status;\n          if (status >= 200 && status < 300) {\n            options.success && options.success(xhr.response);\n          } else {\n            options.fail && options.fail(status);\n          }\n        }\n      };\n\n      xhr.open(\"GET\", options.url, true);\n      xhr.send(null);\n    },\n\n    // 合成URL\n    applyURL(targetURL, baseURL) {\n      baseURL = baseURL || location.href\n      if (targetURL.indexOf('http') === 0) {\n        // 当前页面使用 https 协议时，强制使 ts 资源也使用 https 协议获取\n        if (location.href.indexOf('https') === 0) {\n          return targetURL.replace('http://', 'https://')\n        }\n        return targetURL\n      } else if (targetURL[0] === '/') {\n        let domain = baseURL.split('/')\n        return domain[0] + '//' + domain[2] + targetURL\n      } else {\n        let domain = baseURL.split('/')\n        domain.pop()\n        return domain.join('/') + '/' + targetURL\n      }\n    },\n\n    // 使用流式下载，边下载边保存，解决大视频文件内存不足的难题\n    streamDownload(isMp4) {\n      this.isGetMP4 = isMp4\n      this.title = new URL(this.url).searchParams.get('title') || this.title // 获取视频标题\n      let fileName = this.title || this.formatTime(new Date(), 'YYYY_MM_DD hh_mm_ss')\n      if (document.title !== 'm3u8 downloader') {\n        fileName = this.getDocumentTitle()\n      }\n      this.streamWriter = window.streamSaver.createWriteStream(`${fileName}.${isMp4 ? 'mp4' : 'ts'}`).getWriter()\n      this.getM3U8()\n    },\n\n    // 解析为 mp4 下载\n    getMP4() {\n      this.isGetMP4 = true\n      this.getM3U8()\n    },\n\n    // 获取在线文件\n    getM3U8(onlyGetRange) {\n      if (!this.url) {\n        alert('请输入链接')\n        return\n      }\n\n      if (this.url.toLowerCase().indexOf('m3u8') === -1) {\n        alert('链接有误，请重新输入')\n        return\n      }\n      if (this.downloading) {\n        alert('资源下载中，请稍后')\n        return\n      }\n\n      // 在下载页面才触发，代码注入的页面不需要校验\n      // 当前协议不一致，切换协议\n      if (location.href.indexOf('blog.luckly-mjw.cn') > -1 && this.url.indexOf(location.protocol) === -1) {\n        const targetUrl = new URL(this.url)\n        const targetLink = `${targetUrl.protocol}//blog.luckly-mjw.cn/tool-show/m3u8-downloader/index.html?source=${this.url}`;\n        if (targetUrl.protocol === 'http:') {\n          this.copyToClipboard(targetLink);\n          alert('由于浏览器限制，无法从 https 跳转至 http。请在访问 http 协议页面，页面 url 已复制，直接粘贴使用即可')\n        } else {\n          location.href = targetLink\n        }\n        return\n      }\n\n      // 在下载页面才触发，修改页面 URL，携带下载路径，避免刷新后丢失\n      if (location.href.indexOf('blog.luckly-mjw.cn') > -1) {\n        window.history.replaceState(null, '', `${location.href.split('?')[0]}?source=${this.url}`)\n      }\n\n      this.title = new URL(this.url).searchParams.get('title') || this.title // 获取视频标题\n      this.tips = 'm3u8 文件下载中，请稍后'\n      this.beginTime = new Date()\n      this.ajax({\n        url: this.url,\n        success: (m3u8Str) => {\n          this.tsUrlList = []\n          this.finishList = []\n\n          // 提取 ts 视频片段地址\n          m3u8Str.split('\\n').forEach((item) => {\n            // if (/.(png|image|ts|jpg|mp4|jpeg)/.test(item)) {\n            // 放开片段后缀限制，下载非 # 开头的链接片段\n            if (/^[^#]/.test(item)) {\n              console.log(item)\n              this.tsUrlList.push(this.applyURL(item, this.url))\n              this.finishList.push({\n                title: item,\n                status: ''\n              })\n            }\n          })\n\n          // 仅获取视频片段数\n          if (onlyGetRange) {\n            this.rangeDownload.isShowRange = true\n            this.rangeDownload.endSegment = this.tsUrlList.length\n            this.rangeDownload.targetSegment = this.tsUrlList.length\n            return\n          } else {\n            let startSegment = Math.max(this.rangeDownload.startSegment || 1, 1) // 最小为 1\n            let endSegment = Math.max(this.rangeDownload.endSegment || this.tsUrlList.length, 1)\n            startSegment = Math.min(startSegment, this.tsUrlList.length) // 最大为 this.tsUrlList.length\n            endSegment = Math.min(endSegment, this.tsUrlList.length)\n            this.rangeDownload.startSegment = Math.min(startSegment, endSegment)\n            this.rangeDownload.endSegment = Math.max(startSegment, endSegment)\n            this.rangeDownload.targetSegment = this.rangeDownload.endSegment - this.rangeDownload.startSegment + 1\n            this.downloadIndex = this.rangeDownload.startSegment - 1\n            this.downloading = true\n          }\n\n          // 获取需要下载的 MP4 视频长度\n          if (this.isGetMP4) {\n            let infoIndex = 0\n            m3u8Str.split('\\n').forEach(item => {\n              if (item.toUpperCase().indexOf('#EXTINF:') > -1) { // 计算视频总时长，设置 mp4 信息时使用\n                infoIndex++\n                if (this.rangeDownload.startSegment <= infoIndex && infoIndex <= this.rangeDownload.endSegment) {\n                  this.durationSecond += parseFloat(item.split('#EXTINF:')[1])\n                }\n              }\n            })\n          }\n\n          // 检测视频 AES 加密\n          if (m3u8Str.indexOf('#EXT-X-KEY') > -1) {\n            this.aesConf.method = (m3u8Str.match(/(.*METHOD=([^,\\s]+))/) || ['', '', ''])[2]\n            this.aesConf.uri = (m3u8Str.match(/(.*URI=\"([^\"]+))\"/) || ['', '', ''])[2]\n            this.aesConf.iv = (m3u8Str.match(/(.*IV=([^,\\s]+))/) || ['', '', ''])[2]\n            this.aesConf.iv = this.aesConf.iv ? this.aesConf.stringToBuffer(this.aesConf.iv) : ''\n            this.aesConf.uri = this.applyURL(this.aesConf.uri, this.url)\n\n            // let params = m3u8Str.match(/#EXT-X-KEY:([^,]*,?METHOD=([^,]+))?([^,]*,?URI=\"([^,]+)\")?([^,]*,?IV=([^,^\\n]+))?/)\n            // this.aesConf.method = params[2]\n            // this.aesConf.uri = this.applyURL(params[4], this.url)\n            // this.aesConf.iv = params[6] ? this.aesConf.stringToBuffer(params[6]) : ''\n            this.getAES();\n          } else if (this.tsUrlList.length > 0) { // 如果视频没加密，则直接下载片段，否则先下载秘钥\n            this.downloadTS()\n          } else {\n            this.alertError('资源为空，请查看链接是否有效')\n          }\n        },\n        fail: () => {\n          this.alertError('链接不正确，请查看链接是否有效')\n        }\n      })\n    },\n\n    // 获取AES配置\n    getAES() {\n      // alert('视频被 AES 加密，点击确认，进行视频解码')\n      this.ajax({\n        type: 'file',\n        url: this.aesConf.uri,\n        success: (key) => {\n          // console.log('getAES', key)\n          // this.aesConf.key = this.aesConf.stringToBuffer(key)\n          this.aesConf.key = key\n          this.aesConf.decryptor = new AESDecryptor()\n          this.aesConf.decryptor.constructor()\n          this.aesConf.decryptor.expandKey(this.aesConf.key);\n          this.downloadTS()\n        },\n        fail: () => {\n          this.alertError('视频已加密，可试用右下角入口的「无差别提取工具」')\n        }\n      })\n    },\n\n    // ts 片段的 AES 解码\n    aesDecrypt(data, index) {\n      let iv = this.aesConf.iv || new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, index])\n      return this.aesConf.decryptor.decrypt(data, 0, iv.buffer || iv, true)\n    },\n\n    // 下载分片\n    downloadTS() {\n      this.tips = 'ts 视频碎片下载中，请稍后'\n      let download = () => {\n        let isPause = this.isPause // 使用另一个变量来保持下载前的暂停状态，避免回调后没修改\n        let index = this.downloadIndex\n        if (index >= this.rangeDownload.endSegment) {\n          return\n        }\n        this.downloadIndex++\n        if (this.finishList[index] && this.finishList[index].status === '') {\n          this.finishList[index].status = 'downloading'\n          this.ajax({\n            url: this.tsUrlList[index],\n            type: 'file',\n            success: (file) => {\n              this.dealTS(file, index, () => this.downloadIndex < this.rangeDownload.endSegment && !isPause && download())\n            },\n            fail: () => {\n              this.errorNum++\n              this.finishList[index].status = 'error'\n              if (this.downloadIndex < this.rangeDownload.endSegment) {\n                !isPause && download()\n              }\n            }\n          })\n        } else if (this.downloadIndex < this.rangeDownload.endSegment) { // 跳过已经成功的片段\n          !isPause && download()\n        }\n      }\n\n      // 建立多少个 ajax 线程\n      for (let i = 0; i < Math.min(6, this.rangeDownload.targetSegment - this.finishNum); i++) {\n        download()\n      }\n    },\n\n    // 处理 ts 片段，AES 解密、mp4 转码\n    dealTS(file, index, callback) {\n      const data = this.aesConf.uri ? this.aesDecrypt(file, index) : file\n      this.conversionMp4(data, index, (afterData) => { // mp4 转码\n        this.mediaFileList[index - this.rangeDownload.startSegment + 1] = afterData // 判断文件是否需要解密\n        this.finishList[index].status = 'finish'\n        this.finishNum++\n        if (this.streamWriter) {\n          for (let index = this.streamDownloadIndex; index < this.mediaFileList.length; index++) {\n            if (this.mediaFileList[index]) {\n              this.streamWriter.write(new Uint8Array(this.mediaFileList[index]))\n              this.mediaFileList[index] = null\n              this.streamDownloadIndex = index + 1\n            } else {\n              break\n            }\n          }\n          if (this.streamDownloadIndex >= this.rangeDownload.targetSegment) {\n            this.streamWriter.close()\n          }\n        } else if (this.finishNum === this.rangeDownload.targetSegment) {\n          let fileName = this.title\n          this.downloadFile(this.mediaFileList, fileName)\n        }\n        callback && callback()\n      })\n    },\n\n    // 转码为 mp4\n    conversionMp4(data, index, callback) {\n      if (this.isGetMP4) {\n        let transmuxer = new muxjs.Transmuxer({\n          keepOriginalTimestamps: true,\n          duration: parseInt(this.durationSecond),\n        });\n        transmuxer.on('data', segment => {\n          if (index === this.rangeDownload.startSegment - 1) {\n            let data = new Uint8Array(segment.initSegment.byteLength + segment.data.byteLength);\n            data.set(segment.initSegment, 0);\n            data.set(segment.data, segment.initSegment.byteLength);\n            callback(data.buffer)\n          } else {\n            callback(segment.data)\n          }\n        })\n        transmuxer.push(new Uint8Array(data));\n        transmuxer.flush();\n      } else {\n        callback(data)\n      }\n    },\n\n    // 暂停与恢复\n    togglePause() {\n      this.isPause = !this.isPause\n      !this.isPause && this.retryAll(true)\n    },\n\n    // 重新下载某个片段\n    retry(index) {\n      if (this.finishList[index].status === 'error') {\n        this.finishList[index].status = ''\n        this.ajax({\n          url: this.tsUrlList[index],\n          type: 'file',\n          success: (file) => {\n            this.errorNum--\n            this.dealTS(file, index)\n          },\n          fail: () => {\n            this.finishList[index].status = 'error'\n          }\n        })\n      }\n    },\n\n    // 重新下载所有错误片段\n    retryAll(forceRestart) {\n\n      if (!this.finishList.length || this.isPause) {\n        return\n      }\n\n      let firstErrorIndex = this.downloadIndex // 没有错误项目，则每次都递增\n      this.finishList.forEach((item, index) => { // 重置所有错误片段状态\n        if (item.status === 'error') {\n          item.status = ''\n          firstErrorIndex = Math.min(firstErrorIndex, index)\n        }\n      })\n      this.errorNum = 0\n      // 已经全部下载进程都跑完了，则重新启动下载进程\n      if (this.downloadIndex >= this.rangeDownload.endSegment || forceRestart) {\n        this.downloadIndex = firstErrorIndex\n        this.downloadTS()\n      } else { // 否则只是将下载索引，改为最近一个错误的项目，从那里开始遍历\n        this.downloadIndex = firstErrorIndex\n      }\n    },\n\n    // 下载整合后的TS文件\n    downloadFile(fileDataList, fileName) {\n      this.tips = 'ts 碎片整合中，请留意浏览器下载'\n      let fileBlob = null\n      let a = document.createElement('a')\n      if (this.isGetMP4) {\n        fileBlob = new Blob(fileDataList, { type: 'video/mp4' }) // 创建一个Blob对象，并设置文件的 MIME 类型\n        a.download = fileName + '.mp4'\n      } else {\n        fileBlob = new Blob(fileDataList, { type: 'video/MP2T' }) // 创建一个Blob对象，并设置文件的 MIME 类型\n        a.download = fileName + '.ts'\n      }\n      a.href = URL.createObjectURL(fileBlob)\n      a.style.display = 'none'\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    },\n\n    // 格式化时间\n    formatTime(date, formatStr) {\n      const formatType = {\n        Y: date.getFullYear(),\n        M: date.getMonth() + 1,\n        D: date.getDate(),\n        h: date.getHours(),\n        m: date.getMinutes(),\n        s: date.getSeconds(),\n      }\n      return formatStr.replace(\n          /Y+|M+|D+|h+|m+|s+/g,\n          target => (new Array(target.length).join('0') + formatType[target[0]]).substr(-target.length)\n      )\n    },\n\n    // 强制下载现有片段\n    forceDownload() {\n      if (this.mediaFileList.length) {\n        let fileName = this.title\n        this.downloadFile(this.mediaFileList, fileName)\n      } else {\n        alert('当前无已下载片段')\n      }\n    },\n\n    // 发生错误，进行提示\n    alertError(tips) {\n      alert(tips)\n      this.downloading = false\n      this.tips = 'm3u8 视频在线提取工具';\n    },\n\n\n\n    // 拷贝剪切板\n    copyToClipboard(content) {\n      clearTimeout(this.timeouter)\n\n      if (!document.queryCommandSupported('copy')) {\n        return false\n      }\n\n      let $input = document.createElement('textarea')\n      $input.style.opacity = '0'\n      $input.value = content\n      document.body.appendChild($input)\n      $input.select()\n\n      const result = document.execCommand('copy')\n      document.body.removeChild($input)\n      $input = null\n\n      return result\n    },\n\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n\n<style scoped>\n/*全局设置*/\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n}\n\nbody::-webkit-scrollbar {\n  display: none\n}\n\np {\n  margin: 0;\n}\n\n[v-cloak] {\n  display: none;\n}\n\n#m-app {\n  height: 100%;\n  width: 100%;\n  text-align: center;\n  padding: 10px 50px 80px;\n  box-sizing: border-box;\n}\n\n.m-p-action {\n  margin: 20px auto;\n  max-width: 1100px;\n  width: 100%;\n  font-size: 35px;\n  text-align: center;\n  font-weight: bold;\n}\n\n.m-p-other,\n.m-p-tamper,\n.m-p-github,\n.m-p-language,\n.m-p-mse {\n  position: fixed;\n  right: 50px;\n  background-color: #eff3f6;\n  background-image: linear-gradient(-180deg, #fafbfc, #eff3f6 90%);\n  color: #24292e;\n  border: 1px solid rgba(27, 31, 35, .2);\n  border-radius: 3px;\n  cursor: pointer;\n  display: inline-block;\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 20px;\n  padding: 6px 12px;\n  z-index: 99;\n}\n\n.m-p-help {\n  position: fixed;\n  right: 50px;\n  top: 50px;\n  width: 30px;\n  height: 30px;\n  color: #666666;\n  z-index: 2;\n  line-height: 30px;\n  font-weight: bolder;\n  border-radius: 50%;\n  border: 1px solid rgba(27, 31, 35, .2);\n  cursor: pointer;\n  background-color: #eff3f6;\n  background-image: linear-gradient(-180deg, #fafbfc, #eff3f6 90%);\n}\n\n.m-p-github:hover,\n.m-p-other:hover,\n.m-p-tamper:hover,\n.m-p-help:hover,\n.m-p-language:hover,\n.m-p-mse:hover {\n  opacity: 0.9;\n}\n\n.m-p-language {\n  bottom: 70px;\n}\n\n.m-p-other {\n  bottom: 150px;\n}\n\n.m-p-tamper {\n  bottom: 30px;\n}\n\n.m-p-github {\n  bottom: 190px;\n}\n\n.m-p-mse {\n  bottom: 110px;\n}\n\n/*广告*/\n.m-p-refer {\n  position: absolute;\n  left: 50px;\n  bottom: 50px;\n}\n\n.m-p-refer .text {\n  position: absolute;\n  top: -80px;\n  left: -40px;\n  animation-name: upAnimation;\n  transform-origin: center bottom;\n  animation-duration: 2s;\n  animation-fill-mode: both;\n  animation-iteration-count: infinite;\n  animation-delay: .5s;\n}\n\n.m-p-refer .close {\n  display: block;\n  position: absolute;\n  top: -110px;\n  right: -50px;\n  padding: 0;\n  margin: 0;\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  border: none;\n  cursor: pointer;\n  z-index: 3;\n  transition: 0.3s all;\n  background-size: 30px 30px;\n  background-repeat: no-repeat;\n  background-position: center center;\n  background-image: url(https://blog.luckly-mjw.cn/tool-show/m3u8-downloader/imgs/close.png);\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n.m-p-refer .close:hover {\n  background-color: rgba(0, 0, 0, 0.8);\n}\n\n.m-p-refer .link {\n  border-radius: 4px;\n  text-decoration: none;\n  background-color: #4E84E6;\n  transition: 0.3s all;\n}\n\n.m-p-refer .link:hover {\n  top: -10px;\n  color: #333333;\n  border: 1px solid transparent;\n  background: rgba(0, 0, 0, 0.6);\n  box-shadow: 2px 11px 20px 0 rgba(0, 0, 0, 0.6);\n}\n\n@keyframes upAnimation {\n  0% {\n    transform: rotate(0deg);\n    transition-timing-function: cubic-bezier(0.215, .61, .355, 1)\n  }\n\n  10% {\n    transform: rotate(-12deg);\n    transition-timing-function: cubic-bezier(0.215, .61, .355, 1)\n  }\n\n  20% {\n    transform: rotate(12deg);\n    transition-timing-function: cubic-bezier(0.215, .61, .355, 1)\n  }\n\n  28% {\n    transform: rotate(-10deg);\n    transition-timing-function: cubic-bezier(0.215, .61, .355, 1)\n  }\n\n  36% {\n    transform: rotate(10deg);\n    transition-timing-function: cubic-bezier(0.755, .5, .855, .06)\n  }\n\n  42% {\n    transform: rotate(-8deg);\n    transition-timing-function: cubic-bezier(0.755, .5, .855, .06)\n  }\n\n  48% {\n    transform: rotate(8deg);\n    transition-timing-function: cubic-bezier(0.755, .5, .855, .06)\n  }\n\n  52% {\n    transform: rotate(-4deg);\n    transition-timing-function: cubic-bezier(0.755, .5, .855, .06)\n  }\n\n  56% {\n    transform: rotate(4deg);\n    transition-timing-function: cubic-bezier(0.755, .5, .855, .06)\n  }\n\n  60% {\n    transform: rotate(0deg);\n    transition-timing-function: cubic-bezier(0.755, .5, .855, .06)\n  }\n\n  100% {\n    transform: rotate(0deg);\n    transition-timing-function: cubic-bezier(0.215, .61, .355, 1)\n  }\n}\n\n/*顶部信息录入*/\n.m-p-temp-url {\n  padding-top: 50px;\n  padding-bottom: 10px;\n  width: 100%;\n  color: #999999;\n  text-align: left;\n  font-style: italic;\n  word-break: break-all;\n}\n\n.m-p-input-container {\n  display: flex;\n}\n\n.m-p-input-container input {\n  flex: 1;\n  margin-bottom: 20px;\n  display: block;\n  width: 280px;\n  padding: 16px;\n  font-size: 24px;\n  border-radius: 4px;\n  box-shadow: none;\n  color: #444444;\n  border: 1px solid #cccccc;\n}\n\n.m-p-input-container .range-input {\n  margin-left: 10px;\n  flex: 0 0 100px;\n  width: 100px;\n  box-sizing: border-box;\n}\n\n.m-p-input-container div {\n  position: relative;\n  display: inline-block;\n  margin-left: 10px;\n  height: 60px;\n  line-height: 60px;\n  font-size: 24px;\n  color: white;\n  cursor: pointer;\n  border-radius: 4px;\n  border: 1px solid #eeeeee;\n  background-color: #3D8AC7;\n  opacity: 1;\n  transition: 0.3s all;\n}\n\n.m-p-input-container div:hover {\n  opacity: 0.9;\n}\n\n.m-p-input-container div {\n  width: 200px;\n}\n\n.m-p-input-container .disable {\n  cursor: not-allowed;\n  background-color: #dddddd;\n}\n\n/*下载状态*/\n.m-p-line {\n  margin: 20px 0 50px;\n  vertical-align: top;\n  width: 100%;\n  height: 5px;\n  border-bottom: dotted;\n}\n\n.m-p-tips {\n  width: 100%;\n  color: #999999;\n  text-align: left;\n  font-style: italic;\n  word-break: break-all;\n}\n\n.m-p-tips p {\n  width: 100px;\n  display: inline-block;\n}\n\n.m-p-tips.error-tips {\n  color: #DC5350;\n}\n\n.m-p-segment {\n  text-align: left;\n}\n\n.m-p-segment .item {\n  display: inline-block;\n  margin: 10px 6px;\n  width: 50px;\n  height: 40px;\n  color: white;\n  line-height: 40px;\n  text-align: center;\n  border-radius: 4px;\n  cursor: help;\n  border: solid 1px #eeeeee;\n  background-color: #dddddd;\n  transition: 0.3s all;\n}\n\n.m-p-segment .finish {\n  background-color: #0ACD76;\n}\n\n.m-p-segment .error {\n  cursor: pointer;\n  background-color: #DC5350;\n}\n\n.m-p-segment .error:hover {\n  opacity: 0.9;\n}\n\n.m-p-stream,\n.m-p-report,\n.m-p-cross,\n.m-p-final {\n  margin-top: 10px;\n  display: inline-block;\n  width: 100%;\n  height: 50px;\n  line-height: 50px;\n  font-size: 20px;\n  color: white;\n  cursor: pointer;\n  border-radius: 4px;\n  border: 1px solid #eeeeee;\n  background-color: #3D8AC7;\n  opacity: 1;\n  transition: 0.3s all;\n}\n\n.m-p-stream {\n  background-color: #0ACD76 !important;\n}\n\n.m-p-report {\n  background-color: #e74c3c !important;\n  text-decoration: none;\n}\n\n.m-p-final {\n  text-decoration: none;\n}\n\n.m-p-force,\n.m-p-retry {\n  position: absolute;\n  right: 50px;\n  display: inline-block;\n  padding: 6px 12px;\n  font-size: 18px;\n  color: white;\n  cursor: pointer;\n  border-radius: 4px;\n  border: 1px solid #eeeeee;\n  background-color: #3D8AC7;\n  opacity: 1;\n  transition: 0.3s all;\n}\n\n.m-p-retry {\n  right: 250px;\n}\n\n.m-p-force:hover,\n.m-p-retry:hover {\n  opacity: 0.9;\n}\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./M3u8DownloaderView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./M3u8DownloaderView.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./M3u8DownloaderView.vue?vue&type=template&id=48731891&scoped=true\"\nimport script from \"./M3u8DownloaderView.vue?vue&type=script&lang=js\"\nexport * from \"./M3u8DownloaderView.vue?vue&type=script&lang=js\"\nimport style1 from \"./M3u8DownloaderView.vue?vue&type=style&index=1&id=48731891&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"48731891\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","staticClass","_v","_s","tips","directives","name","rawName","value","task","url","expression","domProps","on","$event","target","composing","$set","title","addTask","taskCount","downloading","rangeDownload","isShowRange","_e","finishNum","targetSegment","togglePause","isPause","start","isSupperStreamWrite","streamDownload","finishList","length","mediaFileList","streamWriter","forceDownload","errorNum","toFixed","class","_l","item","index","key","status","retry","staticRenderFns","metaInfo","meta","content","data","isGetMP4","durationSecond","isShowRefer","beginTime","downloadIndex","tsUrlList","window","streamSaver","useBlobFallback","streamDownloadIndex","startSegment","endSegment","aesConf","method","uri","iv","decryptor","stringToBuffer","str","TextEncoder","encode","created","getSource","addEventListener","onKeyup","setInterval","retryAll","bind","check","setTimeout","beforeDestroy","removeEventListener","computed","methods","tasks","getTask","getM3U8","i","splice","localStorage","setItem","JSON","stringify","history","go","parse","getItem","alert","some","push","href","location","indexOf","split","getDocumentTitle","event","keyCode","ajax","options","xhr","XMLHttpRequest","type","responseType","onreadystatechange","readyState","success","response","fail","open","send","applyURL","targetURL","baseURL","replace","domain","pop","join","isMp4","URL","searchParams","get","fileName","formatTime","Date","document","createWriteStream","getWriter","getMP4","onlyGetRange","toLowerCase","protocol","targetUrl","targetLink","copyToClipboard","replaceState","m3u8Str","forEach","test","console","log","Math","max","min","infoIndex","toUpperCase","parseFloat","match","getAES","downloadTS","alertError","AESDecryptor","constructor","expandKey","aesDecrypt","Uint8Array","decrypt","buffer","download","file","dealTS","callback","conversionMp4","afterData","write","close","downloadFile","transmuxer","muxjs","Transmuxer","keepOriginalTimestamps","duration","parseInt","segment","initSegment","byteLength","set","flush","forceRestart","firstErrorIndex","fileDataList","fileBlob","a","createElement","Blob","createObjectURL","style","display","body","appendChild","click","remove","date","formatStr","formatType","Y","getFullYear","M","getMonth","D","getDate","h","getHours","m","getMinutes","s","getSeconds","Array","substr","clearTimeout","timeouter","queryCommandSupported","$input","opacity","select","result","execCommand","removeChild","component"],"sourceRoot":""}