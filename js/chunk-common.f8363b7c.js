"use strict";(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[996,7434],{46834:function(t,e,r){r.d(e,{V:function(){return o}});r(16280);class o{static async copyText(t){try{if("string"!==typeof t)throw new Error("复制的内容必须是字符串");if(""===t.trim())throw new Error("复制的内容不能为空");return navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(t),!0):this.fallbackCopyText(t)}catch(e){return console.error("复制文本失败:",e),!1}}static fallbackCopyText(t){let e=null;try{e=document.createElement("textarea"),e.value=t,e.style.position="fixed",e.style.left="-9999px",e.style.top="-9999px",e.style.opacity="0",e.style.pointerEvents="none",document.body.appendChild(e),e.focus(),e.select(),e.setSelectionRange(0,t.length);const r=document.execCommand("copy");return r}catch(r){return console.error("兼容模式复制失败:",r),!1}finally{e&&e.parentNode&&document.body.removeChild(e)}}static async copyImage(t){try{if(!navigator.clipboard||!navigator.clipboard.write)throw new Error("浏览器不支持图片复制功能");let e;if(t instanceof Blob)e=t;else if(t instanceof HTMLCanvasElement)e=await this.canvasToBlob(t);else{if("string"!==typeof t)throw new Error("不支持的图片源类型");e=await this.dataURLToBlob(t)}const r=new ClipboardItem({[e.type]:e});return await navigator.clipboard.write([r]),!0}catch(e){return console.error("复制图片失败:",e),!1}}static canvasToBlob(t,e="image/png",r=1){return new Promise((o=>{t.toBlob(o,e,r)}))}static async dataURLToBlob(t){try{const e=await fetch(t);return await e.blob()}catch(e){throw console.error("DataURL转Blob失败:",e),e}}static async readText(){try{if(navigator.clipboard&&navigator.clipboard.readText)return await navigator.clipboard.readText();throw new Error("浏览器不支持读取剪贴板")}catch(t){throw console.error("读取剪贴板失败:",t),t}}static async readImage(){try{if(!navigator.clipboard||!navigator.clipboard.read)throw new Error("浏览器不支持读取剪贴板图片");const t=await navigator.clipboard.read();for(const e of t)for(const t of e.types)if(t.startsWith("image/"))return await e.getType(t);throw new Error("剪贴板中没有图片")}catch(t){throw console.error("读取剪贴板图片失败:",t),t}}static checkSupport(){return{writeText:!(!navigator.clipboard||!navigator.clipboard.writeText),readText:!(!navigator.clipboard||!navigator.clipboard.readText),writeImage:!(!navigator.clipboard||!navigator.clipboard.write),readImage:!(!navigator.clipboard||!navigator.clipboard.read),isSecureContext:window.isSecureContext}}static async copyLines(t){const e=Array.isArray(t)?t.join("\n"):String(t);return await this.copyText(e)}static async copyJSON(t,e=2){try{const r=JSON.stringify(t,null,e);return await this.copyText(r)}catch(r){return console.error("复制JSON失败:",r),!1}}static async copyTable(t,e=null){try{let r="";return e&&e.length>0&&(r+=e.join("\t")+"\n"),t.forEach((t=>{if(Array.isArray(t))r+=t.join("\t")+"\n";else if("object"===typeof t){const o=e?e.map((e=>t[e]||"")):Object.values(t);r+=o.join("\t")+"\n"}})),await this.copyText(r.trim())}catch(r){return console.error("复制表格失败:",r),!1}}}},54623:function(t,e,r){r.d(e,{I:function(){return o}});r(44114),r(72712),r(14603),r(47566),r(98721);class o{static rgbToHex(t,e,r){if(Array.isArray(t))return 3!==t.length?"":"#"+t.map((t=>t.toString(16).padStart(2,"0"))).join("").toUpperCase();if("number"===typeof t&&"number"===typeof e&&"number"===typeof r){const o=t=>{const e=Math.round(Math.max(0,Math.min(255,t))).toString(16);return 1===e.length?"0"+e:e};return`#${o(t)}${o(e)}${o(r)}`.toUpperCase()}return""}static hexToRgb(t){4===t.length&&(t=t.replace(/^#(.)(.)(.)$/,"#$1$1$2$2$3$3"));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}static randomColor(t="hex"){const e=Math.floor(256*Math.random()),r=Math.floor(256*Math.random()),o=Math.floor(256*Math.random());switch(t){case"rgb":return`rgb(${e}, ${r}, ${o})`;case"hsl":{const t=this.rgbToHsl(e,r,o);return`hsl(${t.h}, ${t.s}%, ${t.l}%)`}case"hex":default:return this.rgbToHex(e,r,o)}}static randomGradient(t="hex"){const e=this.randomColor(t),r=this.randomColor(t),o=Math.floor(360*Math.random());return`linear-gradient(${o}deg, ${e}, ${r})`}static rgbToHsl(t,e,r){Array.isArray(t)&&([t,e,r]=t),t/=255,e/=255,r/=255;const o=Math.max(t,e,r),n=Math.min(t,e,r);let a,s,i=(o+n)/2;if(o===n)a=s=0;else{const c=o-n;switch(s=i>.5?c/(2-o-n):c/(o+n),o){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:Math.round(360*a),s:Math.round(100*s),l:Math.round(100*i)}}static hslToHex(t,e,r){t/=360,e/=100,r/=100;const o=(t,e,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t);let n,a,s;if(0===e)n=a=s=r;else{const i=r<.5?r*(1+e):r+e-r*e,c=2*r-i;n=o(c,i,t+1/3),a=o(c,i,t),s=o(c,i,t-1/3)}return this.rgbToHex(Math.round(255*n),Math.round(255*a),Math.round(255*s))}static rgbToCmyk(t,e,r){t/=255,e/=255,r/=255;const o=1-Math.max(t,Math.max(e,r)),n=1===o?0:(1-t-o)/(1-o),a=1===o?0:(1-e-o)/(1-o),s=1===o?0:(1-r-o)/(1-o);return{c:Math.round(100*n),m:Math.round(100*a),y:Math.round(100*s),k:Math.round(100*o)}}static rgbToHsv(t,e,r){t/=255,e/=255,r/=255;const o=Math.max(t,e,r),n=Math.min(t,e,r);let a,s,i=o;const c=o-n;if(s=0===o?0:c/o,o===n)a=0;else{switch(o){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:Math.round(360*a),s:Math.round(100*s),v:Math.round(100*i)}}static getContrastColor(t){let e=0,r=0,o=0;7===t.length?(e=parseInt(t.substr(1,2),16),r=parseInt(t.substr(3,2),16),o=parseInt(t.substr(5,2),16)):4===t.length&&(e=parseInt(t[1]+t[1],16),r=parseInt(t[2]+t[2],16),o=parseInt(t[3]+t[3],16));const n=(299*e+587*r+114*o)/1e3;return n>=128?"#000000":"#FFFFFF"}static formatRgb(t){return t&&3===t.length?`rgb(${t.join(", ")})`:""}static formatHex(t){return t?t.startsWith("#")?t:"#"+t:""}static isValidHex(t){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t)}static parseRgb(t){const e=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);return e?{r:parseInt(e[1]),g:parseInt(e[2]),b:parseInt(e[3])}:null}static parseHsl(t){const e=t.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);return e?{h:parseInt(e[1]),s:parseInt(e[2]),l:parseInt(e[3])}:null}static async getImageMainColor(t){try{const{default:e}=await r.e(1130).then(r.t.bind(r,91130,23));return new Promise(((r,o)=>{const n=new window.Image;n.crossOrigin="Anonymous",n.onload=()=>{try{const t=new e,o=t.getColor(n);r(o)}catch(t){o(t)}},n.onerror=o,n.src=URL.createObjectURL(t)}))}catch(e){throw console.error("获取图片主色失败:",e),e}}static async getImageAvgColor(t){return new Promise(((e,r)=>{const o=new window.Image;o.crossOrigin="Anonymous",o.onload=()=>{try{const t=document.createElement("canvas");t.width=o.width,t.height=o.height;const r=t.getContext("2d");r.drawImage(o,0,0);const n=r.getImageData(0,0,t.width,t.height),a=n.data;let s=0,i=0,c=0,l=0;for(let e=0;e<a.length;e+=4)s+=a[e],i+=a[e+1],c+=a[e+2],l++;s=Math.round(s/l),i=Math.round(i/l),c=Math.round(c/l),e([s,i,c])}catch(t){r(t)}},o.onerror=r,o.src=URL.createObjectURL(t)}))}static async getImageColorPalette(t,e=5){try{const{default:o}=await r.e(1130).then(r.t.bind(r,91130,23));return new Promise(((r,n)=>{const a=new window.Image;a.crossOrigin="Anonymous",a.onload=()=>{try{const t=new o,n=t.getPalette(a,e);r(n)}catch(t){n(t)}},a.onerror=n,a.src=URL.createObjectURL(t)}))}catch(o){throw console.error("获取图片调色板失败:",o),o}}static async analyzeImageColors(t){try{const[e,r,o]=await Promise.all([this.getImageMainColor(t),this.getImageAvgColor(t),this.getImageColorPalette(t,5)]);return{mainColor:{rgb:e,hex:this.rgbToHex(e),hsl:this.rgbToHsl(e[0],e[1],e[2])},avgColor:{rgb:r,hex:this.rgbToHex(r),hsl:this.rgbToHsl(r[0],r[1],r[2])},palette:o.map((t=>({rgb:t,hex:this.rgbToHex(t),hsl:this.rgbToHsl(t[0],t[1],t[2])}))),analysis:{mainColorBrightness:this.calculateBrightness(e),avgColorBrightness:this.calculateBrightness(r),dominantHue:this.getDominantHue(o),colorVariety:this.calculateColorVariety(o)}}}catch(e){throw console.error("图片颜色分析失败:",e),e}}static calculateBrightness(t){const[e,r,o]=t;return Math.round((299*e+587*r+114*o)/1e3)}static getDominantHue(t){if(!t||0===t.length)return"Unknown";const e=t.map((t=>{const e=this.rgbToHsl(t[0],t[1],t[2]);return e.h})),r=e.reduce(((t,e)=>t+e),0)/e.length;return r>=0&&r<30?"Red":r>=30&&r<60?"Orange":r>=60&&r<120?"Yellow":r>=120&&r<180?"Green":r>=180&&r<240?"Cyan":r>=240&&r<300?"Blue":r>=300&&r<360?"Magenta":"Mixed"}static calculateColorVariety(t){if(!t||t.length<=1)return 0;let e=0,r=0;for(let n=0;n<t.length;n++)for(let o=n+1;o<t.length;o++){const[a,s,i]=t[n],[c,l,h]=t[o],d=Math.sqrt(Math.pow(c-a,2)+Math.pow(l-s,2)+Math.pow(h-i,2));e+=d,r++}const o=e/r;return Math.min(100,Math.round(o/441.67*100))}static async batchAnalyzeImageColors(t,e){const r=[];for(let n=0;n<t.length;n++)try{const o=await this.analyzeImageColors(t[n]);r.push({file:t[n],success:!0,data:o}),e&&e(n+1,t.length,t[n].name)}catch(o){r.push({file:t[n],success:!1,error:o.message}),e&&e(n+1,t.length,t[n].name,o)}return r}}},9736:function(t,e,r){class o{static isMobile(t=768){return window.innerWidth<=t}static isTablet(){return window.innerWidth>768&&window.innerWidth<=1024}static isDesktop(){return window.innerWidth>1024}static getDeviceType(){return this.isMobile()?"mobile":this.isTablet()?"tablet":"desktop"}static addResizeListener(t){return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}static isMobileCompat(){return window.innerWidth<=600}}e.A=/^(2248|3057|4223|6234|9196)$/.test(r.j)?o:null},95866:function(t,e,r){r(16280),r(14603),r(47566),r(98721);class o{static downloadText(t,e,r="text/plain"){const o=new Blob([t],{type:r});this.downloadBlob(o,e)}static downloadJSON(t,e="data.json"){const r=JSON.stringify(t,null,2);this.downloadText(r,e,"application/json")}static downloadCSV(t,e="data.csv",r=null){let o="";r&&r.length>0&&(o+=r.join(",")+"\n"),t.forEach((t=>{if(Array.isArray(t))o+=t.map((t=>`"${t}"`)).join(",")+"\n";else if("object"===typeof t){const e=r?r.map((e=>t[e]||"")):Object.values(t);o+=e.map((t=>`"${t}"`)).join(",")+"\n"}}));const n="\ufeff";this.downloadText(n+o,e,"text/csv;charset=utf-8")}static downloadImage(t,e="image.png"){const r=document.createElement("a");r.download=e,r.href=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}static downloadCanvas(t,e="canvas.png",r="image/png",o=1){const n=t.toDataURL(r,o);this.downloadImage(n,e)}static downloadBlob(t,e){const r=URL.createObjectURL(t),o=document.createElement("a");o.href=r,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}static downloadURL(t,e){const r=document.createElement("a");r.href=t,r.download=e,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)}static async downloadZip(t,e="files.zip"){const o=(await Promise.all([r.e(2407),r.e(9479)]).then(r.t.bind(r,44813,23))).default,n=new o;t.forEach((t=>{t.content,Blob,n.file(t.name,t.content)}));try{const t=await n.generateAsync({type:"blob"});return this.downloadBlob(t,e),!0}catch(a){return console.error("生成ZIP文件失败:",a),!1}}static async fetchBlob(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.blob()}catch(e){throw console.error("获取文件失败:",e),e}}static generateTimestampFilename(t,e){const r=(new Date).toISOString().replace(/[:.]/g,"-").slice(0,-5);return`${t}_${r}.${e}`}static formatFileSize(t){if(0===t)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,o)).toFixed(2))+" "+r[o]}}e.A=/^(2(100|248|986|99)|30(11|57)|5(274|466|775)|6(097|318|459)|(422|785|814)3|1174)$/.test(r.j)?o:null},92007:function(t,e,r){r.d(e,{m:function(){return n}});r(16280),r(16573),r(78100),r(77936),r(48140),r(21903),r(91134),r(28845),r(37467),r(44732),r(79577),r(14603),r(47566),r(98721);if(/^(3057|3104|5706)$/.test(r.j))var o=r(93230);class n{static exportToExcel(t,e="export.xlsx",r="Sheet1",n={}){try{if(!t||0===t.length)throw new Error("导出数据不能为空");const a=o.Wp.book_new(),s=o.Wp.json_to_sheet(t,n);return o.Wp.book_append_sheet(a,s,r),o._h(a,e),!0}catch(a){throw console.error("Excel导出失败:",a),a}}static exportOcrResults(t,e="ocr_results.xlsx"){const r=t.filter((t=>t.recognizedText&&t.recognizedText.trim())).map(((t,e)=>({"序号":e+1,"文件名":t.imgFile?t.imgFile.name:`图片${e+1}`,"识别状态":t.status,"识别文字":t.recognizedText,"用时(秒)":t.duration||0,"错误信息":t.errorMessage||""})));if(0===r.length)throw new Error("没有可导出的识别结果");return this.exportToExcel(r,e,"OCR识别结果")}static exportColorResults(t,e="color_analysis.xlsx"){const r=t.map(((t,e)=>({"序号":e+1,RGB:`rgb(${t.rgb.join(", ")})`,HEX:`#${t.hex}`,HSL:t.hsl?`hsl(${t.hsl.join(", ")})`:"","占比":t.percentage?`${t.percentage}%`:"","像素数":t.count||0})));if(0===r.length)throw new Error("没有可导出的颜色数据");return this.exportToExcel(r,e,"颜色分析结果")}static exportExifData(t,e="exif_data.xlsx"){const r=Object.entries(t).map((([t,e])=>({"属性":t,"值":e})));if(0===r.length)throw new Error("没有可导出的EXIF数据");return this.exportToExcel(r,e,"EXIF信息")}static exportQrResults(t,e="qr_results.xlsx"){const r=t.filter((t=>t.text&&t.text.trim())).map(((t,e)=>({"序号":e+1,"文件名":t.fileName||`图片${e+1}`,"二维码内容":t.text,"格式":t.format||"QR_CODE","识别状态":t.status||"成功"})));if(0===r.length)throw new Error("没有可导出的二维码识别结果");return this.exportToExcel(r,e,"二维码识别结果")}static readExcelFile(t){return new Promise(((e,r)=>{if(!t)return void r(new Error("文件不能为空"));const n=new FileReader;n.onload=t=>{try{const r=new Uint8Array(t.target.result),n=o.LF(r,{type:"array"}),a={};n.SheetNames.forEach((t=>{const e=n.Sheets[t];a[t]=o.Wp.sheet_to_json(e)})),e(a)}catch(n){r(new Error(`Excel文件读取失败: ${n.message}`))}},n.onerror=()=>{r(new Error("文件读取失败"))},n.readAsArrayBuffer(t)}))}static createStyledWorksheet(t,e={}){const r=o.Wp.json_to_sheet(t);return e.columnWidths&&(r["!cols"]=e.columnWidths.map((t=>({wch:t})))),e.rowHeights&&(r["!rows"]=e.rowHeights.map((t=>({hpt:t})))),r}static exportMultipleSheets(t,e="export.xlsx"){try{if(!t||0===t.length)throw new Error("工作表数据不能为空");const r=o.Wp.book_new();return t.forEach((t=>{if(!t.name||!t.data)throw new Error("工作表必须包含name和data属性");const e=o.Wp.json_to_sheet(t.data,t.options||{});o.Wp.book_append_sheet(r,e,t.name)})),o._h(r,e),!0}catch(r){throw console.error("多工作表导出失败:",r),r}}static dataToCSV(t,e=","){if(!t||0===t.length)return"";const r=Object.keys(t[0]),o=[r.join(e),...t.map((t=>r.map((r=>{const o=t[r];return"string"===typeof o&&(o.includes(e)||o.includes("\n")||o.includes('"'))?`"${o.replace(/"/g,'""')}"`:o})).join(e)))].join("\n");return o}static exportToCSV(t,e="export.csv",r=","){try{const o=this.dataToCSV(t,r);if(!o)throw new Error("没有可导出的数据");const n=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");return a.href=URL.createObjectURL(n),a.download=e,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(a.href),!0}catch(o){throw console.error("CSV导出失败:",o),o}}static exportColorAnalysis(t,e){try{if(!t||0===t.length)throw new Error("没有可导出的颜色分析结果");const r=t.filter((t=>t.analyzed));if(0===r.length)throw new Error("没有已完成分析的图片");const n=["文件名","主色RGB","主色HEX","平均色RGB","平均色HEX"],a=r.map((t=>[t.imgFile.name,t.mainColor?`rgb(${t.mainColor.join(", ")})`:"",t.mainColor?"#"+this.rgbToHex(t.mainColor):"",t.avgColor?`rgb(${t.avgColor.join(", ")})`:"",t.avgColor?"#"+this.rgbToHex(t.avgColor):""])),s=o.Wp.aoa_to_sheet([n,...a]);this.setColorCellStyles(s,a),s["!cols"]=[{wch:20},{wch:18},{wch:14},{wch:18},{wch:14}];const i=o.Wp.book_new();o.Wp.book_append_sheet(i,s,"主色平均色");const c=e||this.generateTimestampFilename("图片主色平均色","xlsx");return o._h(i,c),!0}catch(r){throw console.error("颜色分析结果导出失败:",r),r}}static rgbToHex(t){return t&&3===t.length?t.map((t=>t.toString(16).padStart(2,"0"))).join("").toUpperCase():""}static setColorCellStyles(t,e){const r=1,n=2,a=3,s=4;for(let i=1;i<=e.length;i++){const c=e[i-1][n],l=e[i-1][s];if(c){const e=t[o.Wp.encode_cell({c:r,r:i})],a=t[o.Wp.encode_cell({c:n,r:i})];e&&(e.s={fill:{fgColor:{rgb:c.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(c)}}}),a&&(a.s={fill:{fgColor:{rgb:c.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(c)}}})}if(l){const e=t[o.Wp.encode_cell({c:a,r:i})],r=t[o.Wp.encode_cell({c:s,r:i})];e&&(e.s={fill:{fgColor:{rgb:l.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(l)}}}),r&&(r.s={fill:{fgColor:{rgb:l.replace("#","")}},font:{color:{rgb:this.getContrastYIQ(l)}}})}}}static getContrastYIQ(t){let e=0,r=0,o=0;7===t.length?(e=parseInt(t.substr(1,2),16),r=parseInt(t.substr(3,2),16),o=parseInt(t.substr(5,2),16)):4===t.length&&(e=parseInt(t[1]+t[1],16),r=parseInt(t[2]+t[2],16),o=parseInt(t[3]+t[3],16));const n=(299*e+587*r+114*o)/1e3;return n>=128?"000000":"FFFFFF"}static generateTimestampFilename(t,e){const r=new Date,o=t=>t.toString().padStart(2,"0"),n=`${r.getFullYear()}${o(r.getMonth()+1)}${o(r.getDate())}_${o(r.getHours())}${o(r.getMinutes())}${o(r.getSeconds())}`;return`${t}_${n}.${e}`}}},75912:function(t,e,r){r(16280),r(14603),r(47566),r(98721);var o=r(44813),n=r.n(o);class a{static formatBytes(t){if(0===t)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,o)).toFixed(2))+" "+r[o]}static getFileExtension(t){return t.slice(2+(t.lastIndexOf(".")-1>>>0))}static getExt(t){return t.split(".").pop().toLowerCase()}static getFileNameWithoutExtension(t){return t.replace(/\.[^/.]+$/,"")}static getBaseName(t){const e=-1===t.lastIndexOf(".")?t:t.substring(0,t.lastIndexOf("."));return e}static isImageFile(t){const e=["jpg","jpeg","png","gif","bmp","webp","svg"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static isVideoFile(t){const e=["mp4","avi","mov","wmv","flv","webm","mkv"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static isAudioFile(t){const e=["mp3","wav","flac","aac","ogg","wma"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static isDocumentFile(t){const e=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt"],r=this.getFileExtension(t).toLowerCase();return e.includes(r)}static generateUniqueFileName(t){const e=Date.now(),r=Math.random().toString(36).substring(2,8),o=this.getFileExtension(t),n=this.getFileNameWithoutExtension(t);return`${n}_${e}_${r}.${o}`}static fileToBase64(t){return new Promise(((e,r)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=()=>e(o.result),o.onerror=t=>r(t)}))}static downloadFile(t,e){const r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}static blobToFile(t,e){return new File([t],e,{type:t.type})}static fileToBlob(t){return t instanceof Blob?t:new Blob([t],{type:t.type})}static isBlob(t){return t instanceof Blob}static async getBlobByUrl(t){if(a.isBlob(t))return t;try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok: "+e.statusText);return await e.blob()}catch(e){throw console.error("Error fetching the blob:",e),e}}static async download(t,e){let r=null;r=a.isBlob(t)?t:await a.getBlobByUrl(t);const o=URL.createObjectURL(r),n=document.createElement("a");n.href=o,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)}static async downloadAsZip(t,e=(new Date).getTime()+".zip",r="file_url",o="save_name"){const s=new(n());for(const n of t){const t=await a.getBlobByUrl(n[r]);s.file(n[o],t)}try{const t=await s.generateAsync({type:"blob"});await a.download(t,e)}catch(i){console.error("Error while generating zip:",i)}}static compressImage(t,e=.8,r=1920,o=1080){return new Promise((n=>{const a=document.createElement("canvas"),s=a.getContext("2d"),i=new Image;i.onload=()=>{let{width:c,height:l}=i;c>r&&(l=l*r/c,c=r),l>o&&(c=c*o/l,l=o),a.width=c,a.height=l,s.drawImage(i,0,0,c,l),a.toBlob((e=>{const r=new File([e],t.name,{type:t.type,lastModified:Date.now()});n(r)}),t.type,e)},i.src=URL.createObjectURL(t)}))}}e.A=/^(3(024|057|625)|64[68]3|2986|5274|5706|7210|7625)$/.test(r.j)?a:null},97515:function(t,e,r){r.d(e,{A:function(){return h}});r(16280),r(14603),r(47566),r(98721);var o=r(79372),n=r.n(o),a=r(75912),s=r(28001),i=r(52125),c=r.n(i);const{Image:l}=r(9914);class h extends(/^(2986|3057|6463)$/.test(r.j)?a.A:null){static compressImage(t,e=.6,r="image/png"){return new Promise(((o,a)=>{new(n())(t,{quality:e,mimeType:r,success:o,error:a})}))}static async changeExt(t,e,r=100){l.load(t).then((t=>{t.save("output.jpg",{quality:r,format:e}),console.log("图片已成功转换为 JPEG 格式")})).catch((t=>{console.error("图片转换出错：",t)}))}static async changeExtension(t,e="image/jpeg"){const r={useWebWorker:!0,fileType:e},o=await(0,s.A)(t,r);return o}static advancedCompressImage(t,e=.8,r=1920,o=1080){return new Promise((n=>{const a=document.createElement("canvas"),s=a.getContext("2d"),i=new l;i.onload=()=>{let{width:c,height:l}=i;c>r&&(l=l*r/c,c=r),l>o&&(c=c*o/l,l=o),a.width=c,a.height=l,s.drawImage(i,0,0,c,l),a.toBlob((e=>{const r=new File([e],t.name,{type:t.type,lastModified:Date.now()});n(r)}),t.type,e)},i.src=URL.createObjectURL(t)}))}static getImageDimensions(t){const e=t.slice(0,t.size,t.type);return new Promise(((t,r)=>{const o=new l,n=URL.createObjectURL(e);o.onload=()=>{console.log(o.naturalWidth),t({width:o.naturalWidth,height:o.naturalHeight}),URL.revokeObjectURL(n)},o.onerror=t=>{console.error("Image加载失败，无法获取尺寸。"+t),URL.revokeObjectURL(n),r(new Error("Image loading failed."))},o.src=n}))}static createThumbnail(t,e=150){return new Promise((r=>{const o=document.createElement("canvas"),n=o.getContext("2d"),a=new l;a.onload=()=>{const{width:t,height:s}=a,i=Math.min(e/t,e/s),c=t*i,l=s*i;o.width=e,o.height=e;const h=(e-c)/2,d=(e-l)/2;n.fillStyle="#f0f0f0",n.fillRect(0,0,e,e),n.drawImage(a,h,d,c,l),r(o.toDataURL()),URL.revokeObjectURL(a.src)},a.src=URL.createObjectURL(t)}))}static async elementToImage(t,e={}){const{type:r="image/png",quality:o=1,scale:n=2,backgroundColor:a="#ffffff",format:s="blob"}=e;if("string"===typeof t&&(t=document.querySelector(t)),!(t instanceof HTMLElement))throw new Error("未找到有效的 DOM 元素");if("function"===typeof c()){const e=await c()(t,{scale:n,backgroundColor:a,useCORS:!0,allowTaint:!1,logging:!1});return h.canvasToResult(e,r,o,s)}throw new Error("请引入 html2canvas 或 dom-to-image 库以获得完整渲染能力")}static canvasToResult(t,e,r,o){return new Promise(((n,a)=>{"canvas"!==o?t.toBlob((t=>{if(!t)return a(new Error("Canvas 转 Blob 失败"));if("blob"===o)n(t);else if("dataurl"===o){const e=new FileReader;e.onload=()=>n(e.result),e.onerror=a,e.readAsDataURL(t)}}),e,r):n(t)}))}}}}]);