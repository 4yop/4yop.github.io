"use strict";(self["webpackChunkweb_tool_vue"]=self["webpackChunkweb_tool_vue"]||[]).push([[5319],{95319:function(t,e,s){s.r(e),s.d(e,{default:function(){return d}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modern-bg"},[e("el-row",{attrs:{gutter:0,justify:"center"}},[e("el-col",{attrs:{xs:{span:24,offset:0},sm:{span:22,offset:1},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:12,offset:6}}},[e("el-card",{staticClass:"modern-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"upload-row"},[e("el-upload",{attrs:{action:"#","auto-upload":!1,multiple:!1,"show-file-list":!1,accept:"image/*","on-change":t.handleUploadChange,disabled:t.loading}},[e("el-button",{attrs:{type:"primary",round:"",disabled:t.loading}},[t._v("选择图片")])],1),e("el-select",{staticStyle:{width:"120px","margin-left":"16px"},attrs:{filterable:"",placeholder:"切割份数",disabled:t.loading},model:{value:t.n,callback:function(e){t.n=e},expression:"n"}},t._l(t.nOptions,(function(t){return e("el-option",{key:t,attrs:{label:t+"份",value:t}})})),1),e("el-button",{attrs:{type:"success",round:"",disabled:!t.file||t.loading},on:{click:t.handleScramble}},[t._v("切割并打乱")]),t.scrambledUrl?e("el-button",{attrs:{type:"primary",size:"mini",disabled:t.loading},on:{click:t.handleDownload}},[t._v("下载拼图")]):t._e()],1),t.loading||t.progress>0?e("el-progress",{staticStyle:{margin:"16px 0"},attrs:{percentage:t.progress,status:"success","stroke-width":16,"text-inside":""}}):t._e(),t.error?e("div",{staticStyle:{color:"#f56c6c",margin:"12px 0","text-align":"center"}},[t._v(t._s(t.error))]):t._e(),e("el-row",{staticStyle:{"margin-top":"24px"},attrs:{gutter:16}},[e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{"text-align":"center"}},[e("div",{staticStyle:{"font-weight":"600","margin-bottom":"8px"}},[t._v("原图预览")]),t.imgUrl?e("el-image",{staticStyle:{"max-width":"100%","max-height":"320px","border-radius":"10px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},attrs:{src:t.imgUrl,"preview-src-list":t.loading?[]:[t.imgUrl,t.scrambledUrl],fit:"contain"}}):e("div",{staticStyle:{color:"#ccc"}},[t._v("请上传图片")])],1)]),e("el-col",{staticStyle:{position:"relative"},attrs:{span:12}},[e("div",{staticStyle:{"text-align":"center"}},[e("div",{staticStyle:{"font-weight":"600","margin-bottom":"8px"}},[t._v("打乱拼图预览")]),e("div",{staticClass:"img-mask-wrap"},[e("div",{staticClass:"img-mask-inner",staticStyle:{position:"relative"}},[t.scrambledUrl?e("el-image",{ref:"scrambledImg",staticStyle:{"max-width":"100%","border-radius":"10px","box-shadow":"0 2px 8px rgba(0,0,0,0.08)",background:"#f0f9eb"},attrs:{src:t.scrambledUrl,"max-height":"auto",fit:"contain","preview-src-list":t.loading?[]:[t.scrambledUrl,t.imgUrl]}}):t._e(),t.showMask&&t.loading?e("div",{staticClass:"scramble-mask-overlay",style:t.scrambleMaskStyle},[e("div",{staticClass:"scramble-mask-content"})]):t._e(),t.loading&&t.progress>0&&t.progress<100?e("div",{staticClass:"scramble-progress-overlay"},[e("span",[t._v(t._s(t.progressText))])]):t._e()],1)])])])],1)],1)],1)],1)],1)},a=[],i=(s(16280),s(14603),s(47566),s(98721),s(95866)),l={name:"ScrambleView",data(){return{metaInfo:{title:"图片切割打乱工具 - 生成混乱拼图效果",meta:[{name:"description",content:"将图片均匀分块并打乱顺序，可用于生成拼图谜题、视觉干扰图或趣味图像实验。"},{name:"keywords",content:"图片打乱,图片碎片,拼图工具,在线图像切割,图像干扰"}]},file:null,imgUrl:"",n:9,nOptions:[],scrambledUrl:"",loading:!1,error:"",showMask:!1,progress:0,progressText:"",scrambleMaskStyle:{}}},created(){window.__PRERENDER_INJECTED__||(this.nOptions=Array.from({length:100},((t,e)=>(e+2)*(e+2))).filter((t=>t<=1e6)))},methods:{handleUploadChange(t,e){e.length>0?(this.file=e[e.length-1].raw||e[e.length-1],this.imgUrl=URL.createObjectURL(this.file),this.scrambledUrl="",this.error=""):(this.file=null,this.imgUrl="",this.scrambledUrl="",this.error="")},async handleScramble(){if(!this.file||!this.n)return;const t=Math.sqrt(this.n);if(t%1===0){this.loading=!0,this.showMask=!0,this.progress=0,this.progressText="切割图片中...",this.error="";try{const t=await this.splitAndShuffleImage(this.file,this.n);this.scrambledUrl=t}catch(e){this.error="处理失败："+(e.message||e)}this.loading=!1,this.showMask=!1,this.progress=0,this.progressText=""}else this.$message.error("份数必须是完全平方数（如4、9、16、25...）")},async splitAndShuffleImage(t,e){const s=Math.sqrt(e);if(s%1!==0)throw new Error("N 必须是完全平方数");const r=await this.loadImageFromFile(t),a=Math.floor(r.width/s),i=Math.floor(r.height/s),l=Array.from({length:e},((t,e)=>e));for(let c=e-1;c>0;c--){const t=Math.floor(Math.random()*(c+1));[l[c],l[t]]=[l[t],l[c]]}const o=document.createElement("canvas");o.width=a*s,o.height=i*s;const n=o.getContext("2d");for(let c=0;c<e;c++){const t=l[c],o=t%s*a,d=Math.floor(t/s)*i,h=document.createElement("canvas");h.width=a,h.height=i;const g=h.getContext("2d");g.drawImage(r,o,d,a,i,0,0,a,i);const m=c%s*a,p=Math.floor(c/s)*i;n.drawImage(h,m,p),this.progress=Math.round((c+1)/e*100),this.progressText=`切割合并 ${c+1}/${e}`,await new Promise((t=>setTimeout(t,0)))}return this.progress=100,this.progressText="完成",await this.$nextTick(),o.toDataURL("image/png")},loadImageFromFile(t){return new Promise(((e,s)=>{const r=new window.Image;r.onload=()=>e(r),r.onerror=s,r.src=URL.createObjectURL(t)}))},handleDownload(){this.scrambledUrl&&i.A.downloadImage(this.scrambledUrl,"scrambled.png")}},beforeDestroy(){this.imgUrl&&URL.revokeObjectURL(this.imgUrl),this.imgUrl="",this.scrambledUrl=""},watch:{showMask(t){t&&this.$nextTick((()=>{const t=this.$refs.scrambledImg&&this.$refs.scrambledImg.$el;t&&(this.scrambleMaskStyle={width:t.offsetWidth+"px",height:t.offsetHeight+"px",borderRadius:"10px"})}))}}},o=l,n=s(81656),c=(0,n.A)(o,r,a,!1,null,"8a34e546",null),d=c.exports}}]);
//# sourceMappingURL=5319.76a16998.js.map