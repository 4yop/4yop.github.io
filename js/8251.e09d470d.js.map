{"version":3,"file":"js/8251.e09d470d.js","mappings":"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","sources":["webpack://web-tool-vue/./src/views/img/OcrView.vue","webpack://web-tool-vue/./src/util/StringUtil.js","webpack://web-tool-vue/./src/util/CanvasUtil.js","webpack://web-tool-vue/./src/util/TimeUtil.js","webpack://web-tool-vue/src/views/img/OcrView.vue","webpack://web-tool-vue/./src/views/img/OcrView.vue?e3e3","webpack://web-tool-vue/./src/views/img/OcrView.vue?b762","webpack://web-tool-vue/./node_modules/tesseract.js/node_modules/regenerator-runtime/runtime.js","webpack://web-tool-vue/./src/util/ExcelUtil.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/Tesseract.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/constants/OEM.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/constants/PSM.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/constants/defaultOptions.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/constants/languages.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/createJob.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/createScheduler.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/createWorker.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/index.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/utils/getEnvironment.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/utils/getId.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/utils/log.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/utils/resolvePaths.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/defaultOptions.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/index.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/loadImage.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/onMessage.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/send.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/spawnWorker.js","webpack://web-tool-vue/./node_modules/tesseract.js/src/worker/browser/terminateWorker.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"modern-bg\"},[_c('el-row',{attrs:{\"gutter\":0,\"justify\":\"center\"}},[_c('el-col',{attrs:{\"xs\":{span: 24, offset: 0},\"sm\":{span: 22, offset: 1},\"md\":{span: 18, offset: 3},\"lg\":{span: 14, offset: 5},\"xl\":{span: 12, offset: 6}}},[_c('el-card',{staticClass:\"modern-card\",attrs:{\"shadow\":\"hover\"}},[_c('h2',{staticClass:\"modern-title\"},[_vm._v(\"批量OCR文字识别\")]),_c('el-divider'),_c('div',{staticClass:\"upload-row\"},[_c('el-upload',{attrs:{\"action\":\"#\",\"auto-upload\":false,\"multiple\":true,\"show-file-list\":false,\"accept\":\"image/*\",\"disabled\":_vm.isProcessing,\"on-change\":_vm.handleUploadChange}},[_c('el-button',{attrs:{\"type\":\"primary\",\"round\":\"\",\"disabled\":_vm.isProcessing}},[_c('i',{staticClass:\"el-icon-upload\"}),_vm._v(\" 选择图片 \")])],1),_c('el-select',{staticStyle:{\"width\":\"120px\"},attrs:{\"placeholder\":\"选择识别语言\",\"disabled\":_vm.isProcessing},model:{value:(_vm.language),callback:function ($$v) {_vm.language=$$v},expression:\"language\"}},_vm._l((_vm.languageOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_c('el-button',{attrs:{\"type\":\"success\",\"round\":\"\",\"disabled\":_vm.isProcessing || _vm.imgs.length === 0,\"loading\":_vm.isProcessing},on:{\"click\":_vm.startBatchRecognition}},[_c('i',{staticClass:\"el-icon-cpu\"}),_vm._v(\" 开始识别 \")]),_c('el-button',{attrs:{\"type\":\"warning\",\"round\":\"\",\"size\":\"small\",\"disabled\":_vm.isProcessing || _vm.imgs.length === 0 || !_vm.hasRecognizedResults},on:{\"click\":_vm.resetAllRecognition}},[_c('i',{staticClass:\"el-icon-refresh\"}),_vm._v(\" 重置 \")])],1),_c('div',{staticClass:\"upload-row\",staticStyle:{\"margin-top\":\"16px\"}},[_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.$refs.imgTable.clearSelection()}}},[_vm._v(\"全不选\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\",\"disabled\":_vm.multipleSelection.length === 0},on:{\"click\":_vm.handleBatchDelete}},[_vm._v(\" 批量删除 \")]),_c('el-button',{attrs:{\"type\":\"warning\",\"size\":\"mini\",\"disabled\":_vm.imgs.filter(img => img.status === '成功').length === 0},on:{\"click\":_vm.exportToExcel}},[_c('i',{staticClass:\"el-icon-download\"}),_vm._v(\" 导出Excel \")]),_c('el-button',{attrs:{\"type\":\"info\",\"size\":\"mini\",\"disabled\":_vm.imgs.length === 0},on:{\"click\":_vm.clearAll}},[_vm._v(\" 清空所有 \")])],1),(_vm.isProcessing)?_c('div',{staticStyle:{\"margin-top\":\"16px\",\"text-align\":\"center\"}},[_c('el-alert',{attrs:{\"title\":`正在处理第 ${_vm.currentProcessingIndex + 1} / ${_vm.imgs.length} 张图片...`,\"type\":\"info\",\"closable\":false,\"show-icon\":\"\"}})],1):_vm._e(),(_vm.imgs.length > 0)?_c('div',{staticStyle:{\"margin-top\":\"24px\"}},[_c('el-table',{ref:\"imgTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.imgs,\"border\":\"\",\"row-class-name\":({row}) => row.statusType === 'success' ? 'success-row' : row.statusType === 'danger' ? 'error-row' : ''},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"50\"}}),_c('el-table-column',{attrs:{\"label\":\"图片\",\"align\":\"center\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticStyle:{\"text-align\":\"center\"}},[_c('el-image',{staticStyle:{\"width\":\"80px\",\"height\":\"80px\",\"border-radius\":\"8px\",\"box-shadow\":\"0 2px 8px rgba(0,0,0,0.08)\"},attrs:{\"src\":scope.row.img,\"alt\":scope.row.fileName,\"preview-src-list\":_vm.imgs.map(i => i.img),\"fit\":\"cover\"}}),_c('p',{staticClass:\"img-info\",staticStyle:{\"margin-top\":\"4px\",\"font-size\":\"12px\",\"color\":\"#666\"}},[_vm._v(\" \"+_vm._s(scope.row.fileName)+\" \")]),_c('p',{staticClass:\"img-info\",staticStyle:{\"margin-top\":\"2px\",\"font-size\":\"11px\",\"color\":\"#999\"}},[_vm._v(\" \"+_vm._s(scope.row.fileSize)+\" \")])],1)]}}],null,false,3341656514)}),_c('el-table-column',{attrs:{\"label\":\"状态\",\"align\":\"center\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"column\",\"align-items\":\"center\",\"gap\":\"4px\"}},[_c('el-tag',{attrs:{\"type\":scope.row.statusType,\"effect\":scope.row.status.includes('识别中') ? 'plain' : 'dark'}},[_vm._v(\" \"+_vm._s(_vm.getStatusText(scope.row))+\" \")]),(_vm.getStatusDetail(scope.row))?_c('div',{staticStyle:{\"font-size\":\"10px\",\"color\":\"#666\",\"text-align\":\"center\",\"line-height\":\"1.2\",\"word-break\":\"break-all\"}},[_vm._v(\" \"+_vm._s(_vm.getStatusDetail(scope.row))+\" \")]):_vm._e()],1),(_vm.isProcessing && _vm.currentProcessingIndex === scope.$index && scope.row.status.includes('识别中'))?_c('div',{staticStyle:{\"margin-top\":\"8px\"}},[_c('el-progress',{attrs:{\"percentage\":scope.row.status.includes('%') ? parseInt(scope.row.status.match(/\\d+/)[0]) : 0,\"stroke-width\":6,\"show-text\":false}})],1):_vm._e()]}}],null,false,2380151332)}),_c('el-table-column',{attrs:{\"label\":\"识别结果\",\"align\":\"left\",\"min-width\":\"300\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.recognizedText)?_c('div',{staticStyle:{\"position\":\"relative\"}},[_c('div',{staticStyle:{\"max-height\":\"100px\",\"overflow-y\":\"auto\",\"padding\":\"8px\",\"background\":\"#f5f7fa\",\"border-radius\":\"4px\",\"font-size\":\"13px\",\"line-height\":\"1.4\"}},[_vm._v(\" \"+_vm._s(scope.row.recognizedText)+\" \")]),_c('el-button',{staticStyle:{\"margin-top\":\"4px\"},attrs:{\"type\":\"text\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.copyText(scope.row.recognizedText)}}},[_c('i',{staticClass:\"el-icon-document-copy\"}),_vm._v(\" 复制 \")])],1):(scope.row.status === '未识别')?_c('div',{staticStyle:{\"color\":\"#909399\",\"font-style\":\"italic\"}},[_vm._v(\" 等待识别... \")]):(scope.row.statusType === 'danger')?_c('div',{staticStyle:{\"color\":\"#f56c6c\",\"font-style\":\"italic\"}},[_vm._v(\" 识别失败 \")]):_c('div',{staticStyle:{\"color\":\"#909399\",\"font-style\":\"italic\"}},[_vm._v(\" 识别中... \")])]}}],null,false,784986391)}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\",\"width\":\"80\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\",\"disabled\":_vm.isProcessing && _vm.currentProcessingIndex === scope.$index},on:{\"click\":function($event){return _vm.handleDeleteRow(scope.$index)}}},[_vm._v(\" 删除 \")])]}}],null,false,871782530)})],1)],1):_c('div',{staticStyle:{\"text-align\":\"center\",\"padding\":\"40px\",\"color\":\"#909399\"}},[_c('i',{staticClass:\"el-icon-picture\",staticStyle:{\"font-size\":\"48px\",\"margin-bottom\":\"16px\"}}),_c('p',[_vm._v(\"请选择图片文件开始批量OCR识别\")]),_c('p',{staticStyle:{\"font-size\":\"12px\",\"margin-top\":\"8px\"}},[_vm._v(\"支持 JPG、PNG、GIF、BMP 等常见图片格式\")])])],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class StringUtil {\r\n    /**\r\n     * 复制文本到剪贴板\r\n     * @param {string} text - 要复制的文本\r\n     * @param {Function} callback - 可选的回调函数\r\n     * @returns {Promise<boolean>} - 复制是否成功\r\n     */\r\n    static async copy(text, callback = null) {\r\n        try {\r\n            // 参数验证\r\n            if (typeof text !== 'string') {\r\n                throw new Error('复制的内容必须是字符串');\r\n            }\r\n\r\n            if (text.trim() === '') {\r\n                throw new Error('复制的内容不能为空');\r\n            }\r\n\r\n            // 优先使用现代 Clipboard API\r\n            if (navigator.clipboard && window.isSecureContext) {\r\n                await navigator.clipboard.writeText(text);\r\n                if (callback) callback(true, '复制成功');\r\n                return true;\r\n            } else {\r\n                // 兼容旧浏览器的方案\r\n                const success = this.fallbackCopy(text);\r\n                if (callback) callback(success, success ? '复制成功' : '复制失败');\r\n                return success;\r\n            }\r\n        } catch (error) {\r\n            console.error('复制失败:', error);\r\n            if (callback) callback(false, error.message);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 兼容旧浏览器的复制方法\r\n     * @param {string} text - 要复制的文本\r\n     * @returns {boolean} - 复制是否成功\r\n     */\r\n    static fallbackCopy(text) {\r\n        let input = null;\r\n        try {\r\n            // 创建临时输入框\r\n            input = document.createElement('textarea');\r\n            input.value = text;\r\n\r\n            // 设置样式，使其不可见但可选中\r\n            input.style.position = 'fixed';\r\n            input.style.left = '-9999px';\r\n            input.style.top = '-9999px';\r\n            input.style.opacity = '0';\r\n            input.style.pointerEvents = 'none';\r\n\r\n            document.body.appendChild(input);\r\n\r\n            // 选中文本\r\n            input.focus();\r\n            input.select();\r\n            input.setSelectionRange(0, text.length);\r\n\r\n            // 执行复制命令\r\n            const success = document.execCommand('copy');\r\n            return success;\r\n        } catch (error) {\r\n            console.error('兼容模式复制失败:', error);\r\n            return false;\r\n        } finally {\r\n            // 清理临时元素\r\n            if (input && input.parentNode) {\r\n                document.body.removeChild(input);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 检查是否支持剪贴板操作\r\n     * @returns {boolean} - 是否支持\r\n     */\r\n    static isClipboardSupported() {\r\n        return !!(navigator.clipboard && window.isSecureContext) ||\r\n               document.queryCommandSupported('copy');\r\n    }\r\n}","/**\n * Canvas处理工具类\n */\nexport class CanvasUtil {\n    /**\n     * 文件转Canvas\n     * @param {File} file - 图片文件\n     * @returns {Promise<HTMLCanvasElement>} Canvas元素\n     */\n    static fileToCanvas(file) {\n        return new Promise((resolve, reject) => {\n            // 验证文件\n            if (!file || !file.type.startsWith('image/')) {\n                reject(new Error('无效的图片文件'));\n                return;\n            }\n\n            const img = new Image();\n            let objectUrl = null;\n\n            img.onload = () => {\n                try {\n                    // 验证图片尺寸\n                    if (img.naturalWidth === 0 || img.naturalHeight === 0) {\n                        throw new Error('图片尺寸无效');\n                    }\n\n                    const canvas = document.createElement('canvas');\n                    const ctx = canvas.getContext('2d');\n\n                    if (!ctx) {\n                        throw new Error('无法创建Canvas上下文');\n                    }\n\n                    // 设置画布尺寸\n                    canvas.width = img.naturalWidth;\n                    canvas.height = img.naturalHeight;\n\n                    // 设置白色背景（有助于OCR识别）\n                    ctx.fillStyle = 'white';\n                    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n                    // 绘制图片\n                    ctx.drawImage(img, 0, 0);\n\n                    // 验证Canvas是否有效\n                    if (canvas.width === 0 || canvas.height === 0) {\n                        throw new Error('Canvas尺寸无效');\n                    }\n\n                    resolve(canvas);\n                } catch (error) {\n                    reject(new Error(`图片处理失败: ${error.message}`));\n                } finally {\n                    // 清理URL\n                    if (objectUrl) {\n                        URL.revokeObjectURL(objectUrl);\n                    }\n                }\n            };\n\n            img.onerror = () => {\n                if (objectUrl) {\n                    URL.revokeObjectURL(objectUrl);\n                }\n                reject(new Error('图片加载失败'));\n            };\n\n            try {\n                objectUrl = URL.createObjectURL(file);\n                img.src = objectUrl;\n            } catch (error) {\n                reject(new Error(`创建图片URL失败: ${error.message}`));\n            }\n        });\n    }\n\n    /**\n     * Canvas转Blob\n     * @param {HTMLCanvasElement} canvas - Canvas元素\n     * @param {string} type - 图片类型\n     * @param {number} quality - 图片质量\n     * @returns {Promise<Blob>} Blob对象\n     */\n    static canvasToBlob(canvas, type = 'image/png', quality = 0.92) {\n        return new Promise((resolve) => {\n            canvas.toBlob(resolve, type, quality);\n        });\n    }\n\n    /**\n     * Canvas转DataURL\n     * @param {HTMLCanvasElement} canvas - Canvas元素\n     * @param {string} type - 图片类型\n     * @param {number} quality - 图片质量\n     * @returns {string} DataURL字符串\n     */\n    static canvasToDataURL(canvas, type = 'image/png', quality = 0.92) {\n        return canvas.toDataURL(type, quality);\n    }\n\n    /**\n     * 调整Canvas尺寸\n     * @param {HTMLCanvasElement} canvas - 原Canvas\n     * @param {number} width - 新宽度\n     * @param {number} height - 新高度\n     * @returns {HTMLCanvasElement} 新Canvas\n     */\n    static resizeCanvas(canvas, width, height) {\n        const newCanvas = document.createElement('canvas');\n        const ctx = newCanvas.getContext('2d');\n        \n        newCanvas.width = width;\n        newCanvas.height = height;\n        \n        ctx.drawImage(canvas, 0, 0, width, height);\n        \n        return newCanvas;\n    }\n\n    /**\n     * 获取Canvas图像数据\n     * @param {HTMLCanvasElement} canvas - Canvas元素\n     * @returns {ImageData} 图像数据\n     */\n    static getImageData(canvas) {\n        const ctx = canvas.getContext('2d');\n        return ctx.getImageData(0, 0, canvas.width, canvas.height);\n    }\n\n    /**\n     * 设置Canvas图像数据\n     * @param {HTMLCanvasElement} canvas - Canvas元素\n     * @param {ImageData} imageData - 图像数据\n     */\n    static putImageData(canvas, imageData) {\n        const ctx = canvas.getContext('2d');\n        ctx.putImageData(imageData, 0, 0);\n    }\n\n    /**\n     * 增强图像对比度\n     * @param {ImageData} imageData - 图像数据\n     * @param {number} factor - 对比度因子\n     */\n    static enhanceContrast(imageData, factor = 1.2) {\n        const data = imageData.data;\n        const intercept = 128 * (1 - factor);\n        \n        for (let i = 0; i < data.length; i += 4) {\n            data[i] = data[i] * factor + intercept;     // Red\n            data[i + 1] = data[i + 1] * factor + intercept; // Green\n            data[i + 2] = data[i + 2] * factor + intercept; // Blue\n            // Alpha channel (data[i + 3]) remains unchanged\n        }\n    }\n\n    /**\n     * 图像灰度化\n     * @param {ImageData} imageData - 图像数据\n     */\n    static grayscale(imageData) {\n        const data = imageData.data;\n        \n        for (let i = 0; i < data.length; i += 4) {\n            const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n            data[i] = gray;     // Red\n            data[i + 1] = gray; // Green\n            data[i + 2] = gray; // Blue\n            // Alpha channel (data[i + 3]) remains unchanged\n        }\n    }\n\n    /**\n     * 调整图像亮度\n     * @param {ImageData} imageData - 图像数据\n     * @param {number} brightness - 亮度值 (-255 到 255)\n     */\n    static adjustBrightness(imageData, brightness) {\n        const data = imageData.data;\n        \n        for (let i = 0; i < data.length; i += 4) {\n            data[i] = Math.max(0, Math.min(255, data[i] + brightness));     // Red\n            data[i + 1] = Math.max(0, Math.min(255, data[i + 1] + brightness)); // Green\n            data[i + 2] = Math.max(0, Math.min(255, data[i + 2] + brightness)); // Blue\n            // Alpha channel (data[i + 3]) remains unchanged\n        }\n    }\n\n    /**\n     * 创建空白Canvas\n     * @param {number} width - 宽度\n     * @param {number} height - 高度\n     * @param {string} backgroundColor - 背景色\n     * @returns {HTMLCanvasElement} Canvas元素\n     */\n    static createCanvas(width, height, backgroundColor = 'white') {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        \n        canvas.width = width;\n        canvas.height = height;\n        \n        if (backgroundColor) {\n            ctx.fillStyle = backgroundColor;\n            ctx.fillRect(0, 0, width, height);\n        }\n        \n        return canvas;\n    }\n\n    /**\n     * 合并多个Canvas\n     * @param {Array<HTMLCanvasElement>} canvases - Canvas数组\n     * @param {string} direction - 合并方向 'horizontal' | 'vertical'\n     * @returns {HTMLCanvasElement} 合并后的Canvas\n     */\n    static mergeCanvases(canvases, direction = 'horizontal') {\n        if (!canvases || canvases.length === 0) {\n            throw new Error('Canvas数组不能为空');\n        }\n\n        if (canvases.length === 1) {\n            return canvases[0];\n        }\n\n        let totalWidth = 0;\n        let totalHeight = 0;\n        let maxWidth = 0;\n        let maxHeight = 0;\n\n        // 计算总尺寸\n        canvases.forEach(canvas => {\n            if (direction === 'horizontal') {\n                totalWidth += canvas.width;\n                maxHeight = Math.max(maxHeight, canvas.height);\n            } else {\n                totalHeight += canvas.height;\n                maxWidth = Math.max(maxWidth, canvas.width);\n            }\n        });\n\n        const resultCanvas = document.createElement('canvas');\n        const ctx = resultCanvas.getContext('2d');\n\n        if (direction === 'horizontal') {\n            resultCanvas.width = totalWidth;\n            resultCanvas.height = maxHeight;\n            let currentX = 0;\n            canvases.forEach(canvas => {\n                ctx.drawImage(canvas, currentX, 0);\n                currentX += canvas.width;\n            });\n        } else {\n            resultCanvas.width = maxWidth;\n            resultCanvas.height = totalHeight;\n            let currentY = 0;\n            canvases.forEach(canvas => {\n                ctx.drawImage(canvas, 0, currentY);\n                currentY += canvas.height;\n            });\n        }\n\n        return resultCanvas;\n    }\n}\n","/**\n * 时间处理工具类\n */\nexport class TimeUtil {\n    /**\n     * 格式化持续时间（秒）\n     * @param {number} seconds - 秒数\n     * @returns {string} 格式化的时间字符串\n     */\n    static formatDuration(seconds) {\n        if (!seconds || seconds < 0) return '0秒';\n        \n        const hours = Math.floor(seconds / 3600);\n        const minutes = Math.floor((seconds % 3600) / 60);\n        const secs = seconds % 60;\n        \n        if (hours > 0) {\n            return `${hours}小时${minutes}分钟${secs}秒`;\n        } else if (minutes > 0) {\n            return `${minutes}分钟${secs}秒`;\n        } else {\n            return `${secs}秒`;\n        }\n    }\n\n    /**\n     * 格式化时间戳\n     * @param {number} timestamp - 时间戳（毫秒）\n     * @param {string} format - 格式字符串\n     * @returns {string} 格式化的时间字符串\n     */\n    static formatTimestamp(timestamp, format = 'YYYY-MM-DD HH:mm:ss') {\n        if (!timestamp) return '';\n        \n        const date = new Date(timestamp);\n        \n        const year = date.getFullYear();\n        const month = String(date.getMonth() + 1).padStart(2, '0');\n        const day = String(date.getDate()).padStart(2, '0');\n        const hours = String(date.getHours()).padStart(2, '0');\n        const minutes = String(date.getMinutes()).padStart(2, '0');\n        const seconds = String(date.getSeconds()).padStart(2, '0');\n        \n        return format\n            .replace('YYYY', year)\n            .replace('MM', month)\n            .replace('DD', day)\n            .replace('HH', hours)\n            .replace('mm', minutes)\n            .replace('ss', seconds);\n    }\n\n    /**\n     * 获取当前时间戳\n     * @returns {number} 当前时间戳（毫秒）\n     */\n    static now() {\n        return Date.now();\n    }\n\n    /**\n     * 获取当前日期字符串\n     * @param {string} format - 格式字符串\n     * @returns {string} 格式化的日期字符串\n     */\n    static today(format = 'YYYY-MM-DD') {\n        return this.formatTimestamp(this.now(), format);\n    }\n\n    /**\n     * 计算时间差（毫秒）\n     * @param {number} startTime - 开始时间戳\n     * @param {number} endTime - 结束时间戳\n     * @returns {number} 时间差（毫秒）\n     */\n    static timeDiff(startTime, endTime = null) {\n        const end = endTime || this.now();\n        return Math.max(0, end - startTime);\n    }\n\n    /**\n     * 计算时间差（秒）\n     * @param {number} startTime - 开始时间戳\n     * @param {number} endTime - 结束时间戳\n     * @returns {number} 时间差（秒）\n     */\n    static timeDiffInSeconds(startTime, endTime = null) {\n        return Math.floor(this.timeDiff(startTime, endTime) / 1000);\n    }\n\n    /**\n     * 创建计时器\n     * @param {Function} callback - 回调函数\n     * @param {number} interval - 间隔时间（毫秒）\n     * @returns {Object} 计时器对象\n     */\n    static createTimer(callback, interval = 1000) {\n        let startTime = this.now();\n        let timerId = null;\n        let isRunning = false;\n\n        const timer = {\n            start() {\n                if (isRunning) return;\n                \n                startTime = TimeUtil.now();\n                isRunning = true;\n                \n                const tick = () => {\n                    if (!isRunning) return;\n                    \n                    const elapsed = TimeUtil.timeDiffInSeconds(startTime);\n                    callback(elapsed);\n                    \n                    timerId = setTimeout(tick, interval);\n                };\n                \n                tick();\n            },\n\n            stop() {\n                if (timerId) {\n                    clearTimeout(timerId);\n                    timerId = null;\n                }\n                isRunning = false;\n            },\n\n            reset() {\n                this.stop();\n                startTime = TimeUtil.now();\n            },\n\n            getElapsed() {\n                return TimeUtil.timeDiffInSeconds(startTime);\n            },\n\n            isRunning() {\n                return isRunning;\n            }\n        };\n\n        return timer;\n    }\n\n    /**\n     * 延迟执行\n     * @param {number} ms - 延迟时间（毫秒）\n     * @returns {Promise} Promise对象\n     */\n    static delay(ms) {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    /**\n     * 超时执行\n     * @param {Promise} promise - Promise对象\n     * @param {number} timeout - 超时时间（毫秒）\n     * @returns {Promise} Promise对象\n     */\n    static timeout(promise, timeout) {\n        return Promise.race([\n            promise,\n            new Promise((_, reject) => \n                setTimeout(() => reject(new Error('操作超时')), timeout)\n            )\n        ]);\n    }\n\n    /**\n     * 格式化相对时间\n     * @param {number} timestamp - 时间戳\n     * @returns {string} 相对时间字符串\n     */\n    static formatRelativeTime(timestamp) {\n        const now = this.now();\n        const diff = now - timestamp;\n        \n        const minute = 60 * 1000;\n        const hour = 60 * minute;\n        const day = 24 * hour;\n        const week = 7 * day;\n        const month = 30 * day;\n        const year = 365 * day;\n        \n        if (diff < minute) {\n            return '刚刚';\n        } else if (diff < hour) {\n            return `${Math.floor(diff / minute)}分钟前`;\n        } else if (diff < day) {\n            return `${Math.floor(diff / hour)}小时前`;\n        } else if (diff < week) {\n            return `${Math.floor(diff / day)}天前`;\n        } else if (diff < month) {\n            return `${Math.floor(diff / week)}周前`;\n        } else if (diff < year) {\n            return `${Math.floor(diff / month)}个月前`;\n        } else {\n            return `${Math.floor(diff / year)}年前`;\n        }\n    }\n\n    /**\n     * 判断是否为今天\n     * @param {number} timestamp - 时间戳\n     * @returns {boolean} 是否为今天\n     */\n    static isToday(timestamp) {\n        const today = new Date();\n        const date = new Date(timestamp);\n        \n        return today.getFullYear() === date.getFullYear() &&\n               today.getMonth() === date.getMonth() &&\n               today.getDate() === date.getDate();\n    }\n\n    /**\n     * 判断是否为本周\n     * @param {number} timestamp - 时间戳\n     * @returns {boolean} 是否为本周\n     */\n    static isThisWeek(timestamp) {\n        const now = new Date();\n        const date = new Date(timestamp);\n        \n        // 获取本周一的日期\n        const monday = new Date(now);\n        monday.setDate(now.getDate() - now.getDay() + 1);\n        monday.setHours(0, 0, 0, 0);\n        \n        // 获取本周日的日期\n        const sunday = new Date(monday);\n        sunday.setDate(monday.getDate() + 6);\n        sunday.setHours(23, 59, 59, 999);\n        \n        return date >= monday && date <= sunday;\n    }\n\n    /**\n     * 获取时间段描述\n     * @param {number} hour - 小时（0-23）\n     * @returns {string} 时间段描述\n     */\n    static getTimeOfDay(hour) {\n        if (hour >= 5 && hour < 8) {\n            return '清晨';\n        } else if (hour >= 8 && hour < 11) {\n            return '上午';\n        } else if (hour >= 11 && hour < 13) {\n            return '中午';\n        } else if (hour >= 13 && hour < 17) {\n            return '下午';\n        } else if (hour >= 17 && hour < 19) {\n            return '傍晚';\n        } else if (hour >= 19 && hour < 22) {\n            return '晚上';\n        } else {\n            return '深夜';\n        }\n    }\n\n    /**\n     * 获取当前时间段描述\n     * @returns {string} 当前时间段描述\n     */\n    static getCurrentTimeOfDay() {\n        const hour = new Date().getHours();\n        return this.getTimeOfDay(hour);\n    }\n\n    /**\n     * 获取北京时间\n     * @returns {Date} 北京时间\n     */\n    static getBeijingTime() {\n        const now = new Date();\n        // 转换为北京时间 (UTC+8)\n        return new Date(now.getTime() + (8 * 60 * 60 * 1000) + (now.getTimezoneOffset() * 60 * 1000));\n    }\n\n    /**\n     * 格式化倒计时显示\n     * @param {number} totalSeconds - 总秒数\n     * @returns {Object} 倒计时对象\n     */\n    static formatCountdown(totalSeconds) {\n        const days = Math.floor(totalSeconds / (24 * 3600));\n        const hours = Math.floor((totalSeconds % (24 * 3600)) / 3600);\n        const minutes = Math.floor((totalSeconds % 3600) / 60);\n        const seconds = totalSeconds % 60;\n\n        return {\n            days,\n            hours: String(hours).padStart(2, '0'),\n            minutes: String(minutes).padStart(2, '0'),\n            seconds: String(seconds).padStart(2, '0'),\n            total: totalSeconds\n        };\n    }\n\n    /**\n     * 判断是否为工作日\n     * @param {Date|number|string} date - 时间\n     * @returns {boolean} 是否为工作日\n     */\n    static isWeekday(date) {\n        const day = new Date(date).getDay();\n        return day >= 1 && day <= 5;\n    }\n\n    /**\n     * 判断是否为周末\n     * @param {Date|number|string} date - 时间\n     * @returns {boolean} 是否为周末\n     */\n    static isWeekend(date) {\n        return !this.isWeekday(date);\n    }\n\n    /**\n     * 添加时间\n     * @param {Date|number|string} date - 基础时间\n     * @param {number} amount - 数量\n     * @param {string} unit - 单位（years, months, days, hours, minutes, seconds）\n     * @returns {Date} 新的时间\n     */\n    static add(date, amount, unit) {\n        const newDate = new Date(date);\n\n        switch (unit) {\n            case 'years':\n                newDate.setFullYear(newDate.getFullYear() + amount);\n                break;\n            case 'months':\n                newDate.setMonth(newDate.getMonth() + amount);\n                break;\n            case 'days':\n                newDate.setDate(newDate.getDate() + amount);\n                break;\n            case 'hours':\n                newDate.setHours(newDate.getHours() + amount);\n                break;\n            case 'minutes':\n                newDate.setMinutes(newDate.getMinutes() + amount);\n                break;\n            case 'seconds':\n                newDate.setSeconds(newDate.getSeconds() + amount);\n                break;\n            default:\n                throw new Error(`不支持的时间单位: ${unit}`);\n        }\n\n        return newDate;\n    }\n\n    /**\n     * 减去时间\n     * @param {Date|number|string} date - 基础时间\n     * @param {number} amount - 数量\n     * @param {string} unit - 单位\n     * @returns {Date} 新的时间\n     */\n    static subtract(date, amount, unit) {\n        return this.add(date, -amount, unit);\n    }\n}\n","<script>\r\nimport Tesseract from 'tesseract.js';\r\nimport FileUtil from \"@/util/FileUtil\";\r\nimport { StringUtil } from \"@/util/StringUtil\";\r\nimport { CanvasUtil } from \"@/util/CanvasUtil\";\r\nimport { ExcelUtil } from \"@/util/ExcelUtil\";\r\nimport { TimeUtil } from \"@/util/TimeUtil\";\r\n\r\nexport default {\r\n  name: 'OcrView',\r\n  data() {\r\n    return {\r\n      metaInfo: {\r\n        title: '批量OCR文字识别工具 - 在线图片转文字',\r\n        meta: [\r\n          { name: 'description', content: '批量上传图片进行OCR文字识别，支持中英文识别，可导出Excel文件，提高文字录入效率。' },\r\n          { name: 'keywords', content: '批量OCR,图片转文字,文字识别,在线OCR,批量识别,Excel导出' }\r\n        ]\r\n      },\r\n      imgs: [],\r\n      multipleSelection: [],\r\n      isProcessing: false,\r\n      currentProcessingIndex: -1,\r\n      language: 'chi_sim', // 默认仅中文\r\n      languageOptions: [\r\n        { label: '仅中文', value: 'chi_sim' },\r\n        { label: '中英文', value: 'eng+chi_sim' },\r\n        { label: '仅英文', value: 'eng' },\r\n        { label: '日文', value: 'jpn' },\r\n        { label: '韩文', value: 'kor' }\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    // 检查是否有识别结果\r\n    hasRecognizedResults() {\r\n      return this.imgs.some(img => img.status === '成功' || img.recognizedText);\r\n    }\r\n  },\r\n  mounted() {\r\n    if (window.__PRERENDER_INJECTED__) {\r\n      return;\r\n    }\r\n  },\r\n  methods: {\r\n    // 格式化文件大小\r\n    formatFileSize(bytes) {\r\n      return FileUtil.formatBytes(bytes);\r\n    },\r\n\r\n    // 处理文件上传\r\n    handleUploadChange(file, fileList) {\r\n      this.imgs = [];\r\n      for (const f of fileList) {\r\n        const rawFile = f.raw || f;\r\n        let imgInfo = {\r\n          id: TimeUtil.now() + Math.random(),\r\n          img: URL.createObjectURL(rawFile),\r\n          imgFile: rawFile,\r\n          fileName: rawFile.name,\r\n          fileSize: this.formatFileSize(rawFile.size),\r\n          status: '未识别',\r\n          statusType: 'info', // info, success, warning, danger\r\n          recognizedText: '',\r\n          errorMessage: '',\r\n          startTime: null,\r\n          endTime: null,\r\n          duration: 0,\r\n          timer: null\r\n        };\r\n\r\n        // 检查文件类型\r\n        if (rawFile.type && !rawFile.type.startsWith('image/')) {\r\n          imgInfo.status = '失败';\r\n          imgInfo.statusType = 'danger';\r\n          imgInfo.errorMessage = '不支持的文件格式';\r\n        } else {\r\n          // 验证图片是否可以正常加载\r\n          this.validateImage(imgInfo);\r\n        }\r\n\r\n        this.imgs.push(imgInfo);\r\n      }\r\n    },\r\n\r\n    // 验证图片是否可以正常加载\r\n    validateImage(imgInfo) {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        // 图片加载成功，可以进行OCR识别\r\n        imgInfo.status = '就绪';\r\n        imgInfo.statusType = 'info';\r\n        // 不要在这里释放URL，因为图片预览还需要使用\r\n      };\r\n      img.onerror = () => {\r\n        // 图片加载失败\r\n        imgInfo.status = '失败';\r\n        imgInfo.statusType = 'danger';\r\n        imgInfo.errorMessage = '图片文件损坏或格式不支持';\r\n        // 图片加载失败时也不释放URL，让用户能看到错误的图片\r\n      };\r\n      img.src = imgInfo.img;\r\n    },\r\n\r\n    // 开始批量识别\r\n    async startBatchRecognition() {\r\n      if (this.imgs.length === 0) {\r\n        this.$message.warning('请先选择图片文件');\r\n        return;\r\n      }\r\n\r\n      // 检查是否有已识别的图片，如果有则询问是否重置\r\n      const hasRecognized = this.imgs.some(img => img.status === '成功' || img.recognizedText);\r\n      if (hasRecognized) {\r\n        try {\r\n          await this.$confirm('检测到已有识别结果，是否重新开始识别？', '确认操作', {\r\n            confirmButtonText: '重新识别',\r\n            cancelButtonText: '继续识别',\r\n            type: 'warning'\r\n          });\r\n          // 用户选择重新识别，重置所有状态\r\n          this.resetAllRecognition();\r\n        } catch {\r\n          // 用户选择继续识别，不做任何操作\r\n        }\r\n      }\r\n\r\n      this.isProcessing = true;\r\n\r\n      // 获取需要识别的图片\r\n      const imagesToProcess = this.imgs.filter(img => !(img.status === '成功' && img.recognizedText));\r\n\r\n      if (imagesToProcess.length === 0) {\r\n        this.isProcessing = false;\r\n        this.$message.info('所有图片都已识别完成');\r\n        return;\r\n      }\r\n\r\n      this.$message.info(`开始同步识别 ${imagesToProcess.length} 张图片...`);\r\n\r\n      // 同步处理，一个个来\r\n      for (let i = 0; i < this.imgs.length; i++) {\r\n        const img = this.imgs[i];\r\n\r\n        // 跳过已经识别成功的图片\r\n        if (img.status === '成功' && img.recognizedText) {\r\n          continue;\r\n        }\r\n\r\n        this.currentProcessingIndex = i;\r\n        await this.recognizeImage(img);\r\n      }\r\n\r\n      // 统计识别结果\r\n      const successCount = this.imgs.filter(img => img.status === '成功').length;\r\n      const failCount = this.imgs.filter(img => img.status === '失败').length;\r\n\r\n      this.isProcessing = false;\r\n      this.currentProcessingIndex = -1;\r\n      this.$message.success(`批量识别完成！成功: ${successCount} 张，失败: ${failCount} 张`);\r\n    },\r\n\r\n    // 重置所有识别状态\r\n    resetAllRecognition() {\r\n      this.imgs.forEach(img => {\r\n        // 清除计时器\r\n        if (img.timer) {\r\n          img.timer.stop();\r\n          img.timer = null;\r\n        }\r\n\r\n        // 重置状态\r\n        img.status = img.errorMessage === '图片文件损坏或格式不支持' ? '失败' : '就绪';\r\n        img.statusType = img.errorMessage === '图片文件损坏或格式不支持' ? 'danger' : 'info';\r\n        img.recognizedText = '';\r\n        img.startTime = null;\r\n        img.endTime = null;\r\n        img.duration = 0;\r\n\r\n        // 保留原有的错误信息（如果是文件损坏）\r\n        if (img.errorMessage !== '图片文件损坏或格式不支持') {\r\n          img.errorMessage = '';\r\n        }\r\n      });\r\n\r\n      this.$message.info('已重置所有识别状态');\r\n    },\r\n\r\n    // 识别单张图片\r\n    async recognizeImage(imgInfo) {\r\n      imgInfo.status = '识别中';\r\n      imgInfo.statusType = 'warning';\r\n      imgInfo.startTime = TimeUtil.now();\r\n      imgInfo.duration = 0;\r\n      imgInfo.errorMessage = '';\r\n\r\n      // 启动计时器\r\n      imgInfo.timer = TimeUtil.createTimer((elapsed) => {\r\n        imgInfo.duration = elapsed;\r\n      });\r\n      imgInfo.timer.start();\r\n\r\n      try {\r\n        // 添加延迟避免资源冲突\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n\r\n        // 优先使用Canvas方法，更稳定\r\n        const canvas = await CanvasUtil.fileToCanvas(imgInfo.imgFile);\r\n\r\n        // 确保canvas有效\r\n        if (!canvas || canvas.width === 0 || canvas.height === 0) {\r\n          throw new Error('图片处理失败，无法生成有效的Canvas');\r\n        }\r\n\r\n        const result = await Tesseract.recognize(canvas, this.language, {\r\n          logger: m => {\r\n            if (m.status === 'recognizing text') {\r\n              imgInfo.status = `识别中 ${Math.round(m.progress * 100)}%`;\r\n            }\r\n          }\r\n        });\r\n\r\n        imgInfo.recognizedText = result.data.text.trim();\r\n        imgInfo.endTime = TimeUtil.now();\r\n        imgInfo.status = '成功';\r\n        imgInfo.statusType = 'success';\r\n\r\n        if (!imgInfo.recognizedText) {\r\n          imgInfo.status = '失败';\r\n          imgInfo.statusType = 'warning';\r\n          imgInfo.errorMessage = '未识别到文字内容';\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('OCR识别失败:', error);\r\n        imgInfo.status = '失败';\r\n        imgInfo.statusType = 'danger';\r\n        imgInfo.errorMessage = error.message || '识别过程中发生错误';\r\n        imgInfo.endTime = TimeUtil.now();\r\n      } finally {\r\n        // 清除计时器\r\n        if (imgInfo.timer) {\r\n          imgInfo.timer.stop();\r\n          imgInfo.timer = null;\r\n        }\r\n\r\n        // 计算最终用时\r\n        if (imgInfo.startTime && imgInfo.endTime) {\r\n          imgInfo.duration = TimeUtil.timeDiffInSeconds(imgInfo.startTime, imgInfo.endTime);\r\n        }\r\n      }\r\n    },\r\n\r\n\r\n\r\n    // 增强图片对比度（可选，有助于OCR识别）\r\n    enhanceContrast(imageData) {\r\n      const data = imageData.data;\r\n      const factor = 1.2; // 对比度增强因子\r\n      const intercept = 128 * (1 - factor);\r\n\r\n      for (let i = 0; i < data.length; i += 4) {\r\n        data[i] = data[i] * factor + intercept;     // Red\r\n        data[i + 1] = data[i + 1] * factor + intercept; // Green\r\n        data[i + 2] = data[i + 2] * factor + intercept; // Blue\r\n        // Alpha channel (data[i + 3]) remains unchanged\r\n      }\r\n    },\r\n\r\n    // 复制文字到剪贴板\r\n    async copyText(text) {\r\n      if (!text || text.trim() === '') {\r\n        this.$message.warning('没有可复制的内容');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const success = await StringUtil.copy(text, (success, message) => {\r\n          if (success) {\r\n            this.$message.success('已复制到剪贴板');\r\n          } else {\r\n            this.$message.error(`复制失败: ${message}`);\r\n          }\r\n        });\r\n\r\n        // 如果没有使用回调，直接显示结果\r\n        if (!success) {\r\n          this.$message.error('复制失败，请手动复制');\r\n        }\r\n      } catch (error) {\r\n        console.error('复制操作失败:', error);\r\n        this.$message.error('复制失败，请手动复制');\r\n      }\r\n    },\r\n\r\n    // 导出Excel\r\n    exportToExcel() {\r\n      try {\r\n        const fileName = `OCR识别结果_${TimeUtil.formatTimestamp(TimeUtil.now(), 'YYYY-MM-DD_HH-mm-ss')}.xlsx`;\r\n        ExcelUtil.exportOcrResults(this.imgs, fileName);\r\n\r\n        const successCount = this.imgs.filter(img => img.status === '成功' && img.recognizedText).length;\r\n        this.$message.success(`已导出 ${successCount} 条识别结果`);\r\n      } catch (error) {\r\n        console.error('Excel导出失败:', error);\r\n        this.$message.error(`导出失败: ${error.message}`);\r\n      }\r\n    },\r\n\r\n    // 表格选择变化\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n    },\r\n\r\n    // 删除单行\r\n    handleDeleteRow(index) {\r\n      // 清理URL对象\r\n      if (this.imgs[index].img) {\r\n        URL.revokeObjectURL(this.imgs[index].img);\r\n      }\r\n      // 清理计时器\r\n      if (this.imgs[index].timer) {\r\n        this.imgs[index].timer.stop();\r\n      }\r\n      this.imgs.splice(index, 1);\r\n    },\r\n\r\n    // 批量删除\r\n    handleBatchDelete() {\r\n      if (this.multipleSelection.length === 0) {\r\n        this.$message.warning('请先选择要删除的项目');\r\n        return;\r\n      }\r\n\r\n      this.$confirm(`确定要删除选中的 ${this.multipleSelection.length} 个项目吗？`, '确认删除', {\r\n        type: 'warning'\r\n      }).then(() => {\r\n        // 清理资源\r\n        this.multipleSelection.forEach(item => {\r\n          if (item.img) {\r\n            URL.revokeObjectURL(item.img);\r\n          }\r\n          if (item.timer) {\r\n            item.timer.stop();\r\n          }\r\n        });\r\n\r\n        // 删除选中项\r\n        this.multipleSelection.forEach(item => {\r\n          const index = this.imgs.findIndex(img => img.id === item.id);\r\n          if (index > -1) {\r\n            this.imgs.splice(index, 1);\r\n          }\r\n        });\r\n\r\n        this.$message.success('删除成功');\r\n        this.$refs.imgTable.clearSelection();\r\n      }).catch(() => {});\r\n    },\r\n\r\n    // 清空所有\r\n    clearAll() {\r\n      if (this.imgs.length === 0) return;\r\n\r\n      this.$confirm('确定要清空所有图片吗？', '确认清空', {\r\n        type: 'warning'\r\n      }).then(() => {\r\n        // 清理所有资源\r\n        this.imgs.forEach(img => {\r\n          if (img.img) {\r\n            URL.revokeObjectURL(img.img);\r\n          }\r\n          if (img.timer) {\r\n            img.timer.stop();\r\n          }\r\n        });\r\n\r\n        this.imgs = [];\r\n        this.$message.success('已清空所有图片');\r\n      }).catch(() => {});\r\n    },\r\n\r\n    // 获取状态显示文本\r\n    getStatusText(img) {\r\n      if (img.status === '识别中' || img.status.includes('识别中')) {\r\n        return `${img.status} (${img.duration}秒)`;\r\n      } else if (img.status === '成功') {\r\n        return '成功';\r\n      } else if (img.status === '失败') {\r\n        return '失败';\r\n      }\r\n      return img.status;\r\n    },\r\n\r\n    // 获取状态详细信息\r\n    getStatusDetail(img) {\r\n      if (img.status === '成功') {\r\n        return `用时${img.duration}秒`;\r\n      } else if (img.status === '失败') {\r\n        return img.errorMessage;\r\n      }\r\n      return '';\r\n    }\r\n  },\r\n\r\n  // 组件销毁时清理资源\r\n  beforeDestroy() {\r\n    this.imgs.forEach(img => {\r\n      if (img.img) {\r\n        URL.revokeObjectURL(img.img);\r\n      }\r\n      if (img.timer) {\r\n        img.timer.stop();\r\n      }\r\n    });\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"modern-bg\">\r\n    <el-row :gutter=\"0\" justify=\"center\">\r\n      <el-col :xs=\"{span: 24, offset: 0}\" :sm=\"{span: 22, offset: 1}\" :md=\"{span: 18, offset: 3}\" :lg=\"{span: 14, offset: 5}\" :xl=\"{span: 12, offset: 6}\">\r\n        <el-card shadow=\"hover\" class=\"modern-card\">\r\n          <h2 class=\"modern-title\">批量OCR文字识别</h2>\r\n          <el-divider></el-divider>\r\n\r\n          <!-- 操作区域 -->\r\n          <div class=\"upload-row\">\r\n            <el-upload\r\n              action=\"#\"\r\n              :auto-upload=\"false\"\r\n              :multiple=\"true\"\r\n              :show-file-list=\"false\"\r\n              accept=\"image/*\"\r\n              :disabled=\"isProcessing\"\r\n              :on-change=\"handleUploadChange\"\r\n            >\r\n              <el-button type=\"primary\" round :disabled=\"isProcessing\">\r\n                <i class=\"el-icon-upload\"></i> 选择图片\r\n              </el-button>\r\n            </el-upload>\r\n\r\n            <el-select v-model=\"language\" placeholder=\"选择识别语言\" style=\"width: 120px;\" :disabled=\"isProcessing\">\r\n              <el-option\r\n                v-for=\"item in languageOptions\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\">\r\n              </el-option>\r\n            </el-select>\r\n\r\n            <el-button\r\n              type=\"success\"\r\n              round\r\n              :disabled=\"isProcessing || imgs.length === 0\"\r\n              :loading=\"isProcessing\"\r\n              @click=\"startBatchRecognition\"\r\n            >\r\n              <i class=\"el-icon-cpu\"></i> 开始识别\r\n            </el-button>\r\n\r\n            <el-button\r\n              type=\"warning\"\r\n              round\r\n              size=\"small\"\r\n              :disabled=\"isProcessing || imgs.length === 0 || !hasRecognizedResults\"\r\n              @click=\"resetAllRecognition\"\r\n            >\r\n              <i class=\"el-icon-refresh\"></i> 重置\r\n            </el-button>\r\n          </div>\r\n\r\n          <!-- 批量操作按钮 -->\r\n          <div class=\"upload-row\" style=\"margin-top: 16px;\">\r\n            <el-button size=\"mini\" @click=\"$refs.imgTable.clearSelection()\">全不选</el-button>\r\n            <el-button type=\"danger\" size=\"mini\" :disabled=\"multipleSelection.length === 0\" @click=\"handleBatchDelete\">\r\n              批量删除\r\n            </el-button>\r\n            <el-button type=\"warning\" size=\"mini\" :disabled=\"imgs.filter(img => img.status === '成功').length === 0\" @click=\"exportToExcel\">\r\n              <i class=\"el-icon-download\"></i> 导出Excel\r\n            </el-button>\r\n            <el-button type=\"info\" size=\"mini\" :disabled=\"imgs.length === 0\" @click=\"clearAll\">\r\n              清空所有\r\n            </el-button>\r\n          </div>\r\n\r\n          <!-- 进度提示 -->\r\n          <div v-if=\"isProcessing\" style=\"margin-top: 16px; text-align: center;\">\r\n            <el-alert\r\n              :title=\"`正在处理第 ${currentProcessingIndex + 1} / ${imgs.length} 张图片...`\"\r\n              type=\"info\"\r\n              :closable=\"false\"\r\n              show-icon>\r\n            </el-alert>\r\n          </div>\r\n\r\n          <!-- 结果表格 -->\r\n          <div style=\"margin-top: 24px;\" v-if=\"imgs.length > 0\">\r\n            <el-table\r\n              ref=\"imgTable\"\r\n              :data=\"imgs\"\r\n              border\r\n              style=\"width: 100%;\"\r\n              @selection-change=\"handleSelectionChange\"\r\n              :row-class-name=\"({row}) => row.statusType === 'success' ? 'success-row' : row.statusType === 'danger' ? 'error-row' : ''\"\r\n            >\r\n              <el-table-column type=\"selection\" width=\"50\"></el-table-column>\r\n\r\n              <!-- 图片列 -->\r\n              <el-table-column label=\"图片\" align=\"center\" width=\"100\">\r\n                <template slot-scope=\"scope\">\r\n                  <div style=\"text-align: center;\">\r\n                    <el-image\r\n                      style=\"width: 80px; height: 80px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);\"\r\n                      :src=\"scope.row.img\"\r\n                      :alt=\"scope.row.fileName\"\r\n                      :preview-src-list=\"imgs.map(i => i.img)\"\r\n                      fit=\"cover\"\r\n                    />\r\n                    <p class=\"img-info\" style=\"margin-top: 4px; font-size: 12px; color: #666;\">\r\n                      {{ scope.row.fileName }}\r\n                    </p>\r\n                    <p class=\"img-info\" style=\"margin-top: 2px; font-size: 11px; color: #999;\">\r\n                      {{ scope.row.fileSize }}\r\n                    </p>\r\n                  </div>\r\n                </template>\r\n              </el-table-column>\r\n\r\n              <!-- 状态列 -->\r\n              <el-table-column label=\"状态\" align=\"center\" width=\"100\">\r\n                <template slot-scope=\"scope\">\r\n                  <div style=\"display: flex; flex-direction: column; align-items: center; gap: 4px;\">\r\n                    <el-tag\r\n                      :type=\"scope.row.statusType\"\r\n                      :effect=\"scope.row.status.includes('识别中') ? 'plain' : 'dark'\"\r\n                    >\r\n                      {{ getStatusText(scope.row) }}\r\n                    </el-tag>\r\n\r\n                    <!-- 状态详细信息：成功耗时或失败原因 -->\r\n                    <div v-if=\"getStatusDetail(scope.row)\"\r\n                         style=\"font-size: 10px; color: #666; text-align: center; line-height: 1.2; word-break: break-all;\">\r\n                      {{ getStatusDetail(scope.row) }}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <!-- 当前正在处理的项目显示进度条 -->\r\n                  <div v-if=\"isProcessing && currentProcessingIndex === scope.$index && scope.row.status.includes('识别中')\"\r\n                       style=\"margin-top: 8px;\">\r\n                    <el-progress\r\n                      :percentage=\"scope.row.status.includes('%') ? parseInt(scope.row.status.match(/\\d+/)[0]) : 0\"\r\n                      :stroke-width=\"6\"\r\n                      :show-text=\"false\"\r\n                    ></el-progress>\r\n                  </div>\r\n                </template>\r\n              </el-table-column>\r\n\r\n              <!-- 识别结果列 -->\r\n              <el-table-column label=\"识别结果\" align=\"left\" min-width=\"300\">\r\n                <template slot-scope=\"scope\">\r\n                  <div v-if=\"scope.row.recognizedText\" style=\"position: relative;\">\r\n                    <div style=\"max-height: 100px; overflow-y: auto; padding: 8px; background: #f5f7fa; border-radius: 4px; font-size: 13px; line-height: 1.4;\">\r\n                      {{ scope.row.recognizedText }}\r\n                    </div>\r\n                    <el-button\r\n                      type=\"text\"\r\n                      size=\"mini\"\r\n                      style=\"margin-top: 4px;\"\r\n                      @click=\"copyText(scope.row.recognizedText)\"\r\n                    >\r\n                      <i class=\"el-icon-document-copy\"></i> 复制\r\n                    </el-button>\r\n                  </div>\r\n                  <div v-else-if=\"scope.row.status === '未识别'\" style=\"color: #909399; font-style: italic;\">\r\n                    等待识别...\r\n                  </div>\r\n                  <div v-else-if=\"scope.row.statusType === 'danger'\" style=\"color: #f56c6c; font-style: italic;\">\r\n                    识别失败\r\n                  </div>\r\n                  <div v-else style=\"color: #909399; font-style: italic;\">\r\n                    识别中...\r\n                  </div>\r\n                </template>\r\n              </el-table-column>\r\n\r\n              <!-- 操作列 -->\r\n              <el-table-column label=\"操作\" align=\"center\" width=\"80\">\r\n                <template slot-scope=\"scope\">\r\n                  <el-button\r\n                    type=\"danger\"\r\n                    size=\"mini\"\r\n                    @click=\"handleDeleteRow(scope.$index)\"\r\n                    :disabled=\"isProcessing && currentProcessingIndex === scope.$index\"\r\n                  >\r\n                    删除\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n          </div>\r\n\r\n          <!-- 空状态 -->\r\n          <div v-else style=\"text-align: center; padding: 40px; color: #909399;\">\r\n            <i class=\"el-icon-picture\" style=\"font-size: 48px; margin-bottom: 16px;\"></i>\r\n            <p>请选择图片文件开始批量OCR识别</p>\r\n            <p style=\"font-size: 12px; margin-top: 8px;\">支持 JPG、PNG、GIF、BMP 等常见图片格式</p>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n/* 所有公共样式已移至 @/assets/styles/common.css */\r\n\r\n/* OcrView 特有样式 */\r\n.success-row {\r\n  background-color: #f0f9eb !important;\r\n}\r\n\r\n.error-row {\r\n  background-color: #fef0f0 !important;\r\n}\r\n\r\n/* 表格内的图片信息样式 */\r\n.img-info {\r\n  margin: 0;\r\n  word-break: break-all;\r\n}\r\n\r\n/* 识别结果文本区域 */\r\n.result-text {\r\n  max-height: 100px;\r\n  overflow-y: auto;\r\n  padding: 8px;\r\n  background: #f5f7fa;\r\n  border-radius: 4px;\r\n  font-size: 13px;\r\n  line-height: 1.4;\r\n  white-space: pre-wrap;\r\n  word-break: break-word;\r\n}\r\n\r\n/* 响应式优化 */\r\n@media screen and (max-width: 768px) {\r\n  .el-card__body, .el-main{\r\n    padding: 0;\r\n  }\r\n  .upload-row {\r\n    flex-direction: column;\r\n    gap: 8px;\r\n  }\r\n\r\n  .upload-row .el-button,\r\n  .upload-row .el-select {\r\n    //width: 100%;\r\n  }\r\n\r\n  /* 移动端表格优化 */\r\n  ::v-deep .el-table .el-table__cell {\r\n    padding: 8px 4px;\r\n  }\r\n\r\n  ::v-deep .el-table th.el-table__cell > .cell {\r\n    padding-left: 4px !important;\r\n    padding-right: 4px !important;\r\n  }\r\n\r\n  /* 移动端图片大小调整 */\r\n  .el-image {\r\n    width: 60px !important;\r\n    height: 60px !important;\r\n  }\r\n\r\n  .img-info {\r\n    font-size: 10px !important;\r\n  }\r\n}\r\n\r\n/* 进度条动画 */\r\n::v-deep .el-progress-bar__outer {\r\n  background-color: #e4e7ed;\r\n}\r\n\r\n::v-deep .el-progress-bar__inner {\r\n  transition: width 0.3s ease;\r\n  background: linear-gradient(90deg, #409eff 0%, #67c23a 100%);\r\n  animation: progress-active 2s ease-in-out infinite;\r\n}\r\n\r\n@keyframes progress-active {\r\n  0% {\r\n    background-position: 0% 50%;\r\n  }\r\n  50% {\r\n    background-position: 100% 50%;\r\n  }\r\n  100% {\r\n    background-position: 0% 50%;\r\n  }\r\n}\r\n\r\n/* 标签样式优化 */\r\n::v-deep .el-tag {\r\n  border-radius: 12px;\r\n  font-size: 12px;\r\n}\r\n\r\n/* 复制按钮样式 */\r\n::v-deep .el-button--text {\r\n  color: #409eff;\r\n  font-size: 12px;\r\n}\r\n\r\n::v-deep .el-button--text:hover {\r\n  color: #66b1ff;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OcrView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OcrView.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./OcrView.vue?vue&type=template&id=6cd6fec8&scoped=true\"\nimport script from \"./OcrView.vue?vue&type=script&lang=js\"\nexport * from \"./OcrView.vue?vue&type=script&lang=js\"\nimport style0 from \"./OcrView.vue?vue&type=style&index=0&id=6cd6fec8&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6cd6fec8\",\n  null\n  \n)\n\nexport default component.exports","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; };\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) });\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: true });\n  defineProperty(\n    GeneratorFunctionPrototype,\n    \"constructor\",\n    { value: GeneratorFunction, configurable: true }\n  );\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    defineProperty(this, \"_invoke\", { value: enqueue });\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method;\n    var method = delegate.iterator[methodName];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method, or a missing .next mehtod, always terminate the\n      // yield* loop.\n      context.delegate = null;\n\n      // Note: [\"return\"] must be used for ES3 parsing compatibility.\n      if (methodName === \"throw\" && delegate.iterator[\"return\"]) {\n        // If the delegate iterator has a return method, give it a\n        // chance to clean up.\n        context.method = \"return\";\n        context.arg = undefined;\n        maybeInvokeDelegate(delegate, context);\n\n        if (context.method === \"throw\") {\n          // If maybeInvokeDelegate(context) changed context.method from\n          // \"return\" to \"throw\", let that override the TypeError below.\n          return ContinueSentinel;\n        }\n      }\n      if (methodName !== \"return\") {\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a '\" + methodName + \"' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(val) {\n    var object = Object(val);\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","import * as XLSX from 'xlsx';\n\n/**\n * Excel处理工具类\n */\nexport class ExcelUtil {\n    /**\n     * 导出数据到Excel\n     * @param {Array} data - 数据数组\n     * @param {string} filename - 文件名\n     * @param {string} sheetName - 工作表名称\n     * @param {Object} options - 选项\n     */\n    static exportToExcel(data, filename = 'export.xlsx', sheetName = 'Sheet1', options = {}) {\n        try {\n            if (!data || data.length === 0) {\n                throw new Error('导出数据不能为空');\n            }\n\n            // 创建工作簿\n            const wb = XLSX.utils.book_new();\n            \n            // 创建工作表\n            const ws = XLSX.utils.json_to_sheet(data, options);\n            \n            // 添加工作表到工作簿\n            XLSX.utils.book_append_sheet(wb, ws, sheetName);\n            \n            // 导出文件\n            XLSX.writeFile(wb, filename);\n            \n            return true;\n        } catch (error) {\n            console.error('Excel导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * 导出OCR识别结果到Excel\n     * @param {Array} imgs - 图片数组\n     * @param {string} filename - 文件名\n     */\n    static exportOcrResults(imgs, filename = 'ocr_results.xlsx') {\n        const data = imgs\n            .filter(img => img.recognizedText && img.recognizedText.trim())\n            .map((img, index) => ({\n                '序号': index + 1,\n                '文件名': img.imgFile ? img.imgFile.name : `图片${index + 1}`,\n                '识别状态': img.status,\n                '识别文字': img.recognizedText,\n                '用时(秒)': img.duration || 0,\n                '错误信息': img.errorMessage || ''\n            }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的识别结果');\n        }\n\n        return this.exportToExcel(data, filename, 'OCR识别结果');\n    }\n\n    /**\n     * 导出颜色分析结果到Excel\n     * @param {Array} colors - 颜色数组\n     * @param {string} filename - 文件名\n     */\n    static exportColorResults(colors, filename = 'color_analysis.xlsx') {\n        const data = colors.map((color, index) => ({\n            '序号': index + 1,\n            'RGB': `rgb(${color.rgb.join(', ')})`,\n            'HEX': `#${color.hex}`,\n            'HSL': color.hsl ? `hsl(${color.hsl.join(', ')})` : '',\n            '占比': color.percentage ? `${color.percentage}%` : '',\n            '像素数': color.count || 0\n        }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的颜色数据');\n        }\n\n        return this.exportToExcel(data, filename, '颜色分析结果');\n    }\n\n    /**\n     * 导出EXIF信息到Excel\n     * @param {Object} exifData - EXIF数据\n     * @param {string} filename - 文件名\n     */\n    static exportExifData(exifData, filename = 'exif_data.xlsx') {\n        const data = Object.entries(exifData).map(([key, value]) => ({\n            '属性': key,\n            '值': value\n        }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的EXIF数据');\n        }\n\n        return this.exportToExcel(data, filename, 'EXIF信息');\n    }\n\n    /**\n     * 导出二维码识别结果到Excel\n     * @param {Array} qrResults - 二维码结果数组\n     * @param {string} filename - 文件名\n     */\n    static exportQrResults(qrResults, filename = 'qr_results.xlsx') {\n        const data = qrResults\n            .filter(result => result.text && result.text.trim())\n            .map((result, index) => ({\n                '序号': index + 1,\n                '文件名': result.fileName || `图片${index + 1}`,\n                '二维码内容': result.text,\n                '格式': result.format || 'QR_CODE',\n                '识别状态': result.status || '成功'\n            }));\n\n        if (data.length === 0) {\n            throw new Error('没有可导出的二维码识别结果');\n        }\n\n        return this.exportToExcel(data, filename, '二维码识别结果');\n    }\n\n    /**\n     * 读取Excel文件\n     * @param {File} file - Excel文件\n     * @returns {Promise<Object>} Excel数据\n     */\n    static readExcelFile(file) {\n        return new Promise((resolve, reject) => {\n            if (!file) {\n                reject(new Error('文件不能为空'));\n                return;\n            }\n\n            const reader = new FileReader();\n            \n            reader.onload = (e) => {\n                try {\n                    const data = new Uint8Array(e.target.result);\n                    const workbook = XLSX.read(data, { type: 'array' });\n                    \n                    const result = {};\n                    workbook.SheetNames.forEach(sheetName => {\n                        const worksheet = workbook.Sheets[sheetName];\n                        result[sheetName] = XLSX.utils.sheet_to_json(worksheet);\n                    });\n                    \n                    resolve(result);\n                } catch (error) {\n                    reject(new Error(`Excel文件读取失败: ${error.message}`));\n                }\n            };\n            \n            reader.onerror = () => {\n                reject(new Error('文件读取失败'));\n            };\n            \n            reader.readAsArrayBuffer(file);\n        });\n    }\n\n    /**\n     * 创建带样式的Excel工作表\n     * @param {Array} data - 数据数组\n     * @param {Object} styles - 样式配置\n     * @returns {Object} 工作表对象\n     */\n    static createStyledWorksheet(data, styles = {}) {\n        const ws = XLSX.utils.json_to_sheet(data);\n        \n        // 设置列宽\n        if (styles.columnWidths) {\n            ws['!cols'] = styles.columnWidths.map(width => ({ wch: width }));\n        }\n        \n        // 设置行高\n        if (styles.rowHeights) {\n            ws['!rows'] = styles.rowHeights.map(height => ({ hpt: height }));\n        }\n        \n        return ws;\n    }\n\n    /**\n     * 批量导出多个工作表\n     * @param {Array} sheets - 工作表数组 [{name, data, options}]\n     * @param {string} filename - 文件名\n     */\n    static exportMultipleSheets(sheets, filename = 'export.xlsx') {\n        try {\n            if (!sheets || sheets.length === 0) {\n                throw new Error('工作表数据不能为空');\n            }\n\n            const wb = XLSX.utils.book_new();\n            \n            sheets.forEach(sheet => {\n                if (!sheet.name || !sheet.data) {\n                    throw new Error('工作表必须包含name和data属性');\n                }\n                \n                const ws = XLSX.utils.json_to_sheet(sheet.data, sheet.options || {});\n                XLSX.utils.book_append_sheet(wb, ws, sheet.name);\n            });\n            \n            XLSX.writeFile(wb, filename);\n            \n            return true;\n        } catch (error) {\n            console.error('多工作表导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * 将数据转换为CSV格式\n     * @param {Array} data - 数据数组\n     * @param {string} delimiter - 分隔符\n     * @returns {string} CSV字符串\n     */\n    static dataToCSV(data, delimiter = ',') {\n        if (!data || data.length === 0) {\n            return '';\n        }\n\n        const headers = Object.keys(data[0]);\n        const csvContent = [\n            headers.join(delimiter),\n            ...data.map(row => \n                headers.map(header => {\n                    const value = row[header];\n                    // 如果值包含分隔符、换行符或引号，需要用引号包围\n                    if (typeof value === 'string' && \n                        (value.includes(delimiter) || value.includes('\\n') || value.includes('\"'))) {\n                        return `\"${value.replace(/\"/g, '\"\"')}\"`;\n                    }\n                    return value;\n                }).join(delimiter)\n            )\n        ].join('\\n');\n\n        return csvContent;\n    }\n\n    /**\n     * 导出CSV文件\n     * @param {Array} data - 数据数组\n     * @param {string} filename - 文件名\n     * @param {string} delimiter - 分隔符\n     */\n    static exportToCSV(data, filename = 'export.csv', delimiter = ',') {\n        try {\n            const csvContent = this.dataToCSV(data, delimiter);\n\n            if (!csvContent) {\n                throw new Error('没有可导出的数据');\n            }\n\n            const blob = new Blob(['\\ufeff' + csvContent], {\n                type: 'text/csv;charset=utf-8;'\n            });\n\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(blob);\n            link.download = filename;\n            link.style.display = 'none';\n\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n\n            URL.revokeObjectURL(link.href);\n\n            return true;\n        } catch (error) {\n            console.error('CSV导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * 导出图片颜色分析结果到Excel\n     * @param {Array} colorResults - 颜色分析结果数组\n     * @param {string} filename - 文件名\n     */\n    static exportColorAnalysis(colorResults, filename) {\n        try {\n            if (!colorResults || colorResults.length === 0) {\n                throw new Error('没有可导出的颜色分析结果');\n            }\n\n            // 过滤出已分析的结果\n            const analyzedResults = colorResults.filter(result => result.analyzed);\n\n            if (analyzedResults.length === 0) {\n                throw new Error('没有已完成分析的图片');\n            }\n\n            // 准备数据\n            const header = ['文件名', '主色RGB', '主色HEX', '平均色RGB', '平均色HEX'];\n            const data = analyzedResults.map(result => [\n                result.imgFile.name,\n                result.mainColor ? `rgb(${result.mainColor.join(', ')})` : '',\n                result.mainColor ? '#' + this.rgbToHex(result.mainColor) : '',\n                result.avgColor ? `rgb(${result.avgColor.join(', ')})` : '',\n                result.avgColor ? '#' + this.rgbToHex(result.avgColor) : ''\n            ]);\n\n            // 创建工作表\n            const ws = XLSX.utils.aoa_to_sheet([header, ...data]);\n\n            // 设置单元格样式\n            this.setColorCellStyles(ws, data);\n\n            // 设置列宽\n            ws['!cols'] = [\n                { wch: 20 }, // 文件名\n                { wch: 18 }, // 主色RGB\n                { wch: 14 }, // 主色HEX\n                { wch: 18 }, // 平均色RGB\n                { wch: 14 }  // 平均色HEX\n            ];\n\n            // 创建工作簿并导出\n            const wb = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(wb, ws, '主色平均色');\n\n            // 生成文件名\n            const finalFilename = filename || this.generateTimestampFilename('图片主色平均色', 'xlsx');\n            XLSX.writeFile(wb, finalFilename);\n\n            return true;\n        } catch (error) {\n            console.error('颜色分析结果导出失败:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * RGB转HEX（内部使用）\n     * @param {Array} rgb - RGB数组\n     * @returns {string} HEX字符串\n     */\n    static rgbToHex(rgb) {\n        if (!rgb || rgb.length !== 3) return '';\n        return rgb.map(x => x.toString(16).padStart(2, '0')).join('').toUpperCase();\n    }\n\n    /**\n     * 设置颜色单元格样式\n     * @param {Object} ws - 工作表对象\n     * @param {Array} data - 数据数组\n     */\n    static setColorCellStyles(ws, data) {\n        const mainRgbColIdx = 1, mainHexColIdx = 2, avgRgbColIdx = 3, avgHexColIdx = 4;\n\n        for (let i = 1; i <= data.length; i++) {\n            const mainHex = data[i-1][mainHexColIdx];\n            const avgHex = data[i-1][avgHexColIdx];\n\n            // 设置主色RGB单元格样式\n            if (mainHex) {\n                const mainRgbCell = ws[XLSX.utils.encode_cell({c: mainRgbColIdx, r: i})];\n                const mainHexCell = ws[XLSX.utils.encode_cell({c: mainHexColIdx, r: i})];\n\n                if (mainRgbCell) {\n                    mainRgbCell.s = {\n                        fill: { fgColor: { rgb: mainHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(mainHex) } }\n                    };\n                }\n\n                if (mainHexCell) {\n                    mainHexCell.s = {\n                        fill: { fgColor: { rgb: mainHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(mainHex) } }\n                    };\n                }\n            }\n\n            // 设置平均色RGB单元格样式\n            if (avgHex) {\n                const avgRgbCell = ws[XLSX.utils.encode_cell({c: avgRgbColIdx, r: i})];\n                const avgHexCell = ws[XLSX.utils.encode_cell({c: avgHexColIdx, r: i})];\n\n                if (avgRgbCell) {\n                    avgRgbCell.s = {\n                        fill: { fgColor: { rgb: avgHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(avgHex) } }\n                    };\n                }\n\n                if (avgHexCell) {\n                    avgHexCell.s = {\n                        fill: { fgColor: { rgb: avgHex.replace('#','') } },\n                        font: { color: { rgb: this.getContrastYIQ(avgHex) } }\n                    };\n                }\n            }\n        }\n    }\n\n    /**\n     * 计算对比色（YIQ公式）\n     * @param {string} hex - HEX颜色值\n     * @returns {string} 对比色（000000 或 FFFFFF）\n     */\n    static getContrastYIQ(hex) {\n        let r = 0, g = 0, b = 0;\n\n        if (hex.length === 7) { // #RRGGBB\n            r = parseInt(hex.substr(1,2),16);\n            g = parseInt(hex.substr(3,2),16);\n            b = parseInt(hex.substr(5,2),16);\n        } else if (hex.length === 4) { // #RGB\n            r = parseInt(hex[1]+hex[1],16);\n            g = parseInt(hex[2]+hex[2],16);\n            b = parseInt(hex[3]+hex[3],16);\n        }\n\n        // YIQ公式\n        const yiq = (r*299 + g*587 + b*114) / 1000;\n        return yiq >= 128 ? '000000' : 'FFFFFF';\n    }\n\n    /**\n     * 生成带时间戳的文件名\n     * @param {string} baseName - 基础文件名\n     * @param {string} extension - 文件扩展名\n     * @returns {string} 完整文件名\n     */\n    static generateTimestampFilename(baseName, extension) {\n        const now = new Date();\n        const pad = n => n.toString().padStart(2, '0');\n        const timeStr = `${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}_${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;\n        return `${baseName}_${timeStr}.${extension}`;\n    }\n}\n","'use strict';\n\nconst createWorker = require('./createWorker');\n\nconst recognize = async (image, langs, options) => {\n  const worker = await createWorker(langs, 1, options);\n  return worker.recognize(image)\n    .finally(async () => {\n      await worker.terminate();\n    });\n};\n\nconst detect = async (image, options) => {\n  const worker = await createWorker('osd', 0, options);\n  return worker.detect(image)\n    .finally(async () => {\n      await worker.terminate();\n    });\n};\n\nmodule.exports = {\n  recognize,\n  detect,\n};\n","'use strict';\n\n/*\n * OEM = OCR Engine Mode, and there are 4 possible modes.\n *\n * By default tesseract.js uses LSTM_ONLY mode.\n *\n */\nmodule.exports = {\n  TESSERACT_ONLY: 0,\n  LSTM_ONLY: 1,\n  TESSERACT_LSTM_COMBINED: 2,\n  DEFAULT: 3,\n};\n","'use strict';\n\n/*\n * PSM = Page Segmentation Mode\n */\nmodule.exports = {\n  OSD_ONLY: '0',\n  AUTO_OSD: '1',\n  AUTO_ONLY: '2',\n  AUTO: '3',\n  SINGLE_COLUMN: '4',\n  SINGLE_BLOCK_VERT_TEXT: '5',\n  SINGLE_BLOCK: '6',\n  SINGLE_LINE: '7',\n  SINGLE_WORD: '8',\n  CIRCLE_WORD: '9',\n  SINGLE_CHAR: '10',\n  SPARSE_TEXT: '11',\n  SPARSE_TEXT_OSD: '12',\n  RAW_LINE: '13',\n};\n","'use strict';\n\nmodule.exports = {\n  /*\n   * Use BlobURL for worker script by default\n   * TODO: remove this option\n   *\n   */\n  workerBlobURL: true,\n  logger: () => {},\n};\n","'use strict';\n\n/*\n * languages with existing tesseract traineddata\n * https://tesseract-ocr.github.io/tessdoc/Data-Files#data-files-for-version-400-november-29-2016\n */\n\n/**\n * @typedef {object} Languages\n * @property {string} AFR Afrikaans\n * @property {string} AMH Amharic\n * @property {string} ARA Arabic\n * @property {string} ASM Assamese\n * @property {string} AZE Azerbaijani\n * @property {string} AZE_CYRL Azerbaijani - Cyrillic\n * @property {string} BEL Belarusian\n * @property {string} BEN Bengali\n * @property {string} BOD Tibetan\n * @property {string} BOS Bosnian\n * @property {string} BUL Bulgarian\n * @property {string} CAT Catalan; Valencian\n * @property {string} CEB Cebuano\n * @property {string} CES Czech\n * @property {string} CHI_SIM Chinese - Simplified\n * @property {string} CHI_TRA Chinese - Traditional\n * @property {string} CHR Cherokee\n * @property {string} CYM Welsh\n * @property {string} DAN Danish\n * @property {string} DEU German\n * @property {string} DZO Dzongkha\n * @property {string} ELL Greek, Modern (1453-)\n * @property {string} ENG English\n * @property {string} ENM English, Middle (1100-1500)\n * @property {string} EPO Esperanto\n * @property {string} EST Estonian\n * @property {string} EUS Basque\n * @property {string} FAS Persian\n * @property {string} FIN Finnish\n * @property {string} FRA French\n * @property {string} FRK German Fraktur\n * @property {string} FRM French, Middle (ca. 1400-1600)\n * @property {string} GLE Irish\n * @property {string} GLG Galician\n * @property {string} GRC Greek, Ancient (-1453)\n * @property {string} GUJ Gujarati\n * @property {string} HAT Haitian; Haitian Creole\n * @property {string} HEB Hebrew\n * @property {string} HIN Hindi\n * @property {string} HRV Croatian\n * @property {string} HUN Hungarian\n * @property {string} IKU Inuktitut\n * @property {string} IND Indonesian\n * @property {string} ISL Icelandic\n * @property {string} ITA Italian\n * @property {string} ITA_OLD Italian - Old\n * @property {string} JAV Javanese\n * @property {string} JPN Japanese\n * @property {string} KAN Kannada\n * @property {string} KAT Georgian\n * @property {string} KAT_OLD Georgian - Old\n * @property {string} KAZ Kazakh\n * @property {string} KHM Central Khmer\n * @property {string} KIR Kirghiz; Kyrgyz\n * @property {string} KOR Korean\n * @property {string} KUR Kurdish\n * @property {string} LAO Lao\n * @property {string} LAT Latin\n * @property {string} LAV Latvian\n * @property {string} LIT Lithuanian\n * @property {string} MAL Malayalam\n * @property {string} MAR Marathi\n * @property {string} MKD Macedonian\n * @property {string} MLT Maltese\n * @property {string} MSA Malay\n * @property {string} MYA Burmese\n * @property {string} NEP Nepali\n * @property {string} NLD Dutch; Flemish\n * @property {string} NOR Norwegian\n * @property {string} ORI Oriya\n * @property {string} PAN Panjabi; Punjabi\n * @property {string} POL Polish\n * @property {string} POR Portuguese\n * @property {string} PUS Pushto; Pashto\n * @property {string} RON Romanian; Moldavian; Moldovan\n * @property {string} RUS Russian\n * @property {string} SAN Sanskrit\n * @property {string} SIN Sinhala; Sinhalese\n * @property {string} SLK Slovak\n * @property {string} SLV Slovenian\n * @property {string} SPA Spanish; Castilian\n * @property {string} SPA_OLD Spanish; Castilian - Old\n * @property {string} SQI Albanian\n * @property {string} SRP Serbian\n * @property {string} SRP_LATN Serbian - Latin\n * @property {string} SWA Swahili\n * @property {string} SWE Swedish\n * @property {string} SYR Syriac\n * @property {string} TAM Tamil\n * @property {string} TEL Telugu\n * @property {string} TGK Tajik\n * @property {string} TGL Tagalog\n * @property {string} THA Thai\n * @property {string} TIR Tigrinya\n * @property {string} TUR Turkish\n * @property {string} UIG Uighur; Uyghur\n * @property {string} UKR Ukrainian\n * @property {string} URD Urdu\n * @property {string} UZB Uzbek\n * @property {string} UZB_CYRL Uzbek - Cyrillic\n * @property {string} VIE Vietnamese\n * @property {string} YID Yiddish\n */\n\n/**\n  * @type {Languages}\n  */\nmodule.exports = {\n  AFR: 'afr',\n  AMH: 'amh',\n  ARA: 'ara',\n  ASM: 'asm',\n  AZE: 'aze',\n  AZE_CYRL: 'aze_cyrl',\n  BEL: 'bel',\n  BEN: 'ben',\n  BOD: 'bod',\n  BOS: 'bos',\n  BUL: 'bul',\n  CAT: 'cat',\n  CEB: 'ceb',\n  CES: 'ces',\n  CHI_SIM: 'chi_sim',\n  CHI_TRA: 'chi_tra',\n  CHR: 'chr',\n  CYM: 'cym',\n  DAN: 'dan',\n  DEU: 'deu',\n  DZO: 'dzo',\n  ELL: 'ell',\n  ENG: 'eng',\n  ENM: 'enm',\n  EPO: 'epo',\n  EST: 'est',\n  EUS: 'eus',\n  FAS: 'fas',\n  FIN: 'fin',\n  FRA: 'fra',\n  FRK: 'frk',\n  FRM: 'frm',\n  GLE: 'gle',\n  GLG: 'glg',\n  GRC: 'grc',\n  GUJ: 'guj',\n  HAT: 'hat',\n  HEB: 'heb',\n  HIN: 'hin',\n  HRV: 'hrv',\n  HUN: 'hun',\n  IKU: 'iku',\n  IND: 'ind',\n  ISL: 'isl',\n  ITA: 'ita',\n  ITA_OLD: 'ita_old',\n  JAV: 'jav',\n  JPN: 'jpn',\n  KAN: 'kan',\n  KAT: 'kat',\n  KAT_OLD: 'kat_old',\n  KAZ: 'kaz',\n  KHM: 'khm',\n  KIR: 'kir',\n  KOR: 'kor',\n  KUR: 'kur',\n  LAO: 'lao',\n  LAT: 'lat',\n  LAV: 'lav',\n  LIT: 'lit',\n  MAL: 'mal',\n  MAR: 'mar',\n  MKD: 'mkd',\n  MLT: 'mlt',\n  MSA: 'msa',\n  MYA: 'mya',\n  NEP: 'nep',\n  NLD: 'nld',\n  NOR: 'nor',\n  ORI: 'ori',\n  PAN: 'pan',\n  POL: 'pol',\n  POR: 'por',\n  PUS: 'pus',\n  RON: 'ron',\n  RUS: 'rus',\n  SAN: 'san',\n  SIN: 'sin',\n  SLK: 'slk',\n  SLV: 'slv',\n  SPA: 'spa',\n  SPA_OLD: 'spa_old',\n  SQI: 'sqi',\n  SRP: 'srp',\n  SRP_LATN: 'srp_latn',\n  SWA: 'swa',\n  SWE: 'swe',\n  SYR: 'syr',\n  TAM: 'tam',\n  TEL: 'tel',\n  TGK: 'tgk',\n  TGL: 'tgl',\n  THA: 'tha',\n  TIR: 'tir',\n  TUR: 'tur',\n  UIG: 'uig',\n  UKR: 'ukr',\n  URD: 'urd',\n  UZB: 'uzb',\n  UZB_CYRL: 'uzb_cyrl',\n  VIE: 'vie',\n  YID: 'yid',\n};\n","'use strict';\n\nconst getId = require('./utils/getId');\n\nlet jobCounter = 0;\n\nmodule.exports = ({\n  id: _id,\n  action,\n  payload = {},\n}) => {\n  let id = _id;\n  if (typeof id === 'undefined') {\n    id = getId('Job', jobCounter);\n    jobCounter += 1;\n  }\n\n  return {\n    id,\n    action,\n    payload,\n  };\n};\n","'use strict';\n\nconst createJob = require('./createJob');\nconst { log } = require('./utils/log');\nconst getId = require('./utils/getId');\n\nlet schedulerCounter = 0;\n\nmodule.exports = () => {\n  const id = getId('Scheduler', schedulerCounter);\n  const workers = {};\n  const runningWorkers = {};\n  let jobQueue = [];\n\n  schedulerCounter += 1;\n\n  const getQueueLen = () => jobQueue.length;\n  const getNumWorkers = () => Object.keys(workers).length;\n\n  const dequeue = () => {\n    if (jobQueue.length !== 0) {\n      const wIds = Object.keys(workers);\n      for (let i = 0; i < wIds.length; i += 1) {\n        if (typeof runningWorkers[wIds[i]] === 'undefined') {\n          jobQueue[0](workers[wIds[i]]);\n          break;\n        }\n      }\n    }\n  };\n\n  const queue = (action, payload) => (\n    new Promise((resolve, reject) => {\n      const job = createJob({ action, payload });\n      jobQueue.push(async (w) => {\n        jobQueue.shift();\n        runningWorkers[w.id] = job;\n        try {\n          resolve(await w[action].apply(this, [...payload, job.id]));\n        } catch (err) {\n          reject(err);\n        } finally {\n          delete runningWorkers[w.id];\n          dequeue();\n        }\n      });\n      log(`[${id}]: Add ${job.id} to JobQueue`);\n      log(`[${id}]: JobQueue length=${jobQueue.length}`);\n      dequeue();\n    })\n  );\n\n  const addWorker = (w) => {\n    workers[w.id] = w;\n    log(`[${id}]: Add ${w.id}`);\n    log(`[${id}]: Number of workers=${getNumWorkers()}`);\n    dequeue();\n    return w.id;\n  };\n\n  const addJob = async (action, ...payload) => {\n    if (getNumWorkers() === 0) {\n      throw Error(`[${id}]: You need to have at least one worker before adding jobs`);\n    }\n    return queue(action, payload);\n  };\n\n  const terminate = async () => {\n    Object.keys(workers).forEach(async (wid) => {\n      await workers[wid].terminate();\n    });\n    jobQueue = [];\n  };\n\n  return {\n    addWorker,\n    addJob,\n    terminate,\n    getQueueLen,\n    getNumWorkers,\n  };\n};\n","'use strict';\n\nconst resolvePaths = require('./utils/resolvePaths');\nconst createJob = require('./createJob');\nconst { log } = require('./utils/log');\nconst getId = require('./utils/getId');\nconst OEM = require('./constants/OEM');\nconst {\n  defaultOptions,\n  spawnWorker,\n  terminateWorker,\n  onMessage,\n  loadImage,\n  send,\n} = require('./worker/node');\n\nlet workerCounter = 0;\n\nmodule.exports = async (langs = 'eng', oem = OEM.LSTM_ONLY, _options = {}, config = {}) => {\n  const id = getId('Worker', workerCounter);\n  const {\n    logger,\n    errorHandler,\n    ...options\n  } = resolvePaths({\n    ...defaultOptions,\n    ..._options,\n  });\n  const promises = {};\n\n  // Current langs, oem, and config file.\n  // Used if the user ever re-initializes the worker using `worker.reinitialize`.\n  const currentLangs = typeof langs === 'string' ? langs.split('+') : langs;\n  let currentOem = oem;\n  let currentConfig = config;\n  const lstmOnlyCore = [OEM.DEFAULT, OEM.LSTM_ONLY].includes(oem) && !options.legacyCore;\n\n  let workerResReject;\n  let workerResResolve;\n  const workerRes = new Promise((resolve, reject) => {\n    workerResResolve = resolve;\n    workerResReject = reject;\n  });\n  const workerError = (event) => { workerResReject(event.message); };\n\n  let worker = spawnWorker(options);\n  worker.onerror = workerError;\n\n  workerCounter += 1;\n\n  const startJob = ({ id: jobId, action, payload }) => (\n    new Promise((resolve, reject) => {\n      log(`[${id}]: Start ${jobId}, action=${action}`);\n      // Using both `action` and `jobId` in case user provides non-unique `jobId`.\n      const promiseId = `${action}-${jobId}`;\n      promises[promiseId] = { resolve, reject };\n      send(worker, {\n        workerId: id,\n        jobId,\n        action,\n        payload,\n      });\n    })\n  );\n\n  const load = () => (\n    console.warn('`load` is depreciated and should be removed from code (workers now come pre-loaded)')\n  );\n\n  const loadInternal = (jobId) => (\n    startJob(createJob({\n      id: jobId, action: 'load', payload: { options: { lstmOnly: lstmOnlyCore, corePath: options.corePath, logging: options.logging } },\n    }))\n  );\n\n  const writeText = (path, text, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method: 'writeFile', args: [path, text] },\n    }))\n  );\n\n  const readText = (path, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method: 'readFile', args: [path, { encoding: 'utf8' }] },\n    }))\n  );\n\n  const removeFile = (path, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method: 'unlink', args: [path] },\n    }))\n  );\n\n  const FS = (method, args, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method, args },\n    }))\n  );\n\n  const loadLanguageInternal = (_langs, jobId) => startJob(createJob({\n    id: jobId,\n    action: 'loadLanguage',\n    payload: {\n      langs: _langs,\n      options: {\n        langPath: options.langPath,\n        dataPath: options.dataPath,\n        cachePath: options.cachePath,\n        cacheMethod: options.cacheMethod,\n        gzip: options.gzip,\n        lstmOnly: [OEM.DEFAULT, OEM.LSTM_ONLY].includes(currentOem)\n          && !options.legacyLang,\n      },\n    },\n  }));\n\n  const initializeInternal = (_langs, _oem, _config, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'initialize',\n      payload: { langs: _langs, oem: _oem, config: _config },\n    }))\n  );\n\n  const reinitialize = (langs = 'eng', oem, config, jobId) => { // eslint-disable-line\n\n    if (lstmOnlyCore && [OEM.TESSERACT_ONLY, OEM.TESSERACT_LSTM_COMBINED].includes(oem)) throw Error('Legacy model requested but code missing.');\n\n    const _oem = oem || currentOem;\n    currentOem = _oem;\n\n    const _config = config || currentConfig;\n    currentConfig = _config;\n\n    // Only load langs that are not already loaded.\n    // This logic fails if the user downloaded the LSTM-only English data for a language\n    // and then uses `worker.reinitialize` to switch to the Legacy engine.\n    // However, the correct data will still be downloaded after initialization fails\n    // and this can be avoided entirely if the user loads the correct data ahead of time.\n    const langsArr = typeof langs === 'string' ? langs.split('+') : langs;\n    const _langs = langsArr.filter((x) => !currentLangs.includes(x));\n    currentLangs.push(..._langs);\n\n    if (_langs.length > 0) {\n      return loadLanguageInternal(_langs, jobId)\n        .then(() => initializeInternal(langs, _oem, _config, jobId));\n    }\n\n    return initializeInternal(langs, _oem, _config, jobId);\n  };\n\n  const setParameters = (params = {}, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'setParameters',\n      payload: { params },\n    }))\n  );\n\n  const recognize = async (image, opts = {}, output = {\n    text: true,\n  }, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'recognize',\n      payload: { image: await loadImage(image), options: opts, output },\n    }))\n  );\n\n  const detect = async (image, jobId) => {\n    if (lstmOnlyCore) throw Error('`worker.detect` requires Legacy model, which was not loaded.');\n\n    return startJob(createJob({\n      id: jobId,\n      action: 'detect',\n      payload: { image: await loadImage(image) },\n    }));\n  };\n\n  const terminate = async () => {\n    if (worker !== null) {\n      /*\n      await startJob(createJob({\n        id: jobId,\n        action: 'terminate',\n      }));\n      */\n      terminateWorker(worker);\n      worker = null;\n    }\n    return Promise.resolve();\n  };\n\n  onMessage(worker, ({\n    workerId, jobId, status, action, data,\n  }) => {\n    const promiseId = `${action}-${jobId}`;\n    if (status === 'resolve') {\n      log(`[${workerId}]: Complete ${jobId}`);\n      promises[promiseId].resolve({ jobId, data });\n      delete promises[promiseId];\n    } else if (status === 'reject') {\n      promises[promiseId].reject(data);\n      delete promises[promiseId];\n      if (action === 'load') workerResReject(data);\n      if (errorHandler) {\n        errorHandler(data);\n      } else {\n        throw Error(data);\n      }\n    } else if (status === 'progress') {\n      logger({ ...data, userJobId: jobId });\n    }\n  });\n\n  const resolveObj = {\n    id,\n    worker,\n    load,\n    writeText,\n    readText,\n    removeFile,\n    FS,\n    reinitialize,\n    setParameters,\n    recognize,\n    detect,\n    terminate,\n  };\n\n  loadInternal()\n    .then(() => loadLanguageInternal(langs))\n    .then(() => initializeInternal(langs, oem, config))\n    .then(() => workerResResolve(resolveObj))\n    .catch(() => {});\n\n  return workerRes;\n};\n","'use strict';\n\n/**\n *\n * Entry point for tesseract.js, should be the entry when bundling.\n *\n * @fileoverview entry point for tesseract.js\n * @author Kevin Kwok <antimatter15@gmail.com>\n * @author Guillermo Webster <gui@mit.edu>\n * @author Jerome Wu <jeromewus@gmail.com>\n */\nrequire('regenerator-runtime/runtime');\nconst createScheduler = require('./createScheduler');\nconst createWorker = require('./createWorker');\nconst Tesseract = require('./Tesseract');\nconst languages = require('./constants/languages');\nconst OEM = require('./constants/OEM');\nconst PSM = require('./constants/PSM');\nconst { setLogging } = require('./utils/log');\n\nmodule.exports = {\n  languages,\n  OEM,\n  PSM,\n  createScheduler,\n  createWorker,\n  setLogging,\n  ...Tesseract,\n};\n","'use strict';\n\nmodule.exports = (key) => {\n  const env = {};\n\n  if (typeof WorkerGlobalScope !== 'undefined') {\n    env.type = 'webworker';\n  } else if (typeof document === 'object') {\n    env.type = 'browser';\n  } else if (typeof process === 'object' && typeof require === 'function') {\n    env.type = 'node';\n  }\n\n  if (typeof key === 'undefined') {\n    return env;\n  }\n\n  return env[key];\n};\n","'use strict';\n\nmodule.exports = (prefix, cnt) => (\n  `${prefix}-${cnt}-${Math.random().toString(16).slice(3, 8)}`\n);\n","'use strict';\n\nlet logging = false;\n\nexports.logging = logging;\n\nexports.setLogging = (_logging) => {\n  logging = _logging;\n};\n\nexports.log = (...args) => (logging ? console.log.apply(this, args) : null);\n","'use strict';\n\nconst isBrowser = require('./getEnvironment')('type') === 'browser';\n\nconst resolveURL = isBrowser ? s => (new URL(s, window.location.href)).href : s => s; // eslint-disable-line\n\nmodule.exports = (options) => {\n  const opts = { ...options };\n  ['corePath', 'workerPath', 'langPath'].forEach((key) => {\n    if (options[key]) {\n      opts[key] = resolveURL(opts[key]);\n    }\n  });\n  return opts;\n};\n","'use strict';\n\nconst version = require('../../../package.json').version;\nconst defaultOptions = require('../../constants/defaultOptions');\n\n/*\n * Default options for browser worker\n */\nmodule.exports = {\n  ...defaultOptions,\n  workerPath: `https://cdn.jsdelivr.net/npm/tesseract.js@v${version}/dist/worker.min.js`,\n};\n","'use strict';\n\n/**\n *\n * Tesseract Worker adapter for browser\n *\n * @fileoverview Tesseract Worker adapter for browser\n * @author Kevin Kwok <antimatter15@gmail.com>\n * @author Guillermo Webster <gui@mit.edu>\n * @author Jerome Wu <jeromewus@gmail.com>\n */\nconst defaultOptions = require('./defaultOptions');\nconst spawnWorker = require('./spawnWorker');\nconst terminateWorker = require('./terminateWorker');\nconst onMessage = require('./onMessage');\nconst send = require('./send');\nconst loadImage = require('./loadImage');\n\nmodule.exports = {\n  defaultOptions,\n  spawnWorker,\n  terminateWorker,\n  onMessage,\n  send,\n  loadImage,\n};\n","'use strict';\n\n/**\n * readFromBlobOrFile\n *\n * @name readFromBlobOrFile\n * @function\n * @access private\n */\nconst readFromBlobOrFile = (blob) => (\n  new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = () => {\n      resolve(fileReader.result);\n    };\n    fileReader.onerror = ({ target: { error: { code } } }) => {\n      reject(Error(`File could not be read! Code=${code}`));\n    };\n    fileReader.readAsArrayBuffer(blob);\n  })\n);\n\n/**\n * loadImage\n *\n * @name loadImage\n * @function load image from different source\n * @access private\n */\nconst loadImage = async (image) => {\n  let data = image;\n  if (typeof image === 'undefined') {\n    return 'undefined';\n  }\n\n  if (typeof image === 'string') {\n    // Base64 Image\n    if (/data:image\\/([a-zA-Z]*);base64,([^\"]*)/.test(image)) {\n      data = atob(image.split(',')[1])\n        .split('')\n        .map((c) => c.charCodeAt(0));\n    } else {\n      const resp = await fetch(image);\n      data = await resp.arrayBuffer();\n    }\n  } else if (typeof HTMLElement !== 'undefined' && image instanceof HTMLElement) {\n    if (image.tagName === 'IMG') {\n      data = await loadImage(image.src);\n    }\n    if (image.tagName === 'VIDEO') {\n      data = await loadImage(image.poster);\n    }\n    if (image.tagName === 'CANVAS') {\n      await new Promise((resolve) => {\n        image.toBlob(async (blob) => {\n          data = await readFromBlobOrFile(blob);\n          resolve();\n        });\n      });\n    }\n  } else if (typeof OffscreenCanvas !== 'undefined' && image instanceof OffscreenCanvas) {\n    const blob = await image.convertToBlob();\n    data = await readFromBlobOrFile(blob);\n  } else if (image instanceof File || image instanceof Blob) {\n    data = await readFromBlobOrFile(image);\n  }\n\n  return new Uint8Array(data);\n};\n\nmodule.exports = loadImage;\n","'use strict';\n\nmodule.exports = (worker, handler) => {\n  worker.onmessage = ({ data }) => { // eslint-disable-line\n    handler(data);\n  };\n};\n","'use strict';\n\n/**\n * send\n *\n * @name send\n * @function send packet to worker and create a job\n * @access public\n */\nmodule.exports = async (worker, packet) => {\n  worker.postMessage(packet);\n};\n","'use strict';\n\n/**\n * spawnWorker\n *\n * @name spawnWorker\n * @function create a new Worker in browser\n * @access public\n */\nmodule.exports = ({ workerPath, workerBlobURL }) => {\n  let worker;\n  if (Blob && URL && workerBlobURL) {\n    const blob = new Blob([`importScripts(\"${workerPath}\");`], {\n      type: 'application/javascript',\n    });\n    worker = new Worker(URL.createObjectURL(blob));\n  } else {\n    worker = new Worker(workerPath);\n  }\n\n  return worker;\n};\n","'use strict';\n\n/**\n * terminateWorker\n *\n * @name terminateWorker\n * @function terminate worker\n * @access public\n */\nmodule.exports = (worker) => {\n  worker.terminate();\n};\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","span","offset","_v","isProcessing","handleUploadChange","staticStyle","model","value","language","callback","$$v","expression","_l","languageOptions","item","key","label","imgs","length","on","startBatchRecognition","hasRecognizedResults","resetAllRecognition","$event","$refs","imgTable","clearSelection","multipleSelection","handleBatchDelete","filter","img","status","exportToExcel","clearAll","currentProcessingIndex","_e","ref","row-class-name","row","statusType","handleSelectionChange","scopedSlots","_u","fn","scope","fileName","map","i","_s","fileSize","includes","getStatusText","getStatusDetail","$index","parseInt","match","recognizedText","copyText","handleDeleteRow","staticRenderFns","StringUtil","copy","text","Error","trim","navigator","clipboard","window","isSecureContext","writeText","success","fallbackCopy","error","console","message","input","document","createElement","style","position","left","top","opacity","pointerEvents","body","appendChild","focus","select","setSelectionRange","execCommand","parentNode","removeChild","isClipboardSupported","queryCommandSupported","CanvasUtil","fileToCanvas","file","Promise","resolve","reject","type","startsWith","Image","objectUrl","onload","naturalWidth","naturalHeight","canvas","ctx","getContext","width","height","fillStyle","fillRect","drawImage","URL","revokeObjectURL","onerror","createObjectURL","src","canvasToBlob","quality","toBlob","canvasToDataURL","toDataURL","resizeCanvas","newCanvas","getImageData","putImageData","imageData","enhanceContrast","factor","data","intercept","grayscale","gray","adjustBrightness","brightness","Math","max","min","createCanvas","backgroundColor","mergeCanvases","canvases","direction","totalWidth","totalHeight","maxWidth","maxHeight","forEach","resultCanvas","currentX","currentY","TimeUtil","formatDuration","seconds","hours","floor","minutes","secs","formatTimestamp","timestamp","format","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","getHours","getMinutes","getSeconds","replace","now","today","timeDiff","startTime","endTime","end","timeDiffInSeconds","createTimer","interval","timerId","isRunning","timer","start","tick","elapsed","setTimeout","stop","clearTimeout","reset","getElapsed","delay","ms","timeout","promise","race","_","formatRelativeTime","diff","minute","hour","week","isToday","isThisWeek","monday","setDate","getDay","setHours","sunday","getTimeOfDay","getCurrentTimeOfDay","getBeijingTime","getTime","getTimezoneOffset","formatCountdown","totalSeconds","days","total","isWeekday","isWeekend","add","amount","unit","newDate","setFullYear","setMonth","setMinutes","setSeconds","subtract","name","metaInfo","title","meta","content","computed","some","mounted","__PRERENDER_INJECTED__","methods","formatFileSize","bytes","FileUtil","formatBytes","fileList","f","rawFile","raw","imgInfo","id","random","imgFile","size","errorMessage","duration","validateImage","push","$message","warning","hasRecognized","$confirm","confirmButtonText","cancelButtonText","imagesToProcess","info","recognizeImage","successCount","failCount","result","Tesseract","logger","m","round","progress","ExcelUtil","exportOcrResults","val","index","splice","then","findIndex","catch","beforeDestroy","component","runtime","exports","undefined","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","desc","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","arg","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","_invoke","AsyncIterator","PromiseImpl","invoke","record","__await","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","TypeError","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","filename","sheetName","options","wb","XLSX","book_new","ws","json_to_sheet","book_append_sheet","exportColorResults","colors","color","rgb","join","hex","hsl","percentage","count","exportExifData","exifData","entries","exportQrResults","qrResults","readExcelFile","reader","FileReader","e","Uint8Array","target","workbook","SheetNames","worksheet","Sheets","sheet_to_json","readAsArrayBuffer","createStyledWorksheet","styles","columnWidths","wch","rowHeights","hpt","exportMultipleSheets","sheets","sheet","dataToCSV","delimiter","headers","csvContent","header","exportToCSV","blob","Blob","link","href","download","display","click","exportColorAnalysis","colorResults","analyzedResults","analyzed","mainColor","rgbToHex","avgColor","aoa_to_sheet","setColorCellStyles","finalFilename","generateTimestampFilename","x","toString","toUpperCase","mainRgbColIdx","mainHexColIdx","avgRgbColIdx","avgHexColIdx","mainHex","avgHex","mainRgbCell","encode_cell","c","r","mainHexCell","s","fill","fgColor","font","getContrastYIQ","avgRgbCell","avgHexCell","g","b","substr","yiq","baseName","extension","pad","n","timeStr","createWorker","require","recognize","image","langs","worker","finally","terminate","detect","TESSERACT_ONLY","LSTM_ONLY","TESSERACT_LSTM_COMBINED","DEFAULT","OSD_ONLY","AUTO_OSD","AUTO_ONLY","AUTO","SINGLE_COLUMN","SINGLE_BLOCK_VERT_TEXT","SINGLE_BLOCK","SINGLE_LINE","SINGLE_WORD","CIRCLE_WORD","SINGLE_CHAR","SPARSE_TEXT","SPARSE_TEXT_OSD","RAW_LINE","workerBlobURL","AFR","AMH","ARA","ASM","AZE","AZE_CYRL","BEL","BEN","BOD","BOS","BUL","CAT","CEB","CES","CHI_SIM","CHI_TRA","CHR","CYM","DAN","DEU","DZO","ELL","ENG","ENM","EPO","EST","EUS","FAS","FIN","FRA","FRK","FRM","GLE","GLG","GRC","GUJ","HAT","HEB","HIN","HRV","HUN","IKU","IND","ISL","ITA","ITA_OLD","JAV","JPN","KAN","KAT","KAT_OLD","KAZ","KHM","KIR","KOR","KUR","LAO","LAT","LAV","LIT","MAL","MAR","MKD","MLT","MSA","MYA","NEP","NLD","NOR","ORI","PAN","POL","POR","PUS","RON","RUS","SAN","SIN","SLK","SLV","SPA","SPA_OLD","SQI","SRP","SRP_LATN","SWA","SWE","SYR","TAM","TEL","TGK","TGL","THA","TIR","TUR","UIG","UKR","URD","UZB","UZB_CYRL","VIE","YID","getId","jobCounter","_id","action","payload","createJob","log","schedulerCounter","workers","runningWorkers","jobQueue","getQueueLen","getNumWorkers","dequeue","wIds","queue","job","shift","w","apply","addWorker","addJob","wid","resolvePaths","OEM","defaultOptions","spawnWorker","terminateWorker","onMessage","loadImage","send","workerCounter","oem","_options","config","errorHandler","promises","currentLangs","split","currentOem","currentConfig","lstmOnlyCore","legacyCore","workerResReject","workerResResolve","workerRes","workerError","event","startJob","jobId","promiseId","workerId","load","warn","loadInternal","lstmOnly","corePath","logging","path","args","readText","encoding","removeFile","FS","loadLanguageInternal","_langs","langPath","dataPath","cachePath","cacheMethod","gzip","legacyLang","initializeInternal","_oem","_config","reinitialize","langsArr","setParameters","params","opts","output","userJobId","resolveObj","createScheduler","languages","PSM","setLogging","env","WorkerGlobalScope","process","prefix","cnt","_logging","isBrowser","resolveURL","location","version","workerPath","readFromBlobOrFile","fileReader","code","test","atob","charCodeAt","resp","fetch","arrayBuffer","HTMLElement","tagName","poster","OffscreenCanvas","convertToBlob","File","handler","onmessage","packet","postMessage","Worker"],"sourceRoot":""}